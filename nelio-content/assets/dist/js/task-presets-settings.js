(()=>{var e,t={1163:(e,t,s)=>{"use strict";s.r(t),s.d(t,{initPage:()=>Mt});var n={};s.r(n),s.d(n,{getEditingTask:()=>h,getEditingTaskError:()=>I,getEditingTaskSource:()=>y,getTaskPreset:()=>_,getTaskPresets:()=>j,isEditingTaskDirty:()=>x,isSavingPresets:()=>P,isTaskTemplateEditorOpen:()=>k});var i={};s.r(i),s.d(i,{closeTaskTemplateEditor:()=>L,createTaskPreset:()=>w,editTaskTemplate:()=>D,markAsSaving:()=>A,openTaskTemplateEditor:()=>M,removeTaskPreset:()=>R,resetTaskPresets:()=>N,setTaskPresetName:()=>G,setTaskTemplates:()=>C});var a={};s.r(a),s.d(a,{saveTaskPresets:()=>B});var o={};s.r(o),s.d(o,{areAuthorsValid:()=>Te,getAutomationGroup:()=>te,getAutomationGroups:()=>ee,getCustomFields:()=>me,getCustomPlaceholders:()=>ge,getEditingTemplate:()=>ce,getEditingTemplateErrors:()=>ue,getEditingTemplateType:()=>de,getGroupTermsValidation:()=>ve,getImportExportData:()=>_e,getNetworkAutomationSettings:()=>ne,getProfileAutomationSettings:()=>se,getProfileError:()=>Ee,getProfileFrequencies:()=>pe,getTemplateErrors:()=>je,isDirty:()=>ie,isEditingNetworkTemplate:()=>le,isEditingNewTemplate:()=>re,isEditingTemplate:()=>oe,isGroupValid:()=>Oe,isPostTypeValid:()=>be,isSaving:()=>ae,isTemplateValid:()=>fe});var r={};s.r(r),s.d(r,{addAutomationGroup:()=>ke,addProfileSettings:()=>he,closeTemplateEditor:()=>xe,closeTemplateImportExport:()=>Ie,deleteAutomationGroup:()=>Pe,deleteAutomationGroupTemplate:()=>Se,initAutomationGroups:()=>Ae,markAsNetworkTemplate:()=>Le,markAsSaving:()=>Ve,openTemplateEditor:()=>Ne,openTemplateExporter:()=>Re,openTemplateImporter:()=>we,receiveAutomationGroupTemplates:()=>Ge,receiveCustomFields:()=>Ce,receiveCustomPlaceholders:()=>Me,setAutomationGroupValidation:()=>Ue,setEditingTemplateAttributes:()=>qe,setEditingTemplateErrors:()=>Fe,setProfileFrequencies:()=>De,updateAutomationGroup:()=>ye});var l={};s.r(l),s.d(l,{saveAutomationGroups:()=>Ke});var c={};s.r(c),s.d(c,{getCustomFields:()=>Ze,getCustomPlaceholders:()=>et});const u=window.ReactJSXRuntime,d=window.wp.data;function p(e){(0,d.register)(e)}function m(e,t){return(0,d.useSelect)(e,t)}const g=window.wp.element;function b(e,t){t&&(g.createRoot?(0,g.createRoot)(t).render(e):(0,g.render)(e,t))}const T=window.wp.i18n,v=window.NelioContent.components,O=window.NelioContent.data,E=window.lodash,f={saving:!1,taskPresets:{byId:{},allIds:[]},editor:void 0};function j(e){return e.taskPresets.allIds}function _(e,t){return t?e.taskPresets.byId[t]:void 0}function k(e){return!!e.editor}function y(e){if(!e.editor)return;const{presetId:t,source:s}=e.editor;return{presetId:t,source:s}}function h(e){var t;return(null===(t=e.editor)||void 0===t?void 0:t.attrs)||S}function x(e){if(!e.editor)return!1;const{source:t}=e.editor,s=Object.assign(Object.assign({},e.editor.attrs),{task:(0,E.trim)(e.editor.attrs.task)});return!(0,E.isEqual)(t,s)}function I(e){if(!e.editor)return;const{attrs:t}=e.editor;return""===(0,E.trim)(t.task)?(0,T._x)("Please write a valid task","user","nelio-content"):""===(0,E.trim)(t.dateValue)?(0,T._x)("Please set a valid date","user","nelio-content"):void 0}function P(e){return e.saving}const S={task:"",color:"none",dateType:"predefined-offset",dateValue:"0",assigneeId:void 0};function A(e){return{type:"MARK_AS_SAVING",saving:e}}function N(e){return{type:"RESET_TASK_PRESETS",presets:e}}function w(){return{type:"CREATE_TASK_PRESET"}}function R(e){return{type:"REMOVE_TASK_PRESET",presetId:e}}function G(e,t){return{type:"SET_TASK_PRESET_NAME",presetId:e,name:t}}function C(e,t){return{type:"SET_TASK_TEMPLATES",presetId:e,templates:t}}function M(e,t){return{type:"OPEN_TASK_TEMPLATE_EDITOR",presetId:e,task:t}}function D(e){return{type:"EDIT_TASK_TEMPLATE",task:e}}function L(){return{type:"CLOSE_TASK_TEMPLATE_EDITOR"}}const V=window.wp.apiFetch,U=s.n(V)(),q=window.NelioContent.utils;var F=function(e,t,s,n){return new(s||(s=Promise))(function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function r(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,r)}l((n=n.apply(e,t||[])).next())})};function B(){return F(this,void 0,void 0,function*(){yield(0,d.dispatch)(K).markAsSaving(!0);const{getTaskPreset:e,getTaskPresets:t}=(0,d.select)(K),s=t().map(e).filter(q.isDefined);try{const e=yield U({path:"/nelio-content/v1/task-presets",method:"POST",data:{presets:s}});yield(0,d.dispatch)(O.store).resetTaskPresets(e),yield(0,d.dispatch)(K).resetTaskPresets(e)}catch(e){yield(0,q.showErrorNotice)(e)}yield(0,d.dispatch)(K).markAsSaving(!1)})}const K=(0,d.createReduxStore)("nelio-content/task-preset-settings",{reducer:function(e=f,t){var s;return null!==(s=function(e,t){switch(t.type){case"RESET_TASK_PRESETS":return Object.assign(Object.assign({},e),{taskPresets:{byId:(0,E.keyBy)(t.presets,"id"),allIds:(0,E.map)(t.presets,"id")}});case"MARK_AS_SAVING":return Object.assign(Object.assign({},e),{saving:t.saving});case"CREATE_TASK_PRESET":{const t=e.taskPresets.allIds.map(e=>Math.abs(e)),s=-(((0,E.max)(t)||0)+1);return Object.assign(Object.assign({},e),{taskPresets:{byId:Object.assign(Object.assign({},e.taskPresets.byId),{[s]:{id:s,name:"",tasks:[]}}),allIds:[...e.taskPresets.allIds,s]}})}case"SET_TASK_PRESET_NAME":{const s=e.taskPresets.byId[t.presetId];return s?Object.assign(Object.assign({},e),{taskPresets:Object.assign(Object.assign({},e.taskPresets),{byId:Object.assign(Object.assign({},e.taskPresets.byId),{[s.id]:Object.assign(Object.assign({},s),{name:t.name})})})}):e}case"SET_TASK_TEMPLATES":{const s=e.taskPresets.byId[t.presetId];return s?Object.assign(Object.assign({},e),{taskPresets:Object.assign(Object.assign({},e.taskPresets),{byId:Object.assign(Object.assign({},e.taskPresets.byId),{[s.id]:Object.assign(Object.assign({},s),{tasks:t.templates})})})}):e}case"REMOVE_TASK_PRESET":return Object.assign(Object.assign({},e),{taskPresets:{byId:(0,E.omit)(e.taskPresets.byId,t.presetId),allIds:(0,E.without)(e.taskPresets.allIds,t.presetId)}});case"OPEN_TASK_TEMPLATE_EDITOR":return Object.assign(Object.assign({},e),{editor:{presetId:t.presetId,source:t.task,attrs:t.task}});case"EDIT_TASK_TEMPLATE":{const s=e.editor;return s?Object.assign(Object.assign({},e),{editor:Object.assign(Object.assign({},s),{attrs:Object.assign(Object.assign({},s.attrs),t.task)})}):e}case"CLOSE_TASK_TEMPLATE_EDITOR":return Object.assign(Object.assign({},e),{editor:void 0})}}(e,t))&&void 0!==s?s:e},controls:d.controls,actions:Object.assign(Object.assign({},i),a),selectors:n});p(K),(0,d.dispatch)(K).resetTaskPresets((0,d.select)(O.store).getTaskPresets());const $=[{title:(0,T._x)("Settings - Task Presets","text","nelio-content"),intro:(0,T._x)("Task presets make it possible to create editorial tasks once and use them when needed, thus saving a lot of time. Don’t repeat yourself and automate your workflow.","text","nelio-content")},{title:(0,T._x)("Task Presets","text","nelio-content"),intro:(0,T._x)("You can easily create new task presets using this button.","text","nelio-content"),element:()=>document.querySelector(".nelio-content-add-task-preset")},{title:(0,T._x)("Task Presets","text","nelio-content"),intro:(0,T._x)("Each preset has an identifying name and contains a set of tasks. Hover on each task to reveal its actions and, thus, be able to edit or delete it, or use the “New Task” button to create new tasks.","text","nelio-content"),elementToClick:()=>{const e=document.querySelector(".nelio-content-task-preset");return e?e.querySelector(".nelio-content-task-preset__body")?null:e.querySelector(".nelio-content-task-preset__header button"):null},element:()=>document.querySelector(".nelio-content-task-preset"),active:()=>!!document.querySelector(".nelio-content-task-preset")},{title:(0,T._x)("Save Changes","text","nelio-content"),intro:(0,T._x)("Once you’re happy with your setup, don’t forget to save your changes using this button!","user","nelio-content"),element:()=>document.querySelector(".nelio-content-save-button.is-primary")}],H=window.wp.components,X=window.wp.notices,W=()=>m(e=>{const t=e(O.store).getTaskPresets(),{getTaskPreset:s,getTaskPresets:n}=e(K),i=n().map(s).filter(q.isDefined);return!!(0,E.difference)((0,E.map)(t,"id"),(0,E.map)(i,"id")).length||(0,E.some)(i,e=>{const s=(0,E.find)(t,{id:e.id});return!(0,E.isEqual)(e,s)})}),z=()=>m(e=>e(K).isSavingPresets()),J=window.wp.coreData,Q=(window.NelioContent.networks,{automationGroups:{byId:{universal:{id:"universal",priority:100,publication:{type:"always"},profileSettings:{},networkSettings:{}}},allIds:["universal"]},validations:{universal:{areAuthorsValid:!0,areTermsValid:{},isPostTypeValid:!0,socialProfileErrors:{},templateErrors:{}}},frequencies:{},isSaving:!1,templateEditor:{attributes:void 0,isNew:!1,isNetwork:!1,customFields:{},customPlaceholders:{},errors:{author:!1,target:!1,content:!1,availability:!1,taxonomies:{}}},templateImportExport:void 0});function Y(e,t){return(0,E.isEqual)((0,E.omit)((0,E.omitBy)(e,E.isNil),["groupId","id","creatorId"]),(0,E.omit)((0,E.omitBy)(t,E.isNil),["groupId","id","creatorId"]))}function Z(e){const t=e.automationGroups.byId;return Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign({universal:(0,q.fixAttributesInGroup)(t.universal)},(0,E.mapValues)((0,E.omit)(t,"universal"),q.fixAttributesInGroup))})})}function ee(e){return e.automationGroups.allIds}function te(e,t){return e.automationGroups.byId[t]}function se(e,t,s){var n;return(0,E.find)(null===(n=te(e,t))||void 0===n?void 0:n.profileSettings,{profileId:s})}function ne(e,t,s){var n;return(0,E.find)(null===(n=te(e,t))||void 0===n?void 0:n.networkSettings,{name:s})}function ie(e,t,s){const n=(0,E.values)(e.automationGroups.byId),i=t;return s.some(t=>{const s=e.frequencies[t.id];return(null==s?void 0:s.publication)!==Math.max(1,t.publicationFrequency)||(null==s?void 0:s.reshare)!==Math.max(1,t.reshareFrequency)})||JSON.stringify(n)!==JSON.stringify(i)}function ae(e){return!!e.isSaving}function oe(e){return!!e.templateEditor.attributes}function re(e){return oe(e)&&e.templateEditor.isNew}function le(e){return oe(e)&&e.templateEditor.isNetwork}function ce(e){const t=e.templateEditor.attributes;return t?(0,E.omit)(t,"type"):void 0}function ue(e){return e.templateEditor.errors}function de(e){var t;return(null===(t=e.templateEditor.attributes)||void 0===t?void 0:t.type)||"publication"}function pe(e,t){return e.frequencies[t]}function me(e){return e.templateEditor.customFields}function ge(e){return e.templateEditor.customPlaceholders}function be(e,t){var s,n;return null===(n=null===(s=e.validations[t])||void 0===s?void 0:s.isPostTypeValid)||void 0===n||n}function Te(e,t){var s,n;return null===(n=null===(s=e.validations[t])||void 0===s?void 0:s.areAuthorsValid)||void 0===n||n}function ve(e,t){var s;return(null===(s=e.validations[t])||void 0===s?void 0:s.areTermsValid)||{}}function Oe(e,t){var s;const n=(0,E.values)(ve(e,t)).every(Boolean);return be(e,t)&&Te(e,t)&&n&&(0,E.keys)(null===(s=te(e,t))||void 0===s?void 0:s.profileSettings).every(s=>!Ee(e,t,s))}function Ee(e,t,s){var n;const i=null===(n=e.validations[t])||void 0===n?void 0:n.socialProfileErrors[s];if(i)return i;const a=se(e,t,s);if(!a)return!1;const o=ne(e,t,a.network),r=s=>!s||(e=>"enabled"in e&&!e.enabled)(s)||(0,E.map)(s.templates,"id").every(s=>fe(e,t,s));return r(a.publication)&&r(null==o?void 0:o.publication)?(!r(a.reshare)||!r(null==o?void 0:o.reshare))&&(0,T._x)("Please review reshare templates","text","nelio-content"):(0,T._x)("Please review publication templates","user","nelio-content")}function fe(e,t,s){var n;const i=null===(n=e.validations[t])||void 0===n?void 0:n.templateErrors[s];return(0,E.keys)((0,E.omit)(i,"taxonomies")).every(e=>!(null==i?void 0:i[e]))&&(0,E.keys)(null==i?void 0:i.taxonomies).every(e=>!(null==i?void 0:i.taxonomies[e]))}function je(e,t,s){var n;return null===(n=e.validations[t])||void 0===n?void 0:n.templateErrors[s]}function _e(e){return e.templateImportExport}function ke(e){return{type:"ADD_AUTOMATION_GROUP",group:e}}function ye(e,t){return{type:"UPDATE_AUTOMATION_GROUP",groupId:e,attrs:t}}function he(e,t){return{type:"ADD_PROFILE_SETTINGS",groupId:e,settings:t}}function xe(){return{type:"CLOSE_TEMPLATE_EDITOR"}}function Ie(){return{type:"CLOSE_TEMPLATE_IMPORT_EXPORT"}}function Pe(e){return{type:"DELETE_AUTOMATION_GROUP",groupId:e}}function Se(e){return{type:"DELETE_AUTOMATION_GROUP_TEMPLATE",template:e}}function Ae(e,t){return{type:"INIT_AUTOMATION_GROUPS",automationGroups:e,profiles:t}}function Ne(e,t,s){return{type:"OPEN_TEMPLATE_EDITOR",template:Object.assign(Object.assign({},t),{type:e}),isNew:"new"===s}}function we(e,t,s){return{type:"OPEN_TEMPLATE_IMPORTER",groupId:e,profileId:t,templateType:s}}function Re(e){return{type:"OPEN_TEMPLATE_EXPORTER",templates:(0,E.castArray)(e)}}function Ge(e,t){return{type:"RECEIVE_AUTOMATION_GROUP_TEMPLATES",templateType:e,templates:(0,E.castArray)(t)}}function Ce(e){return{type:"RECEIVE_CUSTOM_FIELDS",customFields:e}}function Me(e){return{type:"RECEIVE_CUSTOM_PLACEHOLDERS",customPlaceholders:e}}function De(e,t){return{type:"SET_PROFILE_FREQUENCIES",profileId:e,frequencies:t}}function Le(e){return{type:"MARK_AS_NETWORK_TEMPLATE",isNetwork:e}}function Ve(e){return{type:"MARK_AS_SAVING",isSaving:e}}function Ue(e,t){return{type:"SET_AUTOMATION_GROUP_VALIDATION",groupId:e,validation:t}}function qe(e){return{type:"SET_EDITING_TEMPLATE_ATTRIBUTES",attributes:e}}function Fe(e){return{type:"SET_EDITING_TEMPLATE_ERRORS",errors:e}}var Be=function(e,t,s,n){return new(s||(s=Promise))(function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function r(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,r)}l((n=n.apply(e,t||[])).next())})};function Ke(){return Be(this,void 0,void 0,function*(){yield(0,d.dispatch)(st).markAsSaving(!0);const{getAutomationGroup:e,getAutomationGroups:t}=(0,d.select)(st),s=yield Promise.all(t().map(e).filter(q.isDefined).map(Xe));try{const e=(0,d.select)(O.store).getSiteId(),t=(0,d.select)(O.store).getApiRoot(),n=(0,d.select)(O.store).getAuthenticationToken(),i=yield $e(),a=yield U({url:`${t}/site/${e}/automation-groups`,method:"PUT",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${n}`},data:s});yield(0,d.dispatch)(st).initAutomationGroups(a,i),yield(0,d.dispatch)(O.store).resetAutomationGroups(a)}catch(e){yield(0,q.showErrorNotice)(e)}yield(0,d.dispatch)(st).markAsSaving(!1)})}const $e=()=>Be(void 0,void 0,void 0,function*(){return Promise.all((0,d.select)(O.store).getSocialProfiles().map(e=>Be(void 0,void 0,void 0,function*(){if(!He(e))return e;const t=(0,d.select)(st).getProfileFrequencies(e.id);if(!t)return e;const s=(0,d.select)(O.store).getSiteId(),n=(0,d.select)(O.store).getApiRoot(),i=(0,d.select)(O.store).getAuthenticationToken(),a=yield U({url:`${n}/site/${s}/profile/${e.id}`,method:"PUT",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${i}`},data:{publicationFrequency:t.publication,reshareFrequency:t.reshare}});return yield(0,d.dispatch)(O.store).receiveSocialProfiles(a),a})))}),He=e=>{const t=(0,d.select)(st).getProfileFrequencies(e.id);return(null==t?void 0:t.publication)!==e.publicationFrequency||(null==t?void 0:t.reshare)!==e.reshareFrequency},Xe=e=>Be(void 0,void 0,void 0,function*(){if((0,q.isUniversalGroup)(e))return e;const t=yield Qe(e.postType),s=Je(e.postType),n=We({taxonomies:t,supportsAuthors:s});return Object.assign(Object.assign({},e),{authors:!1===s?[]:e.authors,taxonomies:(0,E.pick)(e.taxonomies,t),profileSettings:(0,E.mapValues)(e.profileSettings,n),networkSettings:(0,E.pickBy)((0,E.mapValues)(e.networkSettings,n),e=>!(!e||!e.publication.templates.length&&!e.reshare.templates.length))})}),We=e=>t=>{const s=ze(e);return Object.assign(Object.assign({},t),{publication:Object.assign(Object.assign({},t.publication),{templates:(0,E.map)(t.publication.templates,s)}),reshare:Object.assign(Object.assign({},t.reshare),{templates:(0,E.map)(t.reshare.templates,s)})})},ze=e=>t=>Object.assign(Object.assign({},t),{author:!1===e.supportsAuthors?void 0:t.author,taxonomies:(0,E.pick)(t.taxonomies,e.taxonomies)}),Je=e=>{var t;return null===(t=(0,d.select)(O.store).getPostType(e))||void 0===t?void 0:t.supports.author},Qe=e=>Be(void 0,void 0,void 0,function*(){const{getEntityRecords:t}=(s=J.store,(0,d.resolveSelect)(s));var s;const n=yield t("root","taxonomy",{per_page:-1});return(0,E.castArray)(n).filter(e=>!!e).filter(t=>t.types.includes(e)).map(e=>e.slug)});var Ye=function(e,t,s,n){return new(s||(s=Promise))(function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function r(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,r)}l((n=n.apply(e,t||[])).next())})};function Ze(){return Ye(this,void 0,void 0,function*(){const e=yield U({path:"/nelio-content/v1/custom-fields"});yield(0,d.dispatch)(st).receiveCustomFields(e)})}function et(){return Ye(this,void 0,void 0,function*(){const e=yield U({path:"/nelio-content/v1/custom-placeholders"});yield(0,d.dispatch)(st).receiveCustomPlaceholders(e)})}const tt=Object.assign(Object.assign({},r),l),st=(0,d.createReduxStore)("nelio-content/automation-settings",{reducer:function(e=Q,t){var s;return null!==(s=function(e,t){switch(t.type){case"ADD_AUTOMATION_GROUP":{if(e.automationGroups.byId[t.group.id])return e;const s=Object.assign(Object.assign({},e.automationGroups.byId),{[t.group.id]:t.group});return Z(Object.assign(Object.assign({},e),{automationGroups:{byId:s,allIds:["universal",...(0,E.keys)(s).filter(e=>"universal"!==e)]}}))}case"UPDATE_AUTOMATION_GROUP":return e.automationGroups.byId[t.groupId]?"universal"===t.groupId?Z(Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign(Object.assign({},e.automationGroups.byId),{universal:Object.assign(Object.assign({},e.automationGroups.byId.universal),t.attrs)})})})):Z(Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign(Object.assign({},e.automationGroups.byId),{[t.groupId]:Object.assign(Object.assign({},e.automationGroups.byId[t.groupId]),t.attrs)})})})):e;case"ADD_PROFILE_SETTINGS":{const s=e.automationGroups.byId[t.groupId];if(!s)return e;const n=Object.assign(Object.assign({},s),{profileSettings:Object.assign(Object.assign({},s.profileSettings),{[t.settings.profileId]:t.settings})});return Z(Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign(Object.assign({},e.automationGroups.byId),{[n.id]:n})})}))}case"CLOSE_TEMPLATE_EDITOR":return Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{attributes:void 0,isNew:!1})});case"CLOSE_TEMPLATE_IMPORT_EXPORT":return Object.assign(Object.assign({},e),{templateImportExport:void 0});case"DELETE_AUTOMATION_GROUP":return e.automationGroups.allIds.includes(t.groupId)?Object.assign(Object.assign({},e),{automationGroups:{byId:(0,E.omit)(e.automationGroups.byId,t.groupId),allIds:["universal",...(0,E.without)((0,E.filter)(e.automationGroups.allIds,e=>"universal"!==e),t.groupId)]}}):e;case"DELETE_AUTOMATION_GROUP_TEMPLATE":return Z(function(e,t){var s;const n=e.automationGroups.byId[t.groupId];if(!n)return e;const i=t.profileId?"profileSettings":"networkSettings",a=null!==(s=t.profileId)&&void 0!==s?s:t.network,o=t.profileId?n.profileSettings[t.profileId]:n.networkSettings[t.network];return o?Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign(Object.assign({},e.automationGroups.byId),{[t.groupId]:Object.assign(Object.assign({},n),{[i]:Object.assign(Object.assign({},n[i]),{[a]:Object.assign(Object.assign({},o),{publication:Object.assign(Object.assign({},o.publication),{templates:o.publication.templates.filter(e=>e.id!==t.id)}),reshare:Object.assign(Object.assign({},o.reshare),{templates:o.reshare.templates.filter(e=>e.id!==t.id)})})})})})})}):e}(e,t.template));case"INIT_AUTOMATION_GROUPS":return Z(Object.assign(Object.assign({},e),{automationGroups:{byId:Object.assign({universal:e.automationGroups.byId.universal},(0,E.keyBy)(t.automationGroups,"id")),allIds:["universal",...(0,E.map)(t.automationGroups,"id").filter(e=>"universal"!==e)]},frequencies:(0,E.mapValues)((0,E.keyBy)(t.profiles,"id"),e=>({publication:Math.max(1,e.publicationFrequency),reshare:Math.max(1,e.reshareFrequency)}))}));case"OPEN_TEMPLATE_EDITOR":return Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{attributes:t.template,isNew:t.isNew,isNetwork:!t.isNew&&!t.template.profileId})});case"OPEN_TEMPLATE_IMPORTER":return Object.assign(Object.assign({},e),{templateImportExport:Object.assign({mode:"import"},(0,E.omit)(t,"type"))});case"OPEN_TEMPLATE_EXPORTER":return Object.assign(Object.assign({},e),{templateImportExport:Object.assign({mode:"export"},(0,E.omit)(t,"type"))});case"MARK_AS_NETWORK_TEMPLATE":return e.templateEditor.attributes&&e.templateEditor.isNew?Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{isNetwork:t.isNetwork})}):e;case"MARK_AS_SAVING":return Object.assign(Object.assign({},e),{isSaving:t.isSaving});case"RECEIVE_AUTOMATION_GROUP_TEMPLATES":return(0,E.reduce)(t.templates,(s=t.templateType,(e,t)=>{var n;const i=null!==(n=t.profileId)&&void 0!==n?n:t.network,a=e.automationGroups.byId[t.groupId];if(!a)return e;const o=t.profileId?a.profileSettings:a.networkSettings,r=o[i];if(!r)return e;const l=r[s].templates;return Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign(Object.assign({},e.automationGroups.byId),{[t.groupId]:Object.assign(Object.assign({},a),{[t.profileId?"profileSettings":"networkSettings"]:Object.assign(Object.assign({},o),{[i]:Object.assign(Object.assign({},r),{[s]:Object.assign(Object.assign({},r[s]),{templates:(0,E.uniqWith)((0,E.values)(Object.assign(Object.assign({},(0,E.keyBy)(l,"id")),{[t.id]:t})),Y)})})})})})})})}),e);case"RECEIVE_CUSTOM_FIELDS":return Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{customFields:t.customFields})});case"RECEIVE_CUSTOM_PLACEHOLDERS":return Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{customPlaceholders:t.customPlaceholders})});case"SET_PROFILE_FREQUENCIES":{const s=e.frequencies[t.profileId];return s?Object.assign(Object.assign({},e),{frequencies:Object.assign(Object.assign({},e.frequencies),{[t.profileId]:Object.assign(Object.assign({},s),t.frequencies)})}):e}case"SET_AUTOMATION_GROUP_VALIDATION":return Object.assign(Object.assign({},e),{validations:Object.assign(Object.assign({},e.validations),{[t.groupId]:t.validation})});case"SET_EDITING_TEMPLATE_ATTRIBUTES":return e.templateEditor.attributes?Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{attributes:Object.assign(Object.assign({},e.templateEditor.attributes),t.attributes)})}):e;case"SET_EDITING_TEMPLATE_ERRORS":return e.templateEditor.attributes?Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{errors:t.errors})}):e}var s}(e,t))&&void 0!==s?s:e},controls:d.controls,actions:tt,selectors:o,resolvers:c});p(st);const nt=e=>(e.preventDefault(),e.returnValue=""),it=({presetId:e,task:t,onDelete:s})=>{const{openTaskTemplateEditor:n}=(0,d.useDispatch)(K),i=(0,O.useAuthorName)(t.assigneeId),a=at(t.dateType,t.dateValue);return(0,u.jsxs)("div",{className:"none"===t.color?"nelio-content-task-template":`nelio-content-task-template nelio-content-task-template--is-${t.color}`,children:[(0,u.jsx)("div",{className:"nelio-content-task-template__task",children:t.task}),(0,u.jsx)("div",{className:"nelio-content-task-template__extra",children:(0,T.sprintf)("%1$s • %2$s",t.assigneeId?i:(0,T._x)("Post Author","text","nelio-content"),a)}),(0,u.jsxs)("div",{className:"nelio-content-task-template__actions",children:[(0,u.jsx)(H.Button,{variant:"link",onClick:()=>n(e,t),children:(0,T._x)("Edit","command","nelio-content")}),(0,u.jsx)(v.DeleteButton,{onClick:s})]})]})},at=(e,t)=>{const s=Math.abs(Number.parseInt(t)||0);switch(e){case"negative-days":case"predefined-offset":return{0:(0,T._x)("Same day as publication","text","nelio-content"),"-1":(0,T._x)("The day before publication","text","nelio-content"),"-7":(0,T._x)("A week before publication","text","nelio-content")}[t]||(0,T.sprintf)(/* translators: number of days */ /* translators: number of days */
(0,T._nx)("%d day before publication","%d days before publication",s,"text","nelio-content"),s);case"positive-days":return(0,T.sprintf)(/* translators: number of days */ /* translators: number of days */
(0,T._nx)("%d day after publication","%d days after publication",s,"text","nelio-content"),s)}},ot=({presetId:e})=>{const t=(e=>m(t=>t(K).getTaskPreset(e)))(e),s=z(),{openTaskTemplateEditor:n,removeTaskPreset:i,setTaskPresetName:a,setTaskTemplates:o}=(0,d.useDispatch)(K),[r,l]=(0,g.useState)(!(null==t?void 0:t.tasks.length));return t?(0,u.jsxs)("div",{className:"nelio-content-task-preset",children:[(0,u.jsx)("div",{className:"nelio-content-task-preset__header",children:(0,u.jsxs)("button",{disabled:s,onClick:e=>{e.preventDefault(),l(!r)},children:[(0,u.jsxs)("span",{children:[(0,u.jsx)("strong",{children:(0,E.trim)(t.name)||(0,T._x)("Unnamed Task Preset","text","nelio-content")})," ",(0,T.sprintf)(/* translators: number of tasks */ /* translators: number of tasks */
(0,T._nx)("(%d task)","(%d tasks)",t.tasks.length,"text","nelio-content"),t.tasks.length)]}),(0,u.jsx)(H.Dashicon,{icon:r?"arrow-up":"arrow-down"})]})}),r&&(0,u.jsxs)("div",{className:"nelio-content-task-preset__body",children:[(0,u.jsxs)("div",{className:"nelio-content-task-preset__name-and-delete",children:[(0,u.jsx)(H.TextControl,{value:t.name,onChange:t=>a(e,t),placeholder:(0,T._x)("Name your preset…","user","nelio-content")}),(0,u.jsx)("span",{children:(0,u.jsx)(v.DeleteButton,{onClick:()=>i(e)})})]}),(0,u.jsx)("div",{className:"nelio-content-task-preset__tasks",children:t.tasks.map((n,i)=>(0,u.jsx)(it,{presetId:e,task:n,onDelete:()=>o(e,(0,E.without)(t.tasks,n)),onUpdate:s=>o(e,(0,q.replace)(n,s,t.tasks)),disabled:s},`${i}-${t.tasks.length}`))}),(0,u.jsx)("div",{className:"nelio-content-task-preset__actions",children:(0,u.jsx)(H.Button,{size:"small",variant:"secondary",onClick:()=>n(e,{task:"",assigneeId:void 0,color:"none",dateType:"predefined-offset",dateValue:"0"}),children:(0,T._x)("New Task","command","nelio-content")})})]})]}):null},rt=()=>{const e=m(e=>e(K).getTaskPresets()),t=z(),s=W(),n=lt(),{createTaskPreset:i,saveTaskPresets:a}=(0,d.useDispatch)(K);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:"nelio-content-task-preset-list",children:[(0,q.isEmpty)(e)&&(0,T._x)("Task Presets let you define a set of Editorial Tasks that can be automatically instantiated when creating new posts in your blog.","user","nelio-content"),e.map((e,t)=>(0,u.jsx)(ot,{presetId:e},t))]}),(0,u.jsxs)("div",{className:"nelio-content-task-preset-list__actions",children:[(0,u.jsx)(v.SaveButton,{variant:"primary",error:n,isSaving:t,onClick:a,disabled:!s||t||!!n,baseLabel:(0,T._x)("Save Changes","command","nelio-content")}),(0,u.jsx)(H.Button,{className:"nelio-content-add-task-preset",variant:"secondary",onClick:i,disabled:t,children:(0,T._x)("Add Task Preset","command","nelio-content")})]})]})},lt=()=>{const e=m(e=>e(K).getTaskPresets().map(e(K).getTaskPreset).filter(q.isDefined));return(0,E.some)(e,e=>!(0,E.trim)(e.name))?(0,T._x)("Please name all your presets","user","nelio-content"):(0,E.some)(e,e=>!e.tasks.length)?(0,T._x)("Please add one or more tasks to all your presets","user","nelio-content"):void 0},ct=()=>{const[e,t]=ut();return dt()?(0,u.jsx)("div",{className:"nelio-content-task-template-editor__assignee",children:(0,u.jsx)(v.AuthorSearcher,{hasAllAuthors:!0,allAuthorsLabel:(0,T._x)("Post Author","text","nelio-content"),value:e||void 0,onChange:t,placeholder:(0,T._x)("Assign task to…","command","nelio-content")})}):null},ut=()=>{const e=m(e=>e(K).getEditingTask()),{editTaskTemplate:t}=(0,d.useDispatch)(K);return[e.assigneeId,e=>t({assigneeId:e})]},dt=()=>m(e=>e(O.store).isMultiAuthor),pt=({dateValue:e,disabled:t,setDateType:s,setDateValue:n})=>(0,u.jsx)(H.SelectControl,{className:"nelio-content-task-template-editor-date-due__default-select",disabled:t,options:gt,value:e,onChange:e=>{mt(e)?(s(e),n("")):n(e)}}),mt=e=>["positive-days","negative-days"].includes(e),gt=[{value:"0",label:(0,T._x)("Same day as publication","text","nelio-content")},{value:"-1",label:(0,T._x)("The day before publication","text","nelio-content")},{value:"-7",label:(0,T._x)("A week before publication","text","nelio-content")},{value:"negative-days",label:(0,T._x)("__ days before publication","text","nelio-content")},{value:"positive-days",label:(0,T._x)("__ days after publication","text","nelio-content")}],bt=()=>{const e=m(e=>e(K).getEditingTask()),{editTaskTemplate:t}=(0,d.useDispatch)(K);return[e.dateType,e=>t({dateType:e})]},Tt=()=>{const e=m(e=>e(K).getEditingTask()),{editTaskTemplate:t}=(0,d.useDispatch)(K);return[e.dateValue,e=>t({dateValue:e})]},vt=({disabled:e})=>{const[t,s]=bt(),[__,n]=Tt();return(0,u.jsx)("div",{className:"nelio-content-task-editor-date-due__back-button",children:(0,u.jsx)(H.Button,{variant:"link",disabled:e,onClick:()=>{s("predefined-offset"),n("0")},children:(0,T._x)("Back","command","nelio-content")})})},Ot=({disabled:e,dateValue:t,setDateValue:s})=>(0,u.jsxs)("div",{className:"nelio-content-task-template-editor-date-due__days-offset",children:[(0,u.jsx)(v.NumberControl,{className:"nelio-content-task-template-editor-date-due__days-input",disabled:e,min:2,value:t,onChange:e=>s(Et(e))}),(0,u.jsx)("span",{children:(0,T._x)("days before pub.","text","nelio-content")}),(0,u.jsx)(vt,{disabled:e})]}),Et=e=>void 0===e?"":`${e}`,ft=({disabled:e,dateValue:t,setDateValue:s})=>(0,u.jsxs)("div",{className:"nelio-content-task-template-editor-date-due__days-offset",children:[(0,u.jsx)(v.NumberControl,{className:"nelio-content-task-template-editor-date-due__days-input",disabled:e,min:1,value:t,onChange:e=>s(jt(e))}),(0,u.jsx)("span",{children:(0,T._x)("days after pub.","text","nelio-content")}),(0,u.jsx)(vt,{disabled:e})]}),jt=e=>void 0===e?"":`${e}`,_t=({disabled:e})=>{const[t,s]=bt(),[n,i]=Tt(),a="nelio-content-task-template-editor-date-due nelio-content-task-template-editor__date-due";return"negative-days"===t?(0,u.jsx)("div",{className:a,children:(0,u.jsx)(Ot,{disabled:e,dateValue:n,setDateValue:i})}):"positive-days"===t?(0,u.jsx)("div",{className:a,children:(0,u.jsx)(ft,{disabled:e,dateValue:n,setDateValue:i})}):(0,u.jsx)("div",{className:a,children:(0,u.jsx)(pt,{disabled:e,dateValue:n,setDateValue:i,setDateType:s})})},kt=({color:e,disabled:t,label:s,selected:n,onChange:i})=>(0,u.jsxs)("li",{className:`nelio-content-task-template-colors__option nelio-content-task-template-colors__option--is-${e}`,children:[(0,u.jsx)("input",{disabled:t,type:"checkbox",checked:!!n,onChange:e=>i(!!e.target.checked),title:s})," ",(0,u.jsx)("span",{className:"screen-reader-text",children:s})]}),yt=({className:e="",disabled:t})=>{const[s,n]=ht();return(0,u.jsxs)("div",{className:`nelio-content-task-template-colors ${e}`,children:[(0,u.jsx)("p",{className:"screen-reader-text",children:(0,T._x)("Select a color:","user","nelio-content")}),(0,u.jsx)("ul",{className:"nelio-content-task-template-colors__list",children:xt.map(({value:e,label:i})=>(0,u.jsx)(kt,{disabled:t,color:e,label:i,selected:s===e,onChange:t=>n(t?e:"none")},e))})]})},ht=()=>{const e=m(e=>e(K).getEditingTask()),{editTaskTemplate:t}=(0,d.useDispatch)(K);return[e.color,e=>t({color:e})]},xt=[{value:"red",label:(0,T._x)("Red","text","nelio-content")},{value:"orange",label:(0,T._x)("Orange","text","nelio-content")},{value:"yellow",label:(0,T._x)("Yellow","text","nelio-content")},{value:"green",label:(0,T._x)("Green","text","nelio-content")},{value:"cyan",label:(0,T._x)("Cyan","text","nelio-content")},{value:"blue",label:(0,T._x)("Blue","text","nelio-content")},{value:"purple",label:(0,T._x)("Purple","text","nelio-content")}],It=({disabled:e})=>{const[t,s]=Pt();return(0,u.jsx)("div",{className:"nelio-content-task-template-editor__actual-task",children:(0,u.jsx)(H.TextareaControl,{disabled:e,value:t,onChange:e=>s(e),placeholder:(0,T._x)("Describe the task…","user","nelio-content")})})},Pt=()=>{const e=m(e=>e(K).getEditingTask()),{editTaskTemplate:t}=(0,d.useDispatch)(K);return[e.task,e=>t({task:e})]},St=()=>{const e=m(e=>e(K).getEditingTaskSource()),t=m(e=>e(K).getEditingTask()),s=m(t=>t(K).getTaskPreset(null==e?void 0:e.presetId)),n=!Nt(),i=m(e=>e(K).isTaskTemplateEditorOpen()),a=m(e=>e(K).getEditingTaskError()),o=m(e=>{const{isEditingTaskDirty:t}=e(K);return n&&t()}),{closeTaskTemplateEditor:r,setTaskTemplates:l}=(0,d.useDispatch)(K),c=(0,u.jsx)(At,{});return i?(0,u.jsxs)(H.Modal,{className:"nelio-content-task-template-editor",title:c,isDismissible:!1,shouldCloseOnEsc:!1,shouldCloseOnClickOutside:!1,onRequestClose:()=>{},children:[(0,u.jsx)(It,{}),(0,u.jsxs)("div",{className:"nelio-content-task-template-editor__options",children:[(0,u.jsx)(ct,{}),(0,u.jsx)(_t,{})]}),(0,u.jsxs)("div",{className:"nelio-content-task-template-editor__footer",children:[(0,u.jsx)(yt,{className:"nelio-content-task-template-editor__colors"}),(0,u.jsxs)("div",{className:"nelio-content-task-template-editor__actions",children:[(0,u.jsx)(H.Button,{variant:"secondary",onClick:r,children:o?(0,T._x)("Discard Changes","command","nelio-content"):(0,T._x)("Close","command","nelio-content")}),(0,u.jsx)(v.SaveButton,{variant:"primary",error:a,disabled:!!n&&!o,isUpdate:n,onClick:()=>{if(e&&s){const n=Object.assign(Object.assign({},t),{task:(0,E.trim)(t.task)});l(s.id,(0,E.sortBy)((0,q.replaceOrAppend)(e.source,n,s.tasks),wt))}r()}})]})]})]}):null},At=()=>{const e=Nt();return(0,u.jsx)("div",{className:"nelio-content-task-template-editor__title",children:(0,u.jsx)("div",{className:"nelio-content-task-template-editor__title-text",children:e?(0,T._x)("Create Task","text","nelio-content"):(0,T._x)("Edit Task","text","nelio-content")})})},Nt=()=>m(e=>{const t=e(K).getEditingTaskSource();if(!t)return!1;const s=e(K).getTaskPreset(t.presetId);return!(null==s?void 0:s.tasks.includes(t.source))}),wt=e=>{let t="";const s=Math.abs(Number.parseInt(e.dateValue)||0);return 0===s?(t+="1",t+=(0,E.padStart)("0",5,"0")):"positive-days"===e.dateType?(t+="2",t+=(0,E.padStart)(`${s}`,5,"0")):(t+="0",t+=(0,E.padStart)(""+(99999-s),5,"9")),t+=e.task,t},Rt=()=>(0,u.jsx)(g.StrictMode,{children:(0,u.jsxs)(H.SlotFillProvider,{children:[(0,u.jsx)(Gt,{}),(0,u.jsx)(v.PremiumDialog,{}),(0,u.jsx)(H.Popover.Slot,{})]})}),Gt=(0,O.withSubscriptionCheck)("raw/task-presets",()=>{const{notices:e,removeNotice:t}=Ct();return((e,t=!1)=>{(0,g.useEffect)(()=>{if(!t)return e?window.addEventListener("beforeunload",nt,{capture:!0}):window.removeEventListener("beforeunload",nt,{capture:!0}),()=>{window.removeEventListener("beforeunload",nt,{capture:!0})}},[e,t])})(W()),(0,u.jsxs)("div",{className:"nelio-content-task-presets-settings-layout",children:[(0,u.jsx)(H.NoticeList,{notices:e,className:"components-editor-notices__pinned",onRemove:t}),(0,u.jsx)(rt,{}),(0,u.jsx)(St,{})]})}),Ct=()=>{const e=m(e=>e(X.store).getNotices()),{removeNotice:t}=(0,d.useDispatch)(X.store);return{notices:e,removeNotice:t}};function Mt(e){const t=(0,d.select)(O.store).isSubscribed(),s=document.getElementById(e);b((0,u.jsx)(Rt,{}),s);const n=document.getElementById("nelio-content-settings-title");t&&n&&b((0,u.jsx)(v.ContextualHelp,{context:"social-task-presets",walkthrough:$,autostart:!0,component:Dt}),n)}const Dt=({className:e,runWalkthrough:t})=>(0,u.jsx)("button",{className:`${e}  page-title-action`,onClick:t,children:(0,T._x)("Help","text","nelio-content")})}},s={};function n(e){var i=s[e];if(void 0!==i)return i.exports;var a=s[e]={exports:{}};return t[e](a,a.exports,n),a.exports}n.m=t,e=[],n.O=(t,s,i,a)=>{if(!s){var o=1/0;for(u=0;u<e.length;u++){for(var[s,i,a]=e[u],r=!0,l=0;l<s.length;l++)(!1&a||o>=a)&&Object.keys(n.O).every(e=>n.O[e](s[l]))?s.splice(l--,1):(r=!1,a<o&&(o=a));if(r){e.splice(u--,1);var c=i();void 0!==c&&(t=c)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[s,i,a]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={1247:0,8748:0};n.O.j=t=>0===e[t];var t=(t,s)=>{var i,a,[o,r,l]=s,c=0;if(o.some(t=>0!==e[t])){for(i in r)n.o(r,i)&&(n.m[i]=r[i]);if(l)var u=l(n)}for(t&&t(s);c<o.length;c++)a=o[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(u)},s=globalThis.webpackChunkNelioContent=globalThis.webpackChunkNelioContent||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var i=n.O(void 0,[8748],()=>n(1163));i=n.O(i);var a=NelioContent="undefined"==typeof NelioContent?{}:NelioContent;for(var o in i)a[o]=i[o];i.__esModule&&Object.defineProperty(a,"__esModule",{value:!0})})();