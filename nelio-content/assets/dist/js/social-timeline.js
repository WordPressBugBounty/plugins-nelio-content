(()=>{var e,t={9525:(e,t,n)=>{"use strict";n.r(t),n.d(t,{socialTimeline:()=>o});var o={};n.r(o),n.d(o,{SocialTimeline:()=>G});const i=window.wp.element,r=window.wp.i18n,a=window.wp.components,s=window.wp.data;function l(e,t){return(0,s.useSelect)(e,t)}function c(e){var t,n,o="";if("string"==typeof e||"number"==typeof e)o+=e;else if("object"==typeof e)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=c(e[t]))&&(o&&(o+=" "),o+=n)}else for(n in e)e[n]&&(o&&(o+=" "),o+=n);return o}const u=function(){for(var e,t,n=0,o="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=c(e))&&(o&&(o+=" "),o+=t);return o},m=window.moment;var d=n.n(m);const p=window.lodash,f=window.NelioContent.data,g=window.NelioContent.utils,v=window.NelioContent.socialMessageEditor;var y=function(e,t){switch(e){case"day":return t<1;case"week":return 1<=t&&t<=10;case"month":return 10<t&&t<=40;default:return 40<t}};const h=window.NelioContent.components;var b=function(e){var t,n=e.message,o=e.deleteMessage,s=e.isBeingDeleted,c=e.isTimelineBusy,m=e.post,d=l((function(e){return e(f.store).canCurrentUserEditSocialMessage(n)})),p=l((function(e){return e(f.store).canCurrentUserDeleteSocialMessage(n)})),v=_(n,m),y=!["error","publish"].includes(null!==(t=null==n?void 0:n.status)&&void 0!==t?t:""),b=(0,r._x)("View","command","nelio-content"),w=(0,g.isRecurringMessage)(n)?(0,r._x)("Edit All","command (all recurring messages)","nelio-content"):(0,r._x)("Edit","command","nelio-content");return i.createElement("div",{className:u({"nelio-content-social-message__actions":!0,"nelio-content-social-message__actions--is-deleting":s})},!s&&i.createElement(a.Button,{variant:"link",disabled:!d||c,onClick:v},y?w:b),!s&&!!o&&i.createElement("span",null,"|"),!!o&&i.createElement(h.DeleteButton,{isDeleting:s,onClick:function(){(null==n?void 0:n.id)&&o(n.id)},disabled:!p||c,labels:{delete:(0,g.isRecurringMessage)(n)?(0,r._x)("Delete All","command (all recurring messages)","nelio-content"):(0,r._x)("Delete","command","nelio-content"),deleting:(0,r._x)("Deleting…","text","nelio-content")},confirmationLabels:{title:(0,g.isRecurringMessage)(n)?(0,r._x)("Delete Recurring Social Message","text","nelio-content"):(0,r._x)("Delete Social Message","text","nelio-content"),text:(0,g.isRecurringMessage)(n)?(0,r._x)("Are you sure you want to delete this recurring social message and all its following instances? This operation can’t be undone.","user","nelio-content"):(0,r._x)("Are you sure you want to delete this social message? This operation can’t be undone.","user","nelio-content")}}))},_=function(e,t){var n=(0,s.useDispatch)(v.store).openSocialMessageEditor;return function(){e&&n(e,{context:"post",post:t})}};const w=window.NelioContent.networks;var x=function(e){var t=e.network,n=e.post,o=e.text,r=(0,g.computeSocialMessageText)((0,w.getCharLimitInNetwork)(t),n,o);return i.createElement("div",{className:"nelio-content-social-message__content-wrapper"},i.createElement(h.SocialMessageTextPreview,{className:"nelio-content-social-message__actual-content",placeholder:"",linkBeautifier:function(e){if(-1===(e=e.replace(/^https?:\/\//i,"")).indexOf("/"))return e;var t=e.replace(/^[^/]*\//,"");if(t.length<=10)return e;var n=e.replace(/\/.*$/,"");return"".concat(n,"/").concat(t.substring(0,9),"…")},value:r}))};const E=window.NelioContent.date;var N=function(e){var t=e.isBeingDeleted,n=e.source,o=function(e){var t=e.dateType,n=e.schedule;if("publish"===e.postStatus||"exact"===t)return(0,E.dateI18n)((0,E.getSettings)().formats.datetime,n);var o=e.dateValue,i=e.timeType,a=e.timeValue;if("0"===o){if("exact"===i)return a;if("0"===a)return(0,r._x)("Same time as publication","text","nelio-content");var s=Math.abs(Number.parseInt(a))||0;return(0,r.sprintf)(/* translators: number of hours */ /* translators: number of hours */
(0,r._nx)("%d hour after publication","%d hours after publication",s,"text","nelio-content"),s)}var l=Math.abs(Number.parseInt(o))||0;return(0,r.sprintf)(/* translators: 1 -> number of days, 2 -> time */ /* translators: 1 -> number of days, 2 -> time */
(0,r._nx)("%1$d day after publication at %2$s","%1$d days after publication at %2$s",l,"text","nelio-content"),l,a)}(e);return i.createElement("div",{className:u({"nelio-content-social-message__date":!0,"nelio-content-social-message__date--is-deleting":t})},"reshare-template"===n&&i.createElement(a.Dashicon,{icon:"share-alt"}),"publication-template"===n&&i.createElement(a.Dashicon,{icon:"megaphone"}),["user-highlight","custom-sentence"].includes(n)&&i.createElement(a.Dashicon,{icon:"editor-quote"}),"auto-extracted-sentence"===n&&i.createElement(a.Dashicon,{icon:"format-status"}),o)},M=function(e){var t=e.messageId,n=O(t);return n?i.createElement("div",{className:"nelio-content-social-message__recurrence"},i.createElement(a.Dashicon,{icon:"controls-repeat"}),n):null},T={period:"day",occurrences:2,interval:1},O=function(e){var t,n=l((function(t){return{message:t(f.store).getSocialMessage(e),today:t(f.store).getToday()}})),o=n.message,i=n.today,r=(0,f.useRecurrenceSummary)((0,g.createRecurrenceContext)((null==o?void 0:o.schedule)||i),null!==(t=null==o?void 0:o.recurrenceSettings)&&void 0!==t?t:T);return(null==o?void 0:o.recurrenceSettings)?r:void 0},S=function(e){var t=k(e);return i.createElement("div",{className:"nelio-content-social-message__location"},t)},k=function(e){return l((function(t){var n,o,a=e.network,s=e.profileId,l=e.targetName,c=(0,t(f.store).getSocialProfile)(s),u=(null!==(n=null==c?void 0:c.alias)&&void 0!==n?n:null==c?void 0:c.displayName)||(0,r._x)("Unknown","text","nelio-content");if(!l||!(0,w.doesNetworkSupport)("multi-target",a))return i.createElement("strong",null,u);var m=(0,t(f.store).getProfileTarget)(s,l),d=null!==(o=null==m?void 0:m.displayName)&&void 0!==o?o:"";return(0,g.isEmpty)(d)?i.createElement("strong",null,u):(0,i.createInterpolateElement)((0,r.sprintf)(/* translators: 1 -> profile name, 2 -> target name */ /* translators: 1 -> profile name, 2 -> target name */
(0,r._x)("%1$s on %2$s","text","nelio-content"),"<strong>".concat(u,"</strong>"),"<em>".concat(d,"</em>")),{strong:i.createElement("strong",null),em:i.createElement("em",null)})}))},D=function(e){var t=e.messageId,n=e.deleteMessage,o=e.isBeingDeleted,c=e.isTimelineBusy,m=e.post,d=(0,s.useDispatch)(f.store).openPremiumDialog,g=l((function(e){return e(f.store).getSocialMessage(t)}));if(!g)return null;var v=g.auto,y=g.dateType,_=g.dateValue,w=g.id,E=g.isFreePreview,T=g.image,O=g.network,k=g.profileId,D=g.schedule,C=g.source,I=g.status,j=g.targetName,B=g.text,V=g.timeType,R=g.timeValue,A=g.type,$="error"===I,U="image"===A||"auto-image"===A,F="video"===A,G="multi-media"===A;return i.createElement("div",{className:u({"nelio-content-social-message":!0,"nelio-content-social-message--is-auto":!!v,"nelio-content-social-message--is-error":$,"nelio-content-social-message--is-free-preview":E}),"data-social-message-id":w},U&&i.createElement(a.Dashicon,{className:"nelio-content-social-message__image-type-icon",icon:(0,p.isArray)(T)&&T.length>1?"format-gallery":"format-image"}),F&&i.createElement(a.Dashicon,{className:"nelio-content-social-message__video-type-icon",icon:"video-alt3"}),G&&i.createElement(a.Dashicon,{className:"nelio-content-social-message__multi-media-type-icon",icon:"format-gallery"}),i.createElement("div",{className:"nelio-content-social-message__profile-and-location"},i.createElement(h.SocialProfileIcon,{className:"nelio-content-social-message__profile-icon",profileId:k}),i.createElement(S,{network:O,profileId:k,targetName:j})),i.createElement(x,{network:O,post:m,text:B||P(A)}),i.createElement(M,{messageId:t}),i.createElement(N,{isBeingDeleted:o,dateType:y,dateValue:_,schedule:D,timeType:V,timeValue:R,source:C,postStatus:m.status}),i.createElement(b,{message:g,deleteMessage:n,isTimelineBusy:c,isBeingDeleted:o,post:m}),E&&i.createElement("button",{className:"nelio-content-social-message__free-preview-button",onClick:function(){return d("raw/free-previews")}},i.createElement("div",{className:"nelio-content-social-message__premium-badge components-button nelio-content-social-media-timeline-period__add-button nelio-content-premium-feature-button nelio-content-premium-feature-button--is-premium is-small has-text has-icon"},i.createElement("span",null,i.createElement(a.Dashicon,{icon:"lock"})),i.createElement("span",null,(0,r._x)("Premium","text","nelio-content")))))};function P(e){switch(e){case"auto-image":case"text":return"";case"image":return(0,r._x)("(image)","text","nelio-content");case"video":return(0,r._x)("(video)","text","nelio-content");case"multi-media":return(0,r._x)("(media)","text","nelio-content")}}var C=function(){return C=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},C.apply(this,arguments)},I=function(e){var t=e.period,n=e.deletingMessageIds,o=void 0===n?[]:n,s=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n}(e,["period","deletingMessageIds"]),l=s.post,c=s.isTimelineBusy,m=void 0!==c&&c,d=j(t,l),p=(0,f.useIsSubscribed)(),v=B(t,l,m),y=V(l,m),b=R(l,m),_=b&&!y;return i.createElement("div",{className:"nelio-content-social-media-timeline-period__period-content"},!(0,g.isEmpty)(d)&&i.createElement("div",{className:"nelio-content-social-media-timeline-period__messages"},d.map((function(e){return i.createElement(D,C({key:e,messageId:e,isBeingDeleted:o.includes(e)},s))}))),i.createElement("div",{className:"nelio-content-social-media-timeline-period__add-button-wrapper"},p||"day"===t?i.createElement(a.Button,{className:u({"nelio-content-social-media-timeline-period__add-button":!0,"nelio-content-premium-feature-button nelio-content-premium-feature-button--is-premium":_}),variant:_?void 0:"secondary",size:"small",disabled:!b,onClick:v,icon:_?"lock":void 0},(0,r._x)("Add Social Message","command","nelio-content")):i.createElement(h.PremiumFeatureButton,{feature:"edit-post/custom-timeline",label:(0,r._x)("Add Social Message","command","nelio-content"),size:"small"})))},j=function(e,t){return l((function(n){var o=(0,n(f.store).getSocialMessagesRelatedToPost)(t.id).filter((function(e){return"publish"!==e.status})).filter((function(e,t,n){return!(0,g.isRecurringMessage)(e)||A(n,e)})),i=n(f.store).getUtcNow,r="publish"===t.status?function(e,t){return function(n){var o=n.schedule,i=Math.abs(t.diff(o,"days"));return y(e,i)}}(e,d()(i())):function(e){return function(t){var n=t.dateType,o=t.dateValue;if("exact"===n)return"other"===e;var i=Math.abs(Number.parseInt(o)||0);return y(e,i)}}(e);return(0,p.map)((0,p.filter)(o,r),"id")}))},B=function(e,t,n){var o=V(t,n),i=R(t,n),r=(0,f.useFeatureGuard)("edit-post/create-more-messages",i&&!o),a=function(e){switch(e){case"day":return{dateType:"predefined-offset",dateValue:"0"};case"week":return{dateType:"predefined-offset",dateValue:"7",timeType:"time-interval",timeValue:"morning"};case"month":return{dateType:"predefined-offset",dateValue:"28",timeType:"time-interval",timeValue:"morning"};default:return{dateType:"exact",timeType:"time-interval",timeValue:"morning"}}}(e),c=l((function(e){return e(f.store).getProfilesWithMessagesRelatedToPost(t.id)})),u=(0,s.useDispatch)(v.store).openNewSocialMessageEditor;return r((function(){return u(a,{context:"post",post:t,disabledProfileIds:c})}))},V=function(e,t){return l((function(n){return n(f.store).canCurrentUserCreateMessagesRelatedToPost(e)&&!t}))},R=function(e,t){return l((function(n){return n(f.store).couldSubscriberCreateMessagesRelatedToPost(e)&&!t}))},A=function(e,t){var n=e.filter((function(e){return e.recurrenceGroup===t.recurrenceGroup}));return(0,p.sortBy)(n,"schedule")[0]===t},$=function(){return $=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},$.apply(this,arguments)},U=function(e){var t=function(e,t){switch(e){case"day":return"publish"===t.status?(0,r._x)("Today","text","nelio-content"):(0,r._x)("Publication Day","text","nelio-content");case"week":return(0,r._x)("Week","text","nelio-content");case"month":return(0,r._x)("Month","text","nelio-content");case"other":return(0,r._x)("Other","text","nelio-content")}}(e.period,e.post);return i.createElement("div",{className:"nelio-content-social-media-timeline-period"},i.createElement("div",{className:"nelio-content-social-media-timeline-period__title"},t),i.createElement(I,$({},e)))},F=function(){return F=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},F.apply(this,arguments)},G=function(e){return i.createElement("div",{className:"nelio-content-social-timeline"},i.createElement(U,F({period:"day"},e)),i.createElement(U,F({period:"week"},e)),i.createElement(U,F({period:"month"},e)),i.createElement(U,F({period:"other"},e)))}}},n={};function o(e){var i=n[e];if(void 0!==i)return i.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,o),r.exports}o.m=t,e=[],o.O=(t,n,i,r)=>{if(!n){var a=1/0;for(u=0;u<e.length;u++){for(var[n,i,r]=e[u],s=!0,l=0;l<n.length;l++)(!1&r||a>=r)&&Object.keys(o.O).every((e=>o.O[e](n[l])))?n.splice(l--,1):(s=!1,r<a&&(a=r));if(s){e.splice(u--,1);var c=i();void 0!==c&&(t=c)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[n,i,r]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={1482:0,5001:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var i,r,[a,s,l]=n,c=0;if(a.some((t=>0!==e[t]))){for(i in s)o.o(s,i)&&(o.m[i]=s[i]);if(l)var u=l(o)}for(t&&t(n);c<a.length;c++)r=a[c],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(u)},n=globalThis.webpackChunkNelioContent=globalThis.webpackChunkNelioContent||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var i=o.O(void 0,[5001],(()=>o(9525)));i=o.O(i);var r=NelioContent="undefined"==typeof NelioContent?{}:NelioContent;for(var a in i)r[a]=i[a];i.__esModule&&Object.defineProperty(r,"__esModule",{value:!0})})();