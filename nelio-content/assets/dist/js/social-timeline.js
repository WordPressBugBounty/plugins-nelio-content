(()=>{var e,t={3280:(e,t,n)=>{"use strict";n.r(t),n.d(t,{socialTimeline:()=>s});var s={};n.r(s),n.d(s,{SocialTimeline:()=>U});const o=window.ReactJSXRuntime,i=window.wp.i18n,a=window.wp.components,r=window.wp.data;function l(e,t){return(0,r.useSelect)(e,t)}function c(e){var t,n,s="";if("string"==typeof e||"number"==typeof e)s+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=c(e[t]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}const d=function(){for(var e,t,n=0,s="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=c(e))&&(s&&(s+=" "),s+=t);return s},u=window.moment;var m=n.n(u);const p=window.lodash,g=window.NelioContent.data,x=window.NelioContent.utils,f=window.NelioContent.socialMessageEditor,h=(e,t)=>{switch(e){case"day":return t<1;case"week":return 1<=t&&t<=10;case"month":return 10<t&&t<=40;default:return 40<t}},v=window.NelioContent.components,y=({message:e,deleteMessage:t,isBeingDeleted:n,isTimelineBusy:s,post:r})=>{var c;const u=l((t=>t(g.store).canCurrentUserEditSocialMessage(e))),m=l((t=>t(g.store).canCurrentUserDeleteSocialMessage(e))),p=b(e,r),f=!["error","publish"].includes(null!==(c=null==e?void 0:e.status)&&void 0!==c?c:""),h=(0,i._x)("View","command","nelio-content"),y=(0,x.isRecurringMessage)(e)?(0,i._x)("Edit All","command (all recurring messages)","nelio-content"):(0,i._x)("Edit","command","nelio-content");return(0,o.jsxs)("div",{className:d({"nelio-content-social-message__actions":!0,"nelio-content-social-message__actions--is-deleting":n}),children:[!n&&(0,o.jsx)(a.Button,{variant:"link",disabled:!u||s,onClick:p,children:f?y:h}),!n&&!!t&&(0,o.jsx)("span",{children:"|"}),!!t&&(0,o.jsx)(v.DeleteButton,{isDeleting:n,onClick:()=>{(null==e?void 0:e.id)&&t(e.id)},disabled:!m||s,labels:{delete:(0,x.isRecurringMessage)(e)?(0,i._x)("Delete All","command (all recurring messages)","nelio-content"):(0,i._x)("Delete","command","nelio-content"),deleting:(0,i._x)("Deleting…","text","nelio-content")},confirmationLabels:{title:(0,x.isRecurringMessage)(e)?(0,i._x)("Delete Recurring Social Message","text","nelio-content"):(0,i._x)("Delete Social Message","text","nelio-content"),text:(0,x.isRecurringMessage)(e)?(0,i._x)("Are you sure you want to delete this recurring social message and all its following instances? This operation can’t be undone.","user","nelio-content"):(0,i._x)("Are you sure you want to delete this social message? This operation can’t be undone.","user","nelio-content")}})]})},b=(e,t)=>{const{openSocialMessageEditor:n}=(0,r.useDispatch)(f.store);return()=>{e&&n(e,{context:"post",post:t})}},_=window.NelioContent.networks,w=({network:e,post:t,text:n})=>{const s=(0,x.computeSocialMessageText)((0,_.getCharLimitInNetwork)(e),t,n);return(0,o.jsx)("div",{className:"nelio-content-social-message__content-wrapper",children:(0,o.jsx)(v.SocialMessageTextPreview,{className:"nelio-content-social-message__actual-content",placeholder:"",linkBeautifier:e=>{if(-1===(e=e.replace(/^https?:\/\//i,"")).indexOf("/"))return e;const t=e.replace(/^[^/]*\//,"");return t.length<=10?e:`${e.replace(/\/.*$/,"")}/${t.substring(0,9)}…`},value:s})})},j=window.NelioContent.date,N=e=>{const{isBeingDeleted:t,source:n}=e,s=function(e){const{dateType:t,schedule:n,postStatus:s}=e;if("publish"===s||"exact"===t)return(0,j.dateI18n)((0,j.getSettings)().formats.datetime,n);const{dateValue:o,timeType:a,timeValue:r}=e;if("0"===o){if("exact"===a)return r;if("0"===r)return(0,i._x)("Same time as publication","text","nelio-content");const e=Math.abs(Number.parseInt(r))||0;return(0,i.sprintf)(/* translators: number of hours */ /* translators: number of hours */
(0,i._nx)("%d hour after publication","%d hours after publication",e,"text","nelio-content"),e)}const l=Math.abs(Number.parseInt(o))||0;return(0,i.sprintf)(/* translators: 1 -> number of days, 2 -> time */ /* translators: 1 -> number of days, 2 -> time */
(0,i._nx)("%1$d day after publication at %2$s","%1$d days after publication at %2$s",l,"text","nelio-content"),l,r)}(e);return(0,o.jsxs)("div",{className:d({"nelio-content-social-message__date":!0,"nelio-content-social-message__date--is-deleting":t}),children:["reshare-template"===n&&(0,o.jsx)(a.Dashicon,{icon:"share-alt"}),"publication-template"===n&&(0,o.jsx)(a.Dashicon,{icon:"megaphone"}),["user-highlight","custom-sentence"].includes(n)&&(0,o.jsx)(a.Dashicon,{icon:"editor-quote"}),"auto-extracted-sentence"===n&&(0,o.jsx)(a.Dashicon,{icon:"format-status"}),s]})},M=({messageId:e})=>{const t=T(e);return t?(0,o.jsxs)("div",{className:"nelio-content-social-message__recurrence",children:[(0,o.jsx)(a.Dashicon,{icon:"controls-repeat"}),t]}):null},S={period:"day",occurrences:2,interval:1},T=e=>{var t;const{message:n,today:s}=l((t=>({message:t(g.store).getSocialMessage(e),today:t(g.store).getToday()}))),o=(0,g.useRecurrenceSummary)((0,x.createRecurrenceContext)((null==n?void 0:n.schedule)||s),null!==(t=null==n?void 0:n.recurrenceSettings)&&void 0!==t?t:S);return(null==n?void 0:n.recurrenceSettings)?o:void 0},O=window.wp.element,D=e=>{const t=k(e);return(0,o.jsx)("div",{className:"nelio-content-social-message__location",children:t})},k=e=>l((t=>{var n,s;const{network:a,profileId:r,targetName:l}=e,{getSocialProfile:c}=t(g.store),d=c(r),u=(null!==(n=null==d?void 0:d.alias)&&void 0!==n?n:null==d?void 0:d.displayName)||(0,i._x)("Unknown","text","nelio-content");if(!l||!(0,_.doesNetworkSupport)("multi-target",a))return(0,o.jsx)("strong",{children:u});const{getProfileTarget:m}=t(g.store),p=m(r,l),f=null!==(s=null==p?void 0:p.displayName)&&void 0!==s?s:"";return(0,x.isEmpty)(f)?(0,o.jsx)("strong",{children:u}):(0,O.createInterpolateElement)((0,i.sprintf)(/* translators: 1 -> profile name, 2 -> target name */ /* translators: 1 -> profile name, 2 -> target name */
(0,i._x)("%1$s on %2$s","text","nelio-content"),`<strong>${u}</strong>`,`<em>${f}</em>`),{strong:(0,o.jsx)("strong",{}),em:(0,o.jsx)("em",{})})})),C=({messageId:e,deleteMessage:t,isBeingDeleted:n,isTimelineBusy:s,post:c})=>{const{openPremiumDialog:u}=(0,r.useDispatch)(g.store),m=l((t=>t(g.store).getSocialMessage(e)));if(!m)return null;const{auto:x,dateType:f,dateValue:h,id:b,isFreePreview:_,image:j,network:S,profileId:T,schedule:O,source:k,status:C,targetName:I,text:B,timeType:R,timeValue:V,type:E}=m,$="error"===C,A="image"===E||"auto-image"===E,U="video"===E,F="multi-media"===E;return(0,o.jsxs)("div",{className:d({"nelio-content-social-message":!0,"nelio-content-social-message--is-auto":!!x,"nelio-content-social-message--is-error":$,"nelio-content-social-message--is-free-preview":_}),"data-social-message-id":b,children:[A&&(0,o.jsx)(a.Dashicon,{className:"nelio-content-social-message__image-type-icon",icon:(0,p.isArray)(j)&&j.length>1?"format-gallery":"format-image"}),U&&(0,o.jsx)(a.Dashicon,{className:"nelio-content-social-message__video-type-icon",icon:"video-alt3"}),F&&(0,o.jsx)(a.Dashicon,{className:"nelio-content-social-message__multi-media-type-icon",icon:"format-gallery"}),(0,o.jsxs)("div",{className:"nelio-content-social-message__profile-and-location",children:[(0,o.jsx)(v.SocialProfileIcon,{className:"nelio-content-social-message__profile-icon",profileId:T}),(0,o.jsx)(D,{network:S,profileId:T,targetName:I})]}),(0,o.jsx)(w,{network:S,post:c,text:B||P(E)}),(0,o.jsx)(M,{messageId:e}),(0,o.jsx)(N,{isBeingDeleted:n,dateType:f,dateValue:h,schedule:O,timeType:R,timeValue:V,source:k,postStatus:c.status}),(0,o.jsx)(y,{message:m,deleteMessage:t,isTimelineBusy:s,isBeingDeleted:n,post:c}),_&&(0,o.jsx)("button",{className:"nelio-content-social-message__free-preview-button",onClick:()=>u("raw/free-previews"),children:(0,o.jsxs)("div",{className:"nelio-content-social-message__premium-badge components-button nelio-content-social-media-timeline-period__add-button nelio-content-premium-feature-button nelio-content-premium-feature-button--is-premium is-small has-text has-icon",children:[(0,o.jsx)("span",{children:(0,o.jsx)(a.Dashicon,{icon:"lock"})}),(0,o.jsx)("span",{children:(0,i._x)("Premium","text","nelio-content")})]})})]})};function P(e){switch(e){case"auto-image":case"text":return"";case"image":return(0,i._x)("(image)","text","nelio-content");case"video":return(0,i._x)("(video)","text","nelio-content");case"multi-media":return(0,i._x)("(media)","text","nelio-content")}}const I=e=>{const{period:t,deletingMessageIds:n=[]}=e,s=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(n[s[o]]=e[s[o]])}return n}(e,["period","deletingMessageIds"]),{post:r,isTimelineBusy:l=!1}=s,c=B(t,r),u=(0,g.useIsSubscribed)(),m=R(t,r,l),p=V(r,l),f=E(r,l),h=f&&!p;return(0,o.jsxs)("div",{className:"nelio-content-social-media-timeline-period__period-content",children:[!(0,x.isEmpty)(c)&&(0,o.jsx)("div",{className:"nelio-content-social-media-timeline-period__messages",children:c.map((e=>(0,o.jsx)(C,Object.assign({messageId:e,isBeingDeleted:n.includes(e)},s),e)))}),(0,o.jsx)("div",{className:"nelio-content-social-media-timeline-period__add-button-wrapper",children:u||"day"===t?(0,o.jsx)(a.Button,{className:d({"nelio-content-social-media-timeline-period__add-button":!0,"nelio-content-premium-feature-button nelio-content-premium-feature-button--is-premium":h}),variant:h?void 0:"secondary",size:"small",disabled:!f,onClick:m,icon:h?"lock":void 0,children:(0,i._x)("Add Social Message","command","nelio-content")}):(0,o.jsx)(v.PremiumFeatureButton,{feature:"edit-post/custom-timeline",label:(0,i._x)("Add Social Message","command","nelio-content"),size:"small"})})]})},B=(e,t)=>l((n=>{const{getSocialMessagesRelatedToPost:s}=n(g.store),o=s(t.id).filter((e=>"publish"!==e.status)).filter(((e,t,n)=>!(0,x.isRecurringMessage)(e)||$(n,e))),{getUtcNow:i}=n(g.store),a="publish"===t.status?((e,t)=>({schedule:n})=>{const s=Math.abs(t.diff(n,"days"));return h(e,s)})(e,m()(i())):(e=>t=>{const{dateType:n,dateValue:s}=t;if("exact"===n)return"other"===e;const o=Math.abs(Number.parseInt(s)||0);return h(e,o)})(e);return(0,p.map)((0,p.filter)(o,a),"id")})),R=(e,t,n)=>{const s=V(t,n),o=E(t,n),i=(0,g.useFeatureGuard)("edit-post/create-more-messages",o&&!s),a=(e=>{switch(e){case"day":return{dateType:"predefined-offset",dateValue:"0"};case"week":return{dateType:"predefined-offset",dateValue:"7",timeType:"time-interval",timeValue:"morning"};case"month":return{dateType:"predefined-offset",dateValue:"28",timeType:"time-interval",timeValue:"morning"};default:return{dateType:"exact",timeType:"time-interval",timeValue:"morning"}}})(e),c=l((e=>e(g.store).getProfilesWithMessagesRelatedToPost(t.id))),{openNewSocialMessageEditor:d}=(0,r.useDispatch)(f.store);return i((()=>d(a,{context:"post",post:t,disabledProfileIds:c})))},V=(e,t)=>l((n=>n(g.store).canCurrentUserCreateMessagesRelatedToPost(e)&&!t)),E=(e,t)=>l((n=>n(g.store).couldSubscriberCreateMessagesRelatedToPost(e)&&!t)),$=(e,t)=>{const n=e.filter((e=>e.recurrenceGroup===t.recurrenceGroup));return(0,p.sortBy)(n,"schedule")[0]===t},A=e=>{const t=function(e,t){switch(e){case"day":return"publish"===t.status?(0,i._x)("Today","text","nelio-content"):(0,i._x)("Publication Day","text","nelio-content");case"week":return(0,i._x)("Week","text","nelio-content");case"month":return(0,i._x)("Month","text","nelio-content");case"other":return(0,i._x)("Other","text","nelio-content")}}(e.period,e.post);return(0,o.jsxs)("div",{className:"nelio-content-social-media-timeline-period",children:[(0,o.jsx)("div",{className:"nelio-content-social-media-timeline-period__title",children:t}),(0,o.jsx)(I,Object.assign({},e))]})},U=e=>(0,o.jsxs)("div",{className:"nelio-content-social-timeline",children:[(0,o.jsx)(A,Object.assign({period:"day"},e)),(0,o.jsx)(A,Object.assign({period:"week"},e)),(0,o.jsx)(A,Object.assign({period:"month"},e)),(0,o.jsx)(A,Object.assign({period:"other"},e))]})}},n={};function s(e){var o=n[e];if(void 0!==o)return o.exports;var i=n[e]={exports:{}};return t[e](i,i.exports,s),i.exports}s.m=t,e=[],s.O=(t,n,o,i)=>{if(!n){var a=1/0;for(d=0;d<e.length;d++){for(var[n,o,i]=e[d],r=!0,l=0;l<n.length;l++)(!1&i||a>=i)&&Object.keys(s.O).every((e=>s.O[e](n[l])))?n.splice(l--,1):(r=!1,i<a&&(a=i));if(r){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[n,o,i]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={1482:0,5001:0};s.O.j=t=>0===e[t];var t=(t,n)=>{var o,i,[a,r,l]=n,c=0;if(a.some((t=>0!==e[t]))){for(o in r)s.o(r,o)&&(s.m[o]=r[o]);if(l)var d=l(s)}for(t&&t(n);c<a.length;c++)i=a[c],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(d)},n=globalThis.webpackChunkNelioContent=globalThis.webpackChunkNelioContent||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=s.O(void 0,[5001],(()=>s(3280)));o=s.O(o);var i=NelioContent="undefined"==typeof NelioContent?{}:NelioContent;for(var a in o)i[a]=o[a];o.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();