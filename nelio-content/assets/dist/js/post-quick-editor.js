(()=>{var e,t={6615:(e,t,n)=>{"use strict";n.r(t),n.d(t,{postQuickEditor:()=>s});var r={};n.r(r),n.d(r,{arePremiumItemsDirty:()=>U,areReferencesDirty:()=>z,areSeriesDirty:()=>J,areTasksDirty:()=>F,getAllAttributes:()=>I,getAuthorId:()=>A,getDateValue:()=>V,getExtraInfoTab:()=>ee,getId:()=>O,getNewComments:()=>Y,getPostStatus:()=>q,getPostTerms:()=>D,getPostTermsByTaxonomy:()=>R,getPostType:()=>C,getPremiumItems:()=>B,getReferenceInput:()=>H,getReferences:()=>K,getSeries:()=>j,getTaskPresetSelection:()=>G,getTasks:()=>M,getTimeValue:()=>L,getTitle:()=>N,getValidationError:()=>te,isNewPost:()=>Q,isPublished:()=>X,isSaving:()=>$,isTaskPresetLoaderOpen:()=>W,isVisible:()=>Z});var o={};n.r(o),n.d(o,{close:()=>_e,markAsSaving:()=>ke,openNewPostEditor:()=>ye,openPostEditor:()=>Ee,openTaskPresetLoader:()=>ve,selectTaskPresets:()=>he,setAuthorId:()=>se,setDateValue:()=>ae,setExtraInfoTab:()=>Te,setNewComments:()=>pe,setPostStatus:()=>oe,setPostTerms:()=>ie,setPostType:()=>re,setPremiumItems:()=>ce,setReferenceInput:()=>fe,setReferences:()=>me,setSeries:()=>le,setTasks:()=>de,setTimeValue:()=>ue,setTitle:()=>ne,setValidationError:()=>be});var i={};n.r(i),n.d(i,{saveAndClose:()=>qe});var s={};n.r(s),n.d(s,{PostQuickEditor:()=>En,onSavePremiumItems:()=>yn,store:()=>Be});const a=window.wp.element,u=window.wp.components,c=window.wp.data;function l(e,t){return(0,c.useSelect)(e,t)}function d(e){return(0,c.resolveSelect)(e)}const f=window.wp.i18n,m=window.lodash,p=window.NelioContent.data,v=window.NelioContent.components,h=window.NelioContent.utils,g=window.NelioContent.date;var y={error:"",extraInfoTab:"none",isPublished:!1,isSaving:!1,isVisible:!1},E={isOpen:!1,selection:[]},_=function(){return _=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},_.apply(this,arguments)},T={title:"",type:void 0,taxonomies:{},authorId:void 0,status:void 0,dateValue:"",timeValue:"",referenceInput:"",references:[],tasks:[],newComments:[],series:[],premiumItemsByType:{}},b=function(e){return!("id"in e)||!e.id};function k(e){return void 0===e?"":"".concat(e)}var x=function(e){var t="";if("exact"===e.dateType)t+="0:"+e.dateValue;else{var n=Math.abs(Number.parseInt(e.dateValue)||0);t+="positive-days"===e.dateType||0===n?"2:"+(0,m.padStart)("".concat(n),5,"0"):"1:"+(0,m.padStart)("".concat(Math.abs(9999-n)),5,"0"),t+=":",t+=e.task}return t+=":".concat(e.task,":").concat(e.id),_(_({},e),{_sort:t})},S=function(){return S=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},S.apply(this,arguments)},P=function(){return P=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},P.apply(this,arguments)};const w=(0,c.combineReducers)({attributes:function(e,t){var n;return void 0===e&&(e=T),null!==(n=function(e,t){var n,r,o,i,s,a,u;switch(t.type){case"OPEN_EDITOR":return _(_({},T),{id:b(t.post)?void 0:t.post.id,title:null!==(o=t.post.title)&&void 0!==o?o:T.title,type:null!==(i=t.post.type)&&void 0!==i?i:T.type,taxonomies:b(t.post)?T.taxonomies:t.post.taxonomies,authorId:null!==(s=t.post.author)&&void 0!==s?s:T.authorId,series:null!==(a=t.post.series)&&void 0!==a?a:T.series,status:b(t.post)?T.status:t.post.status,dateValue:!b(t.post)&&t.post.date?(0,g.date)("Y-m-d",t.post.date):k(b(t.post)?t.post.dateValue:""),timeValue:!b(t.post)&&t.post.date?(0,g.date)("H:i",t.post.date):k(b(t.post)?t.post.timeValue:"")});case"SET_TITLE":return _(_({},e),{title:t.title});case"SET_POST_TYPE":return _(_({},e),{type:t.postType});case"SET_POST_STATUS":return _(_({},e),{status:t.postStatus});case"SET_POST_TERMS":return _(_({},e),{taxonomies:_(_({},e.taxonomies),(n={},n[t.taxonomy]=t.terms,n))});case"SET_AUTHOR":return _(_({},e),{authorId:t.authorId});case"SET_DATE":return _(_({},e),{dateValue:k(t.dateValue)});case"SET_TIME":return _(_({},e),{timeValue:k(t.timeValue)});case"SET_PREMIUM_ITEMS":return _(_({},e),{premiumItemsByType:_(_({},e.premiumItemsByType),(r={},r[t.typeName]=t.items,r))});case"SET_TASKS":return _(_({},e),{tasks:(u=t.tasks,(0,m.orderBy)(u.map(x),"_sort"))});case"SET_REFERENCE_INPUT":return _(_({},e),{referenceInput:t.url});case"SET_REFERENCES":return _(_({},e),{references:t.references});case"SET_NEW_COMMENTS":return _(_({},e),{newComments:t.comments});case"SET_SERIES":return _(_({},e),{series:t.series})}}(e,t))&&void 0!==n?n:e},presetLoader:function(e,t){var n;return void 0===e&&(e=E),null!==(n=function(e,t){switch(t.type){case"OPEN_TASK_PRESET_LOADER":return S(S({},E),{isOpen:t.isOpen});case"SELECT_TASK_PRESETS":return e.isOpen?S(S({},e),{selection:t.selection}):e}}(e,t))&&void 0!==n?n:e},status:function(e,t){var n;return void 0===e&&(e=y),null!==(n=function(e,t){switch(t.type){case"OPEN_EDITOR":return P(P({},y),{isPublished:"status"in t.post&&"publish"===t.post.status,isVisible:!0});case"CLOSE_EDITOR":return y;case"SET_EXTRA_INFO_TAB":return P(P({},e),{extraInfoTab:t.tab});case"SET_VALIDATION_ERROR":return P(P({},e),{error:t.error});case"MARK_AS_SAVING":return P(P({},e),{isSaving:!!t.isSaving})}}(e,t))&&void 0!==n?n:e}});function I(e){return e.attributes}function O(e){return e.attributes.id}function N(e){return e.attributes.title||""}function C(e){return e.attributes.type}function q(e){return e.attributes.status}function D(e,t){var n;return null!==(n=e.attributes.taxonomies[t])&&void 0!==n?n:[]}function R(e){return e.attributes.taxonomies}function A(e){return e.attributes.authorId}function V(e){return e.attributes.dateValue}function j(e){return e.attributes.series}function L(e){return e.attributes.timeValue}function M(e){return e.attributes.tasks}var B=function(e,t){var n;return null!==(n=e.attributes.premiumItemsByType[t])&&void 0!==n?n:[]},U=function(e,t,n){var r=B(e,t);return r.length!==n.length||(0,m.some)(r,(function(e){var t=(0,m.find)(n,{id:e.id});return!t||!(0,m.isEqual)((0,m.pick)(e,(0,m.keys)(t)),t)}))};function F(e,t){var n=e.attributes.tasks;return t=t.map((function(e){return(0,m.pick)(e,["id","task","dateType","dateValue","color","assigneeId"])})),n.length!==t.length||(0,m.some)(n,(function(e){var n=(0,m.find)(t,{id:e.id});return!n||!(0,m.isEqual)((0,m.pick)(e,(0,m.keys)(n)),n)}))}function H(e){return e.attributes.referenceInput}function K(e){return e.attributes.references}function Y(e){return e.attributes.newComments}function z(e,t){var n=t.map((function(e){return e.url})),r=e.attributes.references;return n.length!==r.length||(0,m.some)(r,(function(e){return!n.includes(e.url)}))}function J(e,t){var n=e.attributes.series;return t.length!==n.length||(0,m.some)(n,(function(e){return!t.find((function(t){return t.id===e.id&&t.part===e.part}))}))}function W(e){return e.presetLoader.isOpen}function G(e){return e.presetLoader.selection}function Q(e){return!e.attributes.id}function X(e){return!!e.status.isPublished}function Z(e){return!!e.status.isVisible}function $(e){return!!e.status.isSaving}function ee(e){return e.status.extraInfoTab||"none"}function te(e){return e.status.error}function ne(e){return{type:"SET_TITLE",title:e}}function re(e){return{type:"SET_POST_TYPE",postType:e}}function oe(e){return{type:"SET_POST_STATUS",postStatus:e}}function ie(e,t){return{type:"SET_POST_TERMS",taxonomy:e,terms:t}}function se(e){return{type:"SET_AUTHOR",authorId:e}}function ae(e){return{type:"SET_DATE",dateValue:e}}function ue(e){return{type:"SET_TIME",timeValue:e}}function ce(e,t){return{type:"SET_PREMIUM_ITEMS",typeName:e,items:t}}function le(e){return{type:"SET_SERIES",series:e}}function de(e){return{type:"SET_TASKS",tasks:e}}function fe(e){return{type:"SET_REFERENCE_INPUT",url:e}}function me(e){return{type:"SET_REFERENCES",references:e}}function pe(e){return{type:"SET_NEW_COMMENTS",comments:e}}function ve(e){return{type:"OPEN_TASK_PRESET_LOADER",isOpen:e}}function he(e){return{type:"SELECT_TASK_PRESETS",selection:e}}var ge=function(){return ge=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ge.apply(this,arguments)};function ye(e,t){return void 0===t&&(t={}),{type:"OPEN_EDITOR",post:ge(ge({},(0,h.createPost)(e)),(0,m.omitBy)(t,m.isNil))}}function Ee(e){return{type:"OPEN_EDITOR",post:e}}function _e(){return{type:"CLOSE_EDITOR"}}function Te(e){return{type:"SET_EXTRA_INFO_TAB",tab:e}}function be(e){return{type:"SET_VALIDATION_ERROR",error:e}}function ke(e){return{type:"MARK_AS_SAVING",isSaving:e}}const xe=window.wp.apiFetch,Se=n.n(xe)(),Pe=window.wp.hooks;var we=function(){return we=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},we.apply(this,arguments)},Ie=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{u(r.next(e))}catch(e){i(e)}}function a(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},Oe=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},Ne=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},Ce=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};function qe(){return Ie(this,void 0,Promise,(function(){var e,t,n,r,o,i,s,a,u;return Oe(this,(function(l){switch(l.label){case 0:return(0,c.select)(Be).isSaving()?[2]:[4,(0,c.dispatch)(Be).markAsSaving(!0)];case 1:l.sent(),l.label=2;case 2:return l.trys.push([2,10,,11]),e=(0,c.select)(Be).getAllAttributes(),t=e.tasks,n=e.premiumItemsByType,r=e.newComments,[4,De(o=Ne(e,["tasks","premiumItemsByType","newComments"]))];case 3:return i=l.sent(),s=i.post,a=i.references,[4,Ae(!o.id,s,t)];case 4:return l.sent(),[4,Ve(!o.id,s,n)];case 5:return l.sent(),[4,Le(s,r)];case 6:return l.sent(),[4,(0,c.dispatch)(p.store).receivePosts(s)];case 7:return l.sent(),[4,(0,c.dispatch)(p.store).receiveSuggestedReferences(s.id,a)];case 8:return l.sent(),[4,(0,c.dispatch)(p.store).reloadPostRelatedItems(s.id)];case 9:return l.sent(),[3,11];case 10:return u=l.sent(),(0,h.logError)(u),[3,11];case 11:return[4,(0,c.dispatch)(Be).markAsSaving(!1)];case 12:return l.sent(),[4,(0,c.dispatch)(Be).close()];case 13:return l.sent(),[2]}}))}))}function De(e){return Ie(this,void 0,Promise,(function(){var t,n,r;return Oe(this,(function(o){switch(o.label){case 0:return t=e.id?"PUT":"POST",n=e.id?"/nelio-content/v1/post/".concat(e.id):"/nelio-content/v1/post",r=Se({path:n,method:t,data:we(we({},(0,m.omitBy)(e,h.isEmpty)),{references:e.references.map((function(e){return e.url}))})}),[4,Re(e)];case 1:return o.sent(),[2,r]}}))}))}function Re(e){return Ie(this,arguments,void 0,(function(e){var t=e.timeValue;return Oe(this,(function(e){switch(e.label){case 0:return t?[4,(0,c.dispatch)(p.store).setDefaultTime("post",t)]:[2];case 1:return e.sent(),(0,h.setValue)("defaultPostTime",t),[2]}}))}))}function Ae(e,t,n){return Ie(this,void 0,Promise,(function(){var r,o,i,s,a,u;return Oe(this,(function(l){switch(l.label){case 0:return e?[3,2]:[4,d(p.store).getTasksRelatedToPost(t.id)];case 1:return o=l.sent(),[3,3];case 2:o=[],l.label=3;case 3:if(r=o,!(0,c.select)(Be).areTasksDirty(r))return[2];l.label=4;case 4:return l.trys.push([4,6,,7]),i=(0,c.select)(p.store).getSiteId(),s=(0,c.select)(p.store).getApiRoot(),a=(0,c.select)(p.store).getAuthenticationToken(),[4,Se({url:"".concat(s,"/site/").concat(i,"/task"),method:"POST",credentials:"omit",mode:"cors",headers:{Authorization:"Bearer ".concat(a)},data:{mode:"replace",postId:t.id,tasks:n.map((function(e){return we(we({},e),{baseDatetime:t.date||"none",assigneeId:e.assigneeId||t.author,postId:t.id,postType:t.type,postAuthor:t.author})}))}})];case 5:return l.sent(),[3,7];case 6:return u=l.sent(),(0,h.logError)(u),[3,7];case 7:return r.forEach((function(e){var t=e.id;return(0,c.dispatch)(p.store).removeTask(t)})),[2]}}))}))}function Ve(e,t,n){return Ie(this,void 0,Promise,(function(){var r,o,i,s,a,u,l,f,v=this;return Oe(this,(function(g){switch(g.label){case 0:return e?[3,2]:[4,d(p.store).getAllPremiumItemsRelatedToPost(t.id)];case 1:return o=g.sent(),[3,3];case 2:o={},g.label=3;case 3:return r=o,y=(0,m.uniq)(Ce(Ce([],Object.keys(n),!0),Object.keys(r),!0)).reduce((function(e,t){var o,i,s;return we(we({},e),((o={})[t]={old:null!==(i=r[t])&&void 0!==i?i:[],new:null!==(s=n[t])&&void 0!==s?s:[]},o))}),{}),i=(0,m.toPairs)(y).map((function(e){var t=e[0],n=e[1];return n?[t,n]:void 0})).filter(h.isDefined),s=i.filter((function(e){var t=e[0],n=e[1].old;return(0,c.select)(Be).arePremiumItemsDirty(t,n)})),[4,Promise.all(s.map((function(e){return Ie(v,[e],Promise,(function(e){var n,r,o=e[0],i=e[1];return Oe(this,(function(e){switch(e.label){case 0:return n=[o],r={old:i.old},[4,je(o,i.new,t.id)];case 1:return[2,n.concat([(r.new=e.sent(),r)])]}}))}))})))];case 4:return a=g.sent(),u=(0,c.dispatch)(p.store),l=u.receivePremiumItems,f=u.removePremiumItem,a.forEach((function(e){var t=e[0],n=e[1];n.old.forEach((function(e){return f(t,e.id)})),l(t,n.new)})),[2]}var y}))}))}function je(e,t,n){return t.length?(0,Pe.applyFilters)("nelio-content_post-quick-editor_onSavePremiumItems",new Promise((function(e){return e([])})),e,t,n):new Promise((function(e){return e([])}))}function Le(e,t){return Ie(this,void 0,void 0,(function(){var n,r,o,i;return Oe(this,(function(s){switch(s.label){case 0:if(!(t=t.map((function(t){return we(we({},t),{postId:e.id,postType:e.type,postAuthor:e.author})}))).length)return[2];s.label=1;case 1:return s.trys.push([1,3,,4]),n=(0,c.select)(p.store).getSiteId(),r=(0,c.select)(p.store).getApiRoot(),o=(0,c.select)(p.store).getAuthenticationToken(),[4,Se({url:"".concat(r,"/site/").concat(n,"/comment"),method:"POST",credentials:"omit",mode:"cors",headers:{Authorization:"Bearer ".concat(o)},data:t})];case 2:return s.sent(),[3,4];case 3:return i=s.sent(),(0,h.logError)(i),[3,4];case 4:return[2]}}))}))}var Me=function(){return Me=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Me.apply(this,arguments)},Be=(0,c.createReduxStore)("nelio-content/post-quick-editor",{reducer:w,controls:c.controls,actions:Me(Me({},o),i),selectors:r});!function(e){(0,c.register)(e)}(Be);var Ue=[{title:(0,f._x)("Post Editor","text","nelio-content"),intro:(0,f._x)("Welcome to the post editor. This simple modal lets you quickly and efficiently create new posts or edit existing ones.","user","nelio-content")},{title:(0,f._x)("Title","text","nelio-content"),intro:(0,f._x)("Here you can set or change the post’s title.","user","nelio-content"),element:function(){return document.querySelector(".nelio-content-post-quick-editor__title")}},{title:(0,f._x)("Post Type","text","nelio-content"),intro:(0,f._x)("Use this selector to set its type to one of the post types enabled in Nelio Content’s advanced settings.","user","nelio-content"),active:function(){return!!document.querySelector(".nelio-content-post-quick-editor__type")},element:function(){return document.querySelector(".nelio-content-post-quick-editor__type")}},{title:(0,f._x)("Status","text","nelio-content"),intro:(0,f._x)("Use this selector to set the post’s status.","user","nelio-content"),active:function(){return!!document.querySelector(".nelio-content-post-quick-editor__status")},element:function(){return document.querySelector(".nelio-content-post-quick-editor__status")}},{title:(0,f._x)("Status","text","nelio-content"),intro:(0,f._x)("In multiauthor sites, you can select the author of any given post here.","user","nelio-content"),active:function(){return!!document.querySelector(".nelio-content-post-quick-editor__author")},element:function(){return document.querySelector(".nelio-content-post-quick-editor__author")}},{title:(0,f._x)("Date","text","nelio-content"),intro:(0,f._x)("You can also set the date in which the post is supposed to be published. If you don’t set a specific date, the post will show up in the “Unscheduled” section.","user","nelio-content"),active:function(){return!!document.querySelector(".nelio-content-post-quick-editor__date")},element:function(){return document.querySelector(".nelio-content-post-quick-editor__date")}},{title:(0,f._x)("Time","text","nelio-content"),intro:(0,f._x)("You can also set the publication time.","user","nelio-content"),active:function(){return!!document.querySelector(".nelio-content-post-quick-editor__time")},element:function(){return document.querySelector(".nelio-content-post-quick-editor__time")}},{title:(0,f._x)("More Options","text","nelio-content"),intro:(0,f._x)("Finally, you can click on this link to show some additional settings. For example, if you’re creating or editing a blog post, this will reveal a couple of settings to tweak its categories and tags.","user","nelio-content"),active:function(){return!!document.querySelector(".nelio-content-post-quick-editor__extra-action")},element:function(){return document.querySelector(".nelio-content-post-quick-editor__extra-action")}}],Fe=function(){var e=He(),t=e.authorId,n=e.dateValue,r=e.reference,o=e.timeValue,i=e.title,s=Ke(),u=s.setError,c=s.clearErrors;return(0,a.useEffect)(Ye((function(){return(0,h.isEmpty)((0,m.trim)(i))?u((0,f._x)("Please set post’s title","user","nelio-content")):(0,h.isEmpty)(t)?u((0,f._x)("Please set a post author","user","nelio-content")):(0,h.isEmpty)(n)&&!(0,h.isEmpty)(o)?u((0,f._x)("Please specify a valid date","user","nelio-content")):!(0,h.isEmpty)(n)&&(0,h.isEmpty)(o)?u((0,f._x)("Please specify a valid time","user","nelio-content")):r&&!(0,h.isUrl)(r)?u((0,f._x)("Please type in a valid reference URL","user","nelio-content")):c()})),[t,n,r,o,i]),null},He=function(){return l((function(e){var t=e(Be),n=t.getAuthorId,r=t.getDateValue,o=t.getReferenceInput,i=t.getTimeValue,s=t.getTitle;return{authorId:n(),dateValue:r(),reference:o(),timeValue:i(),title:s()}}))},Ke=function(){var e=(0,c.useDispatch)(Be).setValidationError;return{setError:e,clearErrors:function(){return e("")}}},Ye=function(e){return function(){e()}};const ze=window.wp.coreData;var Je=function(){var e=Ge(),t=Xe();return e||!t},We=function(){return l((function(e){return e(Be).isPublished()}))},Ge=function(){return l((function(e){return e(Be).isSaving()}))},Qe=function(){return l((function(e){return e(Be).isNewPost()}))},Xe=function(){return l((function(e){var t=e(p.store),n=t.getPost,r=t.canCurrentUserEditPost,o=e(Be),i=o.getId,s=o.isNewPost,a=i(),u=!!a&&n(a),c=!!u&&r(u);return s()||c}))},Ze=function(){return!!$e().length},$e=function(){var e=l((function(e){return e(Be).getPostType()})),t=nt();return(0,m.filter)(t,(function(t){return!e||t.types.includes(e)}))},et=function(e){return l((function(t){var n=t(Be).getPostType();return t(p.store).getPostTypes(e).some((function(e){return e.name===n}))}))},tt=function(){return[Ze(),et("future-actions"),et("series"),et("tasks"),et("comments"),et("references")].some((function(e){return e}))},nt=function(){var e=(0,m.filter)(l((function(e){return e(ze.store).getEntityRecords("root","taxonomy",{per_page:-1})||[]})),(function(e){return e.visibility.public}));return(0,Pe.applyFilters)("nelio-content_post-quick-editor_allTaxonomies",e)},rt=function(){var e=Xe(),t=ot();return e?null:a.createElement("div",{className:"nelio-content-post-quick-editor__edit-warning"},a.createElement(u.Dashicon,{icon:"warning"}),t)},ot=function(){return l((function(e){switch((0,e(Be).getPostType)()){case"page":return(0,f._x)("You’re not allowed to edit this page.","user","nelio-content");case"post":return(0,f._x)("You’re not allowed to edit this post.","user","nelio-content");default:return(0,f._x)("You’re not allowed to edit this content.","user","nelio-content")}}))},it=function(){var e=(0,c.useDispatch)(Be).setExtraInfoTab,t=st(),n=tt(),r=Je(),o=Ze();return!n||t?null:a.createElement("div",{className:"nelio-content-post-quick-editor__extra-actions"},a.createElement(u.Button,{className:"nelio-content-post-quick-editor__extra-action",variant:"link",disabled:r,onClick:function(){return e(o?"taxonomies":"tasks")}},(0,f._x)("View Details","command","nelio-content")))},st=function(){return l((function(e){return"none"!==e(Be).getExtraInfoTab()}))},at=function(){var e=(0,c.useDispatch)(Be),t=e.close,n=e.saveAndClose,r=Je(),o=ut(),i=Qe(),s=Ge();return a.createElement("div",{className:"nelio-content-post-quick-editor__actions"},a.createElement(it,null),a.createElement(u.Button,{variant:"secondary",disabled:r,onClick:t},(0,f._x)("Cancel","command","nelio-content")),a.createElement(v.SaveButton,{variant:"primary",error:o,isSaving:s,isUpdate:!i,onClick:n}))},ut=function(){return l((function(e){return e(Be).getValidationError()}))},ct=function(){var e=(0,c.useDispatch)(Be).close,t=lt(),n=t.primary,r=t.secondary;return a.createElement("div",{className:"nelio-content-post-quick-editor__actions"},a.createElement(it,null),a.createElement(u.Button,{variant:"secondary",onClick:e},(0,f._x)("Cancel","command","nelio-content")),!!r&&a.createElement(u.ExternalLink,{className:"components-button is-secondary",href:r.url,onClick:e},r.label),!!n&&a.createElement(u.ExternalLink,{className:"components-button is-primary",href:n.url,onClick:e},n.label))},lt=function(){var e=dt(),t=Xe();if(!e)return{};var n=e.status,r=e.editLink,o="publish"===n,i={url:e.viewLink,label:o?(0,f._x)("View","command","nelio-content"):(0,f._x)("Preview","command","nelio-content")},s={url:r,label:(0,f._x)("Edit","command","nelio-content")};return t?{primary:o?i:s,secondary:o?s:i}:{secondary:i}},dt=function(){return l((function(e){return(0,e(p.store).getPost)((0,e(Be).getId)())}))},ft=function(){return ft=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ft.apply(this,arguments)},mt=function(){var e=Xe(),t=pt();return e&&t?a.createElement(at,null):a.createElement(ct,null)},pt=function(){return l((function(e){var t,n,r,o;if(e(p.store),e(Be),(0,e(Be).isNewPost)())return!0;var i=e(Be).getId(),s=e(p.store).getPost(i);if(!s)return!0;var a=e(p.store).getTasksRelatedToPost(i);if(e(Be).areTasksDirty(a))return!0;var u=e(Be).arePremiumItemsDirty,c=(0,m.toPairs)(e(p.store).getAllPremiumItemsRelatedToPost(i)).map((function(e){var t=e[0],n=e[1];return n?[t,n]:void 0})).filter(h.isDefined).map((function(e){var t=e[0],n=e[1];return u(t,n)})).some((function(e){return e}));if(c)return!0;var l=e(p.store).getSuggestedReferences(i);if(e(Be).areReferencesDirty(l))return!0;if(e(Be).getNewComments().length)return!0;var d=s.series;if(e(Be).areSeriesDirty(d))return!0;var f=e(Be),v=f.getTitle,g=f.getAuthorId,y=f.getDateValue,E=f.getTimeValue,_=f.getPostStatus,T=f.getPostTermsByTaxonomy,b=function(e){return JSON.stringify((0,m.mapValues)(e,(function(e){return(0,m.orderBy)(e,"id")})))},k={title:v(),status:_(),author:g(),dateValue:null!==(t=y())&&void 0!==t?t:"",timeValue:null!==(n=E())&&void 0!==n?n:"",taxonomies:b(T())},x=(0,h.extractDateTimeValues)(s.date),S=ft(ft({},(0,m.pick)(s,(0,m.keys)(k))),{taxonomies:b(s.taxonomies),dateValue:null!==(r=null==x?void 0:x.dateValue)&&void 0!==r?r:"",timeValue:null!==(o=null==x?void 0:x.timeValue)&&void 0!==o?o:""});return!(0,m.isEqual)(k,S)}))},vt=function(){var e=ht(),t=e[0],n=e[1],r=gt(),o=Je();return r?a.createElement("div",{className:"nelio-content-post-quick-editor__author"},a.createElement(v.AuthorSearcher,{value:t,onChange:function(e){e&&n(e)},placeholder:(0,f._x)("Author…","text","nelio-content"),disabled:o})):null},ht=function(){return[l((function(e){return e(Be).getAuthorId()})),(0,c.useDispatch)(Be).setAuthorId]},gt=function(){return l((function(e){return e(p.store).isMultiAuthor()}))},yt=function(){var e=Et(),t=e[0],n=e[1],r=_t(),o=Je(),i=We();return a.createElement("div",{className:"nelio-content-post-quick-editor__date"},a.createElement(v.DateInput,{disabled:o||i,value:t,onChange:function(e){return n(null!=e?e:"")},min:r}))},Et=function(){return[l((function(e){return e(Be).getDateValue()})),(0,c.useDispatch)(Be).setDateValue]},_t=function(){return l((function(e){var t=e(p.store),n=t.getToday,r=t.getPost,o=e(Be),i=o.getId,s=o.isNewPost,a=n(),u=r(i()),c=(0,h.extractDateTimeValues)(null==u?void 0:u.date);return s()?a:Tt(a,null==c?void 0:c.dateValue)}))},Tt=function(e,t){return!t||e<t?e:t},bt=n(6942),kt=n.n(bt),xt=function(){return xt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},xt.apply(this,arguments)},St=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Pt=function(){return a.createElement(wt,null)},wt=(0,p.withSubscriptionCheck)("raw/editorial-comments",(function(){return a.createElement("div",{className:"nelio-content-pqe-extra__comments"},a.createElement(It,null),a.createElement(Ot,null))})),It=function(){var e=(0,a.useRef)(null),t=Ct(),n=t.comments,r=t.newComments,o=qt(),i=r.length,s=(0,a.useState)(-1),u=s[0],c=s[1];return(0,a.useEffect)((function(){var t;u!==i&&(u<i&&(null===(t=e.current)||void 0===t||t.scrollTo({top:999999,behavior:-1===u?void 0:"smooth"})),c(i))}),[u,i,c]),a.createElement("ul",{ref:e,className:"nelio-content-pqe-extra__comment-list"},n.map((function(e){return a.createElement(Nt,{key:"nelio-content-comment-".concat(e.id),comment:e})})),r.map((function(e){return a.createElement(Nt,{key:"nelio-content-comment-".concat(e.id),comment:e,onDelete:function(){return o(e.id)}})})))},Ot=function(){var e=(0,a.useState)(""),t=e[0],n=e[1],r=Dt();return a.createElement("div",{className:"nelio-content-pqe-extra__comment-form"},a.createElement(u.TextareaControl,{placeholder:(0,f._x)("Write a comment and press enter to send…","user","nelio-content"),value:t,onChange:n,onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),r(t),n(""))}}))},Nt=function(e){var t=e.comment,n=e.onDelete,r=l((function(e){return e(Be).isSaving()})),o=Rt(null==t?void 0:t.authorId),i=(0,p.useAuthorName)(null==t?void 0:t.authorId);return a.createElement("li",{className:kt()("nelio-content-pqe-extra__comment",{"nelio-content-pqe-extra__comment--is-mine":o})},a.createElement("div",null,a.createElement("div",{className:kt()({"nelio-content-pqe-extra__comment-bubble":!0,"nelio-content-pqe-extra__comment-bubble--is-mine":o})},(null==t?void 0:t.comment)||""),n?a.createElement("div",{className:"nelio-content-pqe-extra__comment-actions"},a.createElement("span",null,r?(0,f._x)("Saving…","text","nelio-content"):(0,f._x)("New","text (editorial comment)","nelio-content"))," • ",a.createElement(v.DeleteButton,{disabled:r,onClick:n})):a.createElement("div",{className:kt()({"nelio-content-pqe-extra__comment-extra":!0,"nelio-content-pqe-extra__comment-extra--is-mine":o})},!o&&a.createElement("div",{className:"nelio-content-pqe-extra__comment-author"},i),a.createElement("div",{className:"nelio-content-pqe-extra__comment-date"},(0,g.dateI18n)((0,g.getSettings)().formats.datetime,null==t?void 0:t.date)))))},Ct=function(){return l((function(e){var t=e(Be).getId();return{comments:e(p.store).getCommentsRelatedToPost(t),newComments:e(Be).getNewComments()}}))},qt=function(){var e=(0,c.useDispatch)(Be).setNewComments;return l((function(t){var n=t(Be).getNewComments();return function(t){e(n.filter((function(e){return e.id!==t})))}}))},Dt=function(){var e=(0,c.useDispatch)(Be).setNewComments;return l((function(t){var n=t(Be).getNewComments();return function(t){(t=(0,m.trim)(t))&&e(St(St([],n,!0),[xt(xt({},(0,h.createComment)(0,"post")),{comment:t})],!1))}}))},Rt=function(e){return l((function(t){return t(p.store).getCurrentUserId()===e}))},At=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Vt=function(){var e=l((function(e){return{referenceInput:e(Be).getReferenceInput(),references:e(Be).getReferences()}})),t=e.references,n=e.referenceInput,r=(0,c.useDispatch)(Be),o=r.setReferenceInput,i=r.setReferences,s=(0,m.trim)(n),d=(0,h.isUrl)(s)&&!t.some((function(e){return e.url===s}));return a.createElement("div",{className:"nelio-content-pqe-extra__references"},a.createElement("ul",{className:"nelio-content-pqe-extra__reference-list"},t.map((function(e,t){return a.createElement("li",{key:"nelio-content-reference-".concat(t)},a.createElement(u.ExternalLink,{href:e.url},e.title||e.url))}))),a.createElement("div",{className:"nelio-content-pqe-extra__new-reference"},a.createElement(u.TextControl,{autoComplete:"off",placeholder:(0,f._x)("Suggest reference…","user","nelio-content"),value:n,onChange:o}),a.createElement(u.Button,{variant:"secondary",onClick:function(){(0,h.isUrl)(s)&&(i(At(At([],t,!0),[{url:s,title:""}],!1)),o(""))},disabled:!d},(0,f._x)("Add","command","nelio-content"))))};const jt=window.NelioContent.taskEditor;var Lt=function(){return Lt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Lt.apply(this,arguments)},Mt=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Bt=function(){var e=Ht(),t=l((function(e){return!!e(Be).getTasks().length})),n=(0,c.useDispatch)(Be),r=n.openTaskPresetLoader,o=n.setTasks,i=l((function(e){return e(Be).getTasks()})),s=Ft(i),u=Ut(),d=u[0],f=u[1];return a.createElement(v.TaskPresetLoader,{state:e,actions:t?"replace-or-merge":"add",selection:d,onUpdate:f,onCancel:function(){return r(!1)},onMerge:function(e){o(Mt(Mt([],i,!0),e.map(s("merge")).filter(h.isDefined),!0)),r(!1)},onReplace:function(e){o(e.map(s("replace")).filter(h.isDefined)),r(!1)}})},Ut=function(){return[l((function(e){return e(Be).getTaskPresetSelection()})),(0,c.useDispatch)(Be).selectTaskPresets]},Ft=function(e){var t=l((function(e){return{postAuthor:e(Be).getAuthorId(),postId:e(Be).getId(),postType:e(Be).getPostType(),postDate:e(Be).getDateValue()}})),n=t.postAuthor,r=t.postId,o=t.postType,i=t.postDate;return function(t){return function(s){var a,u,c=Lt(Lt({},(0,h.createTask)()),{assigneeId:null!==(u=null!==(a=s.assigneeId)&&void 0!==a?a:n)&&void 0!==u?u:0,task:s.task,color:s.color,dateType:s.dateType,dateValue:s.dateValue,postId:r,postType:o,dateDue:(0,h.getTaskDateDue)({baseDatetime:i||"now",dateType:s.dateType,dateValue:s.dateValue}),postAuthor:n}),l=(0,m.pick)(c,["assigneeId","task","dateType","dateValue"]);return"merge"===t&&(0,m.some)(e,(function(e){return(0,m.isEqual)(l,(0,m.pick)(e,(0,m.keys)(l)))}))?void 0:c}}},Ht=function(){return l((function(e){return e(Be).isTaskPresetLoaderOpen()?"selection":void 0}))},Kt=function(){return Kt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Kt.apply(this,arguments)},Yt=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},zt=function(){return a.createElement(Jt,null)},Jt=(0,p.withSubscriptionCheck)("raw/editorial-tasks",(function(){return a.createElement("div",{className:"nelio-content-pqe-extra__tasks"},a.createElement(Wt,null),a.createElement(Gt,null),a.createElement(Bt,null),a.createElement(jt.TaskEditor,null))})),Wt=function(){var e=l((function(e){return e(Be).getTasks()}));return a.createElement("ul",{className:"nelio-content-pqe-extra__task-list"},e.map((function(e){return a.createElement(Qt,{key:"nelio-content-task-".concat(e.id),task:e})})))},Gt=function(){var e=Xt(),t=(0,c.useDispatch)(Be).openTaskPresetLoader,n=(0,c.useDispatch)(jt.store).openNewTaskEditor,r=Zt().addTask,o=l((function(e){return{canEditSettings:e(p.store).canCurrentUserManagePlugin(),hasTaskPresets:!!e(p.store).getTaskPresets().length,settingsUrl:e(p.store).getAdminUrl("/admin.php?page=nelio-content-settings&subpage=tools--task-presets")}})),i=o.canEditSettings,s=o.hasTaskPresets,d=o.settingsUrl;return a.createElement(a.Fragment,null,a.createElement("div",{className:"nelio-content-pqe-extra__task-list-actions"},s&&a.createElement(u.Button,{size:"small",variant:"secondary",onClick:function(){return t(!0)}},(0,f._x)("Load Tasks","command","nelio-content")),a.createElement(u.Button,{size:"small",variant:"secondary",onClick:function(){return n(Kt(Kt({},(0,h.createTask)()),{dateType:"predefined-offset",dateValue:"0"}),{context:"post",post:e,onSave:r})}},(0,f._x)("Add Task","command","nelio-content"))),!s&&i&&a.createElement("div",{className:"nelio-content-pqe-extra__configure-task-presets"},a.createElement(u.ExternalLink,{href:d},(0,f._x)("Create reusable task presets now","user","nelio-content"))))},Qt=function(e){var t,n=e.task,r=(0,p.useAuthorName)(n.assigneeId,(0,f._x)("Unknown Assignee","text","nelio-content")),o=(0,h.getHumanDateDue)(void 0,n.dateType,n.dateValue),i=Xt(),s=Zt(),l=s.editTask,d=s.deleteTask,m=(0,c.useDispatch)(jt.store).openExistingTaskEditor;return a.createElement("li",{className:kt()("nelio-content-pqe-extra__task",(t={"nelio-content-pqe-extra__task--completed":!!n.completed},t["nelio-content-pqe-extra__task--is-".concat(n.color)]=!!n.color,t))},a.createElement("div",{className:kt()("nelio-content-pqe-extra__task-desc",{"nelio-content-pqe-extra__task-desc--completed":!!n.completed})},n.task),a.createElement("div",{className:"nelio-content-pqe-extra__task-details"},"".concat(r," • ").concat(o)),a.createElement("div",{className:"nelio-content-pqe-extra__task-actions"},a.createElement(u.Button,{size:"small",variant:"link",onClick:function(){return m(n,{post:i,context:"post",onSave:l})}},(0,f._x)("Edit","command","nelio-content")),a.createElement(v.DeleteButton,{size:"small",onClick:function(){return d(n)}})))},Xt=function(){return l((function(e){return{id:0,title:e(Be).getTitle(),type:e(Be).getPostType()||"post",author:e(Be).getAuthorId()||0,date:e(Be).getDateValue(),status:e(Be).getPostStatus()||e(Be).getPostStatus()||"draft",viewLink:""}}))},Zt=function(){var e=l((function(e){return e(Be).getTasks()})),t=(0,c.useDispatch)(Be).setTasks;return{addTask:function(n){return t(Yt(Yt([],e,!0),[n],!1))},editTask:function(n){return t((0,m.values)((0,m.keyBy)(Yt(Yt([],e,!0),[n],!1),"id")))},deleteTask:function(n){return t((0,m.without)(e,n))}}},$t=function(e){var t=e.showLabels,n=$e(),r=en(),o=r[0],i=r[1];return a.createElement(a.Fragment,null,n.map((function(e){var n=e.slug,r=e.labels;return a.createElement(v.ItemSelectControl,{key:n,label:t?r.name:void 0,placeholder:r.search_items,kind:"taxonomy",name:n,value:(0,m.map)(o[n],"id"),onChange:i(n)})})))},en=function(){var e=$e().map((function(e){return e.slug})),t=l((function(t){var n=t(Be).getPostTerms;return(0,m.zipObject)(e,e.map(n))})),n=(0,c.useDispatch)(Be).setPostTerms,r=(0,c.select)(ze.store).getEntityRecord;return[t,function(e){return function(t){return n(e,(0,m.map)(t,(o=e,function(e){var t,n;return{id:e,name:(null===(t=r("taxonomy",o,e))||void 0===t?void 0:t.name)||"Term ".concat(e),slug:(null===(n=r("taxonomy",o,e))||void 0===n?void 0:n.slug)||"term-".concat(e)}})));var o}}]},tn=function(){var e=on();return tt()?"none"===e?null:a.createElement(nn,{tab:e}):null},nn=function(e){var t=e.tab,n=rn(t),r=sn(),o=(0,c.useDispatch)(Be).setExtraInfoTab;return a.createElement("div",{className:"nelio-content-pqe-extra"},a.createElement("div",{className:"nelio-content-pqe-extra__tabs"},r.map((function(e){var n=e.name,r=e.title;return a.createElement("button",{key:n,title:r,className:kt()("nelio-content-pqe-extra__tab",{"nelio-content-pqe-extra__tab--active":t===n}),onClick:function(){return o(n)}},r)}))),a.createElement("div",{className:"nelio-content-pqe-extra__content"},a.createElement(n,null)))},rn=function(e){switch(e){case"tasks":return zt;case"future-actions":return(0,v.getPremiumComponent)("pqe/future-actions","raw/future-actions");case"comments":return Pt;case"references":return Vt;case"series":return(0,v.getPremiumComponent)("pqe/series","raw/series");case"taxonomies":return function(){return a.createElement($t,{showLabels:!0})}}},on=function(){return l((function(e){return e(Be).getExtraInfoTab()}))},sn=function(){return[Ze()&&{name:"taxonomies",title:(0,f._x)("Taxonomies","text","nelio-content")},et("tasks")&&{name:"tasks",title:(0,f._x)("Tasks","text","nelio-content")},et("series")&&{name:"series",title:(0,f._x)("Series","text","nelio-content")},et("future-actions")&&{name:"future-actions",title:(0,f._x)("Future Actions","text","nelio-content")},et("comments")&&{name:"comments",title:(0,f._x)("Comments","text","nelio-content")},et("references")&&{name:"references",title:(0,f._x)("References","text","nelio-content")}].filter((function(e){return!!e}))},an=function(){var e=un(),t=e[0],n=e[1],r=Je();return a.createElement("div",{className:"nelio-content-post-quick-editor__title"},a.createElement(u.TextControl,{disabled:r,value:t,onChange:function(e){return n(e)},placeholder:(0,f._x)("Title…","text","nelio-content")}))},un=function(){return[l((function(e){return e(Be).getTitle()})),(0,c.useDispatch)(Be).setTitle]},cn=function(){var e=ln(),t=e[0],n=e[1],r=Je(),o=We();return a.createElement("div",{className:"nelio-content-post-quick-editor__time"},a.createElement(v.TimeInput,{disabled:r||o,value:t,onChange:function(e){return n(null!=e?e:"")}}))},ln=function(){return[l((function(e){return e(Be).getTimeValue()})),(0,c.useDispatch)(Be).setTimeValue]},dn=function(e){var t=e.contexts,n=fn(),r=n[0],o=n[1],i=mn(t),s=Je();return!Qe()||i.length<2?null:a.createElement("div",{className:"nelio-content-post-quick-editor__type"},a.createElement(u.SelectControl,{disabled:s,value:r,onChange:o,options:i}))},fn=function(){return[l((function(e){return e(Be).getPostType()})),(0,c.useDispatch)(Be).setPostType]},mn=function(e){return l((function(t){var n=e.flatMap((function(e){return t(p.store).getPostTypes(e,"create")}));return(0,m.uniq)(n).map((function(e){var t=e.name;return{label:e.labels.singular,value:t}}))}))},pn=function(){var e=vn(),t=e[0],n=e[1],r=hn(),o=Je(),i=gn();return a.createElement("div",{className:"nelio-content-post-quick-editor__status"},a.createElement(u.SelectControl,{disabled:o||i,value:t,onChange:n,options:r}))},vn=function(){var e=(0,m.map)(hn(),"value"),t=l((function(e){return e(Be).getPostStatus()})),n=(0,c.useDispatch)(Be).setPostStatus;return(0,a.useEffect)((function(){(0,h.hasHead)(e)&&(t&&e.includes(t)||n(e[0]))}),[e.join(","),t]),[t,n]},hn=function(){var e,t=gn(),n=l((function(e){var t=e(p.store),n=t.canCurrentUserPublishPost,r=t.getPost,o=t.getPostStatuses,i=e(Be),s=i.getId,a=(0,i.getPostType)(),u=(0,m.filter)(a?o(a):[],(function(e){return"nelio-content-unscheduled"!==e.slug})),c=r(s());return(0,m.map)(u,(function(e){var t=e.slug,r=e.name,o=e.available,i=e.flags;return{value:t,label:r,disabled:!o||(void 0===i?[]:i).includes("disabled-in-editor")||"future"===t&&!n(c)}}))}));return t?[null!==(e=(0,m.find)(n,{value:h.PUBLISHED}))&&void 0!==e?e:{value:h.PUBLISHED,label:(0,f._x)("Published","text","nelio-content"),disabled:!0}]:(0,m.filter)(n,(function(e){var t=e.value;return"publish"!==t&&"trash"!==t}))},gn=function(){return l((function(e){var t=(0,e(p.store).getPost)((0,e(Be).getId)());return"publish"===(null==t?void 0:t.status)}))};function yn(e,t){(0,Pe.addFilter)("nelio-content_post-quick-editor_onSavePremiumItems","save".concat((0,h.pascalCase)(e),"s"),(function(n,r,o,i){return e===r?t(o,i):n}))}var En=function(e){var t=e.className,n=void 0===t?"":t,r=e.context,o=bn(),i=xn(),s=a.createElement(Tn,null),c=(0,m.isArray)(r)?r:[r];return o?i?a.createElement(u.Modal,{className:"nelio-content-post-quick-editor ".concat(n),title:(0,f._x)("Loading…","text","nelio-content"),isDismissible:!1,shouldCloseOnEsc:!1,shouldCloseOnClickOutside:!1,onRequestClose:function(){}},a.createElement("div",{style:{display:"flex",justifyContent:"center"}},a.createElement(u.Spinner,null))):a.createElement(u.Modal,{className:"nelio-content-post-quick-editor ".concat(n),title:s,isDismissible:!1,shouldCloseOnEsc:!1,shouldCloseOnClickOutside:!1,onRequestClose:function(){}},a.createElement("div",{className:"nelio-content-post-quick-editor__title-type-and-status"},a.createElement(an,null),a.createElement(dn,{contexts:c}),a.createElement(pn,null)),a.createElement("div",{className:"nelio-content-post-quick-editor__author-and-datetime"},a.createElement(vt,null),a.createElement(yt,null),a.createElement(cn,null)),a.createElement(tn,null),a.createElement(Fe,null),a.createElement(rt,null),a.createElement(mt,null)):null},Tn=function(){var e=kn();return a.createElement("div",{className:"nelio-content-post-quick-editor__header"},a.createElement("div",{className:"nelio-content-post-quick-editor__header-text"},e),a.createElement("div",{className:"nelio-content-post-quick-editor__header-help"},a.createElement(v.ContextualHelp,{context:"post-quick-editor",walkthrough:Ue,autostart:!0})))},bn=function(){return l((function(e){return e(Be).isVisible()}))},kn=function(){return l((function(e){e(p.store),e(Be);var t=e(Be).isNewPost(),n=e(Be).getPostType(),r=n&&e(p.store).getPostType(n);return r?t?r.labels.new:r.labels.edit:t?(0,f._x)("New post","text","nelio-content"):(0,f._x)("Edit post","text","nelio-content")}))},xn=function(){var e=l((function(e){return e(Be).isNewPost()})),t=Pn(),n=wn(),r=Sn();return!e&&(t||n||r)},Sn=function(){var e=(0,c.useDispatch)(Be).setReferences,t=l((function(e){var t=e(Be).getId();return{references:e(p.store).getSuggestedReferences(t),isLoading:!e(p.store).hasFinishedResolution("getSuggestedReferences",[t])&&!e(p.store).hasResolutionFailed("getSuggestedReferences",[t]),isVisible:e(Be).isVisible()}})),n=t.references,r=t.isLoading,o=t.isVisible;return(0,a.useEffect)((function(){o&&!r&&e(n)}),[o,e,JSON.stringify(n),r]),r},Pn=function(){var e=(0,c.useDispatch)(Be).setTasks,t=l((function(e){var t=e(Be).getId();return{tasks:e(p.store).getTasksRelatedToPost(t),isLoading:!e(p.store).hasFinishedResolution("getTasksRelatedToPost",[t])&&!e(p.store).hasResolutionFailed("getTasksRelatedToPost",[t]),isVisible:e(Be).isVisible()}})),n=t.tasks,r=t.isLoading,o=t.isVisible;return(0,a.useEffect)((function(){o&&!r&&e(n)}),[o,e,JSON.stringify(n),r]),r},wn=function(){var e=(0,c.useDispatch)(Be).setPremiumItems,t=l((function(e){var t=e(Be).getId();return{premiumItems:e(p.store).getAllPremiumItemsRelatedToPost(t),isLoading:!e(p.store).hasFinishedResolution("getAllPremiumItemsRelatedToPost",[t])&&!e(p.store).hasResolutionFailed("getAllPremiumItemsRelatedToPost",[t]),isVisible:e(Be).isVisible()}})),n=t.premiumItems,r=t.isLoading,o=t.isVisible;return(0,a.useEffect)((function(){o&&!r&&(0,m.toPairs)(n).map((function(e){var t=e[0],n=e[1];return n?[t,n]:void 0})).filter(h.isDefined).forEach((function(t){var n=t[0],r=t[1];return e(n,r)}))}),[o,e,JSON.stringify(n),r]),r}},6942:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=s(e,i(n)))}return e}function i(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return o.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)r.call(e,n)&&e[n]&&(t=s(t,n));return t}function s(e,t){return t?e?e+" "+t:e+t:e}e.exports?(o.default=o,e.exports=o):void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var i=n[e]={exports:{}};return t[e](i,i.exports,r),i.exports}r.m=t,e=[],r.O=(t,n,o,i)=>{if(!n){var s=1/0;for(l=0;l<e.length;l++){n=e[l][0],o=e[l][1],i=e[l][2];for(var a=!0,u=0;u<n.length;u++)(!1&i||s>=i)&&Object.keys(r.O).every((e=>r.O[e](n[u])))?n.splice(u--,1):(a=!1,i<s&&(s=i));if(a){e.splice(l--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var l=e.length;l>0&&e[l-1][2]>i;l--)e[l]=e[l-1];e[l]=[n,o,i]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={9303:0,7760:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var o,i,s=n[0],a=n[1],u=n[2],c=0;if(s.some((t=>0!==e[t]))){for(o in a)r.o(a,o)&&(r.m[o]=a[o]);if(u)var l=u(r)}for(t&&t(n);c<s.length;c++)i=s[c],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(l)},n=self.webpackChunkNelioContent=self.webpackChunkNelioContent||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=r.O(void 0,[7760],(()=>r(6615)));o=r.O(o);var i=NelioContent="undefined"==typeof NelioContent?{}:NelioContent;for(var s in o)i[s]=o[s];o.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();