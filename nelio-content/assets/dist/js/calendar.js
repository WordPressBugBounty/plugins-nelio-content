(()=>{var e={n:t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},d:(t,s)=>{for(var n in s)e.o(s,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:s[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};(()=>{"use strict";e.r(t),e.d(t,{calendar:()=>a});var s={};e.r(s),e.d(s,{areAutomaticMessagesVisible:()=>he,areFailedMessagesVisible:()=>pe,areSocialMessagesCollapsedInDay:()=>fe,areTasksVisible:()=>le,areThereActiveExternalEventFilters:()=>te,areThereActiveFilters:()=>z,areThereActivePostFilters:()=>Z,areThereActiveSocialFilters:()=>J,areThereActiveTaskFilters:()=>ee,areThereUnscheduledPostsToLoad:()=>N,formatCalendarTime:()=>He,getActiveTabInFilterPane:()=>X,getAdminSidebarWidth:()=>tt,getCalendarMode:()=>Ye,getCalendarWidth:()=>et,getDisabledExternalCalendars:()=>ie,getDisabledInternalEventTypes:()=>ne,getDisabledPostTypes:()=>ae,getDisabledSocialProfilesByNetwork:()=>oe,getDisabledStatuses:()=>re,getDraggingItem:()=>Ce,getEditingExternalCalendarName:()=>$,getEditingExternalCalendarUrl:()=>F,getExternalCalendar:()=>G,getExternalCalendarEditorMode:()=>x,getExternalCalendars:()=>V,getFilters:()=>q,getFirstDay:()=>qe,getFocusDay:()=>Ke,getHoverItem:()=>Ne,getIcsLink:()=>We,getLastDay:()=>Xe,getLastLoadedPageInUnscheduled:()=>L,getLoaderTimeout:()=>Ae,getMinimumRowHeight:()=>Je,getNumberOfNonCollapsableMessages:()=>Ze,getNumberOfVisibleDays:()=>ze,getPostAuthorFilter:()=>ce,getPremiumFilter:()=>ye,getRecurringAction:()=>I,getSettings:()=>Ue,getSidePane:()=>Qe,getTaskAssigneeFilter:()=>ge,getTaskIdInTaskViewer:()=>_,getUnscheduledPostsSearchQuery:()=>j,getUnscheduledPostsSearchTimeout:()=>R,getVisibleTerms:()=>de,getVisibleTermsByTaxonomy:()=>ue,isAddingAnExternalCalendar:()=>H,isCalendarSynching:()=>ve,isDeletingAnExternalCalendar:()=>W,isDeletingExternalCalendar:()=>Q,isDragging:()=>we,isErrorPaneOpen:()=>Fe,isExportDialogOpen:()=>D,isFilterPaneOpen:()=>Ge,isHighlighted:()=>Le,isIcsEnabled:()=>Be,isItemVisible:()=>se,isLoadingUnscheduledPosts:()=>w,isManagingExternalCalendars:()=>U,isPeriodReady:()=>De,isReusableMessageViewOpen:()=>Ve,isSavingAnExternalCalendar:()=>B,isSynching:()=>_e,isTaskViewerDialogOpen:()=>P,isUnscheduledViewOpen:()=>xe,useEditorialCalendarOnly:()=>$e});var n={};e.r(n),e.d(n,{_setCalendarMode:()=>Ft,clearFilters:()=>Ot,closeExternalCalendarEditor:()=>ft,closeRecurringDialog:()=>rt,collapseSocialMessagesInDay:()=>Nt,dragEnd:()=>Ut,dragStart:()=>kt,initCalendarSettings:()=>Vt,loadPreviousFilters:()=>Ct,manageExternalCalendars:()=>lt,markAsDeleting:()=>mt,markAsSaving:()=>Et,markAsUpdated:()=>Yt,markAsUpdating:()=>Qt,markPeriodAsLoaded:()=>Wt,markPeriodAsLoading:()=>Bt,openExportDialog:()=>st,openExternalCalendarEditor:()=>yt,openTaskViewerDialog:()=>nt,receiveExternalCalendars:()=>bt,removeExternalCalendar:()=>gt,requestRecurringRescheduleMode:()=>it,requestRecurringTrashMode:()=>at,setActiveTabInFilterPane:()=>Tt,setCalendarDimensions:()=>Ht,setDisabledExternalCalendars:()=>vt,setDisabledInternalEventTypes:()=>St,setDisabledPostTypes:()=>Dt,setDisabledSocialProfilesInNetwork:()=>It,setDisabledStatuses:()=>_t,setEditingExternalCalendarName:()=>ht,setEditingExternalCalendarUrl:()=>pt,setFocusDay:()=>$t,setHoverItem:()=>xt,setIsLoadingUnscheduledPosts:()=>ct,setLoaderTimeout:()=>Kt,setPostAuthorFilter:()=>Pt,setPremiumFilter:()=>Mt,setTaskAssigneeFilter:()=>Rt,setUnscheduledPostsQuery:()=>dt,setUnscheduledPostsSearchTimeout:()=>ut,setVisibleTerms:()=>At,showAutomaticMessages:()=>wt,showFailedMessages:()=>Lt,toggleSidePane:()=>Gt,toggleTasksVisibility:()=>jt,updateUnscheduledPostsPagination:()=>ot});var i={};e.r(i),e.d(i,{addExternalCalendar:()=>As,deleteExternalCalendar:()=>_s,deleteSocialMessage:()=>gs,deleteTask:()=>is,loadItemsIn:()=>Ms,loadItemsNow:()=>Cs,loadUnscheduledPosts:()=>Jt,nextPeriod:()=>js,previousPeriod:()=>Rs,reschedulePost:()=>hs,rescheduleSocialMessage:()=>ls,rescheduleTask:()=>ns,saveExternalCalendar:()=>Ds,setCalendarMode:()=>Ns,showToday:()=>Ps,toggleTaskCompletion:()=>as,trashPost:()=>ms,unschedulePost:()=>Es});var a={};e.r(a),e.d(a,{store:()=>Gs,useCanCreateMessages:()=>un,useCanCreatePosts:()=>dn,useCanCreateTasks:()=>ln,useCollapsableItemCount:()=>sn,useDayCollapser:()=>tn,useDayType:()=>en,useDefaultTime:()=>Js,useDraggingItem:()=>zs,useFirstDay:()=>mn,useHoverItem:()=>Zs,useItem:()=>Xs,useItemDragTriggers:()=>rn,useItemDropper:()=>hn,useItemHoverListeners:()=>an,useMessageCreator:()=>yn,useMinRowHeight:()=>En,useNewPostLabel:()=>cn,useNonCollapsedDayItems:()=>nn,useNumberOfVisibleDays:()=>bn,usePostCreator:()=>gn,usePostStatus:()=>on,useSidePane:()=>Tn,useTaskCreator:()=>fn,useToday:()=>pn});const r=window.wp.data;function o(e,t){return(0,r.useSelect)(e,t)}function c(e){return(0,r.resolveSelect)(e)}const d={isExportDialogOpen:!1,recurringAction:void 0,taskIdInTaskViewer:void 0},u={unscheduledPosts:{byQueryPagination:{},defaultPagination:{lastPageLoaded:0,maxPages:1,isLoading:!1},query:"",searchTimeout:0}},l={lastPageLoaded:0,maxPages:1,isLoading:!1},g=window.lodash,y={isManaging:!1,byUrl:{},deleting:[],editor:void 0},f={activeTab:"post",areAllMessagesVisibleInDay:{},disabledInternalEventTypes:[],disabledExternalCalendars:[],disabledPostTypes:[],disabledPostTypeTerms:{},disabledPostAuthors:[],disabledSocialProfilesByNetwork:{},disabledStatuses:[],visibleTermsByTaxonomy:{},areTasksVisible:!0,taskAssignee:void 0,postAuthor:void 0,areFailedMessagesVisible:!0,areAutomaticMessagesVisible:!0,premium:{}},p={drag:void 0,hover:void 0},h={adminSidebarWidth:0,calendarMode:"two-weeks",calendarWidth:0,focusDay:"",icsLinks:void 0,minRowHeight:0,numberOfNonCollapsableMessages:0,sidePane:"unscheduled-posts",useEditorialCalendarOnly:!1,calendarTimeFormat:"H:ia",simplifyCalendarTime:!0},E=window.moment;var m=e.n(E);const b=window.NelioContent.date,T={loadedDays:{},loaderTimeout:0,updating:[]};function O(e,t){return(0,g.find)(e,{type:t.type,id:t.id})?e:[...e,t]}function S(e,t){const s=(0,g.find)(e,e=>e.type===t.type&&e.id===t.id);return s?(0,g.without)(e,s):e}function v(e,t,s){let n;const i=m()(t);do{n=(0,b.date)("Y-m-d",i),e=Object.assign(Object.assign({},e),{[n]:!0}),i.add(1,"day")}while(n<=s);return e}const A=(0,r.combineReducers)({dialogs:function(e=d,t){var s;return null!==(s=function(e,t){switch(t.type){case"OPEN_EXPORT_DIALOG":return Object.assign(Object.assign({},e),{isExportDialogOpen:t.isOpen});case"OPEN_TASK_VIEWER_DIALOG":return Object.assign(Object.assign({},e),{taskIdInTaskViewer:t.taskId});case"REQUEST_RECURRING_RESCHEDULE_MODE":return Object.assign(Object.assign({},e),{recurringAction:{type:"reschedule",props:t.props}});case"REQUEST_RECURRING_TRASH_MODE":return Object.assign(Object.assign({},e),{recurringAction:{type:"trash",props:t.props}});case"CLOSE_RECURRING_DIALOG":return Object.assign(Object.assign({},e),{recurringAction:void 0})}}(e,t))&&void 0!==s?s:e},entities:function(e=u,t){var s;return null!==(s=function(e,t){switch(t.type){case"SET_UNSCHEDULED_POSTS_QUERY":return Object.assign(Object.assign({},e),{unscheduledPosts:Object.assign(Object.assign({},e.unscheduledPosts),{query:t.query})});case"SET_UNSCHEDULED_POSTS_SEARCH_TIMEOUT":return Object.assign(Object.assign({},e),{unscheduledPosts:Object.assign(Object.assign({},e.unscheduledPosts),{searchTimeout:t.timeout})});case"UPDATE_UNSCHEDULED_POSTS_PAGINATION":return t.query?Object.assign(Object.assign({},e),{unscheduledPosts:Object.assign(Object.assign({},e.unscheduledPosts),{byQueryPagination:Object.assign(Object.assign({},e.unscheduledPosts.byQueryPagination),{[t.query]:Object.assign(Object.assign(Object.assign({},l),e.unscheduledPosts.byQueryPagination[t.query]),{lastPageLoaded:t.lastPageLoaded,maxPages:t.maxPages})})})}):Object.assign(Object.assign({},e),{unscheduledPosts:Object.assign(Object.assign({},e.unscheduledPosts),{defaultPagination:Object.assign(Object.assign({},e.unscheduledPosts.defaultPagination),{lastPageLoaded:t.lastPageLoaded,maxPages:t.maxPages})})});case"IS_LOADING_UNSCHEDULED_POSTS":return t.query?Object.assign(Object.assign({},e),{unscheduledPosts:Object.assign(Object.assign({},e.unscheduledPosts),{byQueryPagination:Object.assign(Object.assign({},e.unscheduledPosts.byQueryPagination),{[t.query]:Object.assign(Object.assign(Object.assign({},l),e.unscheduledPosts.byQueryPagination[t.query]),{isLoading:t.isLoading})})})}):Object.assign(Object.assign({},e),{unscheduledPosts:Object.assign(Object.assign({},e.unscheduledPosts),{defaultPagination:Object.assign(Object.assign({},e.unscheduledPosts.defaultPagination),{isLoading:t.isLoading})})})}}(e,t))&&void 0!==s?s:e},externalCalendars:function(e=y,t){var s;return null!==(s=function(e,t){switch(t.type){case"MANAGE_EXTERNAL_CALENDARS":return Object.assign(Object.assign({},e),{isManaging:t.isActive});case"RECEIVE_EXTERNAL_CALENDARS":return Object.assign(Object.assign({},e),{byUrl:Object.assign(Object.assign({},e.byUrl),(0,g.keyBy)(t.externalCalendars,"url"))});case"REMOVE_EXTERNAL_CALENDAR":return Object.assign(Object.assign({},e),{byUrl:(0,g.omit)(e.byUrl,t.url)});case"OPEN_EXTERNAL_EDITOR_CALENDAR":return Object.assign(Object.assign({},e),{editor:{isNew:!t.url,isSaving:!1,url:t.url,name:t.name}});case"CLOSE_EXTERNAL_CALENDAR_EDITOR":return Object.assign(Object.assign({},e),{editor:void 0});case"SET_EDITING_EXTERNAL_CALENDAR_URL":return e.editor&&e.editor.isNew?Object.assign(Object.assign({},e),{editor:Object.assign(Object.assign({},e.editor),{url:t.url})}):e;case"SET_EDITING_EXTERNAL_CALENDAR_NAME":return e.editor?Object.assign(Object.assign({},e),{editor:Object.assign(Object.assign({},e.editor),{name:t.name})}):e;case"MARK_AS_SAVING":return e.editor?Object.assign(Object.assign({},e),{editor:Object.assign(Object.assign({},e.editor),{isSaving:t.isSaving})}):e;case"MARK_AS_DELETING":return Object.assign(Object.assign({},e),{deleting:t.isDeleting?(0,g.uniq)([...e.deleting,t.url]):(0,g.without)(e.deleting,t.url)})}}(e,t))&&void 0!==s?s:e},filters:function(e=f,t){var s;return null!==(s=function(e,t){switch(t.type){case"CLEAR_FILTERS":return f;case"SET_ACTIVE_TAB_IN_FILTER_PANE":return Object.assign(Object.assign({},e),{activeTab:t.tabName});case"SET_VISIBLE_TERMS":return Object.assign(Object.assign({},e),{visibleTermsByTaxonomy:Object.assign(Object.assign({},e.visibleTermsByTaxonomy),{[t.taxonomy]:t.terms})});case"SET_DISABLED_STATUSES":return Object.assign(Object.assign({},e),{disabledStatuses:t.statuses});case"SET_DISABLED_INTERNAL_EVENT_TYPES":return Object.assign(Object.assign({},e),{disabledInternalEventTypes:t.internalEventTypes});case"SET_DISABLED_EXTERNAL_CALENDARS":return Object.assign(Object.assign({},e),{disabledExternalCalendars:t.externalCalendars});case"SET_DISABLED_POST_TYPES":return Object.assign(Object.assign({},e),{disabledPostTypes:t.postTypes});case"SET_POST_AUTHOR_FILTER":return Object.assign(Object.assign({},e),{postAuthor:t.authorId});case"SET_DISABLED_PROFILES_IN_NETWORK":return Object.assign(Object.assign({},e),{disabledSocialProfilesByNetwork:Object.assign(Object.assign({},e.disabledSocialProfilesByNetwork),{[t.network]:t.disabledProfiles})});case"TOGGLE_TASKS_VISIBILITY":return Object.assign(Object.assign({},e),{areTasksVisible:!e.areTasksVisible});case"SET_TASK_ASSIGNEE_FILTER":return Object.assign(Object.assign({},e),{taskAssignee:t.assigneeId});case"COLLAPSE_MESSAGES_IN_DAY":return Object.assign(Object.assign({},e),{areAllMessagesVisibleInDay:Object.assign(Object.assign({},e.areAllMessagesVisibleInDay),{[t.day]:!t.areMessagesCollapsed})});case"SHOW_FAILED_MESSAGES":return Object.assign(Object.assign({},e),{areFailedMessagesVisible:!!t.areFailedMessagesVisible});case"SHOW_AUTOMATIC_MESSAGES":return Object.assign(Object.assign({},e),{areAutomaticMessagesVisible:!!t.areAutomaticMessagesVisible});case"LOAD_PREVIOUS_FILTERS":return Object.assign(Object.assign({},e),t.filters);case"SET_PREMIUM_FILTER":return Object.assign(Object.assign({},e),{premium:Object.assign(Object.assign({},e.premium),{[t.filterName]:t.value})})}}(e,t))&&void 0!==s?s:e},interaction:function(e=p,t){var s;return null!==(s=function(e,t){switch(t.type){case"DRAG_START":return Object.assign(Object.assign({},e),{drag:t.item,hover:void 0});case"DRAG_END":return Object.assign(Object.assign({},e),{drag:void 0});case"HOVER_ITEM":return Object.assign(Object.assign({},e),{hover:t.item});case"HOVER_END":return Object.assign(Object.assign({},e),{hover:void 0})}}(e,t))&&void 0!==s?s:e},settings:function(e=h,t){var s;return null!==(s=function(e,t){switch(t.type){case"SET_CALENDAR_DIMENSIONS":return Object.assign(Object.assign({},e),{adminSidebarWidth:t.adminSidebarWidth,calendarWidth:t.calendarWidth,minRowHeight:t.minRowHeight});case"TOGGLE_SIDE_PANE":return Object.assign(Object.assign({},e),{sidePane:e.sidePane===t.pane?"none":t.pane});case"SET_CALENDAR_MODE":return Object.assign(Object.assign({},e),{calendarMode:t.mode||"two-weeks"});case"SET_FOCUS_DAY":return Object.assign(Object.assign({},e),{focusDay:t.focusDay});case"INIT_CALENDAR_SETTINGS":return Object.assign(Object.assign(Object.assign({},h),t.settings),{sidePane:t.settings.sidePane||"none"})}}(e,t))&&void 0!==s?s:e},status:function(e=T,t){var s;return null!==(s=function(e,t){switch(t.type){case"MARK_AS_UPDATING":return Object.assign(Object.assign({},e),{updating:O(e.updating,t.item)});case"MARK_AS_UPDATED":return Object.assign(Object.assign({},e),{updating:S(e.updating,t.item)});case"MARK_PERIOD_AS_LOADING":return Object.assign(Object.assign({},e),{updating:O(e.updating,t.period)});case"MARK_PERIOD_AS_LOADED":return Object.assign(Object.assign({},e),{loadedDays:v(e.loadedDays,t.period.firstDay,t.period.lastDay),updating:S(e.updating,t.period)});case"SET_LOADER_TIMEOUT":return Object.assign(Object.assign({},e),{loaderTimeout:t.timeout})}}(e,t))&&void 0!==s?s:e}});function D(e){return e.dialogs.isExportDialogOpen}function _(e){return e.dialogs.taskIdInTaskViewer||void 0}function I(e){return e.dialogs.recurringAction}function P(e){return!!e.dialogs.taskIdInTaskViewer}function j(e){return e.entities.unscheduledPosts.query||""}function R(e){return e.entities.unscheduledPosts.searchTimeout}function N(e,t){const s=M(e,"");if(s.lastPageLoaded>=s.maxPages)return!1;const n=M(e,t);return n.lastPageLoaded<n.maxPages}function L(e,t){return M(e,t).lastPageLoaded}function w(e,t){return!!N(e,"")&&M(e,t).isLoading}const C={lastPageLoaded:0,maxPages:1,isLoading:!1};function M(e,t){return(t=(0,g.trim)(t))?Object.assign(Object.assign({},C),e.entities.unscheduledPosts.byQueryPagination[t]):e.entities.unscheduledPosts.defaultPagination}const k=window.NelioContent.utils;function U(e){return e.externalCalendars.isManaging}function x(e){return e.externalCalendars.editor?e.externalCalendars.editor.isNew?"create":"edit":"none"}function V(e){return(0,g.values)(e.externalCalendars.byUrl)}function G(e,t){return e.externalCalendars.byUrl[t]}function F(e){var t;const{editor:s}=e.externalCalendars;return null!==(t=null==s?void 0:s.url)&&void 0!==t?t:""}function $(e){var t;const{editor:s}=e.externalCalendars;return null!==(t=null==s?void 0:s.name)&&void 0!==t?t:""}function H(e){const{editor:t}=e.externalCalendars;return!!(null==t?void 0:t.isNew)&&!!(null==t?void 0:t.isSaving)}function B(e){const{editor:t}=e.externalCalendars;return!!(null==t?void 0:t.isSaving)}function W(e){return!(0,k.isEmpty)(e.externalCalendars.deleting)}function Q(e,t){return e.externalCalendars.deleting.includes(t)}const Y=window.NelioContent.data,K=window.NelioContent.premiumHooksForPages;function q(e){return e.filters}function X(e){return e.filters.activeTab}function z(e){return Z(e)||J(e)||ee(e)||te(e)}function Z(e){return!((0,k.isEmpty)(ae(e))&&(0,k.isEmpty)(re(e))&&(0,k.isEmpty)(ce(e))&&(0,k.isEmpty)(de(e)))}function J(e){const t=oe(e),s=(0,g.flatten)((0,g.values)(t)),{getSocialProfile:n}=(0,r.select)(Y.store);return!(0,k.isEmpty)((0,g.filter)((0,g.map)(s,n)))}function ee(e){return!le(e)||!!ge(e)}function te(e){const t=(0,g.keys)(e.externalCalendars.byUrl);return!!ie(e).filter(e=>t.includes(e)).length}function se(e,t,s){switch(t){case"post":return me(s)&&Ee(e,s);case"social":return be(s)&&function(e,t){if("error"===t.status&&pe(e))return!0;if(t.auto&&!he(e))return!1;if(t.postId){const{getPost:s}=(0,r.select)(Y.store),n=s(t.postId);if(!n||!Ee(e,n))return!1}return!(oe(e)[t.network]||[]).includes(t.profileId)}(e,s);case"task":return Te(s)&&function(e,t){if(!le(e))return!1;const s=ge(e);if(s&&s!==t.assigneeId)return!1;if(t.postId){const{getPost:s}=(0,r.select)(Y.store),n=s(t.postId);if(!n||!Ee(e,n))return!1}return!0}(e,s);case"external-event":return Oe(s)&&function(e,t){return!ie(e).includes(t.calendar)}(e,s);case"internal-event":return Se(s)&&function(e,t){return!ne(e).includes(t.type)}(e,s);default:return(0,K.isPremiumItemVisible)(t,s)}}function ne(e){return e.filters.disabledInternalEventTypes}function ie(e){return e.filters.disabledExternalCalendars}function ae(e){return e.filters.disabledPostTypes}function re(e){return e.filters.disabledStatuses}function oe(e){return e.filters.disabledSocialProfilesByNetwork}function ce(e){return e.filters.postAuthor||void 0}function de(e){return(0,g.flatten)((0,g.filter)((0,g.values)(e.filters.visibleTermsByTaxonomy),e=>!!e))}function ue(e,t){return e.filters.visibleTermsByTaxonomy[t]||[]}function le(e){return e.filters.areTasksVisible}function ge(e){return e.filters.taskAssignee||void 0}function ye(e,t){if("_"!==t)return e.filters.premium[t]}function fe(e,t){return!e.filters.areAllMessagesVisibleInDay[t]}function pe(e){return e.filters.areFailedMessagesVisible}function he(e){return e.filters.areAutomaticMessagesVisible}function Ee(e,t){const s=ce(e);return(!s||s===t.author)&&(!ae(e).includes(t.type)&&(!re(e).includes(t.status)&&!(de(e).length&&!(0,g.keys)(e.filters.visibleTermsByTaxonomy).map(s=>{const n=ue(e,s);if(!n.length)return!0;const i=t.taxonomies[s]||[];return n.every(e=>i.some(t=>t.id===e.id))}).every(e=>e))))}const me=e=>"number"==typeof e.id,be=e=>!me(e)&&"network"in e,Te=e=>!me(e)&&"task"in e,Oe=e=>!me(e)&&"calendar"in e,Se=e=>!me(e);function ve(e){return!(0,k.isEmpty)(e.status.updating)}function Ae(e){return e.status.loaderTimeout||0}function De(e,t,s){let n;const i=m()(t);do{if(n=(0,b.date)("Y-m-d",i),!e.status.loadedDays[n])return!1;i.add(1,"day")}while(n<=s);return!0}function _e(e,t,s){if("post"===t)return!!(0,g.find)(e.status.updating,{relatedPost:s});if((0,g.find)(e.status.updating,{type:t,id:s}))return!0;const{getItem:n}=(0,r.select)(Y.store),i=n(t,s);return Ie(e,i)||je(e,i)}const Ie=(e,t)=>Pe(t)&&!!(0,g.find)(e.status.updating,{type:"post",id:t.postId}),Pe=e=>!!e&&"object"==typeof e&&!!e.postId,je=(e,t)=>Re(t)&&!!(0,g.find)(e.status.updating,{type:"social",recurrenceGroup:t.recurrenceGroup}),Re=e=>!!e&&"object"==typeof e&&!!e.recurrenceGroup;function Ne(e){return e.interaction.hover}function Le(e,t,s){const{hover:n}=e.interaction;if(!n)return!1;if("external-event"===n.type)return!1;if("internal-event"===n.type)return!1;if(_e(e,t,s))return!1;if(n.type===t&&n.id===s)return!0;const{getItem:i}=(0,r.select)(Y.store),a=i(t,s);return!!a&&("post"===t?n.relatedPostId===a.id:!(!Me(a)||a.postId!==n.relatedPostId)||!(!ke(a)||!ke(n)||a.recurrenceGroup!==n.recurrenceGroup))}function we(e,t,s){return!!e.interaction.drag&&e.interaction.drag.type===t&&e.interaction.drag.id===s}function Ce(e){return e.interaction.drag}const Me=e=>!!e&&"object"==typeof e&&!!e.postId,ke=e=>!!e&&"object"==typeof e&&!!e.recurrenceGroup;function Ue(e){return e.settings}function xe(e){return"unscheduled-posts"===e.settings.sidePane}function Ve(e){return"reusable-messages"===e.settings.sidePane}function Ge(e){return"filters"===e.settings.sidePane}function Fe(e){return"errors"===e.settings.sidePane}function $e(e){return e.settings.useEditorialCalendarOnly}function He(e,t){const s=(0,b.dateI18n)(e.settings.calendarTimeFormat,t);return e.settings.simplifyCalendarTime?s.replace(":00","").replace(/m$/i,"").replace(/\s/g,""):s}function Be(e){return!!e.settings.icsLinks}function We(e,t){var s;return null===(s=e.settings.icsLinks)||void 0===s?void 0:s[t]}function Qe(e){return e.settings.sidePane}function Ye(e){return e.settings.calendarMode}function Ke(e){return e.settings.focusDay}function qe(e,t){const s=Ke(e),n=Ye(e);if("agenda"===n)return s;const i=m()((0,b.wpifyDateTime)("c",s,"12:00"));return"month"===n&&i.date(1),i.day()===t?(0,b.date)("Y-m-d",i):(0,b.date)("Y-m-d",i.isoWeekday(t))}function Xe(e,t){const s=qe(e,t);if(!s)return"";const n=ze(e);return(0,b.date)("Y-m-d",m()(s).add(n,"days"))}function ze(e){switch(Ye(e)){case"agenda":return 4;case"week":return 7;case"month":return 42;default:return 14}}function Ze(e){return e.settings.numberOfNonCollapsableMessages}function Je(e){return e.settings.minRowHeight}function et(e){return e.settings.calendarWidth}function tt(e){return e.settings.adminSidebarWidth}function st(e=!0){return{type:"OPEN_EXPORT_DIALOG",isOpen:e}}function nt(e){return{type:"OPEN_TASK_VIEWER_DIALOG",taskId:e}}function it(e){return{type:"REQUEST_RECURRING_RESCHEDULE_MODE",props:e}}function at(e){return{type:"REQUEST_RECURRING_TRASH_MODE",props:e}}function rt(){return{type:"CLOSE_RECURRING_DIALOG"}}function ot(e,t,s){return{type:"UPDATE_UNSCHEDULED_POSTS_PAGINATION",query:e,lastPageLoaded:t,maxPages:s}}function ct(e,t){return{type:"IS_LOADING_UNSCHEDULED_POSTS",query:e,isLoading:t}}function dt(e){return{type:"SET_UNSCHEDULED_POSTS_QUERY",query:e}}function ut(e){return{type:"SET_UNSCHEDULED_POSTS_SEARCH_TIMEOUT",timeout:e}}function lt(e){return{type:"MANAGE_EXTERNAL_CALENDARS",isActive:e}}function gt(e){return{type:"REMOVE_EXTERNAL_CALENDAR",url:e}}function yt(e){var t,s;return{type:"OPEN_EXTERNAL_EDITOR_CALENDAR",url:null!==(t=null==e?void 0:e.url)&&void 0!==t?t:"",name:null!==(s=null==e?void 0:e.name)&&void 0!==s?s:""}}function ft(){return{type:"CLOSE_EXTERNAL_CALENDAR_EDITOR"}}function pt(e){return{type:"SET_EDITING_EXTERNAL_CALENDAR_URL",url:e}}function ht(e){return{type:"SET_EDITING_EXTERNAL_CALENDAR_NAME",name:e}}function Et(e){return{type:"MARK_AS_SAVING",isSaving:e}}function mt(e,t){return{type:"MARK_AS_DELETING",url:e,isDeleting:t}}function bt(e){return{type:"RECEIVE_EXTERNAL_CALENDARS",externalCalendars:(0,g.castArray)(e)}}function Tt(e){return{type:"SET_ACTIVE_TAB_IN_FILTER_PANE",tabName:e}}function Ot(){return{type:"CLEAR_FILTERS"}}function St(e){return{type:"SET_DISABLED_INTERNAL_EVENT_TYPES",internalEventTypes:e}}function vt(e){return{type:"SET_DISABLED_EXTERNAL_CALENDARS",externalCalendars:e}}function At(e,t){return{type:"SET_VISIBLE_TERMS",taxonomy:e,terms:t}}function Dt(e){return{type:"SET_DISABLED_POST_TYPES",postTypes:e}}function _t(e){return{type:"SET_DISABLED_STATUSES",statuses:e}}function It(e,t){return{type:"SET_DISABLED_PROFILES_IN_NETWORK",network:e,disabledProfiles:t}}function Pt(e){return{type:"SET_POST_AUTHOR_FILTER",authorId:e}}function jt(){return{type:"TOGGLE_TASKS_VISIBILITY"}}function Rt(e){return{type:"SET_TASK_ASSIGNEE_FILTER",assigneeId:e}}function Nt(e,t){return{type:"COLLAPSE_MESSAGES_IN_DAY",day:t,areMessagesCollapsed:e}}function Lt(e){return{type:"SHOW_FAILED_MESSAGES",areFailedMessagesVisible:e}}function wt(e){return{type:"SHOW_AUTOMATIC_MESSAGES",areAutomaticMessagesVisible:e}}function Ct(e){if("object"==typeof e)return{type:"LOAD_PREVIOUS_FILTERS",filters:e}}function Mt(e,t){return{type:"SET_PREMIUM_FILTER",filterName:e,value:t}}function kt(e){return{type:"DRAG_START",item:e}}function Ut(){return{type:"DRAG_END"}}function xt(e){return e?{type:"HOVER_ITEM",item:e}:{type:"HOVER_END"}}function Vt(e){return{type:"INIT_CALENDAR_SETTINGS",settings:e}}function Gt(e){return{type:"TOGGLE_SIDE_PANE",pane:e}}function Ft(e){return{type:"SET_CALENDAR_MODE",mode:e}}function $t(e){return{type:"SET_FOCUS_DAY",focusDay:e}}function Ht({adminSidebarWidth:e,calendarWidth:t,minRowHeight:s}){return{type:"SET_CALENDAR_DIMENSIONS",adminSidebarWidth:e,calendarWidth:t,minRowHeight:s}}function Bt(e,t){return{type:"MARK_PERIOD_AS_LOADING",period:{type:"period",id:`${e}::${t}`,firstDay:e,lastDay:t}}}function Wt(e,t){return{type:"MARK_PERIOD_AS_LOADED",period:{type:"period",id:`${e}::${t}`,firstDay:e,lastDay:t}}}function Qt(e){return{type:"MARK_AS_UPDATING",item:e}}function Yt(e){return{type:"MARK_AS_UPDATED",item:e}}function Kt(e){return{type:"SET_LOADER_TIMEOUT",timeout:e}}const qt=window.wp.apiFetch,Xt=e.n(qt)(),zt=window.wp.url;var Zt=function(e,t,s,n){return new(s||(s=Promise))(function(i,a){function r(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(r,o)}c((n=n.apply(e,t||[])).next())})};function Jt(){return Zt(this,arguments,void 0,function*(e=""){if(e=(0,g.trim)(e),yield(0,r.dispatch)(Gs).setUnscheduledPostsSearchTimeout(0),(0,r.select)(Gs).areThereUnscheduledPostsToLoad(e)&&!(0,r.select)(Gs).isLoadingUnscheduledPosts(e))try{yield(0,r.dispatch)(Gs).setIsLoadingUnscheduledPosts(e,!0);const t=(0,r.select)(Gs).getLastLoadedPageInUnscheduled(e),s=(0,g.map)((0,r.select)(Y.store).getPostTypes("calendar"),"name"),n=yield Xt({path:(0,zt.addQueryArgs)("/nelio-content/v1/post/search",{page:t+1,per_page:15,query:e,status:"nc_unscheduled",type:s.join(",")}),method:"GET"}),i=n.results;yield(0,r.dispatch)(Y.store).receivePosts(i),yield(0,r.dispatch)(Gs).updateUnscheduledPostsPagination(e,t+1,n.pagination.pages),yield(0,r.dispatch)(Gs).setIsLoadingUnscheduledPosts(e,!1)}catch(e){yield(0,k.showErrorNotice)(e)}})}function es(e,t){var s;const{utcDate:n,dateType:i,dateValue:a}=ts({dateType:t.dateType,dateValue:t.dateValue,newLocalDay:e,utcDate:null!==(s=t.schedule)&&void 0!==s?s:""});return Object.assign(Object.assign({},t),{dateType:i,dateValue:a,schedule:n})}function ts(e){const{utcDate:t,dateType:s,dateValue:n,newLocalDay:i}=e;if("exact"===s){const e=(0,b.date)("H:i",t);return{utcDate:(0,b.wpifyDateTime)("c",i,e),dateType:s,dateValue:i}}const a=(0,b.date)("Y-m-d",t),r=m()(`${a}T12:00:00.000Z`),o=m()(`${i}T12:00:00.000Z`).diff(r,"days"),c=("negative-days"===s?-Number.parseInt(n):Number.parseInt(n))+o;return c<0?{utcDate:m()(t).add(o,"days").toISOString(),dateType:"negative-days",dateValue:`${Math.abs(c)}`}:{utcDate:m()(t).add(o,"days").toISOString(),dateType:"positive-days",dateValue:`${c}`}}var ss=function(e,t,s,n){return new(s||(s=Promise))(function(i,a){function r(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(r,o)}c((n=n.apply(e,t||[])).next())})};function ns(e,t){return ss(this,void 0,void 0,function*(){const s=(0,r.select)(Y.store).getTask(e);if(s&&(0,b.date)("Y-m-d",s.dateDue)!==t)try{const n=function(e,t){const{utcDate:s,dateType:n,dateValue:i}=ts({dateType:t.dateType,dateValue:t.dateValue,newLocalDay:e,utcDate:t.dateDue});return Object.assign(Object.assign({},t),{dateType:n,dateValue:i,dateDue:s})}(t,s);yield rs(n);const i=(0,r.select)(Y.store).getSiteId(),a=(0,r.select)(Y.store).getApiRoot(),o=(0,r.select)(Y.store).getAuthenticationToken(),c=yield Xt({url:`${a}/site/${i}/task/${e}`,method:"PUT",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${o}`},data:Object.assign(Object.assign({},n),{baseDatetime:"reschedule"})});yield os(c)}catch(e){yield cs(s,e)}})}function is(e){return ss(this,void 0,void 0,function*(){const t=(0,r.select)(Y.store).getTask(e);if(t)try{yield function(e){return ss(this,void 0,void 0,function*(){yield(0,r.dispatch)(Gs).markAsUpdating(ds(e)),yield(0,r.dispatch)(Y.store).removeTask(e.id)})}(t);const s=(0,r.select)(Y.store).getSiteId(),n=(0,r.select)(Y.store).getApiRoot(),i=(0,r.select)(Y.store).getAuthenticationToken();yield Xt({url:`${n}/site/${s}/task/${e}`,method:"DELETE",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${i}`}}),yield function(e){return ss(this,void 0,void 0,function*(){yield(0,r.dispatch)(Gs).markAsUpdated(ds(e))})}(t)}catch(e){yield cs(t,e)}})}function as(e){return ss(this,void 0,void 0,function*(){const t=(0,r.select)(Y.store).getTask(e);if(t)try{const s=Object.assign(Object.assign({},t),{completed:!t.completed});yield rs(s);const n=(0,r.select)(Y.store).getSiteId(),i=(0,r.select)(Y.store).getApiRoot(),a=(0,r.select)(Y.store).getAuthenticationToken(),o=yield Xt({url:`${i}/site/${n}/task/${e}`,method:"PUT",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${a}`},data:s});if(o.completed)try{yield Xt({path:"/nelio-content/v1/notifications/task",method:"POST",data:Object.assign({isNewTask:!1},o)})}catch(e){yield(0,k.showErrorNotice)(e)}yield os(Object.assign(Object.assign({},t),o))}catch(e){yield cs(t,e)}})}function rs(e){return ss(this,void 0,void 0,function*(){yield(0,r.dispatch)(Gs).markAsUpdating(ds(e)),yield(0,r.dispatch)(Y.store).receiveTasks(e)})}function os(e){return ss(this,void 0,void 0,function*(){yield(0,r.dispatch)(Y.store).receiveTasks(e),yield(0,r.dispatch)(Gs).markAsUpdated(ds(e))})}function cs(e,t){return ss(this,void 0,void 0,function*(){yield(0,r.dispatch)(Y.store).receiveTasks(e),yield(0,r.dispatch)(Gs).markAsUpdated(ds(e)),yield(0,k.showErrorNotice)(t)})}function ds(e){return{type:"task",id:e.id,relatedPostId:e.postId}}var us=function(e,t,s,n){return new(s||(s=Promise))(function(i,a){function r(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(r,o)}c((n=n.apply(e,t||[])).next())})};function ls(e,t,s,n){return us(this,void 0,void 0,function*(){var i;const a=(0,r.select)(Y.store).getSocialMessage(e);if(!a)return;const{dateValue:o,timeValue:c}=null!==(i=(0,k.extractDateTimeValues)(a.schedule))&&void 0!==i?i:{};if(o===t&&(!s||c===s))return;const d=s?function(e,t,s){var n;const{dateValue:i}=null!==(n=(0,k.extractDateTimeValues)(s.schedule))&&void 0!==n?n:{};return es(e,s=Object.assign(Object.assign({},s),{timeType:"exact",timeValue:t,schedule:(0,b.wpifyDateTime)("c",null!=i?i:"",t)}))}(t,s,a):es(t,a),u=Object.assign(Object.assign({},d),{recurrenceSettings:n?void 0:d.recurrenceSettings});if("negative-days"!==u.dateType)try{yield function(e){return us(this,void 0,void 0,function*(){yield(0,r.dispatch)(Gs).markAsUpdating(fs(e)),yield(0,r.dispatch)(Y.store).receiveSocialMessages(e)})}(u);const t=(0,r.select)(Y.store).getSiteId(),s=(0,r.select)(Y.store).getApiRoot(),n=(0,r.select)(Y.store).getAuthenticationToken(),i=yield Xt({url:`${s}/site/${t}/social/${e}`,method:"PUT",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${n}`},data:Object.assign(Object.assign({},u),{baseDatetime:"reschedule"})});yield function(e,t){return us(this,void 0,void 0,function*(){yield(0,r.dispatch)(Y.store).removeRecurringMessages(e.recurrenceGroup),yield(0,r.dispatch)(Y.store).receiveSocialMessages(t),(0,g.castArray)(t).map(fs).filter(({type:e,id:t})=>(0,r.select)(Gs).isSynching(e,t)).forEach((0,r.dispatch)(Gs).markAsUpdated)})}(a,i)}catch(e){yield ys(a,e)}})}function gs(e,t){return us(this,void 0,void 0,function*(){const s=(0,r.select)(Y.store).getSocialMessage(e);if(s)try{yield function(e){return us(this,void 0,void 0,function*(){yield(0,r.dispatch)(Gs).markAsUpdating(fs(e)),yield(0,r.dispatch)(Y.store).removeSocialMessage(e.id)})}(s);const n=(0,r.select)(Y.store).getSiteId(),i=(0,r.select)(Y.store).getApiRoot(),a=(0,r.select)(Y.store).getAuthenticationToken(),o=yield Xt({url:`${i}/site/${n}/social/${e}${t?"/following":""}`,method:"DELETE",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${a}`}});yield function(e,t){return us(this,void 0,void 0,function*(){yield(0,r.dispatch)(Y.store).removeSocialMessage(e.id),yield(0,r.dispatch)(Y.store).removeRecurringMessages(e.recurrenceGroup),yield(0,r.dispatch)(Y.store).receiveSocialMessages(t),yield(0,r.dispatch)(Gs).markAsUpdated(fs(e))})}(s,o)}catch(e){yield ys(s,e)}})}function ys(e,t){return us(this,void 0,void 0,function*(){yield(0,r.dispatch)(Y.store).receiveSocialMessages(e),yield(0,r.dispatch)(Gs).markAsUpdated(fs(e)),yield(0,k.showErrorNotice)(t)})}function fs(e){return{type:"social",id:e.id,relatedPostId:e.postId,recurrenceGroup:e.recurrenceGroup}}var ps=function(e,t,s,n){return new(s||(s=Promise))(function(i,a){function r(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(r,o)}c((n=n.apply(e,t||[])).next())})};function hs(e,t,s){return ps(this,void 0,void 0,function*(){const n=yield c(Y.store).getPost(e);if(!n)return;const i=(0,r.select)(Y.store).getDefaultTime("post"),a=function(e,t,s){return Object.assign(Object.assign({},s),{date:(0,b.wpifyDateTime)("c",e,t)})}(t,s||i,n);if(a.date!==n.date)try{yield bs(a);const n=yield Xt({path:(0,zt.addQueryArgs)(`/nelio-content/v1/post/${e}/reschedule`,{day:t,hour:s,defaultHour:i}),method:"PUT"});yield(0,r.dispatch)(Y.store).reloadPostRelatedItems(n.id),yield Ts(n)}catch(e){yield Os(n,e)}})}function Es(e){return ps(this,void 0,void 0,function*(){const t=yield c(Y.store).getPost(e);if(t)try{yield bs(Object.assign(Object.assign({},t),{status:"future"===t.status?"draft":t.status,date:!1}));const s=yield Xt({path:`/nelio-content/v1/post/${e}/unschedule`,method:"PUT"});yield(0,r.dispatch)(Y.store).reloadPostRelatedItems(s.id),yield Ts(s)}catch(e){yield Os(t,e)}})}function ms(e){return ps(this,void 0,void 0,function*(){const t=yield c(Y.store).getPost(e);if(t)try{yield function(e){return ps(this,void 0,void 0,function*(){yield(0,r.dispatch)(Gs).markAsUpdating(Ss(e)),yield(0,r.dispatch)(Y.store).removePost(e.id)})}(t),yield Xt({path:`/nelio-content/v1/post/${e}/trash`,method:"PUT"}),yield(0,r.dispatch)(Y.store).reloadPostRelatedItems(t.id),yield function(e){return ps(this,void 0,void 0,function*(){yield(0,r.dispatch)(Gs).markAsUpdated(Ss(e))})}(t)}catch(e){yield Os(t,e)}})}function bs(e){return ps(this,void 0,void 0,function*(){yield(0,r.dispatch)(Gs).markAsUpdating(Ss(e)),yield(0,r.dispatch)(Y.store).receivePosts(e)})}function Ts(e){return ps(this,void 0,void 0,function*(){yield(0,r.dispatch)(Y.store).receivePosts(e),yield(0,r.dispatch)(Gs).markAsUpdated(Ss(e))})}function Os(e,t){return ps(this,void 0,void 0,function*(){yield(0,r.dispatch)(Gs).markAsUpdated(Ss(e)),yield(0,r.dispatch)(Y.store).receivePosts(e),yield(0,k.showErrorNotice)(t)})}function Ss(e){return{type:"post",id:e.id,relatedPostId:e.id}}var vs=function(e,t,s,n){return new(s||(s=Promise))(function(i,a){function r(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(r,o)}c((n=n.apply(e,t||[])).next())})};function As(e){return vs(this,void 0,void 0,function*(){yield(0,r.dispatch)(Gs).markAsSaving(!0);try{const t=yield Xt({path:"/nelio-content/v1/external-calendars/",method:"POST",data:{url:e}});yield(0,r.dispatch)(Gs).receiveExternalCalendars(t),yield c(Y.store).getExternalEvents(t.url),yield(0,r.dispatch)(Gs).closeExternalCalendarEditor()}catch(e){yield(0,k.showErrorNotice)(e)}yield(0,r.dispatch)(Gs).markAsSaving(!1)})}function Ds(e){return vs(this,arguments,void 0,function*({url:e,name:t}){yield(0,r.dispatch)(Gs).markAsSaving(!0);try{const s=yield Xt({path:"/nelio-content/v1/external-calendars/",method:"PUT",data:{url:e,name:t}});yield(0,r.dispatch)(Gs).receiveExternalCalendars(s)}catch(e){yield(0,k.showErrorNotice)(e)}yield(0,r.dispatch)(Gs).closeExternalCalendarEditor(),yield(0,r.dispatch)(Gs).markAsSaving(!1)})}function _s(e){return vs(this,void 0,void 0,function*(){yield(0,r.dispatch)(Gs).markAsDeleting(e,!0);try{yield Xt({path:(0,zt.addQueryArgs)("/nelio-content/v1/external-calendars/",{url:e}),method:"DELETE"}),yield(0,r.dispatch)(Gs).removeExternalCalendar(e);const t=yield c(Y.store).getExternalEvents(e);yield(0,r.dispatch)(Y.store).invalidateResolution("getExternalEvents",[e]),yield(0,r.dispatch)(Y.store).removeExternalEvents(t.map(e=>e.id))}catch(e){yield(0,k.showErrorNotice)(e)}yield(0,r.dispatch)(Gs).markAsDeleting(e,!1)})}var Is=function(e,t,s,n){return new(s||(s=Promise))(function(i,a){function r(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(r,o)}c((n=n.apply(e,t||[])).next())})};function Ps(){return Is(this,arguments,void 0,function*(e=500){const t=(0,r.select)(Y.store).getToday();yield(0,r.dispatch)(Gs).setFocusDay(t);try{yield(0,r.dispatch)(Gs).loadItemsIn(e)}catch(e){yield(0,k.showErrorNotice)(e)}})}function js(){return Is(this,arguments,void 0,function*(e=500){const t=(0,r.select)(Gs).getCalendarMode(),s=(0,r.select)(Gs).getFocusDay(),n=m()((0,b.wpifyDateTime)("c",s,"12:00")).clone();if("month"===t)n.date(1).add(1,"month");else{const e=(0,r.select)(Gs).getNumberOfVisibleDays();n.add(e,"days")}yield(0,r.dispatch)(Gs).setFocusDay((0,b.date)("Y-m-d",n));try{yield(0,r.dispatch)(Gs).loadItemsIn(e)}catch(e){yield(0,k.showErrorNotice)(e)}})}function Rs(){return Is(this,arguments,void 0,function*(e=500){const t=(0,r.select)(Gs).getCalendarMode(),s=(0,r.select)(Gs).getFocusDay(),n=m()((0,b.wpifyDateTime)("c",s,"12:00")).clone();if("month"===t)n.date(1).subtract(1,"month");else{const e=(0,r.select)(Gs).getNumberOfVisibleDays();n.subtract(e,"days")}yield(0,r.dispatch)(Gs).setFocusDay((0,b.date)("Y-m-d",n));try{yield(0,r.dispatch)(Gs).loadItemsIn(e)}catch(e){yield(0,k.showErrorNotice)(e)}})}function Ns(e){return Is(this,arguments,void 0,function*(e,t=500){yield(0,r.dispatch)(Gs)._setCalendarMode(e);try{yield(0,r.dispatch)(Gs).loadItemsIn(t)}catch(e){yield(0,k.showErrorNotice)(e)}})}const Ls=window.wp.hooks;var ws=function(e,t,s,n){return new(s||(s=Promise))(function(i,a){function r(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(r,o)}c((n=n.apply(e,t||[])).next())})};function Cs(){return ws(this,void 0,void 0,function*(){try{yield Ms(0)}catch(e){yield(0,k.showErrorNotice)(e)}})}function Ms(e){return ws(this,void 0,void 0,function*(){const t=(0,r.select)(Gs).getLoaderTimeout();if(t&&clearTimeout(t),!e){try{yield function(){return ws(this,void 0,void 0,function*(){yield(0,r.dispatch)(Gs).setLoaderTimeout(0);const e=(0,r.select)(Y.store).getFirstDayOfWeek(),t=(0,r.select)(Gs).getFirstDay(e),s=(0,r.select)(Gs).getLastDay(e);if(yield(0,r.dispatch)(Gs).markPeriodAsLoading(t,s),(0,r.select)(Gs).isPeriodReady(t,s))return void(yield(0,r.dispatch)(Gs).markPeriodAsLoaded(t,s));const n=(0,b.date)("Y-m-d",m()(t).add(-2,"days")),i=(0,b.date)("Y-m-d",m()(s).add(2,"days"));try{yield Promise.all([ks(n,i),xs(n,i),Vs(n,i),Us(n,i)]),yield(0,r.dispatch)(Gs).markPeriodAsLoaded(t,s)}catch(e){throw yield(0,r.dispatch)(Gs).markPeriodAsLoaded(t,s),e}})}()}catch(e){yield(0,k.showErrorNotice)(e)}return}const s=setTimeout(()=>{(0,r.dispatch)(Gs).loadItemsNow()},e);yield(0,r.dispatch)(Gs).setLoaderTimeout(s)})}function ks(e,t){return ws(this,void 0,void 0,function*(){try{const s=(0,r.select)(Y.store).getPostTypes("calendar").map(e=>e.name),n=yield Xt({path:(0,zt.addQueryArgs)("/nelio-content/v1/calendar/posts",{from:e,to:t,type:s.join(",")}),method:"GET"});yield(0,r.dispatch)(Y.store).receivePosts(n)}catch(e){throw e}})}function Us(e,t){return ws(this,void 0,void 0,function*(){try{yield Promise.all((0,Ls.applyFilters)("nelio-content_data_loadPremiumItemsInPeriod",[new Promise(e=>e())],e,t))}catch(e){throw e}})}function xs(e,t,s){return ws(this,void 0,void 0,function*(){try{const n=(0,r.select)(Y.store).getSiteId(),i=(0,r.select)(Y.store).getApiRoot(),a=(0,r.select)(Y.store).getAuthenticationToken(),o=yield Xt({url:(0,zt.addQueryArgs)(`${i}/site/${n}/calendar/messages`,{from:e,to:t,page:s}),method:"GET",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${a}`}});if((0,k.isEmpty)(o.messages))return;yield(0,r.dispatch)(Y.store).receiveSocialMessages(o.messages),yield(0,r.dispatch)(Y.store).markSocialPublicationAsPaused(o.isMessagePublicationPaused),o.page&&(yield xs(e,t,o.page))}catch(e){throw e}})}function Vs(e,t,s){return ws(this,void 0,void 0,function*(){try{const n=(0,r.select)(Y.store).getSiteId(),i=(0,r.select)(Y.store).getApiRoot(),a=(0,r.select)(Y.store).getAuthenticationToken(),o=yield Xt({url:(0,zt.addQueryArgs)(`${i}/site/${n}/calendar/tasks`,{from:e,to:t,page:s}),method:"GET",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${a}`}});if((0,k.isEmpty)(o.tasks))return;yield(0,r.dispatch)(Y.store).receiveTasks(o.tasks),o.page&&(yield Vs(e,t,o.page))}catch(e){throw e}})}const Gs=(0,r.createReduxStore)("nelio-content/calendar",{reducer:A,controls:r.controls,actions:Object.assign(Object.assign({},n),i),selectors:s});!function(e){(0,r.register)(e)}(Gs);const Fs=window.wp.i18n,$s={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let Hs;const Bs=new Uint8Array(16),Ws=[];for(let e=0;e<256;++e)Ws.push((e+256).toString(16).slice(1));const Qs=function(e,t,s){if($s.randomUUID&&!t&&!e)return $s.randomUUID();const n=(e=e||{}).random??e.rng?.()??function(){if(!Hs){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Hs=crypto.getRandomValues.bind(crypto)}return Hs(Bs)}();if(n.length<16)throw new Error("Random bytes length must be >= 16");if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){if((s=s||0)<0||s+16>t.length)throw new RangeError(`UUID byte range ${s}:${s+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[s+e]=n[e];return t}return function(e,t=0){return(Ws[e[t+0]]+Ws[e[t+1]]+Ws[e[t+2]]+Ws[e[t+3]]+"-"+Ws[e[t+4]]+Ws[e[t+5]]+"-"+Ws[e[t+6]]+Ws[e[t+7]]+"-"+Ws[e[t+8]]+Ws[e[t+9]]+"-"+Ws[e[t+10]]+Ws[e[t+11]]+Ws[e[t+12]]+Ws[e[t+13]]+Ws[e[t+14]]+Ws[e[t+15]]).toLowerCase()}(n)},Ys=window.NelioContent.postQuickEditor,Ks=window.NelioContent.socialMessageEditor,qs=window.NelioContent.taskEditor;const Xs=(e,t)=>o(s=>{switch(e){case"post":return s(Y.store).getPost(t);case"social":return s(Y.store).getSocialMessage(t);case"task":return s(Y.store).getTask(t);case"external-event":case"internal-event":return;default:return s(Y.store).getPremiumItem(e,t)}}),zs=()=>o(e=>e(Gs).getDraggingItem()),Zs=()=>o(e=>e(Gs).getHoverItem()),Js=e=>o(t=>t(Y.store).getDefaultTime(e)),en=e=>o(t=>{const s=t(Y.store).getToday();return e<s?"past-day":e===s?"today":"future-day"}),tn=e=>{const t=o(t=>t(Gs).areSocialMessagesCollapsedInDay(e)),{collapseSocialMessagesInDay:s}=(0,r.useDispatch)(Gs);return[t,t=>s(t,e)]},sn=e=>{const t=vn(e);return o(e=>{const{getNumberOfNonCollapsableMessages:s}=e(Gs),n=(0,g.filter)(t,{type:"social"}),i=s();return Math.max(0,n.length-i)})},nn=e=>{const t=vn(e),s=en(e),n=sn(e);return o(i=>{const{areSocialMessagesCollapsedInDay:a}=i(Gs);if(!a(e))return t;const r=(0,g.filter)(t,An),o=r.length-n;if(!n)return t;const{getSocialMessage:c}=i(Y.store),d=(0,g.filter)(r,({id:e})=>{var t;return"past-day"!==s||!!(null===(t=c(e))||void 0===t?void 0:t.sent)}),u=(0,g.map)((0,g.drop)(d,o),"id");return(0,g.filter)(t,({id:e,type:t})=>"social"!==t||!u.includes(e))})},an=(e,t)=>{const s=Xs(e,t);if(!s)return On;if("post"===e&&!Dn(s))return On;const n=(0,k.isFreeItemType)(e)?(0,k.createItemSummary)(e,s):(0,k.createPremiumItemSummary)(e,s);return n?{onMouseEnter:()=>Sn(n),onMouseLeave:()=>Sn()}:On},rn=e=>{const{dragEnd:t,dragStart:s}=(0,r.useDispatch)(Gs);return e?{onDragStart:()=>{s(e)},onDragEnd:()=>{t()}}:In},on=(e,t)=>o(s=>{if(s(Y.store),!e||!t)return;const n=s(Y.store).getPostStatuses(e);return(0,g.find)(n,{slug:t})}),cn=()=>o(e=>{const t=(0,Fs._x)("Add New Post","command","nelio-content"),{getPostTypes:s}=e(Y.store),n=s("calendar");return 1===n.length&&n[0]&&n[0].labels.new||t}),dn=()=>o(e=>e(Y.store).canCurrentUserCreatePosts()),un=()=>o(e=>e(Y.store).canCurrentUserCreateMessagesAlways()),ln=()=>o(e=>e(Y.store).canCurrentUserCreateTasksAlways()),gn=(e,t)=>{const{openNewPostEditor:s}=(0,r.useDispatch)(Ys.store);return()=>s("calendar",{dateValue:e,timeValue:t})},yn=(e,t)=>{const s=e===pn(),n=un(),i=(0,Y.useFeatureGuard)("calendar/create-messages",n),{openNewSocialMessageEditor:a}=(0,r.useDispatch)(Ks.store);return i(()=>a({dateType:s?"predefined-offset":"exact",dateValue:s?"0":e,timeType:s?"predefined-offset":"exact",timeValue:s?"0":t},{context:"calendar"}))},fn=e=>{const t=ln(),s=(0,Y.useFeatureGuard)("calendar/create-tasks",t),{openNewTaskEditor:n}=(0,r.useDispatch)(qs.store);return s(()=>n({dateType:"exact",dateValue:e},{post:void 0,context:"calendar"}))},pn=()=>o(e=>e(Y.store).getToday()),hn=(e,t)=>{const{dragEnd:s,reschedulePost:n,rescheduleSocialMessage:i,requestRecurringRescheduleMode:a,rescheduleTask:o}=(0,r.useDispatch)(Gs),c=(0,Y.useFeatureGuard)("calendar/schedule-reusable-messages"),d=s=>{if("reusable-message"===s.type)return c(()=>function(e,t,s){return n=this,i=void 0,o=function*(){var n;const i=(0,r.select)(Y.store).getReusableMessage(e);if(!i)return;const a={dateType:"exact",dateValue:t,timeType:"exact",timeValue:"exact"===i.timeType?i.timeValue:Pn(i.timeValue,s)},o=Object.assign(Object.assign(Object.assign(Object.assign({},(0,k.createSocialMessage)()),i),a),{id:Qs(),schedule:(0,k.getSocialMessageSchedule)(Object.assign({baseDatetime:"now"},a))}),c=(0,k.createItemSummary)("social",o);yield(0,r.dispatch)(Y.store).receiveSocialMessages(o),yield(0,r.dispatch)(Gs).markAsUpdating(c);try{const e=(0,r.select)(Y.store).getSiteId(),t=(0,r.select)(Y.store).getApiRoot(),s=(0,r.select)(Y.store).getAuthenticationToken(),i=(0,r.select)(Y.store).getSiteTimezone(),a=yield Xt({url:`${t}/site/${e}/social`,method:"POST",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${s}`},data:Object.assign(Object.assign({},o),{baseDatetime:"now",timezone:i,slots:[{id:o.id,profileId:o.profileId,targetName:null!==(n=o.targetName)&&void 0!==n?n:"default",network:o.network,type:o.type}]})});yield(0,r.dispatch)(Y.store).receiveSocialMessages(a)}catch(e){yield(0,r.dispatch)(Y.store).removeSocialMessage(o.id),yield(0,k.showErrorNotice)(e)}yield(0,r.dispatch)(Gs).markAsUpdated(c)},new((a=void 0)||(a=Promise))(function(e,t){function s(e){try{c(o.next(e))}catch(e){t(e)}}function r(e){try{c(o.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a(function(e){e(n)})).then(s,r)}c((o=o.apply(n,i||[])).next())});var n,i,a,o}(s.id,e,t))();const{id:d,type:u}=s,l=(0,r.select)(Y.store).getItem(u,d);if(!l)return;const y=t?function(e,t,s){if("task"===e)return"";const n=(0,k.extractDateTimeValues)("post"===e?t.date:t.schedule);if(!n)return"";const{timeValue:i}=n,a=Number.parseInt(i.substring(0,2)),r=Number.parseInt(i.substring(3,5)),o=a%4+s;return(0,g.padStart)(`${o}`,2,"0")+":"+(0,g.padStart)(`${r}`,2,"0")}(u,l,t):void 0;switch(u){case"post":return n(d,e,y);case"social":{const t=(0,r.select)(Y.store).getSocialMessage(d);return(0,k.isRecurringMessage)(t)&&!(0,k.isRecurringSource)(t)?a({id:d,day:e,hour:y}):i(d,e,y)}case"task":return o(d,e)}};return e=>(s(),d(e),e)},En=()=>o(e=>e(Gs).getMinimumRowHeight()),mn=()=>o(e=>{const t=e(Y.store).getFirstDayOfWeek();return e(Gs).getFirstDay(t)}),bn=()=>o(e=>e(Gs).getNumberOfVisibleDays()),Tn=()=>{const e=jn();return o(t=>{const{getDraggingItem:s,getSidePane:n}=t(Gs),i=s(),a=n();if("none"!==a)switch(null==i?void 0:i.type){case"post":return"unscheduled-posts";case"reusable-message":return"reusable-messages"}return"none"===a&&e?"subscribe-banner":a})},On={onMouseEnter:()=>{},onMouseLeave:()=>{}},Sn=(0,g.debounce)((0,r.dispatch)(Gs).setHoverItem,200),vn=e=>o(t=>{const{getItem:s,getItemsInDay:n}=t(Y.store),{isItemVisible:i}=t(Gs);return(0,g.filter)(n(e),({id:e,type:t})=>{const n=s(t,e);return!!n&&i(t,n)})}),An=e=>"social"===e.type,Dn=e=>!!e.date,In={onDragStart:()=>{},onDragEnd:()=>{}};function Pn(e,t){const s=e=>e<10?`0${e}`:e,n=s(Math.floor(60*Math.random()));if(t)return`${s(t)}:${n}`;switch(t=Math.floor(4*Math.random()),e){case"morning":return`${s(t+8)}:${n}`;case"noon":return`${s(t+12)}:${n}`;case"afternoon":return`${s(t+16)}:${n}`;case"night":return`${s(t+20)}:${n}`;default:return`10:${n}`}}const jn=()=>o(e=>!e(Y.store).isSubscribed()&&1200<=e(Gs).getCalendarWidth())})();var s=NelioContent="undefined"==typeof NelioContent?{}:NelioContent;for(var n in t)s[n]=t[n];t.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();