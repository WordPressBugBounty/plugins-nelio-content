(()=>{var e={n:t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},d:(t,s)=>{for(var n in s)e.o(s,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:s[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};(()=>{"use strict";e.r(t),e.d(t,{calendar:()=>a});var s={};e.r(s),e.d(s,{areAutomaticMessagesVisible:()=>pe,areFailedMessagesVisible:()=>ye,areSocialMessagesCollapsedInDay:()=>ge,areTasksVisible:()=>de,areThereActiveExternalEventFilters:()=>te,areThereActiveFilters:()=>z,areThereActivePostFilters:()=>Z,areThereActiveSocialFilters:()=>J,areThereActiveTaskFilters:()=>ee,areThereUnscheduledPostsToLoad:()=>N,formatCalendarTime:()=>Ge,getActiveTabInFilterPane:()=>X,getAdminSidebarWidth:()=>Ze,getCalendarMode:()=>Be,getCalendarWidth:()=>ze,getDisabledExternalCalendars:()=>ie,getDisabledInternalEventTypes:()=>ne,getDisabledPostTypes:()=>ae,getDisabledSocialProfilesByNetwork:()=>oe,getDisabledStatuses:()=>re,getDraggingItem:()=>Ne,getEditingExternalCalendarName:()=>$,getEditingExternalCalendarUrl:()=>F,getExternalCalendar:()=>G,getExternalCalendarEditorMode:()=>x,getExternalCalendars:()=>V,getFilters:()=>q,getFirstDay:()=>Ye,getFocusDay:()=>We,getHoverItem:()=>Ie,getIcsLink:()=>$e,getLastDay:()=>Qe,getLastLoadedPageInUnscheduled:()=>L,getLoaderTimeout:()=>Oe,getMinimumRowHeight:()=>Xe,getNumberOfNonCollapsableMessages:()=>qe,getNumberOfVisibleDays:()=>Ke,getPostAuthorFilter:()=>ce,getPremiumFilter:()=>le,getRecurringAction:()=>P,getSettings:()=>Ce,getSidePane:()=>He,getTaskAssigneeFilter:()=>ue,getTaskIdInTaskViewer:()=>_,getUnscheduledPostsSearchQuery:()=>j,getUnscheduledPostsSearchTimeout:()=>R,isAddingAnExternalCalendar:()=>H,isCalendarSynching:()=>Te,isDeletingAnExternalCalendar:()=>W,isDeletingExternalCalendar:()=>Y,isDragging:()=>Re,isErrorPaneOpen:()=>xe,isExportDialogOpen:()=>D,isFilterPaneOpen:()=>Ue,isHighlighted:()=>je,isIcsEnabled:()=>Fe,isItemVisible:()=>se,isLoadingUnscheduledPosts:()=>w,isManagingExternalCalendars:()=>U,isPeriodReady:()=>Se,isReusableMessageViewOpen:()=>ke,isSavingAnExternalCalendar:()=>B,isSynching:()=>Ae,isTaskViewerDialogOpen:()=>I,isUnscheduledViewOpen:()=>Me,useEditorialCalendarOnly:()=>Ve});var n={};e.r(n),e.d(n,{_setCalendarMode:()=>xt,clearFilters:()=>mt,closeExternalCalendarEditor:()=>lt,closeRecurringDialog:()=>nt,collapseSocialMessagesInDay:()=>It,dragEnd:()=>Ct,dragStart:()=>wt,initCalendarSettings:()=>kt,loadPreviousFilters:()=>Nt,manageExternalCalendars:()=>ct,markAsDeleting:()=>ft,markAsSaving:()=>pt,markAsUpdated:()=>Bt,markAsUpdating:()=>Ht,markPeriodAsLoaded:()=>$t,markPeriodAsLoading:()=>Ft,openExportDialog:()=>Je,openExternalCalendarEditor:()=>ut,openTaskViewerDialog:()=>et,receiveExternalCalendars:()=>ht,removeExternalCalendar:()=>dt,requestRecurringRescheduleMode:()=>tt,requestRecurringTrashMode:()=>st,setActiveTabInFilterPane:()=>Et,setCalendarDimensions:()=>Gt,setDisabledExternalCalendars:()=>Tt,setDisabledInternalEventTypes:()=>bt,setDisabledPostTypeTerms:()=>Ot,setDisabledPostTypes:()=>St,setDisabledSocialProfilesInNetwork:()=>vt,setDisabledStatuses:()=>At,setEditingExternalCalendarName:()=>yt,setEditingExternalCalendarUrl:()=>gt,setFocusDay:()=>Vt,setHoverItem:()=>Mt,setIsLoadingUnscheduledPosts:()=>at,setLoaderTimeout:()=>Wt,setPostAuthorFilter:()=>Dt,setPremiumFilter:()=>Lt,setTaskAssigneeFilter:()=>Pt,setUnscheduledPostsQuery:()=>rt,setUnscheduledPostsSearchTimeout:()=>ot,showAutomaticMessages:()=>Rt,showFailedMessages:()=>jt,toggleSidePane:()=>Ut,toggleTasksVisibility:()=>_t,updateUnscheduledPostsPagination:()=>it});var i={};e.r(i),e.d(i,{addExternalCalendar:()=>Os,deleteExternalCalendar:()=>As,deleteSocialMessage:()=>ds,deleteTask:()=>ts,loadItemsIn:()=>Ls,loadItemsNow:()=>Ns,loadUnscheduledPosts:()=>Xt,nextPeriod:()=>_s,previousPeriod:()=>Ps,reschedulePost:()=>ys,rescheduleSocialMessage:()=>cs,rescheduleTask:()=>es,saveExternalCalendar:()=>Ss,setCalendarMode:()=>Is,showToday:()=>Ds,toggleTaskCompletion:()=>ss,trashPost:()=>fs,unschedulePost:()=>ps});var a={};e.r(a),e.d(a,{store:()=>Us,useCanCreateMessages:()=>on,useCanCreatePosts:()=>rn,useCanCreateTasks:()=>cn,useCollapsableItemCount:()=>Js,useDayCollapser:()=>Zs,useDayType:()=>zs,useDefaultTime:()=>Xs,useDraggingItem:()=>Ks,useFirstDay:()=>fn,useHoverItem:()=>qs,useItem:()=>Qs,useItemDragTriggers:()=>sn,useItemDropper:()=>yn,useItemHoverListeners:()=>tn,useMessageCreator:()=>un,useMinRowHeight:()=>pn,useNewPostLabel:()=>an,useNonCollapsedDayItems:()=>en,useNumberOfVisibleDays:()=>hn,usePostCreator:()=>dn,usePostStatus:()=>nn,useSidePane:()=>En,useTaskCreator:()=>ln,useToday:()=>gn});const r=window.wp.data;function o(e,t){return(0,r.useSelect)(e,t)}function c(e){return(0,r.resolveSelect)(e)}const d={isExportDialogOpen:!1,recurringAction:void 0,taskIdInTaskViewer:void 0},u={unscheduledPosts:{byQueryPagination:{},defaultPagination:{lastPageLoaded:0,maxPages:1,isLoading:!1},query:"",searchTimeout:0}},l={lastPageLoaded:0,maxPages:1,isLoading:!1},g=window.lodash,y={isManaging:!1,byUrl:{},deleting:[],editor:void 0},p={activeTab:"post",areAllMessagesVisibleInDay:{},disabledInternalEventTypes:[],disabledExternalCalendars:[],disabledPostTypes:[],disabledPostTypeTerms:{},disabledPostAuthors:[],disabledSocialProfilesByNetwork:{},disabledStatuses:[],areTasksVisible:!0,taskAssignee:void 0,postAuthor:void 0,areFailedMessagesVisible:!0,areAutomaticMessagesVisible:!0,premium:{}},f={drag:void 0,hover:void 0},h={adminSidebarWidth:0,calendarMode:"two-weeks",calendarWidth:0,focusDay:"",icsLinks:void 0,minRowHeight:0,numberOfNonCollapsableMessages:0,sidePane:"unscheduled-posts",useEditorialCalendarOnly:!1,calendarTimeFormat:"H:ia",simplifyCalendarTime:!0},E=window.moment;var m=e.n(E);const b=window.NelioContent.date,T={loadedDays:{},loaderTimeout:0,updating:[]};function O(e,t){return(0,g.find)(e,{type:t.type,id:t.id})?e:[...e,t]}function S(e,t){const s=(0,g.find)(e,(e=>e.type===t.type&&e.id===t.id));return s?(0,g.without)(e,s):e}function A(e,t,s){let n;const i=m()(t);do{n=(0,b.date)("Y-m-d",i),e=Object.assign(Object.assign({},e),{[n]:!0}),i.add(1,"day")}while(n<=s);return e}const v=(0,r.combineReducers)({dialogs:function(e=d,t){var s;return null!==(s=function(e,t){switch(t.type){case"OPEN_EXPORT_DIALOG":return Object.assign(Object.assign({},e),{isExportDialogOpen:t.isOpen});case"OPEN_TASK_VIEWER_DIALOG":return Object.assign(Object.assign({},e),{taskIdInTaskViewer:t.taskId});case"REQUEST_RECURRING_RESCHEDULE_MODE":return Object.assign(Object.assign({},e),{recurringAction:{type:"reschedule",props:t.props}});case"REQUEST_RECURRING_TRASH_MODE":return Object.assign(Object.assign({},e),{recurringAction:{type:"trash",props:t.props}});case"CLOSE_RECURRING_DIALOG":return Object.assign(Object.assign({},e),{recurringAction:void 0})}}(e,t))&&void 0!==s?s:e},entities:function(e=u,t){var s;return null!==(s=function(e,t){switch(t.type){case"SET_UNSCHEDULED_POSTS_QUERY":return Object.assign(Object.assign({},e),{unscheduledPosts:Object.assign(Object.assign({},e.unscheduledPosts),{query:t.query})});case"SET_UNSCHEDULED_POSTS_SEARCH_TIMEOUT":return Object.assign(Object.assign({},e),{unscheduledPosts:Object.assign(Object.assign({},e.unscheduledPosts),{searchTimeout:t.timeout})});case"UPDATE_UNSCHEDULED_POSTS_PAGINATION":return t.query?Object.assign(Object.assign({},e),{unscheduledPosts:Object.assign(Object.assign({},e.unscheduledPosts),{byQueryPagination:Object.assign(Object.assign({},e.unscheduledPosts.byQueryPagination),{[t.query]:Object.assign(Object.assign(Object.assign({},l),e.unscheduledPosts.byQueryPagination[t.query]),{lastPageLoaded:t.lastPageLoaded,maxPages:t.maxPages})})})}):Object.assign(Object.assign({},e),{unscheduledPosts:Object.assign(Object.assign({},e.unscheduledPosts),{defaultPagination:Object.assign(Object.assign({},e.unscheduledPosts.defaultPagination),{lastPageLoaded:t.lastPageLoaded,maxPages:t.maxPages})})});case"IS_LOADING_UNSCHEDULED_POSTS":return t.query?Object.assign(Object.assign({},e),{unscheduledPosts:Object.assign(Object.assign({},e.unscheduledPosts),{byQueryPagination:Object.assign(Object.assign({},e.unscheduledPosts.byQueryPagination),{[t.query]:Object.assign(Object.assign(Object.assign({},l),e.unscheduledPosts.byQueryPagination[t.query]),{isLoading:t.isLoading})})})}):Object.assign(Object.assign({},e),{unscheduledPosts:Object.assign(Object.assign({},e.unscheduledPosts),{defaultPagination:Object.assign(Object.assign({},e.unscheduledPosts.defaultPagination),{isLoading:t.isLoading})})})}}(e,t))&&void 0!==s?s:e},externalCalendars:function(e=y,t){var s;return null!==(s=function(e,t){switch(t.type){case"MANAGE_EXTERNAL_CALENDARS":return Object.assign(Object.assign({},e),{isManaging:t.isActive});case"RECEIVE_EXTERNAL_CALENDARS":return Object.assign(Object.assign({},e),{byUrl:Object.assign(Object.assign({},e.byUrl),(0,g.keyBy)(t.externalCalendars,"url"))});case"REMOVE_EXTERNAL_CALENDAR":return Object.assign(Object.assign({},e),{byUrl:(0,g.omit)(e.byUrl,t.url)});case"OPEN_EXTERNAL_EDITOR_CALENDAR":return Object.assign(Object.assign({},e),{editor:{isNew:!t.url,isSaving:!1,url:t.url,name:t.name}});case"CLOSE_EXTERNAL_CALENDAR_EDITOR":return Object.assign(Object.assign({},e),{editor:void 0});case"SET_EDITING_EXTERNAL_CALENDAR_URL":return e.editor&&e.editor.isNew?Object.assign(Object.assign({},e),{editor:Object.assign(Object.assign({},e.editor),{url:t.url})}):e;case"SET_EDITING_EXTERNAL_CALENDAR_NAME":return e.editor?Object.assign(Object.assign({},e),{editor:Object.assign(Object.assign({},e.editor),{name:t.name})}):e;case"MARK_AS_SAVING":return e.editor?Object.assign(Object.assign({},e),{editor:Object.assign(Object.assign({},e.editor),{isSaving:t.isSaving})}):e;case"MARK_AS_DELETING":return Object.assign(Object.assign({},e),{deleting:t.isDeleting?(0,g.uniq)([...e.deleting,t.url]):(0,g.without)(e.deleting,t.url)})}}(e,t))&&void 0!==s?s:e},filters:function(e=p,t){var s;return null!==(s=function(e,t){switch(t.type){case"CLEAR_FILTERS":return p;case"SET_ACTIVE_TAB_IN_FILTER_PANE":return Object.assign(Object.assign({},e),{activeTab:t.tabName});case"SET_DISABLED_POST_TYPE_TERMS":return Object.assign(Object.assign({},e),{disabledPostTypeTerms:Object.assign(Object.assign({},e.disabledPostTypeTerms),{[t.postType]:Object.assign(Object.assign({},e.disabledPostTypeTerms[t.postType]),{[t.taxonomy]:t.terms})})});case"SET_DISABLED_STATUSES":return Object.assign(Object.assign({},e),{disabledStatuses:t.statuses});case"SET_DISABLED_INTERNAL_EVENT_TYPES":return Object.assign(Object.assign({},e),{disabledInternalEventTypes:t.internalEventTypes});case"SET_DISABLED_EXTERNAL_CALENDARS":return Object.assign(Object.assign({},e),{disabledExternalCalendars:t.externalCalendars});case"SET_DISABLED_POST_TYPES":return Object.assign(Object.assign({},e),{disabledPostTypes:t.postTypes});case"SET_POST_AUTHOR_FILTER":return Object.assign(Object.assign({},e),{postAuthor:t.authorId});case"SET_DISABLED_PROFILES_IN_NETWORK":return Object.assign(Object.assign({},e),{disabledSocialProfilesByNetwork:Object.assign(Object.assign({},e.disabledSocialProfilesByNetwork),{[t.network]:t.disabledProfiles})});case"TOGGLE_TASKS_VISIBILITY":return Object.assign(Object.assign({},e),{areTasksVisible:!e.areTasksVisible});case"SET_TASK_ASSIGNEE_FILTER":return Object.assign(Object.assign({},e),{taskAssignee:t.assigneeId});case"COLLAPSE_MESSAGES_IN_DAY":return Object.assign(Object.assign({},e),{areAllMessagesVisibleInDay:Object.assign(Object.assign({},e.areAllMessagesVisibleInDay),{[t.day]:!t.areMessagesCollapsed})});case"SHOW_FAILED_MESSAGES":return Object.assign(Object.assign({},e),{areFailedMessagesVisible:!!t.areFailedMessagesVisible});case"SHOW_AUTOMATIC_MESSAGES":return Object.assign(Object.assign({},e),{areAutomaticMessagesVisible:!!t.areAutomaticMessagesVisible});case"LOAD_PREVIOUS_FILTERS":return Object.assign(Object.assign({},e),t.filters);case"SET_PREMIUM_FILTER":return Object.assign(Object.assign({},e),{premium:Object.assign(Object.assign({},e.premium),{[t.filterName]:t.value})})}}(e,t))&&void 0!==s?s:e},interaction:function(e=f,t){var s;return null!==(s=function(e,t){switch(t.type){case"DRAG_START":return Object.assign(Object.assign({},e),{drag:t.item,hover:void 0});case"DRAG_END":return Object.assign(Object.assign({},e),{drag:void 0});case"HOVER_ITEM":return Object.assign(Object.assign({},e),{hover:t.item});case"HOVER_END":return Object.assign(Object.assign({},e),{hover:void 0})}}(e,t))&&void 0!==s?s:e},settings:function(e=h,t){var s;return null!==(s=function(e,t){switch(t.type){case"SET_CALENDAR_DIMENSIONS":return Object.assign(Object.assign({},e),{adminSidebarWidth:t.adminSidebarWidth,calendarWidth:t.calendarWidth,minRowHeight:t.minRowHeight});case"TOGGLE_SIDE_PANE":return Object.assign(Object.assign({},e),{sidePane:e.sidePane===t.pane?"none":t.pane});case"SET_CALENDAR_MODE":return Object.assign(Object.assign({},e),{calendarMode:t.mode||"two-weeks"});case"SET_FOCUS_DAY":return Object.assign(Object.assign({},e),{focusDay:t.focusDay});case"INIT_CALENDAR_SETTINGS":return Object.assign(Object.assign(Object.assign({},h),t.settings),{sidePane:t.settings.sidePane||"none"})}}(e,t))&&void 0!==s?s:e},status:function(e=T,t){var s;return null!==(s=function(e,t){switch(t.type){case"MARK_AS_UPDATING":return Object.assign(Object.assign({},e),{updating:O(e.updating,t.item)});case"MARK_AS_UPDATED":return Object.assign(Object.assign({},e),{updating:S(e.updating,t.item)});case"MARK_PERIOD_AS_LOADING":return Object.assign(Object.assign({},e),{updating:O(e.updating,t.period)});case"MARK_PERIOD_AS_LOADED":return Object.assign(Object.assign({},e),{loadedDays:A(e.loadedDays,t.period.firstDay,t.period.lastDay),updating:S(e.updating,t.period)});case"SET_LOADER_TIMEOUT":return Object.assign(Object.assign({},e),{loaderTimeout:t.timeout})}}(e,t))&&void 0!==s?s:e}});function D(e){return e.dialogs.isExportDialogOpen}function _(e){return e.dialogs.taskIdInTaskViewer||void 0}function P(e){return e.dialogs.recurringAction}function I(e){return!!e.dialogs.taskIdInTaskViewer}function j(e){return e.entities.unscheduledPosts.query||""}function R(e){return e.entities.unscheduledPosts.searchTimeout}function N(e,t){const s=M(e,"");if(s.lastPageLoaded>=s.maxPages)return!1;const n=M(e,t);return n.lastPageLoaded<n.maxPages}function L(e,t){return M(e,t).lastPageLoaded}function w(e,t){return!!N(e,"")&&M(e,t).isLoading}const C={lastPageLoaded:0,maxPages:1,isLoading:!1};function M(e,t){return(t=(0,g.trim)(t))?Object.assign(Object.assign({},C),e.entities.unscheduledPosts.byQueryPagination[t]):e.entities.unscheduledPosts.defaultPagination}const k=window.NelioContent.utils;function U(e){return e.externalCalendars.isManaging}function x(e){return e.externalCalendars.editor?e.externalCalendars.editor.isNew?"create":"edit":"none"}function V(e){return(0,g.values)(e.externalCalendars.byUrl)}function G(e,t){return e.externalCalendars.byUrl[t]}function F(e){var t;const{editor:s}=e.externalCalendars;return null!==(t=null==s?void 0:s.url)&&void 0!==t?t:""}function $(e){var t;const{editor:s}=e.externalCalendars;return null!==(t=null==s?void 0:s.name)&&void 0!==t?t:""}function H(e){const{editor:t}=e.externalCalendars;return!!(null==t?void 0:t.isNew)&&!!(null==t?void 0:t.isSaving)}function B(e){const{editor:t}=e.externalCalendars;return!!(null==t?void 0:t.isSaving)}function W(e){return!(0,k.isEmpty)(e.externalCalendars.deleting)}function Y(e,t){return e.externalCalendars.deleting.includes(t)}const Q=window.NelioContent.data,K=window.NelioContent.premiumHooksForPages;function q(e){return e.filters}function X(e){return e.filters.activeTab}function z(e){return Z(e)||J(e)||ee(e)||te(e)}function Z(e){return!(0,k.isEmpty)(ae(e))||!(0,k.isEmpty)(re(e))||!(0,k.isEmpty)(ce(e))}function J(e){const t=oe(e),s=(0,g.flatten)((0,g.values)(t)),{getSocialProfile:n}=(0,r.select)(Q.store);return!(0,k.isEmpty)((0,g.filter)((0,g.map)(s,n)))}function ee(e){return!de(e)||!!ue(e)}function te(e){const t=(0,g.keys)(e.externalCalendars.byUrl);return!!ie(e).filter((e=>t.includes(e))).length}function se(e,t,s){switch(t){case"post":return fe(s)&&function(e,t){const s=ce(e);if(s&&s!==t.author)return!1;if(ae(e).includes(t.type))return!1;return!re(e).includes(t.status)}(e,s);case"social":return he(s)&&function(e,t){if("error"===t.status&&ye(e))return!0;if(t.auto&&!pe(e))return!1;return!(oe(e)[t.network]||[]).includes(t.profileId)}(e,s);case"task":return Ee(s)&&function(e,t){if(!de(e))return!1;const s=ue(e);return!s||s===t.assigneeId}(e,s);case"external-event":return me(s)&&function(e,t){return!ie(e).includes(t.calendar)}(e,s);case"internal-event":return be(s)&&function(e,t){return!ne(e).includes(t.type)}(e,s);default:return(0,K.isPremiumItemVisible)(t,s)}}function ne(e){return e.filters.disabledInternalEventTypes}function ie(e){return e.filters.disabledExternalCalendars}function ae(e){return e.filters.disabledPostTypes}function re(e){return e.filters.disabledStatuses}function oe(e){return e.filters.disabledSocialProfilesByNetwork}function ce(e){return e.filters.postAuthor||void 0}function de(e){return e.filters.areTasksVisible}function ue(e){return e.filters.taskAssignee||void 0}function le(e,t){if("_"!==t)return e.filters.premium[t]}function ge(e,t){return!e.filters.areAllMessagesVisibleInDay[t]}function ye(e){return e.filters.areFailedMessagesVisible}function pe(e){return e.filters.areAutomaticMessagesVisible}const fe=e=>"number"==typeof e.id,he=e=>!fe(e)&&"network"in e,Ee=e=>!fe(e)&&"task"in e,me=e=>!fe(e)&&"calendar"in e,be=e=>!fe(e);function Te(e){return!(0,k.isEmpty)(e.status.updating)}function Oe(e){return e.status.loaderTimeout||0}function Se(e,t,s){let n;const i=m()(t);do{if(n=(0,b.date)("Y-m-d",i),!e.status.loadedDays[n])return!1;i.add(1,"day")}while(n<=s);return!0}function Ae(e,t,s){if("post"===t)return!!(0,g.find)(e.status.updating,{relatedPost:s});if((0,g.find)(e.status.updating,{type:t,id:s}))return!0;const{getItem:n}=(0,r.select)(Q.store),i=n(t,s);return ve(e,i)||_e(e,i)}const ve=(e,t)=>De(t)&&!!(0,g.find)(e.status.updating,{type:"post",id:t.postId}),De=e=>!!e&&"object"==typeof e&&!!e.postId,_e=(e,t)=>Pe(t)&&!!(0,g.find)(e.status.updating,{type:"social",recurrenceGroup:t.recurrenceGroup}),Pe=e=>!!e&&"object"==typeof e&&!!e.recurrenceGroup;function Ie(e){return e.interaction.hover}function je(e,t,s){const{hover:n}=e.interaction;if(!n)return!1;if("external-event"===n.type)return!1;if("internal-event"===n.type)return!1;if(Ae(e,t,s))return!1;if(n.type===t&&n.id===s)return!0;const{getItem:i}=(0,r.select)(Q.store),a=i(t,s);return!!a&&("post"===t?n.relatedPostId===a.id:!(!Le(a)||a.postId!==n.relatedPostId)||!(!we(a)||!we(n)||a.recurrenceGroup!==n.recurrenceGroup))}function Re(e,t,s){return!!e.interaction.drag&&e.interaction.drag.type===t&&e.interaction.drag.id===s}function Ne(e){return e.interaction.drag}const Le=e=>!!e&&"object"==typeof e&&!!e.postId,we=e=>!!e&&"object"==typeof e&&!!e.recurrenceGroup;function Ce(e){return e.settings}function Me(e){return"unscheduled-posts"===e.settings.sidePane}function ke(e){return"reusable-messages"===e.settings.sidePane}function Ue(e){return"filters"===e.settings.sidePane}function xe(e){return"errors"===e.settings.sidePane}function Ve(e){return e.settings.useEditorialCalendarOnly}function Ge(e,t){const s=(0,b.dateI18n)(e.settings.calendarTimeFormat,t);return e.settings.simplifyCalendarTime?s.replace(":00","").replace(/m$/i,"").replace(/\s/g,""):s}function Fe(e){return!!e.settings.icsLinks}function $e(e,t){var s;return null===(s=e.settings.icsLinks)||void 0===s?void 0:s[t]}function He(e){return e.settings.sidePane}function Be(e){return e.settings.calendarMode}function We(e){return e.settings.focusDay}function Ye(e,t){const s=We(e),n=Be(e);if("agenda"===n)return s;const i=m()((0,b.wpifyDateTime)("c",s,"12:00"));return"month"===n&&i.date(1),i.day()===t?(0,b.date)("Y-m-d",i):(0,b.date)("Y-m-d",i.isoWeekday(t))}function Qe(e,t){const s=Ye(e,t);if(!s)return"";const n=Ke(e);return(0,b.date)("Y-m-d",m()(s).add(n,"days"))}function Ke(e){switch(Be(e)){case"agenda":return 4;case"week":return 7;case"month":return 42;default:return 14}}function qe(e){return e.settings.numberOfNonCollapsableMessages}function Xe(e){return e.settings.minRowHeight}function ze(e){return e.settings.calendarWidth}function Ze(e){return e.settings.adminSidebarWidth}function Je(e=!0){return{type:"OPEN_EXPORT_DIALOG",isOpen:e}}function et(e){return{type:"OPEN_TASK_VIEWER_DIALOG",taskId:e}}function tt(e){return{type:"REQUEST_RECURRING_RESCHEDULE_MODE",props:e}}function st(e){return{type:"REQUEST_RECURRING_TRASH_MODE",props:e}}function nt(){return{type:"CLOSE_RECURRING_DIALOG"}}function it(e,t,s){return{type:"UPDATE_UNSCHEDULED_POSTS_PAGINATION",query:e,lastPageLoaded:t,maxPages:s}}function at(e,t){return{type:"IS_LOADING_UNSCHEDULED_POSTS",query:e,isLoading:t}}function rt(e){return{type:"SET_UNSCHEDULED_POSTS_QUERY",query:e}}function ot(e){return{type:"SET_UNSCHEDULED_POSTS_SEARCH_TIMEOUT",timeout:e}}function ct(e){return{type:"MANAGE_EXTERNAL_CALENDARS",isActive:e}}function dt(e){return{type:"REMOVE_EXTERNAL_CALENDAR",url:e}}function ut(e){var t,s;return{type:"OPEN_EXTERNAL_EDITOR_CALENDAR",url:null!==(t=null==e?void 0:e.url)&&void 0!==t?t:"",name:null!==(s=null==e?void 0:e.name)&&void 0!==s?s:""}}function lt(){return{type:"CLOSE_EXTERNAL_CALENDAR_EDITOR"}}function gt(e){return{type:"SET_EDITING_EXTERNAL_CALENDAR_URL",url:e}}function yt(e){return{type:"SET_EDITING_EXTERNAL_CALENDAR_NAME",name:e}}function pt(e){return{type:"MARK_AS_SAVING",isSaving:e}}function ft(e,t){return{type:"MARK_AS_DELETING",url:e,isDeleting:t}}function ht(e){return{type:"RECEIVE_EXTERNAL_CALENDARS",externalCalendars:(0,g.castArray)(e)}}function Et(e){return{type:"SET_ACTIVE_TAB_IN_FILTER_PANE",tabName:e}}function mt(){return{type:"CLEAR_FILTERS"}}function bt(e){return{type:"SET_DISABLED_INTERNAL_EVENT_TYPES",internalEventTypes:e}}function Tt(e){return{type:"SET_DISABLED_EXTERNAL_CALENDARS",externalCalendars:e}}function Ot(e,t,s){return{type:"SET_DISABLED_POST_TYPE_TERMS",postType:e,taxonomy:t,terms:s}}function St(e){return{type:"SET_DISABLED_POST_TYPES",postTypes:e}}function At(e){return{type:"SET_DISABLED_STATUSES",statuses:e}}function vt(e,t){return{type:"SET_DISABLED_PROFILES_IN_NETWORK",network:e,disabledProfiles:t}}function Dt(e){return{type:"SET_POST_AUTHOR_FILTER",authorId:e}}function _t(){return{type:"TOGGLE_TASKS_VISIBILITY"}}function Pt(e){return{type:"SET_TASK_ASSIGNEE_FILTER",assigneeId:e}}function It(e,t){return{type:"COLLAPSE_MESSAGES_IN_DAY",day:t,areMessagesCollapsed:e}}function jt(e){return{type:"SHOW_FAILED_MESSAGES",areFailedMessagesVisible:e}}function Rt(e){return{type:"SHOW_AUTOMATIC_MESSAGES",areAutomaticMessagesVisible:e}}function Nt(e){if("object"==typeof e)return{type:"LOAD_PREVIOUS_FILTERS",filters:e}}function Lt(e,t){return{type:"SET_PREMIUM_FILTER",filterName:e,value:t}}function wt(e){return{type:"DRAG_START",item:e}}function Ct(){return{type:"DRAG_END"}}function Mt(e){return e?{type:"HOVER_ITEM",item:e}:{type:"HOVER_END"}}function kt(e){return{type:"INIT_CALENDAR_SETTINGS",settings:e}}function Ut(e){return{type:"TOGGLE_SIDE_PANE",pane:e}}function xt(e){return{type:"SET_CALENDAR_MODE",mode:e}}function Vt(e){return{type:"SET_FOCUS_DAY",focusDay:e}}function Gt({adminSidebarWidth:e,calendarWidth:t,minRowHeight:s}){return{type:"SET_CALENDAR_DIMENSIONS",adminSidebarWidth:e,calendarWidth:t,minRowHeight:s}}function Ft(e,t){return{type:"MARK_PERIOD_AS_LOADING",period:{type:"period",id:`${e}::${t}`,firstDay:e,lastDay:t}}}function $t(e,t){return{type:"MARK_PERIOD_AS_LOADED",period:{type:"period",id:`${e}::${t}`,firstDay:e,lastDay:t}}}function Ht(e){return{type:"MARK_AS_UPDATING",item:e}}function Bt(e){return{type:"MARK_AS_UPDATED",item:e}}function Wt(e){return{type:"SET_LOADER_TIMEOUT",timeout:e}}const Yt=window.wp.apiFetch,Qt=e.n(Yt)(),Kt=window.wp.url;var qt=function(e,t,s,n){return new(s||(s=Promise))((function(i,a){function r(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function Xt(){return qt(this,arguments,void 0,(function*(e=""){if(e=(0,g.trim)(e),yield(0,r.dispatch)(Us).setUnscheduledPostsSearchTimeout(0),(0,r.select)(Us).areThereUnscheduledPostsToLoad(e)&&!(0,r.select)(Us).isLoadingUnscheduledPosts(e))try{yield(0,r.dispatch)(Us).setIsLoadingUnscheduledPosts(e,!0);const t=(0,r.select)(Us).getLastLoadedPageInUnscheduled(e),s=(0,g.map)((0,r.select)(Q.store).getPostTypes("calendar"),"name"),n=yield Qt({path:(0,Kt.addQueryArgs)("/nelio-content/v1/post/search",{page:t+1,per_page:15,query:e,status:"nc_unscheduled",type:s.join(",")}),method:"GET"}),i=n.results;yield(0,r.dispatch)(Q.store).receivePosts(i),yield(0,r.dispatch)(Us).updateUnscheduledPostsPagination(e,t+1,n.pagination.pages),yield(0,r.dispatch)(Us).setIsLoadingUnscheduledPosts(e,!1)}catch(e){yield(0,k.showErrorNotice)(e)}}))}function zt(e,t){var s;const{utcDate:n,dateType:i,dateValue:a}=Zt({dateType:t.dateType,dateValue:t.dateValue,newLocalDay:e,utcDate:null!==(s=t.schedule)&&void 0!==s?s:""});return Object.assign(Object.assign({},t),{dateType:i,dateValue:a,schedule:n})}function Zt(e){const{utcDate:t,dateType:s,dateValue:n,newLocalDay:i}=e;if("exact"===s){const e=(0,b.date)("H:i",t);return{utcDate:(0,b.wpifyDateTime)("c",i,e),dateType:s,dateValue:i}}const a=(0,b.date)("Y-m-d",t),r=m()(`${a}T12:00:00.000Z`),o=m()(`${i}T12:00:00.000Z`).diff(r,"days"),c=("negative-days"===s?-Number.parseInt(n):Number.parseInt(n))+o;return c<0?{utcDate:m()(t).add(o,"days").toISOString(),dateType:"negative-days",dateValue:`${Math.abs(c)}`}:{utcDate:m()(t).add(o,"days").toISOString(),dateType:"positive-days",dateValue:`${c}`}}var Jt=function(e,t,s,n){return new(s||(s=Promise))((function(i,a){function r(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function es(e,t){return Jt(this,void 0,void 0,(function*(){const s=(0,r.select)(Q.store).getTask(e);if(s&&(0,b.date)("Y-m-d",s.dateDue)!==t)try{const n=function(e,t){const{utcDate:s,dateType:n,dateValue:i}=Zt({dateType:t.dateType,dateValue:t.dateValue,newLocalDay:e,utcDate:t.dateDue});return Object.assign(Object.assign({},t),{dateType:n,dateValue:i,dateDue:s})}(t,s);yield ns(n);const i=(0,r.select)(Q.store).getSiteId(),a=(0,r.select)(Q.store).getApiRoot(),o=(0,r.select)(Q.store).getAuthenticationToken(),c=yield Qt({url:`${a}/site/${i}/task/${e}`,method:"PUT",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${o}`},data:Object.assign(Object.assign({},n),{baseDatetime:"reschedule"})});yield is(c)}catch(e){yield as(s,e)}}))}function ts(e){return Jt(this,void 0,void 0,(function*(){const t=(0,r.select)(Q.store).getTask(e);if(t)try{yield function(e){return Jt(this,void 0,void 0,(function*(){yield(0,r.dispatch)(Us).markAsUpdating(rs(e)),yield(0,r.dispatch)(Q.store).removeTask(e.id)}))}(t);const s=(0,r.select)(Q.store).getSiteId(),n=(0,r.select)(Q.store).getApiRoot(),i=(0,r.select)(Q.store).getAuthenticationToken();yield Qt({url:`${n}/site/${s}/task/${e}`,method:"DELETE",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${i}`}}),yield function(e){return Jt(this,void 0,void 0,(function*(){yield(0,r.dispatch)(Us).markAsUpdated(rs(e))}))}(t)}catch(e){yield as(t,e)}}))}function ss(e){return Jt(this,void 0,void 0,(function*(){const t=(0,r.select)(Q.store).getTask(e);if(t)try{const s=Object.assign(Object.assign({},t),{completed:!t.completed});yield ns(s);const n=(0,r.select)(Q.store).getSiteId(),i=(0,r.select)(Q.store).getApiRoot(),a=(0,r.select)(Q.store).getAuthenticationToken(),o=yield Qt({url:`${i}/site/${n}/task/${e}`,method:"PUT",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${a}`},data:s});if(o.completed)try{yield Qt({path:"/nelio-content/v1/notifications/task",method:"POST",data:Object.assign({isNewTask:!1},o)})}catch(e){yield(0,k.showErrorNotice)(e)}yield is(Object.assign(Object.assign({},t),o))}catch(e){yield as(t,e)}}))}function ns(e){return Jt(this,void 0,void 0,(function*(){yield(0,r.dispatch)(Us).markAsUpdating(rs(e)),yield(0,r.dispatch)(Q.store).receiveTasks(e)}))}function is(e){return Jt(this,void 0,void 0,(function*(){yield(0,r.dispatch)(Q.store).receiveTasks(e),yield(0,r.dispatch)(Us).markAsUpdated(rs(e))}))}function as(e,t){return Jt(this,void 0,void 0,(function*(){yield(0,r.dispatch)(Q.store).receiveTasks(e),yield(0,r.dispatch)(Us).markAsUpdated(rs(e)),yield(0,k.showErrorNotice)(t)}))}function rs(e){return{type:"task",id:e.id,relatedPostId:e.postId}}var os=function(e,t,s,n){return new(s||(s=Promise))((function(i,a){function r(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function cs(e,t,s,n){return os(this,void 0,void 0,(function*(){var i;const a=(0,r.select)(Q.store).getSocialMessage(e);if(!a)return;const{dateValue:o,timeValue:c}=null!==(i=(0,k.extractDateTimeValues)(a.schedule))&&void 0!==i?i:{};if(o===t&&(!s||c===s))return;const d=s?function(e,t,s){var n;const{dateValue:i}=null!==(n=(0,k.extractDateTimeValues)(s.schedule))&&void 0!==n?n:{};return zt(e,s=Object.assign(Object.assign({},s),{timeType:"exact",timeValue:t,schedule:(0,b.wpifyDateTime)("c",null!=i?i:"",t)}))}(t,s,a):zt(t,a),u=Object.assign(Object.assign({},d),{recurrenceSettings:n?void 0:d.recurrenceSettings});if("negative-days"!==u.dateType)try{yield function(e){return os(this,void 0,void 0,(function*(){yield(0,r.dispatch)(Us).markAsUpdating(ls(e)),yield(0,r.dispatch)(Q.store).receiveSocialMessages(e)}))}(u);const t=(0,r.select)(Q.store).getSiteId(),s=(0,r.select)(Q.store).getApiRoot(),n=(0,r.select)(Q.store).getAuthenticationToken(),i=yield Qt({url:`${s}/site/${t}/social/${e}`,method:"PUT",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${n}`},data:Object.assign(Object.assign({},u),{baseDatetime:"reschedule"})});yield function(e,t){return os(this,void 0,void 0,(function*(){yield(0,r.dispatch)(Q.store).removeRecurringMessages(e.recurrenceGroup),yield(0,r.dispatch)(Q.store).receiveSocialMessages(t),(0,g.castArray)(t).map(ls).filter((({type:e,id:t})=>(0,r.select)(Us).isSynching(e,t))).forEach((0,r.dispatch)(Us).markAsUpdated)}))}(a,i)}catch(e){yield us(a,e)}}))}function ds(e,t){return os(this,void 0,void 0,(function*(){const s=(0,r.select)(Q.store).getSocialMessage(e);if(s)try{yield function(e){return os(this,void 0,void 0,(function*(){yield(0,r.dispatch)(Us).markAsUpdating(ls(e)),yield(0,r.dispatch)(Q.store).removeSocialMessage(e.id)}))}(s);const n=(0,r.select)(Q.store).getSiteId(),i=(0,r.select)(Q.store).getApiRoot(),a=(0,r.select)(Q.store).getAuthenticationToken(),o=yield Qt({url:`${i}/site/${n}/social/${e}${t?"/following":""}`,method:"DELETE",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${a}`}});yield function(e,t){return os(this,void 0,void 0,(function*(){yield(0,r.dispatch)(Q.store).removeSocialMessage(e.id),yield(0,r.dispatch)(Q.store).removeRecurringMessages(e.recurrenceGroup),yield(0,r.dispatch)(Q.store).receiveSocialMessages(t),yield(0,r.dispatch)(Us).markAsUpdated(ls(e))}))}(s,o)}catch(e){yield us(s,e)}}))}function us(e,t){return os(this,void 0,void 0,(function*(){yield(0,r.dispatch)(Q.store).receiveSocialMessages(e),yield(0,r.dispatch)(Us).markAsUpdated(ls(e)),yield(0,k.showErrorNotice)(t)}))}function ls(e){return{type:"social",id:e.id,relatedPostId:e.postId,recurrenceGroup:e.recurrenceGroup}}var gs=function(e,t,s,n){return new(s||(s=Promise))((function(i,a){function r(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function ys(e,t,s){return gs(this,void 0,void 0,(function*(){const n=yield c(Q.store).getPost(e);if(!n)return;const i=(0,r.select)(Q.store).getDefaultTime("post"),a=function(e,t,s){return Object.assign(Object.assign({},s),{date:(0,b.wpifyDateTime)("c",e,t)})}(t,s||i,n);if(a.date!==n.date)try{yield hs(a);const n=yield Qt({path:(0,Kt.addQueryArgs)(`/nelio-content/v1/post/${e}/reschedule`,{day:t,hour:s,defaultHour:i}),method:"PUT"});yield(0,r.dispatch)(Q.store).reloadPostRelatedItems(n.id),yield Es(n)}catch(e){yield ms(n,e)}}))}function ps(e){return gs(this,void 0,void 0,(function*(){const t=yield c(Q.store).getPost(e);if(t)try{yield hs(Object.assign(Object.assign({},t),{status:"future"===t.status?"draft":t.status,date:!1}));const s=yield Qt({path:`/nelio-content/v1/post/${e}/unschedule`,method:"PUT"});yield(0,r.dispatch)(Q.store).reloadPostRelatedItems(s.id),yield Es(s)}catch(e){yield ms(t,e)}}))}function fs(e){return gs(this,void 0,void 0,(function*(){const t=yield c(Q.store).getPost(e);if(t)try{yield function(e){return gs(this,void 0,void 0,(function*(){yield(0,r.dispatch)(Us).markAsUpdating(bs(e)),yield(0,r.dispatch)(Q.store).removePost(e.id)}))}(t),yield Qt({path:`/nelio-content/v1/post/${e}/trash`,method:"PUT"}),yield(0,r.dispatch)(Q.store).reloadPostRelatedItems(t.id),yield function(e){return gs(this,void 0,void 0,(function*(){yield(0,r.dispatch)(Us).markAsUpdated(bs(e))}))}(t)}catch(e){yield ms(t,e)}}))}function hs(e){return gs(this,void 0,void 0,(function*(){yield(0,r.dispatch)(Us).markAsUpdating(bs(e)),yield(0,r.dispatch)(Q.store).receivePosts(e)}))}function Es(e){return gs(this,void 0,void 0,(function*(){yield(0,r.dispatch)(Q.store).receivePosts(e),yield(0,r.dispatch)(Us).markAsUpdated(bs(e))}))}function ms(e,t){return gs(this,void 0,void 0,(function*(){yield(0,r.dispatch)(Us).markAsUpdated(bs(e)),yield(0,r.dispatch)(Q.store).receivePosts(e),yield(0,k.showErrorNotice)(t)}))}function bs(e){return{type:"post",id:e.id,relatedPostId:e.id}}var Ts=function(e,t,s,n){return new(s||(s=Promise))((function(i,a){function r(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function Os(e){return Ts(this,void 0,void 0,(function*(){yield(0,r.dispatch)(Us).markAsSaving(!0);try{const t=yield Qt({path:"/nelio-content/v1/external-calendars/",method:"POST",data:{url:e}});yield(0,r.dispatch)(Us).receiveExternalCalendars(t),yield c(Q.store).getExternalEvents(t.url),yield(0,r.dispatch)(Us).closeExternalCalendarEditor()}catch(e){yield(0,k.showErrorNotice)(e)}yield(0,r.dispatch)(Us).markAsSaving(!1)}))}function Ss(e){return Ts(this,arguments,void 0,(function*({url:e,name:t}){yield(0,r.dispatch)(Us).markAsSaving(!0);try{const s=yield Qt({path:"/nelio-content/v1/external-calendars/",method:"PUT",data:{url:e,name:t}});yield(0,r.dispatch)(Us).receiveExternalCalendars(s)}catch(e){yield(0,k.showErrorNotice)(e)}yield(0,r.dispatch)(Us).closeExternalCalendarEditor(),yield(0,r.dispatch)(Us).markAsSaving(!1)}))}function As(e){return Ts(this,void 0,void 0,(function*(){yield(0,r.dispatch)(Us).markAsDeleting(e,!0);try{yield Qt({path:(0,Kt.addQueryArgs)("/nelio-content/v1/external-calendars/",{url:e}),method:"DELETE"}),yield(0,r.dispatch)(Us).removeExternalCalendar(e);const t=yield c(Q.store).getExternalEvents(e);yield(0,r.dispatch)(Q.store).invalidateResolution("getExternalEvents",[e]),yield(0,r.dispatch)(Q.store).removeExternalEvents(t.map((e=>e.id)))}catch(e){yield(0,k.showErrorNotice)(e)}yield(0,r.dispatch)(Us).markAsDeleting(e,!1)}))}var vs=function(e,t,s,n){return new(s||(s=Promise))((function(i,a){function r(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function Ds(){return vs(this,arguments,void 0,(function*(e=500){const t=(0,r.select)(Q.store).getToday();yield(0,r.dispatch)(Us).setFocusDay(t);try{yield(0,r.dispatch)(Us).loadItemsIn(e)}catch(e){yield(0,k.showErrorNotice)(e)}}))}function _s(){return vs(this,arguments,void 0,(function*(e=500){const t=(0,r.select)(Us).getCalendarMode(),s=(0,r.select)(Us).getFocusDay(),n=m()((0,b.wpifyDateTime)("c",s,"12:00")).clone();if("month"===t)n.date(1).add(1,"month");else{const e=(0,r.select)(Us).getNumberOfVisibleDays();n.add(e,"days")}yield(0,r.dispatch)(Us).setFocusDay((0,b.date)("Y-m-d",n));try{yield(0,r.dispatch)(Us).loadItemsIn(e)}catch(e){yield(0,k.showErrorNotice)(e)}}))}function Ps(){return vs(this,arguments,void 0,(function*(e=500){const t=(0,r.select)(Us).getCalendarMode(),s=(0,r.select)(Us).getFocusDay(),n=m()((0,b.wpifyDateTime)("c",s,"12:00")).clone();if("month"===t)n.date(1).subtract(1,"month");else{const e=(0,r.select)(Us).getNumberOfVisibleDays();n.subtract(e,"days")}yield(0,r.dispatch)(Us).setFocusDay((0,b.date)("Y-m-d",n));try{yield(0,r.dispatch)(Us).loadItemsIn(e)}catch(e){yield(0,k.showErrorNotice)(e)}}))}function Is(e){return vs(this,arguments,void 0,(function*(e,t=500){yield(0,r.dispatch)(Us)._setCalendarMode(e);try{yield(0,r.dispatch)(Us).loadItemsIn(t)}catch(e){yield(0,k.showErrorNotice)(e)}}))}const js=window.wp.hooks;var Rs=function(e,t,s,n){return new(s||(s=Promise))((function(i,a){function r(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function Ns(){return Rs(this,void 0,void 0,(function*(){try{yield Ls(0)}catch(e){yield(0,k.showErrorNotice)(e)}}))}function Ls(e){return Rs(this,void 0,void 0,(function*(){const t=(0,r.select)(Us).getLoaderTimeout();if(t&&clearTimeout(t),!e){try{yield function(){return Rs(this,void 0,void 0,(function*(){yield(0,r.dispatch)(Us).setLoaderTimeout(0);const e=(0,r.select)(Q.store).getFirstDayOfWeek(),t=(0,r.select)(Us).getFirstDay(e),s=(0,r.select)(Us).getLastDay(e);if(yield(0,r.dispatch)(Us).markPeriodAsLoading(t,s),(0,r.select)(Us).isPeriodReady(t,s))return void(yield(0,r.dispatch)(Us).markPeriodAsLoaded(t,s));const n=(0,b.date)("Y-m-d",m()(t).add(-2,"days")),i=(0,b.date)("Y-m-d",m()(s).add(2,"days"));try{yield Promise.all([ws(n,i),Ms(n,i),ks(n,i),Cs(n,i)]),yield(0,r.dispatch)(Us).markPeriodAsLoaded(t,s)}catch(e){throw yield(0,r.dispatch)(Us).markPeriodAsLoaded(t,s),e}}))}()}catch(e){yield(0,k.showErrorNotice)(e)}return}const s=setTimeout((()=>{(0,r.dispatch)(Us).loadItemsNow()}),e);yield(0,r.dispatch)(Us).setLoaderTimeout(s)}))}function ws(e,t){return Rs(this,void 0,void 0,(function*(){try{const s=(0,r.select)(Q.store).getPostTypes("calendar").map((e=>e.name)),n=yield Qt({path:(0,Kt.addQueryArgs)("/nelio-content/v1/calendar/posts",{from:e,to:t,type:s.join(",")}),method:"GET"});yield(0,r.dispatch)(Q.store).receivePosts(n)}catch(e){throw e}}))}function Cs(e,t){return Rs(this,void 0,void 0,(function*(){try{yield Promise.all((0,js.applyFilters)("nelio-content_data_loadPremiumItemsInPeriod",[new Promise((e=>e()))],e,t))}catch(e){throw e}}))}function Ms(e,t,s){return Rs(this,void 0,void 0,(function*(){try{const n=(0,r.select)(Q.store).getSiteId(),i=(0,r.select)(Q.store).getApiRoot(),a=(0,r.select)(Q.store).getAuthenticationToken(),o=yield Qt({url:(0,Kt.addQueryArgs)(`${i}/site/${n}/calendar/messages`,{from:e,to:t,page:s}),method:"GET",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${a}`}});if((0,k.isEmpty)(o.messages))return;yield(0,r.dispatch)(Q.store).receiveSocialMessages(o.messages),yield(0,r.dispatch)(Q.store).markSocialPublicationAsPaused(o.isMessagePublicationPaused),o.page&&(yield Ms(e,t,o.page))}catch(e){throw e}}))}function ks(e,t,s){return Rs(this,void 0,void 0,(function*(){try{const n=(0,r.select)(Q.store).getSiteId(),i=(0,r.select)(Q.store).getApiRoot(),a=(0,r.select)(Q.store).getAuthenticationToken(),o=yield Qt({url:(0,Kt.addQueryArgs)(`${i}/site/${n}/calendar/tasks`,{from:e,to:t,page:s}),method:"GET",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${a}`}});if((0,k.isEmpty)(o.tasks))return;yield(0,r.dispatch)(Q.store).receiveTasks(o.tasks),o.page&&(yield ks(e,t,o.page))}catch(e){throw e}}))}const Us=(0,r.createReduxStore)("nelio-content/calendar",{reducer:v,controls:r.controls,actions:Object.assign(Object.assign({},n),i),selectors:s});!function(e){(0,r.register)(e)}(Us);const xs=window.wp.i18n,Vs={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let Gs;const Fs=new Uint8Array(16),$s=[];for(let e=0;e<256;++e)$s.push((e+256).toString(16).slice(1));const Hs=function(e,t,s){if(Vs.randomUUID&&!t&&!e)return Vs.randomUUID();const n=(e=e||{}).random??e.rng?.()??function(){if(!Gs){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Gs=crypto.getRandomValues.bind(crypto)}return Gs(Fs)}();if(n.length<16)throw new Error("Random bytes length must be >= 16");if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){if((s=s||0)<0||s+16>t.length)throw new RangeError(`UUID byte range ${s}:${s+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[s+e]=n[e];return t}return function(e,t=0){return($s[e[t+0]]+$s[e[t+1]]+$s[e[t+2]]+$s[e[t+3]]+"-"+$s[e[t+4]]+$s[e[t+5]]+"-"+$s[e[t+6]]+$s[e[t+7]]+"-"+$s[e[t+8]]+$s[e[t+9]]+"-"+$s[e[t+10]]+$s[e[t+11]]+$s[e[t+12]]+$s[e[t+13]]+$s[e[t+14]]+$s[e[t+15]]).toLowerCase()}(n)},Bs=window.NelioContent.postQuickEditor,Ws=window.NelioContent.socialMessageEditor,Ys=window.NelioContent.taskEditor;const Qs=(e,t)=>o((s=>{switch(e){case"post":return s(Q.store).getPost(t);case"social":return s(Q.store).getSocialMessage(t);case"task":return s(Q.store).getTask(t);case"external-event":case"internal-event":return;default:return s(Q.store).getPremiumItem(e,t)}})),Ks=()=>o((e=>e(Us).getDraggingItem())),qs=()=>o((e=>e(Us).getHoverItem())),Xs=e=>o((t=>t(Q.store).getDefaultTime(e))),zs=e=>o((t=>{const s=t(Q.store).getToday();return e<s?"past-day":e===s?"today":"future-day"})),Zs=e=>{const t=o((t=>t(Us).areSocialMessagesCollapsedInDay(e))),{collapseSocialMessagesInDay:s}=(0,r.useDispatch)(Us);return[t,t=>s(t,e)]},Js=e=>{const t=Tn(e);return o((e=>{const{getNumberOfNonCollapsableMessages:s}=e(Us),n=(0,g.filter)(t,{type:"social"}),i=s();return Math.max(0,n.length-i)}))},en=e=>{const t=Tn(e),s=zs(e),n=Js(e);return o((i=>{const{areSocialMessagesCollapsedInDay:a}=i(Us);if(!a(e))return t;const r=(0,g.filter)(t,On),o=r.length-n;if(!n)return t;const{getSocialMessage:c}=i(Q.store),d=(0,g.filter)(r,(({id:e})=>{var t;return"past-day"!==s||!!(null===(t=c(e))||void 0===t?void 0:t.sent)})),u=(0,g.map)((0,g.drop)(d,o),"id");return(0,g.filter)(t,(({id:e,type:t})=>"social"!==t||!u.includes(e)))}))},tn=(e,t)=>{const s=Qs(e,t);if(!s)return mn;if("post"===e&&!Sn(s))return mn;const n=(0,k.isFreeItemType)(e)?(0,k.createItemSummary)(e,s):(0,k.createPremiumItemSummary)(e,s);return n?{onMouseEnter:()=>bn(n),onMouseLeave:()=>bn()}:mn},sn=e=>{const{dragEnd:t,dragStart:s}=(0,r.useDispatch)(Us);return e?{onDragStart:()=>{s(e)},onDragEnd:()=>{t()}}:An},nn=(e,t)=>o((s=>{if(s(Q.store),!e||!t)return;const n=s(Q.store).getPostStatuses(e);return(0,g.find)(n,{slug:t})})),an=()=>o((e=>{const t=(0,xs._x)("Add New Post","command","nelio-content"),{getPostTypes:s}=e(Q.store),n=s("calendar");return 1===n.length&&n[0]&&n[0].labels.new||t})),rn=()=>o((e=>e(Q.store).canCurrentUserCreatePosts())),on=()=>o((e=>e(Q.store).canCurrentUserCreateMessagesAlways())),cn=()=>o((e=>e(Q.store).canCurrentUserCreateTasksAlways())),dn=(e,t)=>{const{openNewPostEditor:s}=(0,r.useDispatch)(Bs.store);return()=>s("calendar",{dateValue:e,timeValue:t})},un=(e,t)=>{const s=e===gn(),n=on(),i=(0,Q.useFeatureGuard)("calendar/create-messages",n),{openNewSocialMessageEditor:a}=(0,r.useDispatch)(Ws.store);return i((()=>a({dateType:s?"predefined-offset":"exact",dateValue:s?"0":e,timeType:s?"predefined-offset":"exact",timeValue:s?"0":t},{context:"calendar"})))},ln=e=>{const t=cn(),s=(0,Q.useFeatureGuard)("calendar/create-tasks",t),{openNewTaskEditor:n}=(0,r.useDispatch)(Ys.store);return s((()=>n({dateType:"exact",dateValue:e},{post:void 0,context:"calendar"})))},gn=()=>o((e=>e(Q.store).getToday())),yn=(e,t)=>{const{dragEnd:s,reschedulePost:n,rescheduleSocialMessage:i,requestRecurringRescheduleMode:a,rescheduleTask:o}=(0,r.useDispatch)(Us),c=(0,Q.useFeatureGuard)("calendar/schedule-reusable-messages"),d=s=>{if("reusable-message"===s.type)return c((()=>function(e,t,s){return n=this,i=void 0,o=function*(){var n;const i=(0,r.select)(Q.store).getReusableMessage(e);if(!i)return;const a={dateType:"exact",dateValue:t,timeType:"exact",timeValue:"exact"===i.timeType?i.timeValue:vn(i.timeValue,s)},o=Object.assign(Object.assign(Object.assign(Object.assign({},(0,k.createSocialMessage)()),i),a),{id:Hs(),schedule:(0,k.getSocialMessageSchedule)(Object.assign({baseDatetime:"now"},a))}),c=(0,k.createItemSummary)("social",o);yield(0,r.dispatch)(Q.store).receiveSocialMessages(o),yield(0,r.dispatch)(Us).markAsUpdating(c);try{const e=(0,r.select)(Q.store).getSiteId(),t=(0,r.select)(Q.store).getApiRoot(),s=(0,r.select)(Q.store).getAuthenticationToken(),i=(0,r.select)(Q.store).getSiteTimezone(),a=yield Qt({url:`${t}/site/${e}/social`,method:"POST",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${s}`},data:Object.assign(Object.assign({},o),{baseDatetime:"now",timezone:i,slots:[{id:o.id,profileId:o.profileId,targetName:null!==(n=o.targetName)&&void 0!==n?n:"default",network:o.network,type:o.type}]})});yield(0,r.dispatch)(Q.store).receiveSocialMessages(a)}catch(e){yield(0,r.dispatch)(Q.store).removeSocialMessage(o.id),yield(0,k.showErrorNotice)(e)}yield(0,r.dispatch)(Us).markAsUpdated(c)},new((a=void 0)||(a=Promise))((function(e,t){function s(e){try{c(o.next(e))}catch(e){t(e)}}function r(e){try{c(o.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(s,r)}c((o=o.apply(n,i||[])).next())}));var n,i,a,o}(s.id,e,t)))();const{id:d,type:u}=s,l=(0,r.select)(Q.store).getItem(u,d);if(!l)return;const y=t?function(e,t,s){if("task"===e)return"";const n=(0,k.extractDateTimeValues)("post"===e?t.date:t.schedule);if(!n)return"";const{timeValue:i}=n,a=Number.parseInt(i.substring(0,2)),r=Number.parseInt(i.substring(3,5)),o=a%4+s;return(0,g.padStart)(`${o}`,2,"0")+":"+(0,g.padStart)(`${r}`,2,"0")}(u,l,t):void 0;switch(u){case"post":return n(d,e,y);case"social":{const t=(0,r.select)(Q.store).getSocialMessage(d);return(0,k.isRecurringMessage)(t)&&!(0,k.isRecurringSource)(t)?a({id:d,day:e,hour:y}):i(d,e,y)}case"task":return o(d,e)}};return e=>(s(),d(e),e)},pn=()=>o((e=>e(Us).getMinimumRowHeight())),fn=()=>o((e=>{const t=e(Q.store).getFirstDayOfWeek();return e(Us).getFirstDay(t)})),hn=()=>o((e=>e(Us).getNumberOfVisibleDays())),En=()=>{const e=Dn();return o((t=>{const{getDraggingItem:s,getSidePane:n}=t(Us),i=s(),a=n();if("none"!==a)switch(null==i?void 0:i.type){case"post":return"unscheduled-posts";case"reusable-message":return"reusable-messages"}return"none"===a&&e?"subscribe-banner":a}))},mn={onMouseEnter:()=>{},onMouseLeave:()=>{}},bn=(0,g.debounce)((0,r.dispatch)(Us).setHoverItem,200),Tn=e=>o((t=>{const{getItem:s,getItemsInDay:n}=t(Q.store),{isItemVisible:i}=t(Us);return(0,g.filter)(n(e),(({id:e,type:t})=>{const n=s(t,e);return!!n&&i(t,n)}))})),On=e=>"social"===e.type,Sn=e=>!!e.date,An={onDragStart:()=>{},onDragEnd:()=>{}};function vn(e,t){const s=e=>e<10?`0${e}`:e,n=s(Math.floor(60*Math.random()));if(t)return`${s(t)}:${n}`;switch(t=Math.floor(4*Math.random()),e){case"morning":return`${s(t+8)}:${n}`;case"noon":return`${s(t+12)}:${n}`;case"afternoon":return`${s(t+16)}:${n}`;case"night":return`${s(t+20)}:${n}`;default:return`10:${n}`}}const Dn=()=>o((e=>!e(Q.store).isSubscribed()&&1200<=e(Us).getCalendarWidth()))})();var s=NelioContent="undefined"==typeof NelioContent?{}:NelioContent;for(var n in t)s[n]=t[n];t.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();