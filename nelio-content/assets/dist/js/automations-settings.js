(()=>{var e,t={8312:(e,t,n)=>{"use strict";n.r(t),n.d(t,{initPage:()=>ms});var i={};n.r(i),n.d(i,{areAuthorsValid:()=>G,getAutomationGroup:()=>b,getAutomationGroups:()=>x,getCustomFields:()=>P,getCustomPlaceholders:()=>R,getEditingTemplate:()=>N,getEditingTemplateErrors:()=>E,getEditingTemplateType:()=>A,getGroupTermsValidation:()=>M,getImportExportData:()=>L,getNetworkAutomationSettings:()=>k,getProfileAutomationSettings:()=>j,getProfileError:()=>$,getProfileFrequencies:()=>C,getTemplateErrors:()=>U,isDirty:()=>T,isEditingNetworkTemplate:()=>I,isEditingNewTemplate:()=>S,isEditingTemplate:()=>O,isGroupValid:()=>D,isPostTypeValid:()=>Z,isSaving:()=>w,isTemplateValid:()=>F});var o={};n.r(o),n.d(o,{addAutomationGroup:()=>V,addProfileSettings:()=>B,closeTemplateEditor:()=>z,closeTemplateImportExport:()=>W,deleteAutomationGroup:()=>K,deleteAutomationGroupTemplate:()=>J,initAutomationGroups:()=>H,markAsNetworkTemplate:()=>oe,markAsSaving:()=>ae,openTemplateEditor:()=>Y,openTemplateExporter:()=>Q,openTemplateImporter:()=>X,receiveAutomationGroupTemplates:()=>ee,receiveCustomFields:()=>te,receiveCustomPlaceholders:()=>ne,setAutomationGroupValidation:()=>se,setEditingTemplateAttributes:()=>re,setEditingTemplateErrors:()=>le,setProfileFrequencies:()=>ie,updateAutomationGroup:()=>q});var a={};n.r(a),n.d(a,{saveAutomationGroups:()=>he});var s={};n.r(s),n.d(s,{getCustomFields:()=>ke,getCustomPlaceholders:()=>Te});var r={};n.r(r),n.d(r,{BRAND:()=>sa,DIRTY:()=>Ui,EMPTY_PATH:()=>Mi,INVALID:()=>Fi,NEVER:()=>Qa,OK:()=>Li,ParseStatus:()=>$i,Schema:()=>Yi,ZodAny:()=>Ao,ZodArray:()=>Zo,ZodBigInt:()=>wo,ZodBoolean:()=>Oo,ZodBranded:()=>ra,ZodCatch:()=>oa,ZodDate:()=>So,ZodDefault:()=>ia,ZodDiscriminatedUnion:()=>Fo,ZodEffects:()=>ea,ZodEnum:()=>Yo,ZodError:()=>Ai,ZodFirstPartyTypeKind:()=>ma,ZodFunction:()=>Wo,ZodIntersection:()=>Lo,ZodIssueCode:()=>Ni,ZodLazy:()=>Ko,ZodLiteral:()=>Jo,ZodMap:()=>Bo,ZodNaN:()=>aa,ZodNativeEnum:()=>Xo,ZodNever:()=>Po,ZodNull:()=>Eo,ZodNullable:()=>na,ZodNumber:()=>To,ZodObject:()=>Mo,ZodOptional:()=>ta,ZodParsedType:()=>Si,ZodPipeline:()=>la,ZodPromise:()=>Qo,ZodReadonly:()=>ca,ZodRecord:()=>qo,ZodSchema:()=>Yi,ZodSet:()=>zo,ZodString:()=>jo,ZodSymbol:()=>Io,ZodTransformer:()=>ea,ZodTuple:()=>Vo,ZodType:()=>Yi,ZodUndefined:()=>No,ZodUnion:()=>Do,ZodUnknown:()=>Co,ZodVoid:()=>Ro,addIssueToContext:()=>Di,any:()=>Ta,array:()=>Ia,bigint:()=>_a,boolean:()=>va,coerce:()=>Xa,custom:()=>da,date:()=>xa,datetimeRegex:()=>_o,defaultErrorMap:()=>Ci,discriminatedUnion:()=>Ca,effect:()=>qa,enum:()=>Ua,function:()=>Da,getErrorMap:()=>Zi,getParsedType:()=>Ii,instanceof:()=>ha,intersection:()=>Pa,isAborted:()=>Vi,isAsync:()=>zi,isDirty:()=>qi,isValid:()=>Bi,late:()=>pa,lazy:()=>$a,literal:()=>Fa,makeIssue:()=>Gi,map:()=>Ga,nan:()=>ya,nativeEnum:()=>La,never:()=>Oa,null:()=>ka,nullable:()=>za,number:()=>fa,object:()=>Na,objectUtil:()=>Oi,oboolean:()=>Ya,onumber:()=>Ha,optional:()=>Ba,ostring:()=>Ja,pipeline:()=>Ka,preprocess:()=>Wa,promise:()=>Va,quotelessJson:()=>Ei,record:()=>Za,set:()=>Ma,setErrorMap:()=>Ri,strictObject:()=>Ea,string:()=>ga,symbol:()=>ba,transformer:()=>qa,tuple:()=>Ra,undefined:()=>ja,union:()=>Aa,unknown:()=>wa,util:()=>wi,void:()=>Sa});const l=window.ReactJSXRuntime,c=window.wp.element;function u(e,t){t&&(c.createRoot?(0,c.createRoot)(t).render(e):(0,c.render)(e,t))}const d=window.wp.i18n,p=window.NelioContent.components,m=window.wp.data;function h(e,t){return(0,m.useSelect)(e,t)}const g=window.lodash,f=window.NelioContent.utils,y={automationGroups:{byId:{universal:{id:"universal",priority:100,publication:{type:"always"},profileSettings:{},networkSettings:{}}},allIds:["universal"]},validations:{universal:{areAuthorsValid:!0,areTermsValid:{},isPostTypeValid:!0,socialProfileErrors:{},templateErrors:{}}},frequencies:{},isSaving:!1,templateEditor:{attributes:void 0,isNew:!1,isNetwork:!1,customFields:{},customPlaceholders:{},errors:{author:!1,target:!1,content:!1,availability:!1,taxonomies:{}}},templateImportExport:void 0};function _(e,t){return(0,g.isEqual)((0,g.omit)((0,g.omitBy)(e,g.isNil),["groupId","id","creatorId"]),(0,g.omit)((0,g.omitBy)(t,g.isNil),["groupId","id","creatorId"]))}function v(e){const t=e.automationGroups.byId;return Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign({universal:(0,f.fixAttributesInGroup)(t.universal)},(0,g.mapValues)((0,g.omit)(t,"universal"),f.fixAttributesInGroup))})})}function x(e){return e.automationGroups.allIds}function b(e,t){return e.automationGroups.byId[t]}function j(e,t,n){var i;return(0,g.find)(null===(i=b(e,t))||void 0===i?void 0:i.profileSettings,{profileId:n})}function k(e,t,n){var i;return(0,g.find)(null===(i=b(e,t))||void 0===i?void 0:i.networkSettings,{name:n})}function T(e,t,n){const i=(0,g.values)(e.automationGroups.byId),o=t;return n.some(t=>{const n=e.frequencies[t.id];return(null==n?void 0:n.publication)!==Math.max(1,t.publicationFrequency)||(null==n?void 0:n.reshare)!==Math.max(1,t.reshareFrequency)})||JSON.stringify(i)!==JSON.stringify(o)}function w(e){return!!e.isSaving}function O(e){return!!e.templateEditor.attributes}function S(e){return O(e)&&e.templateEditor.isNew}function I(e){return O(e)&&e.templateEditor.isNetwork}function N(e){const t=e.templateEditor.attributes;return t?(0,g.omit)(t,"type"):void 0}function E(e){return e.templateEditor.errors}function A(e){var t;return(null===(t=e.templateEditor.attributes)||void 0===t?void 0:t.type)||"publication"}function C(e,t){return e.frequencies[t]}function P(e){return e.templateEditor.customFields}function R(e){return e.templateEditor.customPlaceholders}function Z(e,t){var n,i;return null===(i=null===(n=e.validations[t])||void 0===n?void 0:n.isPostTypeValid)||void 0===i||i}function G(e,t){var n,i;return null===(i=null===(n=e.validations[t])||void 0===n?void 0:n.areAuthorsValid)||void 0===i||i}function M(e,t){var n;return(null===(n=e.validations[t])||void 0===n?void 0:n.areTermsValid)||{}}function D(e,t){var n;const i=(0,g.values)(M(e,t)).every(Boolean);return Z(e,t)&&G(e,t)&&i&&(0,g.keys)(null===(n=b(e,t))||void 0===n?void 0:n.profileSettings).every(n=>!$(e,t,n))}function $(e,t,n){var i;const o=null===(i=e.validations[t])||void 0===i?void 0:i.socialProfileErrors[n];if(o)return o;const a=j(e,t,n);if(!a)return!1;const s=k(e,t,a.network),r=n=>!n||(e=>"enabled"in e&&!e.enabled)(n)||(0,g.map)(n.templates,"id").every(n=>F(e,t,n));return r(a.publication)&&r(null==s?void 0:s.publication)?(!r(a.reshare)||!r(null==s?void 0:s.reshare))&&(0,d._x)("Please review reshare templates","text","nelio-content"):(0,d._x)("Please review publication templates","user","nelio-content")}function F(e,t,n){var i;const o=null===(i=e.validations[t])||void 0===i?void 0:i.templateErrors[n];return(0,g.keys)((0,g.omit)(o,"taxonomies")).every(e=>!(null==o?void 0:o[e]))&&(0,g.keys)(null==o?void 0:o.taxonomies).every(e=>!(null==o?void 0:o.taxonomies[e]))}function U(e,t,n){var i;return null===(i=e.validations[t])||void 0===i?void 0:i.templateErrors[n]}function L(e){return e.templateImportExport}function V(e){return{type:"ADD_AUTOMATION_GROUP",group:e}}function q(e,t){return{type:"UPDATE_AUTOMATION_GROUP",groupId:e,attrs:t}}function B(e,t){return{type:"ADD_PROFILE_SETTINGS",groupId:e,settings:t}}function z(){return{type:"CLOSE_TEMPLATE_EDITOR"}}function W(){return{type:"CLOSE_TEMPLATE_IMPORT_EXPORT"}}function K(e){return{type:"DELETE_AUTOMATION_GROUP",groupId:e}}function J(e){return{type:"DELETE_AUTOMATION_GROUP_TEMPLATE",template:e}}function H(e,t){return{type:"INIT_AUTOMATION_GROUPS",automationGroups:e,profiles:t}}function Y(e,t,n){return{type:"OPEN_TEMPLATE_EDITOR",template:Object.assign(Object.assign({},t),{type:e}),isNew:"new"===n}}function X(e,t,n){return{type:"OPEN_TEMPLATE_IMPORTER",groupId:e,profileId:t,templateType:n}}function Q(e){return{type:"OPEN_TEMPLATE_EXPORTER",templates:(0,g.castArray)(e)}}function ee(e,t){return{type:"RECEIVE_AUTOMATION_GROUP_TEMPLATES",templateType:e,templates:(0,g.castArray)(t)}}function te(e){return{type:"RECEIVE_CUSTOM_FIELDS",customFields:e}}function ne(e){return{type:"RECEIVE_CUSTOM_PLACEHOLDERS",customPlaceholders:e}}function ie(e,t){return{type:"SET_PROFILE_FREQUENCIES",profileId:e,frequencies:t}}function oe(e){return{type:"MARK_AS_NETWORK_TEMPLATE",isNetwork:e}}function ae(e){return{type:"MARK_AS_SAVING",isSaving:e}}function se(e,t){return{type:"SET_AUTOMATION_GROUP_VALIDATION",groupId:e,validation:t}}function re(e){return{type:"SET_EDITING_TEMPLATE_ATTRIBUTES",attributes:e}}function le(e){return{type:"SET_EDITING_TEMPLATE_ERRORS",errors:e}}const ce=window.wp.apiFetch,ue=n.n(ce)(),de=window.wp.coreData,pe=window.NelioContent.data;var me=function(e,t,n,i){return new(n||(n=Promise))(function(o,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,r)}l((i=i.apply(e,t||[])).next())})};function he(){return me(this,void 0,void 0,function*(){yield(0,m.dispatch)(Oe).markAsSaving(!0);const{getAutomationGroup:e,getAutomationGroups:t}=(0,m.select)(Oe),n=yield Promise.all(t().map(e).filter(f.isDefined).map(ye));try{const e=(0,m.select)(pe.store).getSiteId(),t=(0,m.select)(pe.store).getApiRoot(),i=(0,m.select)(pe.store).getAuthenticationToken(),o=yield ge(),a=yield ue({url:`${t}/site/${e}/automation-groups`,method:"PUT",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${i}`},data:n});yield(0,m.dispatch)(Oe).initAutomationGroups(a,o),yield(0,m.dispatch)(pe.store).resetAutomationGroups(a)}catch(e){yield(0,f.showErrorNotice)(e)}yield(0,m.dispatch)(Oe).markAsSaving(!1)})}const ge=()=>me(void 0,void 0,void 0,function*(){return Promise.all((0,m.select)(pe.store).getSocialProfiles().map(e=>me(void 0,void 0,void 0,function*(){if(!fe(e))return e;const t=(0,m.select)(Oe).getProfileFrequencies(e.id);if(!t)return e;const n=(0,m.select)(pe.store).getSiteId(),i=(0,m.select)(pe.store).getApiRoot(),o=(0,m.select)(pe.store).getAuthenticationToken(),a=yield ue({url:`${i}/site/${n}/profile/${e.id}`,method:"PUT",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${o}`},data:{publicationFrequency:t.publication,reshareFrequency:t.reshare}});return yield(0,m.dispatch)(pe.store).receiveSocialProfiles(a),a})))}),fe=e=>{const t=(0,m.select)(Oe).getProfileFrequencies(e.id);return(null==t?void 0:t.publication)!==e.publicationFrequency||(null==t?void 0:t.reshare)!==e.reshareFrequency},ye=e=>me(void 0,void 0,void 0,function*(){if((0,f.isUniversalGroup)(e))return e;const t=yield be(e.postType),n=xe(e.postType),i=_e({taxonomies:t,supportsAuthors:n});return Object.assign(Object.assign({},e),{authors:!1===n?[]:e.authors,taxonomies:(0,g.pick)(e.taxonomies,t),profileSettings:(0,g.mapValues)(e.profileSettings,i),networkSettings:(0,g.pickBy)((0,g.mapValues)(e.networkSettings,i),e=>!(!e||!e.publication.templates.length&&!e.reshare.templates.length))})}),_e=e=>t=>{const n=ve(e);return Object.assign(Object.assign({},t),{publication:Object.assign(Object.assign({},t.publication),{templates:(0,g.map)(t.publication.templates,n)}),reshare:Object.assign(Object.assign({},t.reshare),{templates:(0,g.map)(t.reshare.templates,n)})})},ve=e=>t=>Object.assign(Object.assign({},t),{author:!1===e.supportsAuthors?void 0:t.author,taxonomies:(0,g.pick)(t.taxonomies,e.taxonomies)}),xe=e=>{var t;return null===(t=(0,m.select)(pe.store).getPostType(e))||void 0===t?void 0:t.supports.author},be=e=>me(void 0,void 0,void 0,function*(){const{getEntityRecords:t}=(n=de.store,(0,m.resolveSelect)(n));var n;const i=yield t("root","taxonomy",{per_page:-1});return(0,g.castArray)(i).filter(e=>!!e).filter(t=>t.types.includes(e)).map(e=>e.slug)});var je=function(e,t,n,i){return new(n||(n=Promise))(function(o,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,r)}l((i=i.apply(e,t||[])).next())})};function ke(){return je(this,void 0,void 0,function*(){const e=yield ue({path:"/nelio-content/v1/custom-fields"});yield(0,m.dispatch)(Oe).receiveCustomFields(e)})}function Te(){return je(this,void 0,void 0,function*(){const e=yield ue({path:"/nelio-content/v1/custom-placeholders"});yield(0,m.dispatch)(Oe).receiveCustomPlaceholders(e)})}const we=Object.assign(Object.assign({},o),a),Oe=(0,m.createReduxStore)("nelio-content/automation-settings",{reducer:function(e=y,t){var n;return null!==(n=function(e,t){switch(t.type){case"ADD_AUTOMATION_GROUP":{if(e.automationGroups.byId[t.group.id])return e;const n=Object.assign(Object.assign({},e.automationGroups.byId),{[t.group.id]:t.group});return v(Object.assign(Object.assign({},e),{automationGroups:{byId:n,allIds:["universal",...(0,g.keys)(n).filter(e=>"universal"!==e)]}}))}case"UPDATE_AUTOMATION_GROUP":return e.automationGroups.byId[t.groupId]?"universal"===t.groupId?v(Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign(Object.assign({},e.automationGroups.byId),{universal:Object.assign(Object.assign({},e.automationGroups.byId.universal),t.attrs)})})})):v(Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign(Object.assign({},e.automationGroups.byId),{[t.groupId]:Object.assign(Object.assign({},e.automationGroups.byId[t.groupId]),t.attrs)})})})):e;case"ADD_PROFILE_SETTINGS":{const n=e.automationGroups.byId[t.groupId];if(!n)return e;const i=Object.assign(Object.assign({},n),{profileSettings:Object.assign(Object.assign({},n.profileSettings),{[t.settings.profileId]:t.settings})});return v(Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign(Object.assign({},e.automationGroups.byId),{[i.id]:i})})}))}case"CLOSE_TEMPLATE_EDITOR":return Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{attributes:void 0,isNew:!1})});case"CLOSE_TEMPLATE_IMPORT_EXPORT":return Object.assign(Object.assign({},e),{templateImportExport:void 0});case"DELETE_AUTOMATION_GROUP":return e.automationGroups.allIds.includes(t.groupId)?Object.assign(Object.assign({},e),{automationGroups:{byId:(0,g.omit)(e.automationGroups.byId,t.groupId),allIds:["universal",...(0,g.without)((0,g.filter)(e.automationGroups.allIds,e=>"universal"!==e),t.groupId)]}}):e;case"DELETE_AUTOMATION_GROUP_TEMPLATE":return v(function(e,t){var n;const i=e.automationGroups.byId[t.groupId];if(!i)return e;const o=t.profileId?"profileSettings":"networkSettings",a=null!==(n=t.profileId)&&void 0!==n?n:t.network,s=t.profileId?i.profileSettings[t.profileId]:i.networkSettings[t.network];return s?Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign(Object.assign({},e.automationGroups.byId),{[t.groupId]:Object.assign(Object.assign({},i),{[o]:Object.assign(Object.assign({},i[o]),{[a]:Object.assign(Object.assign({},s),{publication:Object.assign(Object.assign({},s.publication),{templates:s.publication.templates.filter(e=>e.id!==t.id)}),reshare:Object.assign(Object.assign({},s.reshare),{templates:s.reshare.templates.filter(e=>e.id!==t.id)})})})})})})}):e}(e,t.template));case"INIT_AUTOMATION_GROUPS":return v(Object.assign(Object.assign({},e),{automationGroups:{byId:Object.assign({universal:e.automationGroups.byId.universal},(0,g.keyBy)(t.automationGroups,"id")),allIds:["universal",...(0,g.map)(t.automationGroups,"id").filter(e=>"universal"!==e)]},frequencies:(0,g.mapValues)((0,g.keyBy)(t.profiles,"id"),e=>({publication:Math.max(1,e.publicationFrequency),reshare:Math.max(1,e.reshareFrequency)}))}));case"OPEN_TEMPLATE_EDITOR":return Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{attributes:t.template,isNew:t.isNew,isNetwork:!t.isNew&&!t.template.profileId})});case"OPEN_TEMPLATE_IMPORTER":return Object.assign(Object.assign({},e),{templateImportExport:Object.assign({mode:"import"},(0,g.omit)(t,"type"))});case"OPEN_TEMPLATE_EXPORTER":return Object.assign(Object.assign({},e),{templateImportExport:Object.assign({mode:"export"},(0,g.omit)(t,"type"))});case"MARK_AS_NETWORK_TEMPLATE":return e.templateEditor.attributes&&e.templateEditor.isNew?Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{isNetwork:t.isNetwork})}):e;case"MARK_AS_SAVING":return Object.assign(Object.assign({},e),{isSaving:t.isSaving});case"RECEIVE_AUTOMATION_GROUP_TEMPLATES":return(0,g.reduce)(t.templates,(n=t.templateType,(e,t)=>{var i;const o=null!==(i=t.profileId)&&void 0!==i?i:t.network,a=e.automationGroups.byId[t.groupId];if(!a)return e;const s=t.profileId?a.profileSettings:a.networkSettings,r=s[o];if(!r)return e;const l=r[n].templates;return Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign(Object.assign({},e.automationGroups.byId),{[t.groupId]:Object.assign(Object.assign({},a),{[t.profileId?"profileSettings":"networkSettings"]:Object.assign(Object.assign({},s),{[o]:Object.assign(Object.assign({},r),{[n]:Object.assign(Object.assign({},r[n]),{templates:(0,g.uniqWith)((0,g.values)(Object.assign(Object.assign({},(0,g.keyBy)(l,"id")),{[t.id]:t})),_)})})})})})})})}),e);case"RECEIVE_CUSTOM_FIELDS":return Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{customFields:t.customFields})});case"RECEIVE_CUSTOM_PLACEHOLDERS":return Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{customPlaceholders:t.customPlaceholders})});case"SET_PROFILE_FREQUENCIES":{const n=e.frequencies[t.profileId];return n?Object.assign(Object.assign({},e),{frequencies:Object.assign(Object.assign({},e.frequencies),{[t.profileId]:Object.assign(Object.assign({},n),t.frequencies)})}):e}case"SET_AUTOMATION_GROUP_VALIDATION":return Object.assign(Object.assign({},e),{validations:Object.assign(Object.assign({},e.validations),{[t.groupId]:t.validation})});case"SET_EDITING_TEMPLATE_ATTRIBUTES":return e.templateEditor.attributes?Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{attributes:Object.assign(Object.assign({},e.templateEditor.attributes),t.attributes)})}):e;case"SET_EDITING_TEMPLATE_ERRORS":return e.templateEditor.attributes?Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{errors:t.errors})}):e}var n}(e,t))&&void 0!==n?n:e},controls:m.controls,actions:we,selectors:i,resolvers:s});!function(e){(0,m.register)(e)}(Oe);const Se=[{title:(0,d._x)("Settings - Social Automations","text","nelio-content"),intro:(0,d._x)("Welcome to the Social Automations Screen. Here you can customize which content from your site can be automatically shared by Nelio Content and where it should be shared.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item")},{title:(0,d._x)("Automation Groups","text","nelio-content"),intro:(0,d._x)("An Automation Group allows you to select some content from your WordPress site and customize where and how it should be shared.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item"),element:()=>document.querySelector(".nelio-content-automation-group:first-child")},{title:(0,d._x)("Automation Groups","text","nelio-content"),intro:(0,d._x)("In general, the first section of an automation group lets you filter your WordPress content by its type, taxonomies, author, and publication date.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item"),element:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group-settings__section")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item")},{title:(0,d._x)("Automation Groups","text","nelio-content"),intro:(0,d._x)("However, the Universal Group limits this selection to the publication date only.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item"),element:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group-settings__extra")},{title:(0,d._x)("Automation Groups","text","nelio-content"),intro:(0,d._x)("Once you’ve established which content is shareable, you can select the social profiles where Nelio Content is allowed to share it.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item"),element:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group-settings__section + .nelio-content-automation-group-settings__section")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item")},{title:(0,d._x)("Automation Groups","text","nelio-content"),intro:(0,d._x)("Click on each social profile to toggle it. If it’s selected, Nelio Content might use it to share content on your behalf.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item"),element:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group-settings__section + .nelio-content-automation-group-settings__section")},{title:(0,d._x)("Social Profile Settings","text","nelio-content"),intro:(0,d._x)("Active social profiles will show up here. Click on any profile to further customize how Nelio Content should use it to share your content.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)"),element:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar")},{title:(0,d._x)("Social Profile Settings","text","nelio-content"),intro:(0,d.sprintf)(/* translators: 1 -> a dashicon, 2 -> another dashicon */ /* translators: 1 -> a dashicon, 2 -> another dashicon */
(0,d._x)("In particular, you can customize if and how Nelio Content should share content on publication (%1$s) and on reshare (%2$s).","user","nelio-content"),'<span class="dashicons dashicons-megaphone"></span>','<span class="dashicons dashicons-share-alt"></span>'),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)"),element:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-profile-settings__tab-selector")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar")},{title:(0,d._x)("Social Profile Settings","text","nelio-content"),intro:(0,d._x)("If you enable social automations for a profile, you’ll be able to specify how many social messages should be created by Nelio Content when sharing new content, as well as the Social Templates is should use to do so, thus setting the tone of your auto-publications. Please notice the number of messages you set in one automation group is actually shared across all your groups.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)"),element:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-templates")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-profile-settings")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-profile-settings")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar")},{title:(0,d._x)("Duplicate and Delete","text","nelio-content"),intro:(0,d._x)("You can easily duplicate an existing group or delete it using the actions here.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)"),element:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-actions")},{title:(0,d._x)("Temporary Deactivation","text","nelio-content"),intro:(0,d._x)("If you want to disable a set of posts from being auto-shared, you can easily do so by toggling this button in the desired automation group.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)"),element:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__header-content-activation-toggle")},{title:(0,d._x)("Save Changes","text","nelio-content"),intro:(0,d._x)("Once you’re happy with your setup, don’t forget to save your changes using this button!","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item"),element:()=>document.querySelector(".nelio-content-save-automation-groups")}],Ie=window.wp.components,Ne=window.wp.notices,Ee=window.NelioContent.networks,Ae=()=>h(e=>{const{getAutomationGroup:t,getAutomationGroups:n,getSocialProfiles:i}=e(pe.store),o=n().map(t).filter(f.isDefined),a=i();return e(Oe).isDirty(o,a)});function Ce(e){return h(t=>{const{getAutomationGroup:n}=t(Oe);return e?n(e):void 0})}const Pe=(e,t)=>{const n=Ce(e),{updateAutomationGroup:i}=(0,m.useDispatch)(Oe);return[n?n[t]:void 0,o=>{n&&i(e,{[t]:o})}]},Re=e=>{const t=(0,g.map)(Ze(e),"slug");return h(e=>{const{hasFinishedResolution:n,hasResolutionFailed:i,getEntityRecords:o}=e(de.store),a=(e,t)=>n(e,t)||i(e,t),s={per_page:10,context:"edit",search:"",page:1,exclude:[]},r={per_page:10,context:"view",search:"",page:1,exclude:[],who:"authors"};return t.forEach(e=>o("taxonomy",e,s)),o("root","user",r),[...t.map(e=>a("getEntityRecords",["taxonomy",e,s])),a("getEntityRecords",["root","user",r])]}).every(Boolean)},Ze=e=>ze()[e||"nc_any"]||[],Ge=e=>!!We()[e||"nc_any"],Me=(e,t)=>{const n=We(),i=(0,g.mapValues)(ze(),e=>(0,g.map)(e,"slug")),o=Ve(t);return h(a=>{const{getEntityRecord:s,hasFinishedResolution:r,hasResolutionFailed:l}=a(de.store),c=(e,t,n)=>{return!(n&&!s(e,t,n,{context:"user"===t?"view":"edit"})&&(i="getEntityRecord",o=[e,t,n,{context:"user"===t?"view":"edit"}],r(i,o)||l(i,o)));var i,o},u=(e,t)=>!t||!(null==e?void 0:e.length)||e.includes(t);return e?(0,g.mapValues)((0,g.keyBy)((0,g.castArray)(t),"id"),t=>{var a;return{target:!!t.profileId&&!!(0,Ee.doesNetworkSupport)("multi-target",t.network)&&!t.targetName&&(0,Ee.getTargetLabel)("selectTargetError",t.network),content:null!==(a=o[t.id])&&void 0!==a&&a,availability:!!t.availability&&Ke(t.availability),author:Ye({doesAuthorExist:c("root","user",t.author),isAuthorSupported:!!n[t.postType||"nc_any"],isGroupAuthor:(0,f.isUniversalGroup)(e)||u(e.authors,t.author)}),taxonomies:(0,g.pick)((0,g.mapValues)(t.taxonomies,(t,n)=>Xe({doesTermExist:c("taxonomy",n,t),isGroupTerm:(0,f.isUniversalGroup)(e)||u(e.taxonomies[n],t)})),i[t.postType||"nc_any"]||[])}}):{}},[JSON.stringify(n),JSON.stringify(i),JSON.stringify(o),JSON.stringify(t)])},De=()=>h(e=>e(Oe).isSaving()),$e=e=>{const t=(0,pe.usePostTypes)("social");if(!e)return(0,d._x)("All Content","text","nelio-content");const n=t.find(t=>t.name===e);return(null==n?void 0:n.labels.plural)||(0,d.sprintf)(/* translators: post type name */ /* translators: post type name */
(0,d._x)("Post type %s","text","nelio-content"),e)},Fe=e=>{const t=h(t=>{const{getEntityRecord:n}=t(de.store);return e.map(e=>n("root","user",e,{context:"view"})).map(e=>null==e?void 0:e.name).filter(f.isDefined)});return t.length?(0,d.sprintf)(/* translators: author name(s) */ /* translators: author name(s) */
(0,d._x)("by %s","text","nelio-content"),(0,f.listify)("or",t)):""},Ue=(e,t)=>{var n,i,o,a,s,r,l,c;const u=(0,g.map)(Ze(e),"slug"),p=(0,g.keys)(t).filter(e=>u.includes(e)),m=h(e=>{const{getEntityRecord:t}=e(de.store),n=p.map(e=>t("root","taxonomy",e)).map(e=>null==e?void 0:e.labels.singular_name);return(0,g.pickBy)((0,g.zipObject)(p,n),e=>"string"==typeof e)},[JSON.stringify(p)]),y=(0,g.pick)(t,p),_=h(e=>{const{getEntityRecord:t}=e(de.store);return(0,g.mapValues)(y,(e,n)=>e.map(e=>t("taxonomy",n,e,{context:"edit"})).map(e=>null==e?void 0:e.name).filter(f.isDefined))},[JSON.stringify(y)]),v=(0,g.keys)(m).filter(e=>{var t;return!!(null===(t=_[e])||void 0===t?void 0:t.length)}),x=!!(null===(n=_[f.CAT])||void 0===n?void 0:n.length)||!!(null===(i=_[f.PROD_CAT])||void 0===i?void 0:i.length),b=!!(null===(o=_[f.TAG])||void 0===o?void 0:o.length)||!!(null===(a=_[f.PROD_TAG])||void 0===a?void 0:a.length),j=[];x&&j.push((0,d.sprintf)(/* translators: category names */ /* translators: category names */
(0,d._x)("in %s","text","nelio-content"),(0,f.listify)("or",null!==(r=null!==(s=_[f.CAT])&&void 0!==s?s:_[f.PROD_CAT])&&void 0!==r?r:[]))),b&&j.push((0,d.sprintf)(/* translators: tag names */ /* translators: tag names */
(0,d._x)("tagged as %s","text","nelio-content"),(0,f.listify)("or",null!==(c=null!==(l=_[f.TAG])&&void 0!==l?l:_[f.PROD_TAG])&&void 0!==c?c:[])));const k=v.filter(e=>![f.CAT,f.PROD_CAT,f.TAG,f.PROD_TAG].includes(e)).map((e,t)=>{var n,i;return t?(0,d.sprintf)(/* translators: 1 -> taxonomy name, 2 -> taxonomy terms */ /* translators: 1 -> taxonomy name, 2 -> taxonomy terms */
(0,d._x)("%2$s in taxonomy %1$s","text","nelio-content"),m[e],(0,f.listify)("or",null!==(i=_[e])&&void 0!==i?i:[])):(0,d.sprintf)(/* translators: 1 -> taxonomy name, 2 -> taxonomy terms */ /* translators: 1 -> taxonomy name, 2 -> taxonomy terms */
(0,d._x)("with %2$s in taxonomy %1$s","text","nelio-content"),m[e],(0,f.listify)("or",null!==(n=_[e])&&void 0!==n?n:[]))});return(0,f.listify)("and",[...j,...k])},Le=e=>"always"===e.type?"":{30:(0,d._x)("from last month","text","nelio-content"),60:(0,d._x)("from last two months","text","nelio-content"),90:(0,d._x)("from last three months","text","nelio-content"),180:(0,d._x)("from last six months","text","nelio-content"),365:(0,d._x)("from last year","text","nelio-content")}[`${e.days}`]||(0,d.sprintf)(/* translators: number of days */ /* translators: number of days */
(0,d._x)("from last %d days","text","nelio-content"),e.days),Ve=e=>{const t=(0,g.mapValues)(qe(),e=>(0,g.map)(e,"key")),n=(0,g.mapValues)(Be(),e=>(0,g.map)(e,"key")),i=We(),o=(0,g.mapValues)(ze(),e=>(0,g.map)(e,"slug")),a=(0,g.map)(e,e=>{if(!(0,g.trim)(e.text).length)return(0,d._x)("Please create a template with some content","user","nelio-content");const a=/* translators: a placeholder name, like author or tags */ /* translators: a placeholder name, like author or tags */
(0,d._x)("Unsupported %s placeholder found in template","text","nelio-content");if(!i[e.postType||"nc_any"]&&e.text.includes("{author}"))return(0,d.sprintf)(a,"{author}");const s=o[e.postType||"nc_any"]||[];if(!s.includes(f.CAT)&&!s.includes(f.PROD_CAT)&&e.text.includes("{categories}"))return(0,d.sprintf)(a,"{categories}");if(!s.includes(f.TAG)&&!s.includes(f.PROD_TAG)&&e.text.includes("{tags}"))return(0,d.sprintf)(a,"{tags}");const r=(0,g.map)(Array.from(e.text.matchAll(/{taxonomy:([^}]+)}/g)),1);for(const e of r)if(!s.includes(e))return(0,d.sprintf)(a,`{taxonomy:${e}}`);const l=e.postType?t[e.postType]||[]:(0,g.values)(t).flatMap(e=>e),c=(0,g.map)(Array.from(e.text.matchAll(/{field:([^}]+)}/g)),1);for(const e of c)if(!l.includes(e))return(0,d.sprintf)(a,`{field:${e}}`);const u=e.postType?n[e.postType]||[]:(0,g.values)(n).flatMap(e=>e),p=(0,g.map)(Array.from(e.text.matchAll(/{custom:([^}]+)}/g)),1);for(const e of p)if(!u.includes(e))return(0,d.sprintf)(a,`{custom:${e}}`);return!1}),s=(0,g.map)(e,"id");return(0,g.zipObject)(s,a)},qe=()=>h(e=>e(Oe).getCustomFields()),Be=()=>h(e=>e(Oe).getCustomPlaceholders()),ze=()=>{const e=(0,g.map)((0,pe.usePostTypes)("social"),"name"),t=(0,g.filter)(h(e=>e(de.store).getEntityRecords("root","taxonomy",{per_page:-1})||[],[]),e=>e.visibility.public);return(0,g.reduce)(["nc_any",...e],(n,i)=>{const o="nc_any"===i?e:[i];return n[i]=(0,g.filter)(t,e=>o.some(t=>e.types.includes(t))),n},{nc_any:[]})},We=()=>{const e=(0,pe.usePostTypes)("social");return(0,g.reduce)(["nc_any",...(0,g.map)(e,"name")],(t,n)=>(t[n]=e.filter(e=>"nc_any"===n||e.name===n).some(e=>e.supports.author),t),{nc_any:!1})},Ke=e=>{switch(e.type){case"publication-day-offset":return!(0<=e.hoursAfterPublication&&e.hoursAfterPublication<=24)&&(0,d._x)("Please select a number of hours after publication between 0 and 24 for the availability time.","user","nelio-content");case"publication-day-period":return Je(e.time);case"after-publication":return e.daysAfterPublication<0?(0,d._x)("Please select a valid positive number of days after publication for the availability date.","user","nelio-content"):Je(e.time);case"reshare":return(0,g.values)(e.weekday).some(Boolean)?Je(e.time):(0,d._x)("Please select at least one day for the availability date or the template will not be used.","user","nelio-content")}},Je=e=>!Qe(e)&&(0,d._x)("Please select a valid availability time.","user","nelio-content"),He=e=>{switch(e){case"morning":return(0,d._x)("in the morning","text","nelio-content");case"noon":return(0,d._x)("at noon","text","nelio-content");case"afternoon":return(0,d._x)("in the afternoon","text","nelio-content");case"night":return(0,d._x)("at night","text","nelio-content");default:return(0,d.sprintf)(/* translators: a fixed time in the format HH:mm */ /* translators: a fixed time in the format HH:mm */(0,d._x)("at %s","text","nelio-content"),e)}},Ye=({doesAuthorExist:e,isAuthorSupported:t,isGroupAuthor:n})=>!!t&&(e?!n&&(0,d._x)("The author is not among those selected in the automation group","text","nelio-content"):(0,d._x)("Selected author doesn’t exist","text","nelio-content")),Xe=({doesTermExist:e,isGroupTerm:t})=>e?!t&&(0,d._x)("The term is not among those selected in the automation group","text","nelio-content"):(0,d._x)("Selected term doesn’t exist","text","nelio-content"),Qe=e=>et(e)||/^(?:[01][0-9]|2[0-3]):[0-5][0-9](?::[0-5][0-9])?$/.test(e),et=e=>["morning","noon","afternoon","night"].includes(e);function tt(e){return e.map(e=>{switch(e){case"mon":return(0,d._x)("Monday","text","nelio-content");case"tue":return(0,d._x)("Tuesday","text","nelio-content");case"wed":return(0,d._x)("Wednesday","text","nelio-content");case"thu":return(0,d._x)("Thursday","text","nelio-content");case"fri":return(0,d._x)("Friday","text","nelio-content");case"sat":return(0,d._x)("Saturday","text","nelio-content");case"sun":return(0,d._x)("Sunday","text","nelio-content");default:return""}})}const nt=(e,t)=>{const[n,i]=(0,c.useState)(t.length?"loading-entities":"loading-groups"),o="authors"===e?it(t):ot(t),a="authors"===e?"root":"taxonomy",s="authors"===e?"view":"edit";(0,c.useEffect)(()=>{t.length&&"loading-groups"===n&&i("loading-entities")},[!!t.length,n]);const{loadedEntities:r,hasFinishedResolution:l}=h(e=>(e(de.store),"loading-entities"===n&&(0,g.keys)(o).length?{loadedEntities:(0,g.mapValues)(o,(t,n)=>(0,g.chunk)(t,100).flatMap(t=>(0,g.map)(e(de.store).getEntityRecords(a,n,{include:t.join(","),per_page:t.length,context:s}),e=>e.id))),hasFinishedResolution:(0,g.every)((0,g.values)((0,g.mapValues)(o,(t,n)=>(0,g.every)((0,g.chunk)(t,100).flatMap(t=>e(de.store).hasFinishedResolution("getEntityRecords",[a,n,{include:t.join(","),per_page:t.length,context:s}]))))))}:{loadedEntities:{},hasFinishedResolution:!0})),u=(()=>{const{startResolution:e,finishResolution:t}=(0,m.useDispatch)(de.store);return(n,i)=>{e(n,i),t(n,i)}})();return(0,c.useEffect)(()=>{"loading-entities"===n&&l&&((0,g.mapValues)(r,(e,t)=>e.forEach(e=>u("getEntityRecord",[a,t,e,{context:s}]))),i("done"))},[n,l]),"done"!==n},it=e=>{const t=e.flatMap(e=>[...(0,g.values)(e.profileSettings),...(0,g.values)(e.networkSettings)]).flatMap(e=>[...e.publication.templates,...e.reshare.templates]).map(e=>e.author).filter(f.isDefined),n=e.flatMap(e=>(0,f.isUniversalGroup)(e)?[]:e.authors);return{user:(0,g.uniq)([...t,...n])}},ot=e=>{const t=[...e.flatMap(e=>[...(0,g.values)(e.profileSettings),...(0,g.values)(e.networkSettings)]).flatMap(e=>[...e.publication.templates,...e.reshare.templates]).map(e=>(0,g.mapValues)(e.taxonomies,e=>[e])),...e.flatMap(e=>(0,f.isUniversalGroup)(e)?[]:e.taxonomies)],n=(0,g.reduce)(t,(e,t)=>(0,g.mergeWith)(e,t,(e,t)=>(0,g.isArray)(e)&&(0,g.isArray)(t)?[...e,...t]:void 0),{});return(0,g.mapValues)(n,g.uniq)},at=e=>(e.preventDefault(),e.returnValue="");function st(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=st(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}const rt=function(){for(var e,t,n=0,i="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=st(e))&&(i&&(i+=" "),i+=t);return i},lt=({groupId:e,isActive:t,isExpanded:n,onToggle:i,onToggleActivation:o})=>{const a=(e=>{const t=Ce(e),n=(({authors:e,postType:t,publication:n,taxonomies:i})=>{const o=$e(t),a=Fe(null!=e?e:[]),s=Ue(t,null!=i?i:{}),r=Le(null!=n?n:{type:"always"}),l=(0,d.sprintf)(/* translators: 1 -> plural post type name (like “Posts” or “Pages”) or “All Content”, 2 -> byline, 3 -> in taxonomy, 4 -> published time */ /* translators: 1 -> plural post type name (like “Posts” or “Pages”) or “All Content”, 2 -> byline, 3 -> in taxonomy, 4 -> published time */
(0,d._x)("%1$s %2$s %3$s %4$s","text","nelio-content"),o,a,s,r);return(0,g.trim)(l.replace(/\s+/g," "))})(null!=t?t:{});return(0,f.isUniversalGroup)(t)?(0,d._x)("Universal Group","text","nelio-content"):(null==t?void 0:t.name)||n})(e),s=ut(e),r=De();return(0,l.jsxs)("div",{className:"nelio-content-automation-group__header",onClick:i,"aria-hidden":"true",children:[(0,l.jsxs)("div",{className:"nelio-content-automation-group__header-content",onClick:i,"aria-hidden":"true",children:[(0,l.jsx)("div",{className:"nelio-content-automation-group__header-content-activation-toggle",onClick:e=>e.stopPropagation(),"aria-hidden":"true",children:(0,l.jsx)(Ie.ToggleControl,{label:"",checked:t,onChange:o,disabled:r})}),(0,l.jsx)(ct,{groupId:e,isActive:t,isExpanded:n}),(0,l.jsx)("div",{className:"nelio-content-automation-group__header-content-title",children:a}),(0,l.jsxs)("div",{className:"nelio-content-automation-group__header-content-icons",children:[s.length<=4?s.map(({id:e})=>(0,l.jsx)(p.SocialProfileIcon,{profileId:e},e)):s.slice(0,3).map(({id:e})=>(0,l.jsx)(p.SocialProfileIcon,{profileId:e},e)),s.length>4&&(0,l.jsx)("div",{className:"nelio-content-automation-group__header-content-remaining-profiles",children:"+"+(s.length-4+1)})]})]}),(0,l.jsx)("div",{className:"nelio-content-automation-group__header-toggle",children:(0,l.jsx)(Ie.Button,{disabled:r,icon:n?"arrow-up":"arrow-down",onClick:i})})]})},ct=({groupId:e,isActive:t,isExpanded:n})=>{const i=dt(e),o=pt(e),a=(0,pe.useIsSubscribed)("standard");return!t&&!n||i&&(n||o)?a||"universal"===e?null:(0,l.jsx)(Ie.Tooltip,{text:(0,d._x)("Upgrade to Nelio Content Standard to be able to use this automation group","user","nelio-content"),placement:"bottom-end",delay:0,children:(0,l.jsx)("div",{className:rt({"nelio-content-automation-group--is-warning":!0,"nelio-content-automation-group--is-expanded":n})})}):(0,l.jsx)(Ie.Tooltip,{text:o?(0,d._x)("Please review this group’s settings and its active social profiles","user","nelio-content"):(0,d._x)("This group does not have any profiles selected","text","nelio-content"),placement:"bottom-end",delay:0,children:(0,l.jsx)("div",{className:rt({"nelio-content-automation-group--is-invalid":!i||!n&&!o,"nelio-content-automation-group--is-expanded":n})})})},ut=e=>h(t=>{const n=t(Oe).getAutomationGroup(e);if(!n)return[];const i=(0,g.values)(n.profileSettings).filter(e=>e.enabled).map(e=>e.profileId);return t(pe.store).getSocialProfiles().filter(e=>i.includes(e.id))}),dt=e=>h(t=>t(Oe).isGroupValid(e)),pt=e=>{const t=Ce(e);return!!(0,g.values)(null==t?void 0:t.profileSettings).filter(e=>e.enabled).length},mt={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let ht;const gt=new Uint8Array(16),ft=[];for(let e=0;e<256;++e)ft.push((e+256).toString(16).slice(1));const yt=function(e,t,n){if(mt.randomUUID&&!t&&!e)return mt.randomUUID();const i=(e=e||{}).random??e.rng?.()??function(){if(!ht){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");ht=crypto.getRandomValues.bind(crypto)}return ht(gt)}();if(i.length<16)throw new Error("Random bytes length must be >= 16");if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){if((n=n||0)<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=i[e];return t}return function(e,t=0){return(ft[e[t+0]]+ft[e[t+1]]+ft[e[t+2]]+ft[e[t+3]]+"-"+ft[e[t+4]]+ft[e[t+5]]+"-"+ft[e[t+6]]+ft[e[t+7]]+"-"+ft[e[t+8]]+ft[e[t+9]]+"-"+ft[e[t+10]]+ft[e[t+11]]+ft[e[t+12]]+ft[e[t+13]]+ft[e[t+14]]+ft[e[t+15]]).toLowerCase()}(i)},_t=({activeTab:e,groupId:t,setActiveTab:n})=>{const[i,o]=(0,c.useState)(!1),a=De(),s=xt(t),r=h(e=>e(Oe).getAutomationGroup(t)),{addAutomationGroup:u,deleteAutomationGroup:g}=(0,m.useDispatch)(Oe),y=bt(),_=h(e=>e(pe.store).getPluginLimits().maxAutomationGroups),v=h(e=>e(Oe).getAutomationGroups().length)>=_;return r?(0,l.jsxs)("div",{className:"nelio-content-automation-group__sidebar",children:[s.map((t,i)=>(0,l.jsx)("div",{className:rt({"nelio-content-automation-group__sidebar-item":!0,"nelio-content-automation-group__sidebar-item--active":vt(t,e)}),onClick:()=>!a&&n(t),"aria-hidden":"true",children:"settings"===t.type?(0,l.jsx)(Ie.Dashicon,{icon:"admin-settings"}):(0,l.jsx)(Ie.Tooltip,{text:t.displayName,placement:"bottom-end",delay:0,children:(0,l.jsxs)("div",{className:"nelio-content-profile__icon-and-indicator",children:[(0,l.jsx)(p.SocialProfileIcon,{className:rt({"nelio-content-profile__profile-icon":!0,"nelio-content-profile__profile-icon--is-selected":vt(t,e),"nelio-content-profile__profile-icon--is-invalid":!t.isValid}),profileId:t.id,isNetworkHidden:!1}),(0,l.jsx)("div",{className:rt({"nelio-content-profile__profile-indicator":!0,"nelio-content-profile__profile-indicator--is-invalid":!t.isValid})})]})})},i)),(0,l.jsx)("div",{className:"nelio-content-automation-group__sidebar-item nelio-content-automation-group__sidebar-item--is-spacer"}),(0,l.jsxs)("div",{className:"nelio-content-automation-group__sidebar-item nelio-content-automation-group__sidebar-actions",children:[(0,l.jsx)(Ie.DropdownMenu,{icon:"admin-generic",label:(0,d._x)("Actions","text","nelio-content"),toggleProps:{disabled:a},controls:[{title:(0,d._x)("Duplicate group","command","nelio-content"),icon:"admin-page",isDisabled:v,onClick:()=>u(y(r))},...(0,f.isUniversalGroup)(r)?[]:[{title:(0,d._x)("Remove group","command","nelio-content"),icon:"trash",onClick:()=>o(!0)}]]}),"universal"!==t&&(0,l.jsx)(p.ConfirmationDialog,{isOpen:i,confirmLabel:(0,d._x)("Delete","command","nelio-content"),onConfirm:()=>{o(!1),g(t)},onCancel:()=>o(!1),text:(0,d._x)("Are you sure you want to delete this group? This operation can’t be undone.","user","nelio-content"),title:(0,d._x)("Delete group","text","nelio-content")})]})]}):null},vt=(e,t)=>{if(e.type!==t.type)return!1;switch(e.type){case"settings":return!0;case"profile":return"profile"===t.type&&e.id===t.id}},xt=e=>{const t=Ce(e);return h(n=>{if(!t)return[];const i=(0,g.values)(t.profileSettings).filter(e=>e.enabled).map(e=>e.profileId),o=n(pe.store).getSocialProfiles().filter(e=>i.includes(e.id)),{getProfileError:a}=n(Oe);return[{type:"settings"},...o.map(t=>{var n;return{displayName:a(e,t.id)||(null!==(n=t.alias)&&void 0!==n?n:t.displayName),type:"profile",id:t.id,isValid:!a(e,t.id)}})]})},bt=()=>{var e,t;const n=null!==(t=null===(e=(0,pe.usePostTypes)("social")[0])||void 0===e?void 0:e.name)&&void 0!==t?t:f.POST;return e=>{var t;const i=Object.assign(Object.assign({postType:(0,f.isUniversalGroup)(e)?n:e.postType,authors:[],taxonomies:{}},e),{id:(0,f.createAutomationGroupId)(),name:(0,f.isUniversalGroup)(e)?(0,d._x)("Copy of Universal Group","text","nelio-content"):(0,d.sprintf)(/* translators: automation group name */ /* translators: automation group name */
(0,d._x)("Copy of %s","text","nelio-content"),null!==(t=e.name)&&void 0!==t?t:(0,d._x)("Unnamed Group","text","nelio-content"))}),o=(0,g.cloneDeep)(i);return Object.assign(Object.assign({},o),{name:(o.name||"")+" "+(0,d._x)("(duplicate)","text","nelio-content"),profileSettings:(0,g.mapValues)(o.profileSettings,e=>Object.assign(Object.assign({},e),{publication:Object.assign(Object.assign({},e),{templates:e.publication.templates.map(e=>Object.assign(Object.assign({},e),{groupId:o.id,id:yt()}))}),reshare:Object.assign(Object.assign({},e.reshare),{templates:e.reshare.templates.map(e=>Object.assign(Object.assign({},e),{groupId:o.id,id:yt()}))})})),networkSettings:(0,g.mapValues)(o.networkSettings,e=>e?Object.assign(Object.assign({},e),{publication:Object.assign(Object.assign({},e.publication),{templates:e.publication.templates.map(e=>Object.assign(Object.assign({},e),{groupId:o.id,id:yt()}))}),reshare:Object.assign(Object.assign({},e.reshare),{templates:e.reshare.templates.map(e=>Object.assign(Object.assign({},e),{groupId:o.id,id:yt()}))})}):void 0)})}},jt=[{value:"always",label:(0,d._x)("Any date","text","nelio-content")},{value:"30",label:(0,d._x)("Last month","text","nelio-content")},{value:"60",label:(0,d._x)("Last two months","text","nelio-content")},{value:"90",label:(0,d._x)("Last three months","text","nelio-content")},{value:"180",label:(0,d._x)("Last six months","text","nelio-content")},{value:"365",label:(0,d._x)("Last year","text","nelio-content")}],kt=({value:e,onChange:t})=>{const n="always"===e.type?"always":`${e.days}`;return(0,l.jsx)(Ie.SelectControl,{label:(0,d._x)("Publication date","text","nelio-content"),options:jt,value:n,onChange:e=>t("always"===e?{type:"always"}:{type:"max-age",days:parseInt(e)||30})})},Tt=({groupId:e,disabled:t,profileId:n})=>{const i=(0,pe.useSocialProfile)(n),[o,a]=wt(e,n),{alias:s,displayName:r="",network:c="twitter"}=i||{};return(0,l.jsx)(Ie.Tooltip,{text:`${null!=s?s:r} (${(0,Ee.getNetworkLabel)("name",c)})`,delay:0,children:(0,l.jsxs)("li",{className:rt({"nelio-content-profile-selector__profile":!0,"nelio-content-profile-selector__profile--is-selected":o,"nelio-content-profile-selector__profile--is-disabled":t}),children:[(0,l.jsx)("span",{className:"screen-reader-text",children:`${null!=s?s:r}: `}),(0,l.jsx)("input",{className:"nelio-content-profile-selector__profile-input-field",disabled:t,type:"checkbox",checked:!!o,onChange:()=>a(!o)}),(0,l.jsxs)("div",{className:"nelio-content-profile-selector__icon-and-indicator",children:[(0,l.jsx)(p.SocialProfileIcon,{className:rt({"nelio-content-profile-selector__profile-icon":!0,"nelio-content-profile-selector__profile-icon--is-selected":o}),profileId:n,isNetworkHidden:!1}),(0,l.jsx)("div",{className:rt({"nelio-content-profile-selector__profile-indicator":!0,"nelio-content-profile-selector__profile-indicator--is-selected":o})})]})]})})},wt=(e,t)=>{const n=Ce(e),i=h(e=>e(pe.store).getSocialProfile(t)),o=(0,g.find)(null==n?void 0:n.profileSettings,{profileId:t}),{addProfileSettings:a}=(0,m.useDispatch)(Oe);return[!!(null==o?void 0:o.enabled),s=>{n&&i&&a(e,Object.assign(Object.assign({profileId:t,network:i.network,publication:{enabled:!0,templates:[(0,f.createSocialTemplate)({groupId:n.id,text:"{title} {permalink}",network:i.network,profileId:i.id,postType:void 0}),(0,f.createSocialTemplate)({groupId:n.id,text:"{highlight} {permalink}",network:i.network,profileId:i.id,postType:void 0}),(0,f.createSocialTemplate)({groupId:n.id,text:"{phrase} {permalink}",network:i.network,profileId:i.id,postType:void 0})]},reshare:{enabled:!1,templates:[]}},o),{enabled:s}))}]},Ot=({groupId:e})=>{const t=St(),n=(0,pe.useAdminUrl)("admin.php",{page:"nelio-content-settings",subpage:"social--profiles"});return(0,l.jsxs)("div",{className:"nelio-content-automation-group-settings__section",children:[(0,l.jsx)("p",{className:"nelio-content-automation-group-settings__section-title",children:(0,d._x)("Where should your content be shared?","user","nelio-content")}),(0,l.jsx)("div",{className:"nelio-content-automation-group-settings__section-content",children:t.length?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("p",{className:"screen-reader-text",children:(0,d._x)("Select one or more profiles:","text","nelio-content")}),(0,l.jsx)("ul",{className:"nelio-content-automation-group-settings__profile-list",children:t.map(({id:t})=>(0,l.jsx)("div",{className:"nelio-content-automation-group-settings__profile-list-item",children:(0,l.jsx)(Tt,{groupId:e,profileId:t})},t))})]}):(0,l.jsx)("p",{children:(0,c.createInterpolateElement)((0,d._x)("There aren’t any social profiles connected to Nelio Content. <a>Connect one first</a> and then configure its auto share settings here.","user","nelio-content"),{a:(0,l.jsx)("a",{href:n,children:"."})})})})]})},St=()=>(0,pe.useSocialProfiles)().filter(e=>(0,Ee.doesNetworkSupport)("automations",e.network)),It=()=>{const e=(0,g.map)((0,pe.usePostTypes)("social"),e=>e.labels.plural),t=(0,f.listify)("and",(0,g.map)(e,e=>`<strong>${e}</strong>`)),n=(0,pe.useAdminUrl)("admin.php",{page:"nelio-content-settings",subpage:"social--advanced"});return(0,l.jsxs)("div",{className:"nelio-content-automation-group-settings",children:[(0,l.jsxs)("div",{className:"nelio-content-automation-group-settings__section",children:[(0,l.jsx)("p",{className:"nelio-content-automation-group-settings__section-title",children:(0,d._x)("Which content should be shared?","user","nelio-content")}),(0,l.jsxs)("div",{className:"nelio-content-automation-group-settings__section-content",children:[(0,l.jsx)(Ie.BaseControl,{id:"nelio-content-universal-post-types",label:(0,d._x)("Post Types","text","nelio-content"),children:(0,l.jsx)("p",{className:"nelio-content-automation-group-settings__universal-post-types",children:(0,c.createInterpolateElement)((0,d.sprintf)(/* translators: list of post type names */ /* translators: list of post type names */
(0,d._x)("When enabled, the universal group applies to all your <a>shareable content</a>: %s.","text","nelio-content"),t),{strong:(0,l.jsx)("strong",{}),a:(0,l.jsx)("a",{href:n,children:"."})})})}),(0,l.jsx)(Nt,{})]})]}),(0,l.jsx)(Ot,{groupId:"universal"})]})},Nt=()=>{const e=Ce("universal"),{updateAutomationGroup:t}=(0,m.useDispatch)(Oe);if(!(0,f.isUniversalGroup)(e))return null;const{publication:n}=e;return(0,l.jsx)("div",{className:"nelio-content-automation-group-settings__extra",children:(0,l.jsx)(kt,{value:n,onChange:e=>t("universal",{publication:e})})})},Et=({groupId:e})=>{const t=(0,pe.usePostTypes)("social").map(e=>({value:e.name,label:e.labels.plural})),[n,i]=Pe(e,"name"),[o,a]=Pe(e,"postType"),s=h(t=>t(Oe).isPostTypeValid(e));return(0,l.jsxs)("div",{className:"nelio-content-automation-group-settings",children:[(0,l.jsx)(Ie.TextControl,{className:"nelio-content-automation-group-settings__group-name",label:(0,d._x)("Group name","text","nelio-content"),value:null!=n?n:"",onChange:i}),(0,l.jsx)("p",{className:"nelio-content-automation-group-settings__section-title",children:(0,d._x)("Which content should be shared?","user","nelio-content")}),(0,l.jsxs)("div",{className:"nelio-content-automation-group-settings__section-content",children:[(0,l.jsx)(Ie.SelectControl,{label:(0,d._x)("Post Type","text","nelio-content"),help:!s&&(0,l.jsx)("span",{className:"nelio-content-error-help",children:(0,d._x)("The selected post type is not valid.","text","nelio-content")}),options:t,value:o,onChange:a}),(0,l.jsx)(At,{groupId:e})]}),(0,l.jsx)(Ot,{groupId:e})]})},At=({groupId:e})=>{const[t]=Pe(e,"postType"),n=Ge(t),[i={},o]=Pe(e,"taxonomies"),[a=[],s]=Pe(e,"authors"),[r={type:"always"},u]=Pe(e,"publication"),[m,f]=(0,c.useState)((0,g.values)(i).some(e=>e.length)||a.length||r&&"always"!==r.type),y=Ze(t),_=Re(t),{areAuthorsValid:v,areTermsValid:x}=h(t=>{const n=t(Oe);return{areAuthorsValid:n.areAuthorsValid(e),areTermsValid:n.getGroupTermsValidation(e)}});return m?_?(0,l.jsxs)("div",{className:"nelio-content-automation-group-settings__extra",children:[y.map(e=>{var t;return(0,l.jsx)(p.ItemSelectControl,{id:"nelio-content-automation-group-settings-taxonomies",error:!x[e.slug]&&(0,d._x)("Some terms are not valid.","text","nelio-content"),kind:"taxonomy",label:e.labels.name,name:e.slug,placeholder:e.labels.filter_by_item,value:null!==(t=i[e.slug])&&void 0!==t?t:[],onChange:t=>o(Object.assign(Object.assign({},i),{[e.slug]:t}))},e.slug)}),n&&(0,l.jsx)(p.ItemSelectControl,{id:"nelio-content-automation-group-settings-authors",error:!v&&(0,d._nx)("The selected author is not valid.","Some of the selected authors are not valid.",a.length,"text","nelio-content"),kind:"author",label:(0,d._x)("Authors","text","nelio-content"),placeholder:(0,d._x)("Filter by author","text","nelio-content"),value:a,onChange:s}),(0,l.jsx)(kt,{value:r,onChange:u})]}):(0,l.jsx)("div",{className:"nelio-content-automation-group-settings__extra",children:(0,l.jsx)(Ie.Spinner,{})}):(0,l.jsx)("div",{className:"nelio-content-automation-group-settings__extra",children:(0,l.jsx)(Ie.Button,{className:"nelio-content-automation-group-settings__extra-action",variant:"link",onClick:()=>f(!0),children:(0,d._x)("Show additional filters","command","nelio-content")})})},Ct=({groupId:e})=>"universal"===e?(0,l.jsx)(It,{}):(0,l.jsx)(Et,{groupId:e}),Pt=/({title}|{permalink}|{phrase}|{highlight}|{tags}|{author}|{categories}|{excerpt}|{field:[^}]*}|{custom:[^}]*}|{taxonomy:[^}]*})/g,Rt=e=>{const t=Zt(e),n=Gt(t),i=Mt(e),{deleteAutomationGroupTemplate:o,openTemplateEditor:a,openTemplateExporter:s}=(0,m.useDispatch)(Oe);return t?(0,l.jsxs)("div",{"data-template-type":"network"===e.type?(0,d._x)("Network","text (network template)","nelio-content"):"",className:rt({"nelio-content-social-template":!0,"nelio-content-social-template--is-network":"network"===e.type}),children:[(0,l.jsx)("div",{className:"nelio-content-social-template__text",children:$t(t.text)}),(0,l.jsxs)("div",{className:rt({"nelio-content-social-template__extra":!0,"nelio-content-social-template__extra--is-invalid":!i}),children:[(0,l.jsx)("span",{className:rt({"nelio-content-social-template__filters":!0,"nelio-content-social-template__filters--is-invalid":!i}),children:n}),(0,l.jsxs)("div",{className:"nelio-content-social-template__actions",children:[(0,l.jsx)("span",{children:"•"}),(0,l.jsx)(Ie.Button,{variant:"link",onClick:()=>a(e.templateType,t),children:(0,d._x)("Edit","command","nelio-content")}),"|",(0,l.jsx)(Ie.Button,{variant:"link",onClick:()=>s((0,f.makeExportedTemplate)(t)),children:(0,d._x)("Export","command","nelio-content")}),e.canBeDeleted&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{children:"|"}),(0,l.jsx)(p.DeleteButton,{confirmationLabels:{title:(0,d._x)("Delete Template","text","nelio-content"),text:(0,d._x)("Are you sure you want to delete this social template? If you then save your social automations, you won’t be able to recover it.","user","nelio-content")},onClick:()=>o(t)})]})]})]})]}):null},Zt=e=>{var t,n,i,o,a,s;const r=Ce(e.groupId);if(!r)return;const{profileSettings:l,networkSettings:c}=r;switch(e.type){case"network":return null!==(n=(0,g.find)(null===(t=c[e.networkName])||void 0===t?void 0:t.publication.templates,{id:e.templateId}))&&void 0!==n?n:(0,g.find)(null===(i=c[e.networkName])||void 0===i?void 0:i.reshare.templates,{id:e.templateId});case"profile":return null!==(a=(0,g.find)(null===(o=l[e.profileId])||void 0===o?void 0:o.publication.templates,{id:e.templateId}))&&void 0!==a?a:(0,g.find)(null===(s=l[e.profileId])||void 0===s?void 0:s.reshare.templates,{id:e.templateId})}},Gt=e=>{const t=(({attachment:e,author:t,postType:n,taxonomies:i,availability:o})=>{var a;const s=$e(n),r=Fe((0,f.isDefined)(t)?[t]:[]),l=Ue(n,null!==(a=(0,g.mapValues)(i,g.castArray))&&void 0!==a?a:{}),c=(e=>{if(!e)return"";let t="";switch(e.type){case"publication-day-offset":t=0===e.hoursAfterPublication?(0,d._x)("on publication","text","nelio-content"):(0,d.sprintf)(/* translators: number of hours */ /* translators: number of hours */
(0,d._nx)("%d hour after publication","%d hours after publication",e.hoursAfterPublication,"text","nelio-content"),e.hoursAfterPublication);break;case"publication-day-period":t=He(e.time);break;case"after-publication":switch(e.daysAfterPublication){case 0:t=(0,d._x)("on publication","text","nelio-content");break;case 1:t=(0,d._x)("the day after publication","text","nelio-content");break;case 7:t=(0,d._x)("one week after publication","text","nelio-content");break;case 28:case 29:case 30:case 31:t=(0,d._x)("one month after publication","text","nelio-content");break;default:t=(0,d.sprintf)(/* translators: number of days */ /* translators: number of days */
(0,d._x)("%d days after publication","text","nelio-content"),e.daysAfterPublication)}t+=" "+He(e.time);break;case"reshare":const n=(0,g.keys)(e.weekday).filter(t=>!1!==e.weekday[t]);let i="";i=7===n.length?(0,d._x)("every day","text","nelio-content"):2===n.length&&n.includes("sat")&&n.includes("sun")?(0,d._x)("on weekends","text","nelio-content"):5!==n.length||n.includes("sat")||n.includes("sun")?1===n.length?(0,d.sprintf)(/* translators: a day of the week */ /* translators: a day of the week */
(0,d._x)("all week but %s,","text","nelio-content"),tt(n)[0]):(0,d.sprintf)(/* translators: a list of days */ /* translators: a list of days */
(0,d._x)("on %s","text","nelio-content"),(0,f.listify)("and",tt(n))):(0,d._x)("on weekdays","text","nelio-content"),t=i+" "+He(e.time)}return(0,d.sprintf)(/* translators: time period */ /* translators: time period */
(0,d._x)(", used %s","text","nelio-content"),t)})(o),u=(e=>{if(!e)return"";switch(e){case"none":return(0,d._x)("(text only)","text","nelio-content");case"image":return(0,d._x)("(image)","text","nelio-content");case"video":return(0,d._x)("(video)","text","nelio-content")}})(e),p=(0,d.sprintf)(/* translators: 1 -> plural post type name, 2 -> byline, 3 -> in taxonomy, 4 -> availability time, 5 -> text / image template */ /* translators: 1 -> plural post type name, 2 -> byline, 3 -> in taxonomy, 4 -> availability time, 5 -> text / image template */
(0,d._x)("%1$s %2$s %3$s %4$s %5$s","text","nelio-content"),s,r,l,c,u);return(0,g.trim)(p.replace(/\s+/g," ").replace(/ , /g,", "))})({attachment:null==e?void 0:e.attachment,postType:null==e?void 0:e.postType,author:null==e?void 0:e.author,taxonomies:null==e?void 0:e.taxonomies,availability:null==e?void 0:e.availability});return Dt(e)||t},Mt=e=>h(t=>{const{groupId:n,templateId:i}=e;return t(Oe).isTemplateValid(n,i)}),Dt=e=>{const t=h(t=>{const{getTemplateErrors:n}=t(Oe);return e&&n(e.groupId,e.id)});if(!t)return"";return t.target||t.content||(t.author?t.author:(0,g.values)(t.taxonomies).some(Boolean)?(0,d._x)("Please review selected terms","user","nelio-content"):t.availability?(0,d._x)("Please review availability settings","user","nelio-content"):"")},$t=e=>(0,c.createInterpolateElement)(Ft(e),{code:(0,l.jsx)("span",{className:"nelio-content-social-template__code-tag"}),newline:(0,l.jsx)("span",{className:"nelio-content-social-template__newline-tag"})}),Ft=e=>(0,g.flow)(Ut,Lt,Vt,qt,g.trim)(` ${e} `),Ut=e=>e.replace(/\r?\n/g,"¶"),Lt=e=>e.replace(new RegExp("<","g"),"<⁠").replace(new RegExp(">","g"),"⁠>"),Vt=e=>e.replace(Pt,"<code>$1</code>"),qt=e=>e.replace(/ *\\u00b6 */g,"<newline>¶</newline>"),Bt=e=>{const[t,n]=(0,c.useState)(0);(0,c.useEffect)(()=>n(0),[e.profileId]);const{openTemplateEditor:i,openTemplateExporter:o,openTemplateImporter:a}=(0,m.useDispatch)(Oe),s=Ce(e.groupId),r=Kt(e),u=Wt(e.profileId),p=1===(null==r?void 0:r.length);if(!r||!u)return null;const h=r.length<=20?[r]:(0,g.chunk)(r,10),y=h.length,_=y>1;return(0,l.jsxs)("div",{className:"nelio-content-automation-templates",children:[(0,l.jsxs)("div",{className:"nelio-content-automation-templates__header",children:[(0,l.jsxs)("h3",{className:"nelio-content-automation-templates__title",children:[(0,d._x)("Social Templates","text","nelio-content"),_?` (${r.length})`:""]}),(0,l.jsx)(Ie.Button,{size:"small",variant:"secondary",onClick:()=>{if(!s)return;const t=(0,f.createSocialTemplate)({groupId:s.id,text:"",network:u,profileId:e.profileId,postType:(0,f.isUniversalGroup)(s)?void 0:s.postType});i(e.mode,t,"new")},children:(0,d._x)("Add Template","command","nelio-content")}),(0,l.jsx)(Ie.Button,{size:"small",variant:"secondary",onClick:()=>a(e.groupId,e.profileId,e.mode),children:(0,d._x)("Import","command","nelio-content")}),!!r.length&&(0,l.jsx)(Ie.Button,{size:"small",variant:"secondary",onClick:()=>o(r.map(f.makeExportedTemplate)),children:(0,d._x)("Export","command","nelio-content")}),_&&(0,l.jsx)(zt,{mode:"title",current:t,total:y,onChange:n})]}),(0,l.jsx)("div",{className:"nelio-content-automation-templates__content",children:(0,g.map)(h[t],t=>t.profileId?(0,l.jsx)(Rt,{type:"profile",groupId:e.groupId,profileId:t.profileId,templateId:t.id,templateType:e.mode,canBeDeleted:!p},t.id):(0,l.jsx)(Rt,{type:"network",groupId:e.groupId,networkName:t.network,templateId:t.id,templateType:e.mode,canBeDeleted:!p},t.id))}),_&&(0,l.jsx)(zt,{mode:"footer",current:t,total:y,onChange:n})]})},zt=({mode:e,current:t,total:n,onChange:i})=>(0,l.jsx)("div",{className:`nelio-content-automation-templates__pagination nelio-content-automation-templates__pagination--${e}`,children:(0,l.jsxs)(Ie.ButtonGroup,{children:[(0,l.jsxs)(Ie.Button,{disabled:0===t,onClick:()=>i(t-1),variant:"title"===e?"secondary":void 0,size:"title"===e?"small":void 0,children:["< ",(0,l.jsx)(Ie.VisuallyHidden,{children:(0,d._x)("Previous page","command","nelio-content")})]}),"footer"===e&&(0,l.jsx)("div",{className:"nelio-content-automation-templates__current-page",children:`${t+1} / ${n}`}),(0,l.jsxs)(Ie.Button,{disabled:t>=n-1,onClick:()=>i(t+1),variant:"title"===e?"secondary":void 0,size:"title"===e?"small":void 0,children:["> ",(0,l.jsx)(Ie.VisuallyHidden,{children:(0,d._x)("Next page","command","nelio-content")})]})]})}),Wt=e=>h(t=>{var n;return null===(n=t(pe.store).getSocialProfile(e))||void 0===n?void 0:n.network}),Kt=({groupId:e,profileId:t,mode:n})=>{const i=Wt(t);return h(o=>{var a,s;const r=o(Oe).getAutomationGroup(e);if(!r)return;const l=r.profileSettings[t],c=i?r.networkSettings[i]:void 0;return[...null!==(a=null==l?void 0:l[n].templates)&&void 0!==a?a:[],...null!==(s=null==c?void 0:c[n].templates)&&void 0!==s?s:[]]})},Jt=({className:e,tab:t,setTab:n})=>(0,l.jsxs)(Ie.Toolbar,{className:e,label:(0,d._x)("Settings","text","nelio-content"),children:[(0,l.jsx)(Ie.ToolbarButton,{icon:"megaphone",title:(0,d._x)("Publication","text","nelio-content"),isActive:"publication"===t,onClick:()=>n("publication")}),(0,l.jsx)(Ie.ToolbarButton,{icon:"share-alt",title:(0,d._x)("Reshare","text","nelio-content"),isActive:"reshare"===t,onClick:()=>n("reshare")})]});const Ht=e=>{var t;const{groupId:n,profileId:i}=e,[o,a]=(0,c.useState)("publication"),s=(0,pe.useSocialProfile)(i),r=Qt(i),[u]=en(n,i);if(!s||!u)return null;const d=r&&!!u[o].enabled;return(0,l.jsxs)("div",{className:"nelio-content-automation-profile-settings",children:[(0,l.jsxs)("div",{className:"nelio-content-automation-profile-settings__header",children:[(0,l.jsxs)("div",{className:"nelio-content-automation-profile-settings__profile-details",children:[(0,l.jsx)("h3",{className:"nelio-content-automation-profile-settings__profile-name",children:null!==(t=s.alias)&&void 0!==t?t:s.displayName}),(0,l.jsx)(p.ProfileCreator,{className:"nelio-content-automation-profile-settings__profile-creator",profileId:i})]}),(0,l.jsx)(Jt,{className:"nelio-content-automation-profile-settings__tab-selector",tab:o,setTab:a})]}),(0,l.jsxs)("div",{className:"nelio-content-automation-profile-settings__content",children:[(0,l.jsx)(Yt,Object.assign({type:o},e)),d&&(0,l.jsx)(Bt,{groupId:n,profileId:i,mode:o})]})]})},Yt=e=>{var{type:t}=e,n=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n}(e,["type"]);const{groupId:i,profileId:o}=n,[a,s]=en(i,o),r=Ce(i),c=tn(i,o,t);return r&&a?(0,l.jsx)("div",{className:"nelio-content-automation-profile-settings__sharing-settings",children:(0,l.jsx)(Ie.CheckboxControl,{checked:a[t].enabled,onChange:()=>{const e=c||!!a[t].templates.length,i=!a[t].enabled,o=a[t].templates,l=[(0,f.createSocialTemplate)({groupId:r.id,text:"{title} {permalink}",network:a.network,profileId:n.profileId,postType:void 0}),(0,f.createSocialTemplate)({groupId:r.id,text:"{highlight} {permalink}",network:a.network,profileId:n.profileId,postType:void 0}),(0,f.createSocialTemplate)({groupId:r.id,text:"{phrase} {permalink}",network:a.network,profileId:n.profileId,postType:void 0})];s(Object.assign(Object.assign({},a),{[t]:Object.assign(Object.assign({},a[t]),{enabled:i,templates:i&&!e?l:o})}))},label:(0,l.jsx)(Xt,{profileId:n.profileId,enabled:a[t].enabled,type:t})})}):null},Xt=({enabled:e,profileId:t,type:n})=>{const[i,o]=nn(t,n);if(!e)return(0,l.jsx)(l.Fragment,{children:"publication"===n?(0,d._x)("Share content on publication","command","nelio-content"):(0,d._x)("Reshare content","command","nelio-content")});const a=e=>Math.min(20,Math.max(1,e)),s="publication"===n?/* translators: number of social messages */ /* translators: number of social messages */
(0,d._x)("Share content on publication using up to %s messages","command","nelio-content"):/* translators: number of social messages */ /* translators: number of social messages */
(0,d._x)("Reshare content using up to %s daily messages","command","nelio-content");return(0,c.createInterpolateElement)((0,d.sprintf)(s,"<value/>"),{value:(0,l.jsx)("input",{type:"number",style:{width:"4.5em"},min:"1",max:20,value:a(i),onChange:e=>{const t=e.target.value,n=Number.parseInt(t);isNaN(n)||o(a(n))}})})},Qt=e=>{const t=(0,pe.useSocialProfile)(e);return!!t&&(0,Ee.doesNetworkSupport)("profile-template",t.network)},en=(e,t)=>{const n=h(n=>n(Oe).getProfileAutomationSettings(e,t)),{addProfileSettings:i}=(0,m.useDispatch)(Oe);return[n,t=>{if(n)return i(e,Object.assign(Object.assign({},n),t))}]},tn=(e,t,n)=>{var i,o;const a=Ce(e),s=null===(i=null==a?void 0:a.profileSettings[t])||void 0===i?void 0:i.network;return!!s&&!!(null===(o=null==a?void 0:a.networkSettings[s])||void 0===o?void 0:o[n].templates.length)},nn=(e,t)=>{const n=h(n=>{var i,o;return null!==(o=null===(i=n(Oe).getProfileFrequencies(e))||void 0===i?void 0:i[t])&&void 0!==o?o:1}),{setProfileFrequencies:i}=(0,m.useDispatch)(Oe);return[n,n=>i(e,{[t]:n})]},on=({groupId:e})=>{const[t,n]=an(e),[i,o]=(0,c.useState)(t),[a,s]=(0,c.useState)({type:"settings"}),r=De();return(e=>{const t=Ce(e),n=(0,g.map)((0,pe.usePostTypes)("social"),"name"),i=!!(0,f.isUniversalGroup)(t)||!!(null==t?void 0:t.postType)&&n.includes(t.postType),o=(e=>{var t;const n=(0,f.isUniversalGroup)(e)||null==e?void 0:e.postType,i=!!(null===(t=(0,pe.usePostType)(n))||void 0===t?void 0:t.supports.author);return h(t=>{var n;if(t(de.store),!i||(0,f.isUniversalGroup)(e))return!0;const{getEntityRecord:o,hasFinishedResolution:a,hasResolutionFailed:s}=t(de.store),r=null!==(n=null==e?void 0:e.authors)&&void 0!==n?n:[],l=(0,g.map)(r,e=>o("root","user",e,{context:"view"})),c=(0,g.map)(r,e=>a("getEntityRecord",["root","user",e,{context:"view"}])||s("getEntityRecord",["root","user",e,{context:"view"}]));return!(0,g.every)(c)||(0,g.every)(l)})})(t),a=(e=>{var t;const n=(0,f.isUniversalGroup)(e)||null==e?void 0:e.postType,i=(0,g.map)(Ze(n),"slug"),o=(0,g.pick)(Object.assign(Object.assign({},(0,g.zipObject)(i,(0,g.map)(i,()=>[]))),(0,f.isUniversalGroup)(e)?{}:null!==(t=null==e?void 0:e.taxonomies)&&void 0!==t?t:{}),i);return h(e=>{const{getEntityRecord:t,hasFinishedResolution:n,hasResolutionFailed:i}=e(de.store),a=(0,g.mapValues)(o,(e,n)=>e.map((e=>n=>t("taxonomy",e,n)||void 0)(n))),s=(0,g.mapValues)(o,(e,t)=>e.map((e=>t=>!!n("getEntityRecord",["taxonomy",e,t])||!!i("getEntityRecord",["taxonomy",e,t]))(t)));return(0,g.mapValues)(o,(e,t)=>!(0,g.every)(s[t])||(0,g.every)(a[t]))})})(t),s=(e=>(0,g.mapValues)(null==e?void 0:e.profileSettings,e=>!(!e.enabled||e.publication.enabled||e.reshare.enabled)&&(0,d._x)("Missing permissions to automatically share content on your behalf","user","nelio-content")))(t),r=Me(t,(e=>{const t=(0,g.filter)((0,g.values)(null==e?void 0:e.profileSettings),{enabled:!0}),n=(0,g.map)(t,"network"),i=(0,g.values)((0,g.pick)(null==e?void 0:e.networkSettings,n));return[...(0,g.flatten)((0,g.map)((0,g.filter)((0,g.map)(t,"publication"),{enabled:!0}),"templates")),...(0,g.flatten)((0,g.map)((0,g.filter)((0,g.map)(t,"reshare"),{enabled:!0}),"templates")),...(0,g.flatten)((0,g.map)((0,g.map)(i,"publication"),"templates")),...(0,g.flatten)((0,g.map)((0,g.map)(i,"reshare"),"templates"))]})(t)),{setAutomationGroupValidation:l}=(0,m.useDispatch)(Oe);(0,c.useEffect)(()=>{t&&l(e,{isPostTypeValid:i,areAuthorsValid:o,areTermsValid:a,socialProfileErrors:s,templateErrors:r})},[JSON.stringify(i),JSON.stringify(o),JSON.stringify(a),JSON.stringify(s),JSON.stringify(r)])})(e),(0,l.jsxs)("div",{className:rt({"nelio-content-automation-group":!0,"nelio-content-automation-group--inactive":!t&&!i,"nelio-content-automation-group--disabled":r}),children:[(0,l.jsx)(lt,{groupId:e,isActive:t,isExpanded:i,onToggleActivation:()=>n(!t),onToggle:()=>o(!i)}),i&&(0,l.jsxs)("div",{className:"nelio-content-automation-group__body",children:[(0,l.jsx)(_t,{groupId:e,activeTab:a,setActiveTab:s}),(0,l.jsx)("div",{className:"nelio-content-automation-group__body-content",children:"settings"===a.type?(0,l.jsx)(Ct,{groupId:e}):(0,l.jsx)(Ht,{groupId:e,profileId:a.id})})]})]})},an=e=>{const t=Ce(e),n=!!(null==t?void 0:t.priority),{updateAutomationGroup:i}=(0,m.useDispatch)(Oe);return[n,t=>i(e,{priority:t?100:0})]},sn=()=>{const e=h(e=>e(Oe).getAutomationGroups()),t=h(e=>e(pe.store).getPluginLimits().maxAutomationGroups),n=h(e=>e(pe.store).canCurrentUserManagePlugin()),i=e.length<t,o=(0,pe.usePostTypes)("social"),{addAutomationGroup:a,saveAutomationGroups:s}=(0,m.useDispatch)(Oe),r=h(e=>e(Oe).isSaving()),c=Ae();return(0,f.isEmpty)(e)?null:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"nelio-content-automation-group-list",children:e.map(e=>(0,l.jsx)(on,{groupId:e},e))}),(0,l.jsx)(rn,{limit:t,active:!i}),(0,l.jsxs)("div",{className:"nelio-content-automation-group-list__actions",children:[!(0,f.isEmpty)(e)&&(0,l.jsx)(Ie.Button,{className:"nelio-content-save-automation-groups",variant:"primary",onClick:s,disabled:!c||r,children:r?(0,d._x)("Saving…","text","nelio-content"):(0,d._x)("Save Changes","command","nelio-content")}),1===t&&n&&(0,l.jsx)(p.PremiumFeatureButton,{feature:"raw/automation-groups",label:(0,d._x)("Add Group","command","nelio-content"),variant:"secondary"}),1<t&&(0,l.jsx)(Ie.Button,{className:"nelio-content-add-automation-group",variant:(0,f.isEmpty)(e)?"primary":"secondary",onClick:()=>{o[0]&&a({id:(0,f.createAutomationGroupId)(),name:"",priority:100,postType:o[0].name,taxonomies:{},publication:{type:"always"},authors:[],profileSettings:{},networkSettings:{}})},disabled:r||!i,children:(0,d._x)("Add Group","command","nelio-content")})]})]})},rn=({active:e,limit:t})=>{const n=h(e=>e(pe.store).getAdminUrl("/admin.php",{page:"nelio-content-account"})),i=h(e=>e(pe.store).canCurrentUserManagePlugin()),o=h(e=>e(pe.store).isSubscribed("plus"));return e&&1!==t?(0,l.jsxs)("div",{className:"nelio-content-automation-group-list__error",children:[(0,d.sprintf)(/* translators: number of groups allowed */ /* translators: number of groups allowed */
(0,d._x)("You’ve reached the maximum number of automation groups allowed (i.e. %d).","user","nelio-content"),t)+" ",!o&&i&&(0,l.jsx)(Ie.ExternalLink,{href:n,children:(0,d._x)("Please consider upgrading your subscription.","user","nelio-content")})]}):null},ln=()=>{const e=h(e=>e(pe.store).isSocialPublicationPaused()),t=h(e=>e(pe.store).isSocialPublicationStatusBeingSynched()),{toggleSocialPublicationStatus:n}=(0,m.useDispatch)(pe.store),i=e?(0,d._x)("Resume Social Publication","command","nelio-content"):(0,d._x)("Pause Social Publication","command","nelio-content"),o=e?(0,d._x)("Resuming Social Publication…","command","nelio-content"):(0,d._x)("Pausing Social Publication…","command","nelio-content");return(0,l.jsx)(Ie.Button,{variant:"link",disabled:t,onClick:n,children:t?o:i})},cn=()=>{switch(h(e=>e(pe.store).getResetStatus())){case"ready":return(0,l.jsx)(un,{});case"resetting":return(0,l.jsx)(dn,{});case"done":return(0,l.jsx)(pn,{});case"error":return(0,l.jsx)(mn,{})}},un=()=>{const{resetSocialMessages:e}=(0,m.useDispatch)(pe.store);return(0,l.jsx)(Ie.Button,{variant:"link",onClick:e,children:(0,d._x)("Reset Social Messages","command","nelio-content")})},dn=()=>(0,l.jsx)(l.Fragment,{children:(0,d._x)("Resetting Social Messages…","text","nelio-content")}),pn=()=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Ie.Dashicon,{icon:"info"})," ",(0,d._x)("Social messages will be automatically regenerated shortly","text","nelio-content")]}),mn=()=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Ie.Dashicon,{icon:"warning"})," ",(0,d._x)("Unable to reset social messages","text","nelio-content")]}),hn=()=>{const e=Ae();return!h(e=>!!e(pe.store).canCurrentUserManagePlugin())||e?null:(0,l.jsxs)("div",{className:"nelio-content-message-actions",children:[(0,l.jsx)(cn,{}),(0,l.jsx)("span",{children:"|"}),(0,l.jsx)(ln,{})]})},gn=()=>{const{publication:e,reshare:t}=fn(),n=h(e=>e(pe.store).isSocialPublicationPaused());return e||t?(0,l.jsxs)("div",{className:"nelio-content-message-count-estimation",children:[(0,l.jsxs)("div",{children:[!!n&&yn(),!!e&&xn(e),!!t&&vn(t)]}),(0,l.jsx)(hn,{})]}):(0,l.jsx)("div",{className:"nelio-content-message-count-estimation",children:(0,l.jsx)("div",{children:(0,d._x)("Enable social automations on one or more profiles to allow Nelio Content to generate messages automatically.","user","nelio-content")})})},fn=()=>h(e=>{const{getAutomationGroup:t,getAutomationGroups:n,getProfileFrequencies:i}=e(Oe),o=n().map(t).filter(f.isDefined),a=e=>(0,g.sum)((0,g.uniq)(o.flatMap(t=>Object.keys(t.profileSettings).map(e=>e).filter(n=>{var i,o;return!!t.priority&&!!(null===(i=t.profileSettings[n])||void 0===i?void 0:i.enabled)&&!!(null===(o=t.profileSettings[n])||void 0===o?void 0:o[e].enabled)}))).map(i).filter(f.isDefined).map(t=>t[e]));return{publication:a("publication"),reshare:a("reshare")}}),yn=()=>bn((0,d._x)("<strong>Notice!</strong> Social publication is currently paused. This means Nelio Content will not share any scheduled social messages when their time comes.","usr","nelio-content")+"<br/>"),vn=e=>bn(30<e?(0,d._x)("Your calendar will contain <strong>as many messages per day as possible</strong>.","text","nelio-content"):(0,d.sprintf)(/* translators: number of social messages */ /* translators: number of social messages */
(0,d._nx)("Your calendar will contain <strong>%d social message per day</strong>.","Your calendar will contain <strong>%d social messages per day</strong>.",e,"text","nelio-content"),e)),xn=e=>bn(30<e?(0,d._x)("When publishing new content, Nelio will automatically generate <strong>as many messages as possible</strong>.","text","nelio-content"):(0,d.sprintf)(/* translators: number of social messages */ /* translators: number of social messages */
(0,d._nx)("When publishing new content, Nelio will automatically generate up to <strong>%d social message</strong>.","When publishing new content, Nelio will automatically generate up to <strong>%d social messages</strong>.",e,"text","nelio-content"),e)),bn=e=>(0,c.createInterpolateElement)(e+" ",{strong:(0,l.jsx)("strong",{}),br:(0,l.jsx)("br",{})}),jn=({resetDateTime:e})=>(0,l.jsx)("div",{className:"nelio-content-social-template-editor__reset-date-button",children:(0,l.jsx)(Ie.Button,{variant:"link",onClick:()=>e(),children:(0,d._x)("Change","command","nelio-content")})}),kn=({value:e,onChange:t,resetSelector:n})=>(0,l.jsx)(Ie.BaseControl,{id:"nelio-content-social-template-editor__date-selector",label:(0,d._x)("Date","text","nelio-content"),children:(0,l.jsxs)("div",{className:"nelio-content-social-template-editor__date-selector",children:[(0,c.createInterpolateElement)((0,d.sprintf)(/* translators: number of days */ /* translators: number of days */
(0,d._x)("%s days after publication.","text","nelio-content"),"<input/>"),{input:(0,l.jsx)(p.NumberControl,{className:"nelio-content-social-template-editor__positive-days-selector",value:e,min:2,onChange:e=>t(null!=e?e:2)})}),(0,l.jsx)(jn,{resetDateTime:n})]})}),Tn=({daysAfterPublication:e,onChange:t})=>(0,l.jsx)(Ie.BaseControl,{id:"nelio-content-social-template-editor__date-selector",label:(0,d._x)("Date","text","nelio-content"),children:(0,l.jsx)("div",{className:"nelio-content-social-template-editor__date-selector",children:(0,l.jsx)(Ie.SelectControl,{options:wn,value:`${e}`,onChange:e=>t("positive-days"===e?"positive-days":parseInt(e))})})}),wn=[{value:"0",label:(0,d._x)("Same day as publication","text","nelio-content")},{value:"1",label:(0,d._x)("The day after publication","text","nelio-content")},{value:"7",label:(0,d._x)("A week after publication","text","nelio-content")},{value:"28",label:(0,d._x)("A month after publication","text","nelio-content")},{value:"positive-days",label:(0,d._x)("__ days after publication","text","nelio-content")}],On=({days:e,onChange:t})=>{const n=h(e=>e(pe.store).getFirstDayOfWeek()),i=[{id:"sun",label:(0,d._x)("SUN","text","nelio-content")},{id:"mon",label:(0,d._x)("MON","text","nelio-content")},{id:"tue",label:(0,d._x)("TUE","text","nelio-content")},{id:"wed",label:(0,d._x)("WED","text","nelio-content")},{id:"thu",label:(0,d._x)("THU","text","nelio-content")},{id:"fri",label:(0,d._x)("FRI","text","nelio-content")},{id:"sat",label:(0,d._x)("SAT","text","nelio-content")}],o=[...i.slice(n),...i.slice(0,n)];return(0,l.jsx)(Ie.BaseControl,{id:"nelio-content-social-template-editor__week-days-selector",label:(0,d._x)("Week Days","text","nelio-content"),children:(0,l.jsx)("div",{className:"nelio-content-social-template-editor__week-days-selector",children:o.map(({id:n,label:i},o)=>(0,l.jsx)(Ie.CheckboxControl,{label:i,checked:e[n],onChange:i=>t(Object.assign(Object.assign({},e),{[n]:i}))},o))})})},Sn=({templateType:e,availability:t,setAvailability:n})=>{const[i,o]=(0,c.useState)("after-publication"===t.type&&!En(t.daysAfterPublication)),a=In(t),s=Nn(t);return"reshare"===e||"reshare"===t.type?(0,l.jsx)(On,{days:s,onChange:e=>n(Object.assign(Object.assign({},t),function(e){const{type:t}=e;switch(t){case"publication-day-offset":case"after-publication":case"publication-day-period":return!1;case"reshare":return!0}}(t)&&{weekday:Object.assign({},e)}))}):"after-publication"!==t.type||En(t.daysAfterPublication)&&!i?(0,l.jsx)(Tn,{daysAfterPublication:a,onChange:e=>{0===e?n(Object.assign(Object.assign({},t),{type:"publication-day-offset",hoursAfterPublication:"publication-day-offset"===t.type?t.hoursAfterPublication:0})):"positive-days"===e?(n(Object.assign(Object.assign({},t),{type:"after-publication",daysAfterPublication:2,time:"after-publication"===t.type?t.time:"morning"})),o(!0)):n(Object.assign(Object.assign({},t),{type:"after-publication",daysAfterPublication:e,time:"after-publication"===t.type?t.time:"morning"}))}}):(0,l.jsx)(kn,{value:t.daysAfterPublication,onChange:e=>n(Object.assign(Object.assign({},t),{type:"after-publication",daysAfterPublication:e})),resetSelector:()=>{n({type:"publication-day-offset",hoursAfterPublication:0}),o(!1)}})},In=e=>{const{type:t}=e;return"after-publication"!==t?0:e.daysAfterPublication},Nn=e=>"reshare"===e.type?e.weekday:{mon:!1,tue:!1,wed:!1,thu:!1,fri:!1,sat:!1,sun:!1};function En(e){return[0,1,7,28].includes(e)}const An=({onClick:e})=>(0,l.jsx)("div",{className:"nelio-content-social-template-editor__reset-time-button",children:(0,l.jsx)(Ie.Button,{variant:"link",onClick:e,children:(0,d._x)("Change","command","nelio-content")})}),Cn=({exactTime:e,setExactTime:t,reset:n})=>(0,l.jsx)(Ie.BaseControl,{id:"nelio-content-social-template-editor__time-selector",label:(0,d._x)("Time","text","nelio-content"),children:(0,l.jsxs)("div",{className:"nelio-content-social-template-editor__time-selector",children:[(0,l.jsx)(p.TimeInput,{value:e,onChange:e=>e?t(e):null}),(0,l.jsx)(An,{onClick:()=>n()})]})}),Pn=({hours:e,setHours:t,reset:n})=>(0,l.jsx)(Ie.BaseControl,{id:"nelio-content-social-template-editor__time-selector",label:(0,d._x)("Time","text","nelio-content"),children:(0,l.jsxs)("div",{className:"nelio-content-social-template-editor__time-selector",children:[(0,c.createInterpolateElement)((0,d.sprintf)(/* translators: number of hours */ /* translators: number of hours */
(0,d._x)("%s hours after publication.","text","nelio-content"),"<input/>"),{input:(0,l.jsx)(p.NumberControl,{className:"nelio-content-social-template-editor__positive-hours-selector",value:e,min:2,max:24,onChange:e=>t(null!=e?e:2)})}),(0,l.jsx)(An,{onClick:()=>n()})]})}),Rn=({interval:e,setIntervalValue:t,selectExactTime:n,reset:i})=>(0,l.jsxs)(Ie.BaseControl,{id:"nelio-content-social-template-editor__time-selector",label:(0,d._x)("Time","text","nelio-content"),children:[(0,l.jsx)("div",{className:"nelio-content-social-template-editor__time-selector",children:(0,l.jsx)(Ie.SelectControl,{options:Zn,value:e,onChange:e=>"exact"===e?n():t(e)})}),!!i&&(0,l.jsx)(An,{onClick:()=>i()})]}),Zn=[{value:"morning",label:(0,d._x)("Morning (8am – 11am)","text","nelio-content")},{value:"noon",label:(0,d._x)("Noon (11am – 3pm)","text","nelio-content")},{value:"afternoon",label:(0,d._x)("Afternoon (3pm – 7pm)","text","nelio-content")},{value:"night",label:(0,d._x)("Night (7pm – 11pm)","text","nelio-content")},{value:"exact",label:(0,d._x)("Choose a custom time…","user","nelio-content")}],Gn=({value:e,setValue:t,selectExactTime:n,selectPositiveHours:i,selectTimeInterval:o})=>(0,l.jsx)(Ie.BaseControl,{id:"nelio-content-social-template-editor__time-selector",label:(0,d._x)("Time","text","nelio-content"),children:(0,l.jsx)("div",{className:"nelio-content-social-template-editor__time-selector",children:(0,l.jsx)(Ie.SelectControl,{options:Mn,value:`${e}`,onChange:e=>{"positive-hours"===e?i():"exact"===e?n():"time-interval"===e?o():t(parseInt(e))}})})}),Mn=[{value:"0",label:(0,d._x)("Same time as publication","text","nelio-content")},{value:"1",label:(0,d._x)("One hour after publication","text","nelio-content")},{value:"3",label:(0,d._x)("Three hours after publication","text","nelio-content")},{value:"5",label:(0,d._x)("Five hours after publication","text","nelio-content")},{value:"positive-hours",label:(0,d._x)("__ hours after publication","text","nelio-content")},{value:"time-interval",label:(0,d._x)("Choose a time interval…","user","nelio-content")},{value:"exact",label:(0,d._x)("Choose a custom time…","user","nelio-content")}],Dn=({templateType:e,availability:t,setAvailability:n})=>{const[i,o]=(0,c.useState)("publication-day-offset"===t.type&&!Vn(t.hoursAfterPublication)),a=$n(e,i,t),s=Fn(t);return"exact"===a||"time-interval"===a&&Bn(s)?(0,l.jsx)(Cn,{exactTime:Bn(s)?s:"10:00",setExactTime:e=>n(Object.assign(Object.assign({},t),Un(t)&&{time:e})),reset:()=>n("publication-day-period"===t.type?{type:"publication-day-offset",hoursAfterPublication:0}:Object.assign(Object.assign({},t),Un(t)&&{time:"morning"}))}):"positive-hours"===a?(0,l.jsx)(Pn,{hours:"number"==typeof s?s:2,setHours:e=>n({type:"publication-day-offset",hoursAfterPublication:e}),reset:()=>{n(Object.assign(Object.assign({},t),Ln(t)&&{hoursAfterPublication:0})),o(!1)}}):"time-interval"===a?(0,l.jsx)(Rn,{interval:"number"!=typeof s&&qn(s)?s:"morning",setIntervalValue:e=>n(Object.assign(Object.assign({},t),Un(t)&&{time:e})),selectExactTime:()=>n(Object.assign(Object.assign({},t),Un(t)&&{time:"10:00"})),reset:"publication-day-period"===t.type?()=>n({type:"publication-day-offset",hoursAfterPublication:0}):void 0}):"predefined-offset"===a?(0,l.jsx)(Gn,{value:"publication-day-offset"===t.type&&Vn(t.hoursAfterPublication)?t.hoursAfterPublication:0,setValue:e=>{o(!1),n(Object.assign(Object.assign({},t),Ln(t)&&{hoursAfterPublication:e}))},selectExactTime:()=>{o(!1),n({type:"publication-day-period",time:"10:00"})},selectTimeInterval:()=>{o(!1),n({type:"publication-day-period",time:"morning"})},selectPositiveHours:()=>{o(!0),n(Object.assign(Object.assign({},t),Ln(t)&&{hoursAfterPublication:2}))}}):null},$n=(e,t,n)=>{const{type:i}=n;if("reshare"===e)return"time-interval";switch(i){case"publication-day-offset":return!n.hoursAfterPublication||!t&&Vn(n.hoursAfterPublication)?"predefined-offset":"positive-hours";case"after-publication":case"publication-day-period":case"reshare":return qn(n.time)?"time-interval":"exact"}},Fn=e=>{const{type:t}=e;switch(t){case"publication-day-offset":return e.hoursAfterPublication;case"after-publication":case"publication-day-period":case"reshare":return e.time}};function Un(e){const{type:t}=e;switch(t){case"publication-day-offset":return!1;case"after-publication":case"publication-day-period":case"reshare":return!0}}function Ln(e){return"publication-day-offset"===e.type}function Vn(e){return[0,1,3,5].includes(e)}function qn(e){return!e.includes(":")}function Bn(e){return"string"==typeof e&&!qn(e)}const zn=()=>{var e;const t=Kn(),[n,i]=Wn(),o=h(e=>e(Oe).getEditingTemplateErrors());if(!n)return null;const{availability:a}=n;return(0,l.jsxs)("div",{className:"nelio-content-availability-control",children:[!a&&(0,l.jsx)(Ie.Button,{variant:"link",onClick:()=>i({availability:Jn(t)}),children:(0,d._x)("Customize template availability","command","nelio-content")}),!!a&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:rt("nelio-content-availability-control__options",{"nelio-content-availability-control__options--reshare":"reshare"===t}),children:[(0,l.jsx)(Sn,{templateType:t,availability:a,setAvailability:e=>i({availability:e})}),(0,l.jsx)(Dn,{templateType:t,availability:a,setAvailability:e=>i({availability:e})})]}),(0,l.jsx)("div",{className:"nelio-content-availability-control__error",children:null!==(e=o.availability)&&void 0!==e?e:""}),(0,l.jsx)("div",{children:(0,l.jsx)(Ie.Button,{variant:"link",onClick:()=>i({availability:void 0}),children:(0,d._x)("Make template always available","command","nelio-content")})})]})]})},Wn=()=>{const e=h(e=>e(Oe).getEditingTemplate()),{setEditingTemplateAttributes:t}=(0,m.useDispatch)(Oe);return[e,t]},Kn=()=>h(e=>e(Oe).getEditingTemplateType()),Jn=e=>"publication"===e?{type:"publication-day-offset",hoursAfterPublication:0}:{type:"reshare",weekday:{mon:!0,tue:!0,wed:!0,thu:!0,fri:!0,sat:!0,sun:!0},time:"morning"},Hn=[{title:(0,d._x)("Social Template Editor","text","nelio-content"),intro:(0,d._x)("Welcome to the social template editor, the easiest way to create custom templates for sharing your content on social media.","user","nelio-content"),elementToClick:()=>null,element:()=>document.querySelector(".nelio-content-social-template-editor-dialog")},{title:(0,d._x)("Message","text","nelio-content"),intro:(0,d._x)("Here you can write the template itself. Add placeholders like, for example, {title} or {tags}, which will be then replaced by Nelio Content when the template is used for sharing a specific post from your site.","user","nelio-content"),elementToClick:()=>null,element:()=>document.querySelector(".nelio-content-social-template-editor-dialog__text")},{title:(0,d._x)("Placeholders","text","nelio-content"),intro:(0,d._x)("If you don’t know which placeholders are available, use this action and select the placeholder(s) you want to include in your template.","user","nelio-content"),elementToClick:()=>null,element:()=>document.querySelector(".nelio-content-social-template-editor-dialog__add-placeholder")},{title:(0,d._x)("Additional Filters","text","nelio-content"),intro:(0,d._x)("By default, templates apply to all content in the Automation Group. But you can narrow the selection using these actions here.","user","nelio-content"),elementToClick:()=>null,element:()=>document.querySelector(".nelio-content-social-template-editor-dialog__quick-actions .is-link")||document.querySelector(".nelio-content-social-template-editor-dialog__tab-selector")},{title:(0,d._x)("Content Type","text","nelio-content"),intro:(0,d._x)("Depending on the content selected in the Automation Group, you’ll be able to filter the tempate by taxonomy and/or author.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-social-template-editor-dialog__quick-actions .is-link"),element:()=>document.querySelector(".nelio-content-social-template-editor-dialog__tab-selector")},{title:(0,d._x)("Template Availability","text","nelio-content"),intro:(0,d._x)("You can also customize the template’s availability (i.e. when a template is eligible). For instance, let Nelio Content use a template on post’s publication or on a Monday morning","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-social-template-editor__availability-action"),element:()=>document.querySelector(".nelio-content-availability-control")},{title:(0,d._x)("Save Changes","text","nelio-content"),intro:(0,d._x)("Save the template using the “Save” button. If there are any errors, the button will be disabled – hover it to reveal the error.","user","nelio-content"),elementToClick:()=>null,element:()=>document.querySelector(".nelio-content-social-template-editor-dialog__save-button")}];let Yn;const Xn=()=>{"function"==typeof Yn&&Yn()},Qn=({onClick:e})=>{const t=ti(),n=ei(),i=(e=>h(t=>{const n=t(Oe).getCustomFields();return e?n[e]||[]:(0,g.values)((0,g.keyBy)((0,g.values)(n).flatMap(e=>e),"key"))}))(t),o=(e=>h(t=>{const n=t(Oe).getCustomPlaceholders();return e?n[e]||[]:(0,g.values)((0,g.keyBy)((0,g.values)(n).flatMap(e=>e),"key"))}))(t),a=ni();return(0,l.jsx)(Ie.DropdownMenu,{className:"nelio-content-social-template-editor-dialog__quick-action nelio-content-social-template-editor-dialog__add-placeholder",icon:"tag",label:(0,d._x)("Placeholders","text","nelio-content"),toggleProps:{tooltipPosition:"bottom center"},popoverProps:{onFocusOutside:Xn},children:({onClose:t})=>(Yn=t,(0,l.jsxs)(Ie.MenuGroup,{children:[(0,l.jsxs)(Ie.MenuGroup,{children:[n.title&&(0,l.jsx)(Ie.MenuItem,{role:"menuitem",icon:"editor-textcolor",onClick:()=>e("{title}"),children:(0,d._x)("Add Title","command","nelio-content")}),(0,l.jsx)(Ie.MenuItem,{role:"menuitem",icon:"format-status",onClick:()=>e("{phrase}"),children:(0,d._x)("Add Content Phrase","command","nelio-content")}),(0,l.jsx)(Ie.MenuItem,{role:"menuitem",icon:"editor-quote",onClick:()=>e("{highlight}"),children:(0,d._x)("Add Highlight","command","nelio-content")}),n.author&&(0,l.jsx)(Ie.MenuItem,{role:"menuitem",icon:"admin-users",onClick:()=>e("{author}"),children:(0,d._x)("Add Author","command","nelio-content")}),n.excerpt&&(0,l.jsx)(Ie.MenuItem,{role:"menuitem",icon:"text",onClick:()=>e("{excerpt}"),children:(0,d._x)("Add Excerpt","command","nelio-content")}),(0,l.jsx)(Ie.MenuItem,{role:"menuitem",icon:"admin-links",onClick:()=>e("{permalink}"),children:(0,d._x)("Add Permalink","command","nelio-content")})]}),!!a.length&&(0,l.jsx)(Ie.MenuGroup,{label:(0,d._x)("Taxonomies","text","nelio-content"),children:a.map(({slug:t,labels:n})=>(0,l.jsx)(Ie.MenuItem,{role:"menuitem",icon:oi(t),onClick:()=>e(ai(t)),children:(0,d.sprintf)(/* translators: taxonomy name */ /* translators: taxonomy name */
(0,d._x)("Add %s","command","nelio-content"),n.name)},t))}),!!i.length&&(0,l.jsx)(Ie.MenuGroup,{label:(0,d._x)("Custom fields","text","nelio-content"),children:i.map(({key:t,name:n})=>(0,l.jsx)(Ie.MenuItem,{role:"menuitem",icon:"welcome-widgets-menus",onClick:()=>e(`{field:${t}}`),children:(0,d.sprintf)(/* translators: custom field name */ /* translators: custom field name */
(0,d._x)("Add %s","command","nelio-content"),n)},t))}),!!o.length&&(0,l.jsx)(Ie.MenuGroup,{label:(0,d._x)("Custom placeholders","text","nelio-content"),children:o.map(({key:t,name:n})=>(0,l.jsx)(Ie.MenuItem,{role:"menuitem",icon:"plus-alt",onClick:()=>e(`{custom:${t}}`),children:(0,d.sprintf)(/* translators: custom placeholder name */ /* translators: custom placeholder name */
(0,d._x)("Add %s","command","nelio-content"),n)},t))})]}))})},ei=()=>{const e=ti();return h(t=>{const n=e?[e]:(0,g.map)(t(pe.store).getPostTypes("social"),"name"),{getEntityRecord:i}=t(de.store),o=n.map(e=>i("root","postType",e)).filter(ii).filter(f.isDefined);return{author:o.some(e=>{var t;return!!(null===(t=e.supports)||void 0===t?void 0:t.author)}),excerpt:o.some(e=>{var t;return!!(null===(t=e.supports)||void 0===t?void 0:t.excerpt)}),title:o.some(e=>{var t;return!!(null===(t=e.supports)||void 0===t?void 0:t.title)})}})},ti=()=>h(e=>{var t;return null===(t=e(Oe).getEditingTemplate())||void 0===t?void 0:t.postType}),ni=()=>h(e=>{var t,n;e(de.store),e(pe.store);const{getEditingTemplate:i}=e(Oe),o=i();if(!o)return[];const{getPostTypes:a}=e(pe.store),s=o.postType?[o.postType]:null!==(t=(0,g.map)(a("social"),"name"))&&void 0!==t?t:[],{getEntityRecords:r}=e(de.store);return(null!==(n=r("root","taxonomy",{per_page:-1}))&&void 0!==n?n:[]).filter(e=>!!e).filter(e=>e.visibility.public&&s.some(t=>e.types.includes(t)))}),ii=e=>!!e,oi=e=>{switch(e){case"category":case"product_cat":return"category";case"post_tag":case"product_tag":return"tag";default:return"archive"}},ai=e=>{switch(e){case"category":case"product_cat":return"{categories}";case"post_tag":case"product_tag":return"{tags}";default:return`{taxonomy:${e}}`}},si=({data:{label:e,image:t},isFocused:n,isSelected:i,innerRef:o,innerProps:a})=>(0,l.jsxs)("div",Object.assign({ref:o,className:rt({"nelio-content-target-option-in-profile-selector":!0,"nelio-content-target-option-in-profile-selector--is-focused":n,"nelio-content-target-option-in-profile-selector--is-selected":i})},a,{children:[(0,l.jsx)("div",{className:"nelio-content-target-option-in-profile-selector__icon-wrapper",children:(0,l.jsx)("div",{className:"nelio-content-target-option-in-profile-selector__icon",style:{backgroundImage:`url(${t||""})`}})}),(0,l.jsx)("div",{className:"nelio-content-target-option-in-profile-selector__label",children:e})]})),ri=({network:e,profileId:t,targetName:n,onTargetChange:i})=>{const{targets:o,isLoadingTargets:a}=li(t,e);if(!t||!o)return null;const s=(0,g.map)(o,e=>({value:e.name,label:e.displayName,image:e.image})),r=n?(0,g.find)(s,{value:n}):void 0;return(0,l.jsx)("div",{className:"nelio-content-social-profile-selector__targets",children:(0,l.jsx)(p.StylizedSelectControl,{disabled:a,placeholder:a?(0,d._x)("Loading…","text","nelio-content"):(0,Ee.getTargetLabel)("selectTarget",e),options:s,value:r,onChange:e=>i(null==e?void 0:e.value),components:{Option:si}})})},li=(e,t)=>h(n=>{if(n(pe.store),!e||!(0,Ee.doesNetworkSupport)("multi-target",t))return{};const{getTargetsInProfile:i}=n(pe.store),o=i(e);return{isLoadingTargets:void 0===o,targets:o||[]}}),ci=({className:e=""})=>{const t=mi(),[n,i]=gi(),[o,a]=(0,c.useState)("availability"),[s,r]=fi(),{isNewTemplate:u,templateType:h}=_i(),f=hi(null==s?void 0:s.groupId),y=Ge(null==s?void 0:s.postType),[_,v]=yi(),{closeTemplateEditor:x,receiveAutomationGroupTemplates:b}=(0,m.useDispatch)(Oe),j=vi();xi();const k=Ze(null==s?void 0:s.postType);if((0,c.useEffect)(()=>{f.length>1?a("postType"):k.length?a("taxonomy"):a(y?"author":"availability")},[f.length,null==s?void 0:s.postType]),!t||!s||!k)return null;const T=()=>{x(),i(!1)},{text:w,network:O}=s,S=e=>r({text:e});return(0,l.jsxs)(Ie.Modal,{className:`nelio-content-social-template-editor-dialog ${e}`,title:_?ki(u):Ti(u),isDismissible:!1,shouldCloseOnEsc:!1,shouldCloseOnClickOutside:!1,onRequestClose:()=>{},children:[(0,l.jsx)(ri,{network:s.network,profileId:s.profileId,targetName:s.targetName,onTargetChange:e=>r({targetName:e})}),(0,l.jsx)(Ie.TextareaControl,{className:"nelio-content-social-template-editor-dialog__text",value:w,onChange:S,placeholder:(0,d._x)("Write a template…","user","nelio-content")}),(0,l.jsxs)("div",{className:"nelio-content-social-template-editor-dialog__quick-actions",children:[n?(0,l.jsx)(pi,{className:"nelio-content-social-template-editor-dialog__tab-selector",tab:o,availableTabs:[f.length>1&&"postType",!!k.length&&"taxonomy",y&&"author","availability","attachment"],setTab:a}):(0,l.jsx)(Ie.Button,{variant:"link",onClick:()=>i(!0),children:(0,d._x)("Additional options","command","nelio-content")}),(0,l.jsx)("div",{className:"nelio-content-social-template-editor-dialog__quick-action-spacer"}),u&&(0,Ee.doesNetworkSupport)("network-template",O)&&!(0,Ee.doesNetworkSupport)("multi-target",O)&&(0,l.jsx)(Ie.Button,{className:rt({"nelio-content-social-template-editor-dialog__quick-action":!0,"nelio-content-social-template-editor-dialog__quick-action--is-preview":!0,"nelio-content-social-template-editor-dialog__quick-action--is-toggled":_}),icon:(0,Ee.getNetworkIcon)(O),label:(0,d.sprintf)(/* translators: network name */ /* translators: network name */
(0,d._x)("Network template (available to all %s profiles)","text","nelio-content"),(0,Ee.getNetworkLabel)("name",O)),onClick:()=>v(!_)}),(0,l.jsx)(Qn,{onClick:e=>(e=>S(/[^\s]$/.test(w)?`${w} ${e}`:`${w}${e}`))(e)})]}),n&&(0,l.jsx)(ui,{type:o}),(0,l.jsxs)("div",{className:"nelio-content-social-template-editor-dialog__buttons",children:[(0,l.jsx)(p.ContextualHelp,{context:"social-template-editor",walkthrough:Hn,autostart:!0}),(0,l.jsxs)("div",{className:"nelio-content-social-template-editor-dialog__default-buttons-wrapper",children:[(0,l.jsx)(Ie.Button,{className:"nelio-content-social-template-editor-dialog__cancel-button",variant:"secondary",onClick:T,children:(0,d._x)("Cancel","command","nelio-content")}),(0,l.jsx)(p.SaveButton,{className:"nelio-content-social-template-editor-dialog__save-button",variant:"primary",isUpdate:!u,error:j,onClick:()=>{T(),b(h,Object.assign(Object.assign({},s),{taxonomies:(0,g.pick)(s.taxonomies,(0,g.map)(k,"slug")),profileId:_?void 0:s.profileId,targetName:_?void 0:s.targetName}))}})]})]})]})},ui=({type:e})=>{const[t,n]=fi(),i=(0,pe.usePostTypes)("social"),o=Ze(null==t?void 0:t.postType),a=Re(null==t?void 0:t.postType),s=h(e=>e(Oe).getEditingTemplateErrors()),r=bi(null==t?void 0:t.attachment);if(!t||!s)return null;const{author:c}=t;if(!a)return(0,l.jsx)("div",{className:"nelio-content-social-template-editor-dialog__extra",children:(0,l.jsx)(Ie.Spinner,{})});switch(e){case"postType":return(0,l.jsx)("div",{className:"nelio-content-social-template-editor-dialog__extra",children:(0,l.jsx)(Ie.SelectControl,{value:(null==t?void 0:t.postType)||"__nc-all",options:[{value:"__nc-all",label:(0,d._x)("All Content","text","nelio-content")},...i.map(e=>({value:e.name,label:e.labels.plural||e.labels.singular||e.name}))],onChange:e=>n("__nc-all"===e?{postType:void 0}:{postType:e})})});case"taxonomy":return(0,l.jsx)("div",{className:"nelio-content-social-template-editor-dialog__extra",children:o.map(e=>(0,l.jsx)(p.ItemSelectControl,{error:s.taxonomies[e.slug],isSingle:!0,kind:"taxonomy",label:e.labels.singular_name,name:e.slug,value:t.taxonomies[e.slug],onChange:i=>n({taxonomies:ji(Object.assign(Object.assign({},t.taxonomies),{[e.slug]:i||void 0}))})},e.slug))});case"author":return(0,l.jsx)("div",{className:"nelio-content-social-template-editor-dialog__extra",children:(0,l.jsx)(p.ItemSelectControl,{isSingle:!0,error:s.author,kind:"author",label:(0,d._x)("Author","text","nelio-content"),value:c,onChange:e=>n({author:e})})});case"availability":return(0,l.jsx)("div",{className:"nelio-content-social-template-editor-dialog__extra",children:(0,l.jsx)(zn,{})});case"attachment":return(0,l.jsx)("div",{className:"nelio-content-social-template-editor-dialog__extra",children:(0,l.jsx)(Ie.SelectControl,{options:[{label:(0,d._x)("Auto Image","text","nelio-content"),value:"auto-image"},{label:(0,d._x)("Text","text","nelio-content"),value:"none"},{label:(0,d._x)("Image","text","nelio-content"),value:"image"},"video"===(null==t?void 0:t.attachment)?{label:(0,d._x)("Video","text","nelio-content"),value:"video"}:void 0].filter(f.isDefined),value:(null==t?void 0:t.attachment)||"auto-image",onChange:e=>n({attachment:"auto-image"===e?void 0:e}),help:r})})}},di={postType:{icon:"admin-post",title:(0,d._x)("Post Type","text","nelio-content")},taxonomy:{icon:"archive",title:(0,d._x)("Taxonomies","text","nelio-content")},author:{icon:"admin-users",title:(0,d._x)("Author","text","nelio-content")},availability:{icon:"calendar-alt",title:(0,d._x)("Availability","text","nelio-content")},attachment:{icon:"format-gallery",title:(0,d._x)("Media Requirements","text","nelio-content")}},pi=({className:e,availableTabs:t,tab:n,setTab:i})=>(0,l.jsx)(Ie.Toolbar,{className:e,label:(0,d._x)("Settings","text","nelio-content"),children:t.filter(e=>!!e).map(e=>(0,l.jsx)(Ie.ToolbarButton,{className:`nelio-content-social-template-editor__${e}-action`,icon:di[e].icon,title:di[e].title,isActive:n===e,onClick:()=>i(e)},e))}),mi=()=>h(e=>e(Oe).isEditingTemplate()),hi=e=>{const t=Ce(e);return(0,pe.usePostTypes)("social").filter(e=>(0,f.isUniversalGroup)(t)||e.name===(null==t?void 0:t.postType))},gi=()=>{const e=mi(),[t]=fi(),[n,i]=(0,c.useState)(!1);return(0,c.useEffect)(()=>{i(!(!e||!(null==t?void 0:t.author)&&!(0,g.keys)(null==t?void 0:t.taxonomies).length&&!(null==t?void 0:t.availability)))},[e]),[n,i]},fi=()=>{const e=h(e=>e(Oe).getEditingTemplate()),{setEditingTemplateAttributes:t}=(0,m.useDispatch)(Oe);return[e,t]},yi=()=>{const e=h(e=>e(Oe).isEditingNetworkTemplate()),{markAsNetworkTemplate:t}=(0,m.useDispatch)(Oe);return[e,t]},_i=()=>({isNewTemplate:h(e=>e(Oe).isEditingNewTemplate()),templateType:h(e=>e(Oe).getEditingTemplateType())}),vi=()=>{const e=h(e=>e(Oe).getEditingTemplateErrors());return e.target||e.content||(e.author?e.author:(0,g.values)(e.taxonomies).some(Boolean)?(0,d._x)("Please review selected terms","user","nelio-content"):e.availability?(0,d._x)("Please review availability settings","user","nelio-content"):"")},xi=()=>{const e=mi(),[t]=fi(),{setEditingTemplateErrors:n}=(0,m.useDispatch)(Oe),i=Ce(null==t?void 0:t.groupId),o=Me(i,t?[t]:[]);(0,c.useEffect)(()=>{if(!e||!(null==t?void 0:t.id))return;const i=o[t.id];i&&n(i)},[e,JSON.stringify(o)])},bi=e=>{switch(e){case void 0:return(0,d._x)("Nelio Content may sometimes generate messages that share an image from related content","text","nelio-content");case"none":return(0,d._x)("Nelio Content won’t attach any images to messages generated using this template","text","nelio-content");case"image":return(0,d._x)("Nelio Content will only use this template if it can extract an image from shared content","text","nelio-content");case"video":return""}},ji=e=>(0,g.keys)(e).reduce((t,n)=>e[n]?Object.assign(Object.assign({},t),{[n]:e[n]}):t,{}),ki=e=>e?(0,d._x)("New Network Template","text","nelio-content"):(0,d._x)("Edit Network Template","text","nelio-content"),Ti=e=>e?(0,d._x)("New Template","text","nelio-content"):(0,d._x)("Edit Template","text","nelio-content");var wi,Oi;!function(e){e.assertEqual=e=>{},e.assertIs=function(e){},e.assertNever=function(_x){throw new Error},e.arrayToEnum=e=>{const t={};for(const n of e)t[n]=n;return t},e.getValidEnumValues=t=>{const n=e.objectKeys(t).filter(e=>"number"!=typeof t[t[e]]),i={};for(const e of n)i[e]=t[e];return e.objectValues(i)},e.objectValues=t=>e.objectKeys(t).map(function(e){return t[e]}),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},e.find=(e,t)=>{for(const n of e)if(t(n))return n},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(wi||(wi={})),function(e){e.mergeShapes=(e,t)=>({...e,...t})}(Oi||(Oi={}));const Si=wi.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ii=e=>{switch(typeof e){case"undefined":return Si.undefined;case"string":return Si.string;case"number":return Number.isNaN(e)?Si.nan:Si.number;case"boolean":return Si.boolean;case"function":return Si.function;case"bigint":return Si.bigint;case"symbol":return Si.symbol;case"object":return Array.isArray(e)?Si.array:null===e?Si.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?Si.promise:"undefined"!=typeof Map&&e instanceof Map?Si.map:"undefined"!=typeof Set&&e instanceof Set?Si.set:"undefined"!=typeof Date&&e instanceof Date?Si.date:Si.object;default:return Si.unknown}},Ni=wi.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Ei=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class Ai extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(e){return e.message},n={_errors:[]},i=e=>{for(const o of e.issues)if("invalid_union"===o.code)o.unionErrors.map(i);else if("invalid_return_type"===o.code)i(o.returnTypeError);else if("invalid_arguments"===o.code)i(o.argumentsError);else if(0===o.path.length)n._errors.push(t(o));else{let e=n,i=0;for(;i<o.path.length;){const n=o.path[i];i===o.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(t(o))):e[n]=e[n]||{_errors:[]},e=e[n],i++}}};return i(this),n}static assert(e){if(!(e instanceof Ai))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,wi.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){const t={},n=[];for(const i of this.issues)if(i.path.length>0){const n=i.path[0];t[n]=t[n]||[],t[n].push(e(i))}else n.push(e(i));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}Ai.create=e=>new Ai(e);const Ci=(e,t)=>{let n;switch(e.code){case Ni.invalid_type:n=e.received===Si.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case Ni.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,wi.jsonStringifyReplacer)}`;break;case Ni.unrecognized_keys:n=`Unrecognized key(s) in object: ${wi.joinValues(e.keys,", ")}`;break;case Ni.invalid_union:n="Invalid input";break;case Ni.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${wi.joinValues(e.options)}`;break;case Ni.invalid_enum_value:n=`Invalid enum value. Expected ${wi.joinValues(e.options)}, received '${e.received}'`;break;case Ni.invalid_arguments:n="Invalid function arguments";break;case Ni.invalid_return_type:n="Invalid function return type";break;case Ni.invalid_date:n="Invalid date";break;case Ni.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:wi.assertNever(e.validation):n="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case Ni.too_small:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type||"bigint"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case Ni.too_big:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case Ni.custom:n="Invalid input";break;case Ni.invalid_intersection_types:n="Intersection results could not be merged";break;case Ni.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Ni.not_finite:n="Number must be finite";break;default:n=t.defaultError,wi.assertNever(e)}return{message:n}};let Pi=Ci;function Ri(e){Pi=e}function Zi(){return Pi}const Gi=e=>{const{data:t,path:n,errorMaps:i,issueData:o}=e,a=[...n,...o.path||[]],s={...o,path:a};if(void 0!==o.message)return{...o,path:a,message:o.message};let r="";const l=i.filter(e=>!!e).slice().reverse();for(const e of l)r=e(s,{data:t,defaultError:r}).message;return{...o,path:a,message:r}},Mi=[];function Di(e,t){const n=Zi(),i=Gi({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===Ci?void 0:Ci].filter(e=>!!e)});e.common.issues.push(i)}class $i{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const i of t){if("aborted"===i.status)return Fi;"dirty"===i.status&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const e of t){const t=await e.key,i=await e.value;n.push({key:t,value:i})}return $i.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const i of t){const{key:t,value:o}=i;if("aborted"===t.status)return Fi;if("aborted"===o.status)return Fi;"dirty"===t.status&&e.dirty(),"dirty"===o.status&&e.dirty(),"__proto__"===t.value||void 0===o.value&&!i.alwaysSet||(n[t.value]=o.value)}return{status:e.value,value:n}}}const Fi=Object.freeze({status:"aborted"}),Ui=e=>({status:"dirty",value:e}),Li=e=>({status:"valid",value:e}),Vi=e=>"aborted"===e.status,qi=e=>"dirty"===e.status,Bi=e=>"valid"===e.status,zi=e=>"undefined"!=typeof Promise&&e instanceof Promise;var Wi;!function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:e?.message}(Wi||(Wi={}));class Ki{constructor(e,t,n,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Ji=(e,t)=>{if(Bi(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Ai(e.common.issues);return this._error=t,this._error}}};function Hi(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:i,description:o}=e;if(t&&(n||i))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:o}:{errorMap:(t,o)=>{const{message:a}=e;return"invalid_enum_value"===t.code?{message:a??o.defaultError}:void 0===o.data?{message:a??i??o.defaultError}:"invalid_type"!==t.code?{message:o.defaultError}:{message:a??n??o.defaultError}},description:o}}class Yi{get description(){return this._def.description}_getType(e){return Ii(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Ii(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new $i,ctx:{common:e.parent.common,data:e.data,parsedType:Ii(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(zi(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){const n={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ii(e)},i=this._parseSync({data:e,path:n.path,parent:n});return Ji(n,i)}"~validate"(e){const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ii(e)};if(!this["~standard"].async)try{const n=this._parseSync({data:e,path:[],parent:t});return Bi(n)?{value:n.value}:{issues:t.common.issues}}catch(e){e?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(e=>Bi(e)?{value:e.value}:{issues:t.common.issues})}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ii(e)},i=this._parse({data:e,path:n.path,parent:n}),o=await(zi(i)?i:Promise.resolve(i));return Ji(n,o)}refine(e,t){const n=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement((t,i)=>{const o=e(t),a=()=>i.addIssue({code:Ni.custom,...n(t)});return"undefined"!=typeof Promise&&o instanceof Promise?o.then(e=>!!e||(a(),!1)):!!o||(a(),!1)})}refinement(e,t){return this._refinement((n,i)=>!!e(n)||(i.addIssue("function"==typeof t?t(n,i):t),!1))}_refinement(e){return new ea({schema:this,typeName:ma.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return ta.create(this,this._def)}nullable(){return na.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Zo.create(this)}promise(){return Qo.create(this,this._def)}or(e){return Do.create([this,e],this._def)}and(e){return Lo.create(this,e,this._def)}transform(e){return new ea({...Hi(this._def),schema:this,typeName:ma.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new ia({...Hi(this._def),innerType:this,defaultValue:t,typeName:ma.ZodDefault})}brand(){return new ra({typeName:ma.ZodBranded,type:this,...Hi(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new oa({...Hi(this._def),innerType:this,catchValue:t,typeName:ma.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return la.create(this,e)}readonly(){return ca.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Xi=/^c[^\s-]{8,}$/i,Qi=/^[0-9a-z]+$/,eo=/^[0-9A-HJKMNP-TV-Z]{26}$/i,to=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,no=/^[a-z0-9_-]{21}$/i,io=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,oo=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,ao=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let so;const ro=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,lo=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,co=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,uo=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,po=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,mo=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,ho="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",go=new RegExp(`^${ho}$`);function fo(e){let t="[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`),`([01]\\d|2[0-3]):[0-5]\\d(:${t})${e.precision?"+":"?"}`}function yo(e){return new RegExp(`^${fo(e)}$`)}function _o(e){let t=`${ho}T${fo(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function vo(e,t){return!("v4"!==t&&t||!ro.test(e))||!("v6"!==t&&t||!co.test(e))}function xo(e,t){if(!io.test(e))return!1;try{const[n]=e.split(".");if(!n)return!1;const i=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),o=JSON.parse(atob(i));return!("object"!=typeof o||null===o||"typ"in o&&"JWT"!==o?.typ||!o.alg||t&&o.alg!==t)}catch{return!1}}function bo(e,t){return!("v4"!==t&&t||!lo.test(e))||!("v6"!==t&&t||!uo.test(e))}class jo extends Yi{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Si.string){const t=this._getOrReturnCtx(e);return Di(t,{code:Ni.invalid_type,expected:Si.string,received:t.parsedType}),Fi}const t=new $i;let n;for(const i of this._def.checks)if("min"===i.kind)e.data.length<i.value&&(n=this._getOrReturnCtx(e,n),Di(n,{code:Ni.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("max"===i.kind)e.data.length>i.value&&(n=this._getOrReturnCtx(e,n),Di(n,{code:Ni.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("length"===i.kind){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(n=this._getOrReturnCtx(e,n),o?Di(n,{code:Ni.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&Di(n,{code:Ni.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),t.dirty())}else if("email"===i.kind)ao.test(e.data)||(n=this._getOrReturnCtx(e,n),Di(n,{validation:"email",code:Ni.invalid_string,message:i.message}),t.dirty());else if("emoji"===i.kind)so||(so=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),so.test(e.data)||(n=this._getOrReturnCtx(e,n),Di(n,{validation:"emoji",code:Ni.invalid_string,message:i.message}),t.dirty());else if("uuid"===i.kind)to.test(e.data)||(n=this._getOrReturnCtx(e,n),Di(n,{validation:"uuid",code:Ni.invalid_string,message:i.message}),t.dirty());else if("nanoid"===i.kind)no.test(e.data)||(n=this._getOrReturnCtx(e,n),Di(n,{validation:"nanoid",code:Ni.invalid_string,message:i.message}),t.dirty());else if("cuid"===i.kind)Xi.test(e.data)||(n=this._getOrReturnCtx(e,n),Di(n,{validation:"cuid",code:Ni.invalid_string,message:i.message}),t.dirty());else if("cuid2"===i.kind)Qi.test(e.data)||(n=this._getOrReturnCtx(e,n),Di(n,{validation:"cuid2",code:Ni.invalid_string,message:i.message}),t.dirty());else if("ulid"===i.kind)eo.test(e.data)||(n=this._getOrReturnCtx(e,n),Di(n,{validation:"ulid",code:Ni.invalid_string,message:i.message}),t.dirty());else if("url"===i.kind)try{new URL(e.data)}catch{n=this._getOrReturnCtx(e,n),Di(n,{validation:"url",code:Ni.invalid_string,message:i.message}),t.dirty()}else"regex"===i.kind?(i.regex.lastIndex=0,i.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),Di(n,{validation:"regex",code:Ni.invalid_string,message:i.message}),t.dirty())):"trim"===i.kind?e.data=e.data.trim():"includes"===i.kind?e.data.includes(i.value,i.position)||(n=this._getOrReturnCtx(e,n),Di(n,{code:Ni.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),t.dirty()):"toLowerCase"===i.kind?e.data=e.data.toLowerCase():"toUpperCase"===i.kind?e.data=e.data.toUpperCase():"startsWith"===i.kind?e.data.startsWith(i.value)||(n=this._getOrReturnCtx(e,n),Di(n,{code:Ni.invalid_string,validation:{startsWith:i.value},message:i.message}),t.dirty()):"endsWith"===i.kind?e.data.endsWith(i.value)||(n=this._getOrReturnCtx(e,n),Di(n,{code:Ni.invalid_string,validation:{endsWith:i.value},message:i.message}),t.dirty()):"datetime"===i.kind?_o(i).test(e.data)||(n=this._getOrReturnCtx(e,n),Di(n,{code:Ni.invalid_string,validation:"datetime",message:i.message}),t.dirty()):"date"===i.kind?go.test(e.data)||(n=this._getOrReturnCtx(e,n),Di(n,{code:Ni.invalid_string,validation:"date",message:i.message}),t.dirty()):"time"===i.kind?yo(i).test(e.data)||(n=this._getOrReturnCtx(e,n),Di(n,{code:Ni.invalid_string,validation:"time",message:i.message}),t.dirty()):"duration"===i.kind?oo.test(e.data)||(n=this._getOrReturnCtx(e,n),Di(n,{validation:"duration",code:Ni.invalid_string,message:i.message}),t.dirty()):"ip"===i.kind?vo(e.data,i.version)||(n=this._getOrReturnCtx(e,n),Di(n,{validation:"ip",code:Ni.invalid_string,message:i.message}),t.dirty()):"jwt"===i.kind?xo(e.data,i.alg)||(n=this._getOrReturnCtx(e,n),Di(n,{validation:"jwt",code:Ni.invalid_string,message:i.message}),t.dirty()):"cidr"===i.kind?bo(e.data,i.version)||(n=this._getOrReturnCtx(e,n),Di(n,{validation:"cidr",code:Ni.invalid_string,message:i.message}),t.dirty()):"base64"===i.kind?po.test(e.data)||(n=this._getOrReturnCtx(e,n),Di(n,{validation:"base64",code:Ni.invalid_string,message:i.message}),t.dirty()):"base64url"===i.kind?mo.test(e.data)||(n=this._getOrReturnCtx(e,n),Di(n,{validation:"base64url",code:Ni.invalid_string,message:i.message}),t.dirty()):wi.assertNever(i);return{status:t.value,value:e.data}}_regex(e,t,n){return this.refinement(t=>e.test(t),{validation:t,code:Ni.invalid_string,...Wi.errToObj(n)})}_addCheck(e){return new jo({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Wi.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Wi.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Wi.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Wi.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Wi.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Wi.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Wi.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Wi.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Wi.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Wi.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Wi.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Wi.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Wi.errToObj(e)})}datetime(e){return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===e?.precision?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...Wi.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===e?.precision?null:e?.precision,...Wi.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...Wi.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...Wi.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...Wi.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...Wi.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...Wi.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...Wi.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...Wi.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...Wi.errToObj(t)})}nonempty(e){return this.min(1,Wi.errToObj(e))}trim(){return new jo({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new jo({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new jo({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function ko(e,t){const n=(e.toString().split(".")[1]||"").length,i=(t.toString().split(".")[1]||"").length,o=n>i?n:i;return Number.parseInt(e.toFixed(o).replace(".",""))%Number.parseInt(t.toFixed(o).replace(".",""))/10**o}jo.create=e=>new jo({checks:[],typeName:ma.ZodString,coerce:e?.coerce??!1,...Hi(e)});class To extends Yi{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Si.number){const t=this._getOrReturnCtx(e);return Di(t,{code:Ni.invalid_type,expected:Si.number,received:t.parsedType}),Fi}let t;const n=new $i;for(const i of this._def.checks)"int"===i.kind?wi.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),Di(t,{code:Ni.invalid_type,expected:"integer",received:"float",message:i.message}),n.dirty()):"min"===i.kind?(i.inclusive?e.data<i.value:e.data<=i.value)&&(t=this._getOrReturnCtx(e,t),Di(t,{code:Ni.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):"max"===i.kind?(i.inclusive?e.data>i.value:e.data>=i.value)&&(t=this._getOrReturnCtx(e,t),Di(t,{code:Ni.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):"multipleOf"===i.kind?0!==ko(e.data,i.value)&&(t=this._getOrReturnCtx(e,t),Di(t,{code:Ni.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):"finite"===i.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),Di(t,{code:Ni.not_finite,message:i.message}),n.dirty()):wi.assertNever(i);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Wi.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Wi.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Wi.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Wi.toString(t))}setLimit(e,t,n,i){return new To({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:Wi.toString(i)}]})}_addCheck(e){return new To({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Wi.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Wi.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Wi.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Wi.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Wi.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Wi.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:Wi.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Wi.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Wi.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&wi.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if("finite"===n.kind||"int"===n.kind||"multipleOf"===n.kind)return!0;"min"===n.kind?(null===t||n.value>t)&&(t=n.value):"max"===n.kind&&(null===e||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}To.create=e=>new To({checks:[],typeName:ma.ZodNumber,coerce:e?.coerce||!1,...Hi(e)});class wo extends Yi{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==Si.bigint)return this._getInvalidInput(e);let t;const n=new $i;for(const i of this._def.checks)"min"===i.kind?(i.inclusive?e.data<i.value:e.data<=i.value)&&(t=this._getOrReturnCtx(e,t),Di(t,{code:Ni.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):"max"===i.kind?(i.inclusive?e.data>i.value:e.data>=i.value)&&(t=this._getOrReturnCtx(e,t),Di(t,{code:Ni.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):"multipleOf"===i.kind?e.data%i.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),Di(t,{code:Ni.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):wi.assertNever(i);return{status:n.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return Di(t,{code:Ni.invalid_type,expected:Si.bigint,received:t.parsedType}),Fi}gte(e,t){return this.setLimit("min",e,!0,Wi.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Wi.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Wi.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Wi.toString(t))}setLimit(e,t,n,i){return new wo({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:Wi.toString(i)}]})}_addCheck(e){return new wo({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Wi.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Wi.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Wi.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Wi.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Wi.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}wo.create=e=>new wo({checks:[],typeName:ma.ZodBigInt,coerce:e?.coerce??!1,...Hi(e)});class Oo extends Yi{_parse(e){if(this._def.coerce&&(e.data=Boolean(e.data)),this._getType(e)!==Si.boolean){const t=this._getOrReturnCtx(e);return Di(t,{code:Ni.invalid_type,expected:Si.boolean,received:t.parsedType}),Fi}return Li(e.data)}}Oo.create=e=>new Oo({typeName:ma.ZodBoolean,coerce:e?.coerce||!1,...Hi(e)});class So extends Yi{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Si.date){const t=this._getOrReturnCtx(e);return Di(t,{code:Ni.invalid_type,expected:Si.date,received:t.parsedType}),Fi}if(Number.isNaN(e.data.getTime()))return Di(this._getOrReturnCtx(e),{code:Ni.invalid_date}),Fi;const t=new $i;let n;for(const i of this._def.checks)"min"===i.kind?e.data.getTime()<i.value&&(n=this._getOrReturnCtx(e,n),Di(n,{code:Ni.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),t.dirty()):"max"===i.kind?e.data.getTime()>i.value&&(n=this._getOrReturnCtx(e,n),Di(n,{code:Ni.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),t.dirty()):wi.assertNever(i);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new So({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:Wi.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:Wi.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}So.create=e=>new So({checks:[],coerce:e?.coerce||!1,typeName:ma.ZodDate,...Hi(e)});class Io extends Yi{_parse(e){if(this._getType(e)!==Si.symbol){const t=this._getOrReturnCtx(e);return Di(t,{code:Ni.invalid_type,expected:Si.symbol,received:t.parsedType}),Fi}return Li(e.data)}}Io.create=e=>new Io({typeName:ma.ZodSymbol,...Hi(e)});class No extends Yi{_parse(e){if(this._getType(e)!==Si.undefined){const t=this._getOrReturnCtx(e);return Di(t,{code:Ni.invalid_type,expected:Si.undefined,received:t.parsedType}),Fi}return Li(e.data)}}No.create=e=>new No({typeName:ma.ZodUndefined,...Hi(e)});class Eo extends Yi{_parse(e){if(this._getType(e)!==Si.null){const t=this._getOrReturnCtx(e);return Di(t,{code:Ni.invalid_type,expected:Si.null,received:t.parsedType}),Fi}return Li(e.data)}}Eo.create=e=>new Eo({typeName:ma.ZodNull,...Hi(e)});class Ao extends Yi{constructor(){super(...arguments),this._any=!0}_parse(e){return Li(e.data)}}Ao.create=e=>new Ao({typeName:ma.ZodAny,...Hi(e)});class Co extends Yi{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Li(e.data)}}Co.create=e=>new Co({typeName:ma.ZodUnknown,...Hi(e)});class Po extends Yi{_parse(e){const t=this._getOrReturnCtx(e);return Di(t,{code:Ni.invalid_type,expected:Si.never,received:t.parsedType}),Fi}}Po.create=e=>new Po({typeName:ma.ZodNever,...Hi(e)});class Ro extends Yi{_parse(e){if(this._getType(e)!==Si.undefined){const t=this._getOrReturnCtx(e);return Di(t,{code:Ni.invalid_type,expected:Si.void,received:t.parsedType}),Fi}return Li(e.data)}}Ro.create=e=>new Ro({typeName:ma.ZodVoid,...Hi(e)});class Zo extends Yi{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),i=this._def;if(t.parsedType!==Si.array)return Di(t,{code:Ni.invalid_type,expected:Si.array,received:t.parsedType}),Fi;if(null!==i.exactLength){const e=t.data.length>i.exactLength.value,o=t.data.length<i.exactLength.value;(e||o)&&(Di(t,{code:e?Ni.too_big:Ni.too_small,minimum:o?i.exactLength.value:void 0,maximum:e?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),n.dirty())}if(null!==i.minLength&&t.data.length<i.minLength.value&&(Di(t,{code:Ni.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),n.dirty()),null!==i.maxLength&&t.data.length>i.maxLength.value&&(Di(t,{code:Ni.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((e,n)=>i.type._parseAsync(new Ki(t,e,t.path,n)))).then(e=>$i.mergeArray(n,e));const o=[...t.data].map((e,n)=>i.type._parseSync(new Ki(t,e,t.path,n)));return $i.mergeArray(n,o)}get element(){return this._def.type}min(e,t){return new Zo({...this._def,minLength:{value:e,message:Wi.toString(t)}})}max(e,t){return new Zo({...this._def,maxLength:{value:e,message:Wi.toString(t)}})}length(e,t){return new Zo({...this._def,exactLength:{value:e,message:Wi.toString(t)}})}nonempty(e){return this.min(1,e)}}function Go(e){if(e instanceof Mo){const t={};for(const n in e.shape){const i=e.shape[n];t[n]=ta.create(Go(i))}return new Mo({...e._def,shape:()=>t})}return e instanceof Zo?new Zo({...e._def,type:Go(e.element)}):e instanceof ta?ta.create(Go(e.unwrap())):e instanceof na?na.create(Go(e.unwrap())):e instanceof Vo?Vo.create(e.items.map(e=>Go(e))):e}Zo.create=(e,t)=>new Zo({type:e,minLength:null,maxLength:null,exactLength:null,typeName:ma.ZodArray,...Hi(t)});class Mo extends Yi{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=wi.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==Si.object){const t=this._getOrReturnCtx(e);return Di(t,{code:Ni.invalid_type,expected:Si.object,received:t.parsedType}),Fi}const{status:t,ctx:n}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Po&&"strip"===this._def.unknownKeys))for(const e in n.data)o.includes(e)||a.push(e);const s=[];for(const e of o){const t=i[e],o=n.data[e];s.push({key:{status:"valid",value:e},value:t._parse(new Ki(n,o,n.path,e)),alwaysSet:e in n.data})}if(this._def.catchall instanceof Po){const e=this._def.unknownKeys;if("passthrough"===e)for(const e of a)s.push({key:{status:"valid",value:e},value:{status:"valid",value:n.data[e]}});else if("strict"===e)a.length>0&&(Di(n,{code:Ni.unrecognized_keys,keys:a}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of a){const i=n.data[t];s.push({key:{status:"valid",value:t},value:e._parse(new Ki(n,i,n.path,t)),alwaysSet:t in n.data})}}return n.common.async?Promise.resolve().then(async()=>{const e=[];for(const t of s){const n=await t.key,i=await t.value;e.push({key:n,value:i,alwaysSet:t.alwaysSet})}return e}).then(e=>$i.mergeObjectSync(t,e)):$i.mergeObjectSync(t,s)}get shape(){return this._def.shape()}strict(e){return Wi.errToObj,new Mo({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,n)=>{const i=this._def.errorMap?.(t,n).message??n.defaultError;return"unrecognized_keys"===t.code?{message:Wi.errToObj(e).message??i}:{message:i}}}:{}})}strip(){return new Mo({...this._def,unknownKeys:"strip"})}passthrough(){return new Mo({...this._def,unknownKeys:"passthrough"})}extend(e){return new Mo({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Mo({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:ma.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new Mo({...this._def,catchall:e})}pick(e){const t={};for(const n of wi.objectKeys(e))e[n]&&this.shape[n]&&(t[n]=this.shape[n]);return new Mo({...this._def,shape:()=>t})}omit(e){const t={};for(const n of wi.objectKeys(this.shape))e[n]||(t[n]=this.shape[n]);return new Mo({...this._def,shape:()=>t})}deepPartial(){return Go(this)}partial(e){const t={};for(const n of wi.objectKeys(this.shape)){const i=this.shape[n];e&&!e[n]?t[n]=i:t[n]=i.optional()}return new Mo({...this._def,shape:()=>t})}required(e){const t={};for(const n of wi.objectKeys(this.shape))if(e&&!e[n])t[n]=this.shape[n];else{let e=this.shape[n];for(;e instanceof ta;)e=e._def.innerType;t[n]=e}return new Mo({...this._def,shape:()=>t})}keyof(){return Ho(wi.objectKeys(this.shape))}}Mo.create=(e,t)=>new Mo({shape:()=>e,unknownKeys:"strip",catchall:Po.create(),typeName:ma.ZodObject,...Hi(t)}),Mo.strictCreate=(e,t)=>new Mo({shape:()=>e,unknownKeys:"strict",catchall:Po.create(),typeName:ma.ZodObject,...Hi(t)}),Mo.lazycreate=(e,t)=>new Mo({shape:e,unknownKeys:"strip",catchall:Po.create(),typeName:ma.ZodObject,...Hi(t)});class Do extends Yi{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;if(t.common.async)return Promise.all(n.map(async e=>{const n={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}})).then(function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const n of e)if("dirty"===n.result.status)return t.common.issues.push(...n.ctx.common.issues),n.result;const n=e.map(e=>new Ai(e.ctx.common.issues));return Di(t,{code:Ni.invalid_union,unionErrors:n}),Fi});{let e;const i=[];for(const o of n){const n={...t,common:{...t.common,issues:[]},parent:null},a=o._parseSync({data:t.data,path:t.path,parent:n});if("valid"===a.status)return a;"dirty"!==a.status||e||(e={result:a,ctx:n}),n.common.issues.length&&i.push(n.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const o=i.map(e=>new Ai(e));return Di(t,{code:Ni.invalid_union,unionErrors:o}),Fi}}get options(){return this._def.options}}Do.create=(e,t)=>new Do({options:e,typeName:ma.ZodUnion,...Hi(t)});const $o=e=>e instanceof Ko?$o(e.schema):e instanceof ea?$o(e.innerType()):e instanceof Jo?[e.value]:e instanceof Yo?e.options:e instanceof Xo?wi.objectValues(e.enum):e instanceof ia?$o(e._def.innerType):e instanceof No?[void 0]:e instanceof Eo?[null]:e instanceof ta?[void 0,...$o(e.unwrap())]:e instanceof na?[null,...$o(e.unwrap())]:e instanceof ra||e instanceof ca?$o(e.unwrap()):e instanceof oa?$o(e._def.innerType):[];class Fo extends Yi{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Si.object)return Di(t,{code:Ni.invalid_type,expected:Si.object,received:t.parsedType}),Fi;const n=this.discriminator,i=t.data[n],o=this.optionsMap.get(i);return o?t.common.async?o._parseAsync({data:t.data,path:t.path,parent:t}):o._parseSync({data:t.data,path:t.path,parent:t}):(Di(t,{code:Ni.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Fi)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const i=new Map;for(const n of t){const t=$o(n.shape[e]);if(!t.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of t){if(i.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);i.set(o,n)}}return new Fo({typeName:ma.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i,...Hi(n)})}}function Uo(e,t){const n=Ii(e),i=Ii(t);if(e===t)return{valid:!0,data:e};if(n===Si.object&&i===Si.object){const n=wi.objectKeys(t),i=wi.objectKeys(e).filter(e=>-1!==n.indexOf(e)),o={...e,...t};for(const n of i){const i=Uo(e[n],t[n]);if(!i.valid)return{valid:!1};o[n]=i.data}return{valid:!0,data:o}}if(n===Si.array&&i===Si.array){if(e.length!==t.length)return{valid:!1};const n=[];for(let i=0;i<e.length;i++){const o=Uo(e[i],t[i]);if(!o.valid)return{valid:!1};n.push(o.data)}return{valid:!0,data:n}}return n===Si.date&&i===Si.date&&+e===+t?{valid:!0,data:e}:{valid:!1}}class Lo extends Yi{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),i=(e,i)=>{if(Vi(e)||Vi(i))return Fi;const o=Uo(e.value,i.value);return o.valid?((qi(e)||qi(i))&&t.dirty(),{status:t.value,value:o.data}):(Di(n,{code:Ni.invalid_intersection_types}),Fi)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([e,t])=>i(e,t)):i(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Lo.create=(e,t,n)=>new Lo({left:e,right:t,typeName:ma.ZodIntersection,...Hi(n)});class Vo extends Yi{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==Si.array)return Di(n,{code:Ni.invalid_type,expected:Si.array,received:n.parsedType}),Fi;if(n.data.length<this._def.items.length)return Di(n,{code:Ni.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Fi;!this._def.rest&&n.data.length>this._def.items.length&&(Di(n,{code:Ni.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const i=[...n.data].map((e,t)=>{const i=this._def.items[t]||this._def.rest;return i?i._parse(new Ki(n,e,n.path,t)):null}).filter(e=>!!e);return n.common.async?Promise.all(i).then(e=>$i.mergeArray(t,e)):$i.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new Vo({...this._def,rest:e})}}Vo.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Vo({items:e,typeName:ma.ZodTuple,rest:null,...Hi(t)})};class qo extends Yi{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==Si.object)return Di(n,{code:Ni.invalid_type,expected:Si.object,received:n.parsedType}),Fi;const i=[],o=this._def.keyType,a=this._def.valueType;for(const e in n.data)i.push({key:o._parse(new Ki(n,e,n.path,e)),value:a._parse(new Ki(n,n.data[e],n.path,e)),alwaysSet:e in n.data});return n.common.async?$i.mergeObjectAsync(t,i):$i.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,n){return new qo(t instanceof Yi?{keyType:e,valueType:t,typeName:ma.ZodRecord,...Hi(n)}:{keyType:jo.create(),valueType:e,typeName:ma.ZodRecord,...Hi(t)})}}class Bo extends Yi{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==Si.map)return Di(n,{code:Ni.invalid_type,expected:Si.map,received:n.parsedType}),Fi;const i=this._def.keyType,o=this._def.valueType,a=[...n.data.entries()].map(([e,t],a)=>({key:i._parse(new Ki(n,e,n.path,[a,"key"])),value:o._parse(new Ki(n,t,n.path,[a,"value"]))}));if(n.common.async){const e=new Map;return Promise.resolve().then(async()=>{for(const n of a){const i=await n.key,o=await n.value;if("aborted"===i.status||"aborted"===o.status)return Fi;"dirty"!==i.status&&"dirty"!==o.status||t.dirty(),e.set(i.value,o.value)}return{status:t.value,value:e}})}{const e=new Map;for(const n of a){const i=n.key,o=n.value;if("aborted"===i.status||"aborted"===o.status)return Fi;"dirty"!==i.status&&"dirty"!==o.status||t.dirty(),e.set(i.value,o.value)}return{status:t.value,value:e}}}}Bo.create=(e,t,n)=>new Bo({valueType:t,keyType:e,typeName:ma.ZodMap,...Hi(n)});class zo extends Yi{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==Si.set)return Di(n,{code:Ni.invalid_type,expected:Si.set,received:n.parsedType}),Fi;const i=this._def;null!==i.minSize&&n.data.size<i.minSize.value&&(Di(n,{code:Ni.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),null!==i.maxSize&&n.data.size>i.maxSize.value&&(Di(n,{code:Ni.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());const o=this._def.valueType;function a(e){const n=new Set;for(const i of e){if("aborted"===i.status)return Fi;"dirty"===i.status&&t.dirty(),n.add(i.value)}return{status:t.value,value:n}}const s=[...n.data.values()].map((e,t)=>o._parse(new Ki(n,e,n.path,t)));return n.common.async?Promise.all(s).then(e=>a(e)):a(s)}min(e,t){return new zo({...this._def,minSize:{value:e,message:Wi.toString(t)}})}max(e,t){return new zo({...this._def,maxSize:{value:e,message:Wi.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}zo.create=(e,t)=>new zo({valueType:e,minSize:null,maxSize:null,typeName:ma.ZodSet,...Hi(t)});class Wo extends Yi{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Si.function)return Di(t,{code:Ni.invalid_type,expected:Si.function,received:t.parsedType}),Fi;function n(e,n){return Gi({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Zi(),Ci].filter(e=>!!e),issueData:{code:Ni.invalid_arguments,argumentsError:n}})}function i(e,n){return Gi({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Zi(),Ci].filter(e=>!!e),issueData:{code:Ni.invalid_return_type,returnTypeError:n}})}const o={errorMap:t.common.contextualErrorMap},a=t.data;if(this._def.returns instanceof Qo){const e=this;return Li(async function(...t){const s=new Ai([]),r=await e._def.args.parseAsync(t,o).catch(e=>{throw s.addIssue(n(t,e)),s}),l=await Reflect.apply(a,this,r);return await e._def.returns._def.type.parseAsync(l,o).catch(e=>{throw s.addIssue(i(l,e)),s})})}{const e=this;return Li(function(...t){const s=e._def.args.safeParse(t,o);if(!s.success)throw new Ai([n(t,s.error)]);const r=Reflect.apply(a,this,s.data),l=e._def.returns.safeParse(r,o);if(!l.success)throw new Ai([i(r,l.error)]);return l.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Wo({...this._def,args:Vo.create(e).rest(Co.create())})}returns(e){return new Wo({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new Wo({args:e||Vo.create([]).rest(Co.create()),returns:t||Co.create(),typeName:ma.ZodFunction,...Hi(n)})}}class Ko extends Yi{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Ko.create=(e,t)=>new Ko({getter:e,typeName:ma.ZodLazy,...Hi(t)});class Jo extends Yi{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return Di(t,{received:t.data,code:Ni.invalid_literal,expected:this._def.value}),Fi}return{status:"valid",value:e.data}}get value(){return this._def.value}}function Ho(e,t){return new Yo({values:e,typeName:ma.ZodEnum,...Hi(t)})}Jo.create=(e,t)=>new Jo({value:e,typeName:ma.ZodLiteral,...Hi(t)});class Yo extends Yi{_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),n=this._def.values;return Di(t,{expected:wi.joinValues(n),received:t.parsedType,code:Ni.invalid_type}),Fi}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return Di(t,{received:t.data,code:Ni.invalid_enum_value,options:n}),Fi}return Li(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Yo.create(e,{...this._def,...t})}exclude(e,t=this._def){return Yo.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}Yo.create=Ho;class Xo extends Yi{_parse(e){const t=wi.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==Si.string&&n.parsedType!==Si.number){const e=wi.objectValues(t);return Di(n,{expected:wi.joinValues(e),received:n.parsedType,code:Ni.invalid_type}),Fi}if(this._cache||(this._cache=new Set(wi.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const e=wi.objectValues(t);return Di(n,{received:n.data,code:Ni.invalid_enum_value,options:e}),Fi}return Li(e.data)}get enum(){return this._def.values}}Xo.create=(e,t)=>new Xo({values:e,typeName:ma.ZodNativeEnum,...Hi(t)});class Qo extends Yi{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Si.promise&&!1===t.common.async)return Di(t,{code:Ni.invalid_type,expected:Si.promise,received:t.parsedType}),Fi;const n=t.parsedType===Si.promise?t.data:Promise.resolve(t.data);return Li(n.then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Qo.create=(e,t)=>new Qo({type:e,typeName:ma.ZodPromise,...Hi(t)});class ea extends Yi{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ma.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),i=this._def.effect||null,o={addIssue:e=>{Di(n,e),e.fatal?t.abort():t.dirty()},get path(){return n.path}};if(o.addIssue=o.addIssue.bind(o),"preprocess"===i.type){const e=i.transform(n.data,o);if(n.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return Fi;const i=await this._def.schema._parseAsync({data:e,path:n.path,parent:n});return"aborted"===i.status?Fi:"dirty"===i.status||"dirty"===t.value?Ui(i.value):i});{if("aborted"===t.value)return Fi;const i=this._def.schema._parseSync({data:e,path:n.path,parent:n});return"aborted"===i.status?Fi:"dirty"===i.status||"dirty"===t.value?Ui(i.value):i}}if("refinement"===i.type){const e=e=>{const t=i.refinement(e,o);if(n.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===n.common.async){const i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===i.status?Fi:("dirty"===i.status&&t.dirty(),e(i.value),{status:t.value,value:i.value})}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(n=>"aborted"===n.status?Fi:("dirty"===n.status&&t.dirty(),e(n.value).then(()=>({status:t.value,value:n.value}))))}if("transform"===i.type){if(!1===n.common.async){const e=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Bi(e))return Fi;const a=i.transform(e.value,o);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(e=>Bi(e)?Promise.resolve(i.transform(e.value,o)).then(e=>({status:t.value,value:e})):Fi)}wi.assertNever(i)}}ea.create=(e,t,n)=>new ea({schema:e,typeName:ma.ZodEffects,effect:t,...Hi(n)}),ea.createWithPreprocess=(e,t,n)=>new ea({schema:t,effect:{type:"preprocess",transform:e},typeName:ma.ZodEffects,...Hi(n)});class ta extends Yi{_parse(e){return this._getType(e)===Si.undefined?Li(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ta.create=(e,t)=>new ta({innerType:e,typeName:ma.ZodOptional,...Hi(t)});class na extends Yi{_parse(e){return this._getType(e)===Si.null?Li(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}na.create=(e,t)=>new na({innerType:e,typeName:ma.ZodNullable,...Hi(t)});class ia extends Yi{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===Si.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}ia.create=(e,t)=>new ia({innerType:e,typeName:ma.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...Hi(t)});class oa extends Yi{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return zi(i)?i.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new Ai(n.common.issues)},input:n.data})})):{status:"valid",value:"valid"===i.status?i.value:this._def.catchValue({get error(){return new Ai(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}oa.create=(e,t)=>new oa({innerType:e,typeName:ma.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...Hi(t)});class aa extends Yi{_parse(e){if(this._getType(e)!==Si.nan){const t=this._getOrReturnCtx(e);return Di(t,{code:Ni.invalid_type,expected:Si.nan,received:t.parsedType}),Fi}return{status:"valid",value:e.data}}}aa.create=e=>new aa({typeName:ma.ZodNaN,...Hi(e)});const sa=Symbol("zod_brand");class ra extends Yi{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class la extends Yi{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const e=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?Fi:"dirty"===e.status?(t.dirty(),Ui(e.value)):this._def.out._parseAsync({data:e.value,path:n.path,parent:n})})();{const e=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?Fi:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:n.path,parent:n})}}static create(e,t){return new la({in:e,out:t,typeName:ma.ZodPipeline})}}class ca extends Yi{_parse(e){const t=this._def.innerType._parse(e),n=e=>(Bi(e)&&(e.value=Object.freeze(e.value)),e);return zi(t)?t.then(e=>n(e)):n(t)}unwrap(){return this._def.innerType}}function ua(e,t){const n="function"==typeof e?e(t):"string"==typeof e?{message:e}:e;return"string"==typeof n?{message:n}:n}function da(e,t={},n){return e?Ao.create().superRefine((i,o)=>{const a=e(i);if(a instanceof Promise)return a.then(e=>{if(!e){const e=ua(t,i),a=e.fatal??n??!0;o.addIssue({code:"custom",...e,fatal:a})}});if(!a){const e=ua(t,i),a=e.fatal??n??!0;o.addIssue({code:"custom",...e,fatal:a})}}):Ao.create()}ca.create=(e,t)=>new ca({innerType:e,typeName:ma.ZodReadonly,...Hi(t)});const pa={object:Mo.lazycreate};var ma;!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(ma||(ma={}));const ha=(e,t={message:`Input not instance of ${e.name}`})=>da(t=>t instanceof e,t),ga=jo.create,fa=To.create,ya=aa.create,_a=wo.create,va=Oo.create,xa=So.create,ba=Io.create,ja=No.create,ka=Eo.create,Ta=Ao.create,wa=Co.create,Oa=Po.create,Sa=Ro.create,Ia=Zo.create,Na=Mo.create,Ea=Mo.strictCreate,Aa=Do.create,Ca=Fo.create,Pa=Lo.create,Ra=Vo.create,Za=qo.create,Ga=Bo.create,Ma=zo.create,Da=Wo.create,$a=Ko.create,Fa=Jo.create,Ua=Yo.create,La=Xo.create,Va=Qo.create,qa=ea.create,Ba=ta.create,za=na.create,Wa=ea.createWithPreprocess,Ka=la.create,Ja=()=>ga().optional(),Ha=()=>fa().optional(),Ya=()=>va().optional(),Xa={string:e=>jo.create({...e,coerce:!0}),number:e=>To.create({...e,coerce:!0}),boolean:e=>Oo.create({...e,coerce:!0}),bigint:e=>wo.create({...e,coerce:!0}),date:e=>So.create({...e,coerce:!0})},Qa=Fi,es=r,ts=()=>{const e=ns(),{receiveAutomationGroupTemplates:t,closeTemplateImportExport:n}=(0,m.useDispatch)(Oe),[i,o]=(0,c.useState)(""),a=is(i);if((0,c.useEffect)(()=>{"export"===(null==e?void 0:e.mode)?o(JSON.stringify(e.templates,null,2)):o("")},[e]),!e)return null;const{mode:s}=e,r="export"===s?(0,d._x)("Export Templates","text","nelio-content"):(0,d._x)("Import Templates","text","nelio-content"),u="export"===s?(0,d._x)("Copy","command","nelio-content"):(0,d._x)("Import","command","nelio-content"),p="import"===s?()=>{"import"===s&&a.length&&(t(e.templateType,a),n())}:()=>{navigator.clipboard.writeText(i).then(()=>n())},h="import"===s&&!a.length,g="export"!==s||"https:"===document.location.protocol;return(0,l.jsxs)(Ie.Modal,{className:"nelio-content-import-export-templates",title:r,onRequestClose:n,style:{minWidth:"30%"},children:[(0,l.jsx)(Ie.TextareaControl,{placeholder:"import"===s?(0,d._x)("Paste social templates here…","user","nelio-content"):void 0,value:i,onChange:o,readOnly:"export"===s}),(0,l.jsxs)("div",{className:"nelio-content-import-export-templates__actions",children:[(0,l.jsx)(Ie.Button,{variant:"secondary",onClick:n,children:(0,d._x)("Close","command","nelio-content")}),g&&(0,l.jsx)(Ie.Button,{variant:"primary",onClick:p,disabled:h,children:u})]})]})},ns=()=>h(e=>e(Oe).getImportExportData()),is=e=>{const t=ns(),n=h(e=>e(pe.store).getCurrentUserId()),i=h(e=>{var n;const{getSocialProfile:i}=e(pe.store);return"import"===(null==t?void 0:t.mode)?null===(n=i(t.profileId))||void 0===n?void 0:n.network:void 0});if("import"!==(null==t?void 0:t.mode)||!i)return[];try{const{groupId:o,profileId:a}=t;return(0,g.castArray)(JSON.parse(e)).map(e=>cs.safeParse(e)).map(e=>e.success?e.data:void 0).filter(f.isDefined).map(e=>{var s;return Object.assign(Object.assign({groupId:o,id:yt(),creatorId:n,network:i},!e.isNetwork&&{profileId:a,targetName:e.targetName}),{taxonomies:null!==(s=e.taxonomies)&&void 0!==s?s:{},text:e.text,postType:"universal"===o?e.postType:void 0,author:e.author,availability:os(t.templateType,e.availability)?e.availability:void 0})}).filter(e=>!!e.text.length)}catch(e){return[]}},os=(e,t)=>!!(null==t?void 0:t.type.includes(e)),as=es.object({mon:es.boolean(),tue:es.boolean(),wed:es.boolean(),thu:es.boolean(),fri:es.boolean(),sat:es.boolean(),sun:es.boolean()}),ss=es.union([es.literal("morning"),es.literal("noon"),es.literal("afternoon"),es.literal("night"),es.custom(e=>"string"==typeof e&&/^[0-2][0-9]:[0-5][0-9]$/.test(e))]),rs=es.object({instanceCount:es.number().nonnegative(),intervalInDays:es.number().positive()}),ls=es.discriminatedUnion("type",[es.object({type:es.literal("publication-day-offset"),hoursAfterPublication:es.number().nonnegative(),randomize:es.optional(es.number().nonnegative()),recurrency:es.optional(rs)}),es.object({type:es.literal("publication-day-period"),time:ss,randomize:es.optional(es.number().nonnegative()),recurrency:es.optional(rs)}),es.object({type:es.literal("after-publication"),daysAfterPublication:es.number().nonnegative(),time:ss,randomize:es.optional(es.number().nonnegative()),recurrency:es.optional(rs)}),es.object({type:es.literal("reshare"),weekday:as,time:ss,randomize:es.optional(es.number().nonnegative())})]),cs=es.object({text:es.string().min(1),isNetwork:es.boolean(),targetName:es.optional(es.string()).transform(e=>e),author:es.optional(es.number().positive()).transform(e=>e),postType:es.optional(es.string()).transform(e=>e),taxonomies:es.optional(es.record(es.number().positive())).transform(e=>e),availability:es.optional(ls)}),us=()=>{const{isLoading:e,data:t}=(()=>{const{groups:e,isLoadingGroups:t}=h(e=>({groups:e(pe.store).getAutomationGroups().map(t=>e(pe.store).getAutomationGroup(t)).filter(f.isDefined),isLoadingGroups:!e(pe.store).hasFinishedResolution("getAutomationGroups")})),n=nt("authors",t?[]:e),i=nt("terms",t?[]:e);return{data:e,isLoading:t||n||i}})(),{isLoading:n,data:i}=ds(),{initAutomationGroups:o}=(0,m.useDispatch)(Oe),{notices:a,removeNotice:s}=ps(),r=Ae(),u=e||n;return(0,c.useEffect)(()=>{u||o(t,i)},[u]),((e,t=!1)=>{(0,c.useEffect)(()=>{if(!t)return e?window.addEventListener("beforeunload",at,{capture:!0}):window.removeEventListener("beforeunload",at,{capture:!0}),()=>{window.removeEventListener("beforeunload",at,{capture:!0})}},[e,t])})(r,u),u?(0,l.jsx)("div",{className:"nelio-content-automations-settings-layout",children:(0,l.jsx)(p.LoadingAnimation,{})}):(0,l.jsx)("div",{className:"nelio-content-automations-settings-layout",children:(0,l.jsx)(c.StrictMode,{children:(0,l.jsxs)(Ie.SlotFillProvider,{children:[(0,l.jsx)(Ie.NoticeList,{notices:a,className:"components-editor-notices__pinned",onRemove:s}),(0,l.jsx)(sn,{}),(0,l.jsx)(ci,{}),(0,l.jsx)(ts,{}),(0,l.jsx)(gn,{}),(0,l.jsx)(p.PremiumDialog,{}),(0,l.jsx)(Ie.Popover.Slot,{})]})})})},ds=()=>h(e=>{const t=e(pe.store).getSocialProfiles();return{isLoading:e(pe.store).isResolving("getSocialProfiles"),data:t}}),ps=()=>{const e=h(e=>e(Ne.store).getNotices()),{removeNotice:t}=(0,m.useDispatch)(Ne.store);return{notices:e,removeNotice:t}};function ms(e){const t=document.getElementById(e);u((0,l.jsx)(us,{}),t);const n=document.getElementById("nelio-content-settings-title");n&&u((0,l.jsx)(p.ContextualHelp,{context:"social-automations",walkthrough:Se,autostart:!0,component:hs}),n)}const hs=({className:e,runWalkthrough:t})=>(0,l.jsx)("button",{className:`${e}  page-title-action`,onClick:()=>{gs().then(t)},children:(0,d._x)("Help","text","nelio-content")}),gs=()=>{return e=void 0,t=void 0,i=function*(){const e=".nelio-content-automation-group",t=document.querySelector(`${e}:first-child`);if(!t)return;if(!t.querySelector(`${e}__body`)){const n=t.querySelector(`${e}__header-content`);null==n||n.click(),yield fs()}const n=t.querySelector(`${e}__sidebar-item`);null==n||n.click(),yield fs()},new((n=void 0)||(n=Promise))(function(o,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,r)}l((i=i.apply(e,t||[])).next())});var e,t,n,i},fs=()=>new Promise(e=>setTimeout(e,50))}},n={};function i(e){var o=n[e];if(void 0!==o)return o.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,i),a.exports}i.m=t,e=[],i.O=(t,n,o,a)=>{if(!n){var s=1/0;for(u=0;u<e.length;u++){for(var[n,o,a]=e[u],r=!0,l=0;l<n.length;l++)(!1&a||s>=a)&&Object.keys(i.O).every(e=>i.O[e](n[l]))?n.splice(l--,1):(r=!1,a<s&&(s=a));if(r){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[n,o,a]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={9877:0,262:0,492:0};i.O.j=t=>0===e[t];var t=(t,n)=>{var o,a,[s,r,l]=n,c=0;if(s.some(t=>0!==e[t])){for(o in r)i.o(r,o)&&(i.m[o]=r[o]);if(l)var u=l(i)}for(t&&t(n);c<s.length;c++)a=s[c],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(u)},n=globalThis.webpackChunkNelioContent=globalThis.webpackChunkNelioContent||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=i.O(void 0,[262,492],()=>i(8312));o=i.O(o);var a=NelioContent="undefined"==typeof NelioContent?{}:NelioContent;for(var s in o)a[s]=o[s];o.__esModule&&Object.defineProperty(a,"__esModule",{value:!0})})();