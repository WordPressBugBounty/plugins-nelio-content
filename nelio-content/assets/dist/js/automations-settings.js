(()=>{var e,t={8437:(e,t,n)=>{"use strict";n.r(t),n.d(t,{initPage:()=>rs});var i={};n.r(i),n.d(i,{areAuthorsValid:()=>Z,getAutomationGroup:()=>x,getAutomationGroups:()=>_,getCustomFields:()=>C,getCustomPlaceholders:()=>P,getEditingTemplate:()=>E,getEditingTemplateErrors:()=>I,getEditingTemplateType:()=>N,getGroupTermsValidation:()=>G,getImportExportData:()=>U,getNetworkAutomationSettings:()=>j,getProfileAutomationSettings:()=>b,getProfileError:()=>D,getProfileFrequencies:()=>A,getTemplateErrors:()=>F,isDirty:()=>k,isEditingNetworkTemplate:()=>S,isEditingNewTemplate:()=>O,isEditingTemplate:()=>w,isGroupValid:()=>M,isPostTypeValid:()=>R,isSaving:()=>T,isTemplateValid:()=>$});var o={};n.r(o),n.d(o,{addAutomationGroup:()=>L,addProfileSettings:()=>q,closeTemplateEditor:()=>B,closeTemplateImportExport:()=>z,deleteAutomationGroup:()=>W,deleteAutomationGroupTemplate:()=>K,initAutomationGroups:()=>J,markAsNetworkTemplate:()=>ie,markAsSaving:()=>oe,openTemplateEditor:()=>H,openTemplateExporter:()=>X,openTemplateImporter:()=>Y,receiveAutomationGroupTemplates:()=>Q,receiveCustomFields:()=>ee,receiveCustomPlaceholders:()=>te,setAutomationGroupValidation:()=>ae,setEditingTemplateAttributes:()=>se,setEditingTemplateErrors:()=>re,setProfileFrequencies:()=>ne,updateAutomationGroup:()=>V});var a={};n.r(a),n.d(a,{saveAutomationGroups:()=>me});var s={};n.r(s),n.d(s,{getCustomFields:()=>je,getCustomPlaceholders:()=>ke});const r=window.ReactJSXRuntime,l=window.wp.element;function c(e,t){t&&(l.createRoot?(0,l.createRoot)(t).render(e):(0,l.render)(e,t))}const u=window.wp.i18n,d=window.NelioContent.components,p=window.wp.data;function m(e,t){return(0,p.useSelect)(e,t)}const h=window.lodash,g=window.NelioContent.utils,f={automationGroups:{byId:{universal:{id:"universal",priority:100,publication:{type:"always"},profileSettings:{},networkSettings:{}}},allIds:["universal"]},validations:{universal:{areAuthorsValid:!0,areTermsValid:{},isPostTypeValid:!0,socialProfileErrors:{},templateErrors:{}}},frequencies:{},isSaving:!1,templateEditor:{attributes:void 0,isNew:!1,isNetwork:!1,customFields:{},customPlaceholders:{},errors:{author:!1,target:!1,content:!1,availability:!1,taxonomies:{}}},templateImportExport:void 0};function v(e,t){return(0,h.isEqual)((0,h.omit)((0,h.omitBy)(e,h.isNil),["groupId","id","creatorId"]),(0,h.omit)((0,h.omitBy)(t,h.isNil),["groupId","id","creatorId"]))}function y(e){const t=e.automationGroups.byId;return Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign({universal:(0,g.fixAttributesInGroup)(t.universal)},(0,h.mapValues)((0,h.omit)(t,"universal"),g.fixAttributesInGroup))})})}function _(e){return e.automationGroups.allIds}function x(e,t){return e.automationGroups.byId[t]}function b(e,t,n){var i;return(0,h.find)(null===(i=x(e,t))||void 0===i?void 0:i.profileSettings,{profileId:n})}function j(e,t,n){var i;return(0,h.find)(null===(i=x(e,t))||void 0===i?void 0:i.networkSettings,{name:n})}function k(e,t,n){const i=(0,h.values)(e.automationGroups.byId),o=t;return n.some((t=>{const n=e.frequencies[t.id];return(null==n?void 0:n.publication)!==Math.max(1,t.publicationFrequency)||(null==n?void 0:n.reshare)!==Math.max(1,t.reshareFrequency)}))||JSON.stringify(i)!==JSON.stringify(o)}function T(e){return!!e.isSaving}function w(e){return!!e.templateEditor.attributes}function O(e){return w(e)&&e.templateEditor.isNew}function S(e){return w(e)&&e.templateEditor.isNetwork}function E(e){const t=e.templateEditor.attributes;return t?(0,h.omit)(t,"type"):void 0}function I(e){return e.templateEditor.errors}function N(e){var t;return(null===(t=e.templateEditor.attributes)||void 0===t?void 0:t.type)||"publication"}function A(e,t){return e.frequencies[t]}function C(e){return e.templateEditor.customFields}function P(e){return e.templateEditor.customPlaceholders}function R(e,t){var n,i;return null===(i=null===(n=e.validations[t])||void 0===n?void 0:n.isPostTypeValid)||void 0===i||i}function Z(e,t){var n,i;return null===(i=null===(n=e.validations[t])||void 0===n?void 0:n.areAuthorsValid)||void 0===i||i}function G(e,t){var n;return(null===(n=e.validations[t])||void 0===n?void 0:n.areTermsValid)||{}}function M(e,t){var n;const i=(0,h.values)(G(e,t)).every(Boolean);return R(e,t)&&Z(e,t)&&i&&(0,h.keys)(null===(n=x(e,t))||void 0===n?void 0:n.profileSettings).every((n=>!D(e,t,n)))}function D(e,t,n){var i;const o=null===(i=e.validations[t])||void 0===i?void 0:i.socialProfileErrors[n];if(o)return o;const a=b(e,t,n);if(!a)return!1;const s=j(e,t,a.network),r=n=>!n||(e=>"enabled"in e&&!e.enabled)(n)||(0,h.map)(n.templates,"id").every((n=>$(e,t,n)));return r(a.publication)&&r(null==s?void 0:s.publication)?(!r(a.reshare)||!r(null==s?void 0:s.reshare))&&(0,u._x)("Please review reshare templates","text","nelio-content"):(0,u._x)("Please review publication templates","user","nelio-content")}function $(e,t,n){var i;const o=null===(i=e.validations[t])||void 0===i?void 0:i.templateErrors[n];return(0,h.keys)((0,h.omit)(o,"taxonomies")).every((e=>!(null==o?void 0:o[e])))&&(0,h.keys)(null==o?void 0:o.taxonomies).every((e=>!(null==o?void 0:o.taxonomies[e])))}function F(e,t,n){var i;return null===(i=e.validations[t])||void 0===i?void 0:i.templateErrors[n]}function U(e){return e.templateImportExport}function L(e){return{type:"ADD_AUTOMATION_GROUP",group:e}}function V(e,t){return{type:"UPDATE_AUTOMATION_GROUP",groupId:e,attrs:t}}function q(e,t){return{type:"ADD_PROFILE_SETTINGS",groupId:e,settings:t}}function B(){return{type:"CLOSE_TEMPLATE_EDITOR"}}function z(){return{type:"CLOSE_TEMPLATE_IMPORT_EXPORT"}}function W(e){return{type:"DELETE_AUTOMATION_GROUP",groupId:e}}function K(e){return{type:"DELETE_AUTOMATION_GROUP_TEMPLATE",template:e}}function J(e,t){return{type:"INIT_AUTOMATION_GROUPS",automationGroups:e,profiles:t}}function H(e,t,n){return{type:"OPEN_TEMPLATE_EDITOR",template:Object.assign(Object.assign({},t),{type:e}),isNew:"new"===n}}function Y(e,t,n){return{type:"OPEN_TEMPLATE_IMPORTER",groupId:e,profileId:t,templateType:n}}function X(e){return{type:"OPEN_TEMPLATE_EXPORTER",templates:(0,h.castArray)(e)}}function Q(e,t){return{type:"RECEIVE_AUTOMATION_GROUP_TEMPLATES",templateType:e,templates:(0,h.castArray)(t)}}function ee(e){return{type:"RECEIVE_CUSTOM_FIELDS",customFields:e}}function te(e){return{type:"RECEIVE_CUSTOM_PLACEHOLDERS",customPlaceholders:e}}function ne(e,t){return{type:"SET_PROFILE_FREQUENCIES",profileId:e,frequencies:t}}function ie(e){return{type:"MARK_AS_NETWORK_TEMPLATE",isNetwork:e}}function oe(e){return{type:"MARK_AS_SAVING",isSaving:e}}function ae(e,t){return{type:"SET_AUTOMATION_GROUP_VALIDATION",groupId:e,validation:t}}function se(e){return{type:"SET_EDITING_TEMPLATE_ATTRIBUTES",attributes:e}}function re(e){return{type:"SET_EDITING_TEMPLATE_ERRORS",errors:e}}const le=window.wp.apiFetch,ce=n.n(le)(),ue=window.wp.coreData,de=window.NelioContent.data;var pe=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,r)}l((i=i.apply(e,t||[])).next())}))};function me(){return pe(this,void 0,void 0,(function*(){yield(0,p.dispatch)(we).markAsSaving(!0);const{getAutomationGroup:e,getAutomationGroups:t}=(0,p.select)(we),n=yield Promise.all(t().map(e).filter(g.isDefined).map(fe));try{const e=(0,p.select)(de.store).getSiteId(),t=(0,p.select)(de.store).getApiRoot(),i=(0,p.select)(de.store).getAuthenticationToken(),o=yield he(),a=yield ce({url:`${t}/site/${e}/automation-groups`,method:"PUT",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${i}`},data:n});yield(0,p.dispatch)(we).initAutomationGroups(a,o),yield(0,p.dispatch)(de.store).resetAutomationGroups(a)}catch(e){yield(0,g.showErrorNotice)(e)}yield(0,p.dispatch)(we).markAsSaving(!1)}))}const he=()=>pe(void 0,void 0,void 0,(function*(){return Promise.all((0,p.select)(de.store).getSocialProfiles().map((e=>pe(void 0,void 0,void 0,(function*(){if(!ge(e))return e;const t=(0,p.select)(we).getProfileFrequencies(e.id);if(!t)return e;const n=(0,p.select)(de.store).getSiteId(),i=(0,p.select)(de.store).getApiRoot(),o=(0,p.select)(de.store).getAuthenticationToken(),a=yield ce({url:`${i}/site/${n}/profile/${e.id}`,method:"PUT",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${o}`},data:{publicationFrequency:t.publication,reshareFrequency:t.reshare}});return yield(0,p.dispatch)(de.store).receiveSocialProfiles(a),a})))))})),ge=e=>{const t=(0,p.select)(we).getProfileFrequencies(e.id);return(null==t?void 0:t.publication)!==e.publicationFrequency||(null==t?void 0:t.reshare)!==e.reshareFrequency},fe=e=>pe(void 0,void 0,void 0,(function*(){if((0,g.isUniversalGroup)(e))return e;const t=yield xe(e.postType),n=_e(e.postType),i=ve({taxonomies:t,supportsAuthors:n});return Object.assign(Object.assign({},e),{authors:!1===n?[]:e.authors,taxonomies:(0,h.pick)(e.taxonomies,t),profileSettings:(0,h.mapValues)(e.profileSettings,i),networkSettings:(0,h.pickBy)((0,h.mapValues)(e.networkSettings,i),(e=>!(!e||!e.publication.templates.length&&!e.reshare.templates.length)))})})),ve=e=>t=>{const n=ye(e);return Object.assign(Object.assign({},t),{publication:Object.assign(Object.assign({},t.publication),{templates:(0,h.map)(t.publication.templates,n)}),reshare:Object.assign(Object.assign({},t.reshare),{templates:(0,h.map)(t.reshare.templates,n)})})},ye=e=>t=>Object.assign(Object.assign({},t),{author:!1===e.supportsAuthors?void 0:t.author,taxonomies:(0,h.pick)(t.taxonomies,e.taxonomies)}),_e=e=>{var t;return null===(t=(0,p.select)(de.store).getPostType(e))||void 0===t?void 0:t.supports.author},xe=e=>pe(void 0,void 0,void 0,(function*(){const{getEntityRecords:t}=(n=ue.store,(0,p.resolveSelect)(n));var n;const i=yield t("root","taxonomy",{per_page:-1});return(0,h.castArray)(i).filter((e=>!!e)).filter((t=>t.types.includes(e))).map((e=>e.slug))}));var be=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,r)}l((i=i.apply(e,t||[])).next())}))};function je(){return be(this,void 0,void 0,(function*(){const e=yield ce({path:"/nelio-content/v1/custom-fields"});yield(0,p.dispatch)(we).receiveCustomFields(e)}))}function ke(){return be(this,void 0,void 0,(function*(){const e=yield ce({path:"/nelio-content/v1/custom-placeholders"});yield(0,p.dispatch)(we).receiveCustomPlaceholders(e)}))}const Te=Object.assign(Object.assign({},o),a),we=(0,p.createReduxStore)("nelio-content/automation-settings",{reducer:function(e=f,t){var n;return null!==(n=function(e,t){switch(t.type){case"ADD_AUTOMATION_GROUP":{if(e.automationGroups.byId[t.group.id])return e;const n=Object.assign(Object.assign({},e.automationGroups.byId),{[t.group.id]:t.group});return y(Object.assign(Object.assign({},e),{automationGroups:{byId:n,allIds:["universal",...(0,h.keys)(n).filter((e=>"universal"!==e))]}}))}case"UPDATE_AUTOMATION_GROUP":return e.automationGroups.byId[t.groupId]?"universal"===t.groupId?y(Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign(Object.assign({},e.automationGroups.byId),{universal:Object.assign(Object.assign({},e.automationGroups.byId.universal),t.attrs)})})})):y(Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign(Object.assign({},e.automationGroups.byId),{[t.groupId]:Object.assign(Object.assign({},e.automationGroups.byId[t.groupId]),t.attrs)})})})):e;case"ADD_PROFILE_SETTINGS":{const n=e.automationGroups.byId[t.groupId];if(!n)return e;const i=Object.assign(Object.assign({},n),{profileSettings:Object.assign(Object.assign({},n.profileSettings),{[t.settings.profileId]:t.settings})});return y(Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign(Object.assign({},e.automationGroups.byId),{[i.id]:i})})}))}case"CLOSE_TEMPLATE_EDITOR":return Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{attributes:void 0,isNew:!1})});case"CLOSE_TEMPLATE_IMPORT_EXPORT":return Object.assign(Object.assign({},e),{templateImportExport:void 0});case"DELETE_AUTOMATION_GROUP":return e.automationGroups.allIds.includes(t.groupId)?Object.assign(Object.assign({},e),{automationGroups:{byId:(0,h.omit)(e.automationGroups.byId,t.groupId),allIds:["universal",...(0,h.without)((0,h.filter)(e.automationGroups.allIds,(e=>"universal"!==e)),t.groupId)]}}):e;case"DELETE_AUTOMATION_GROUP_TEMPLATE":return y(function(e,t){var n;const i=e.automationGroups.byId[t.groupId];if(!i)return e;const o=t.profileId?"profileSettings":"networkSettings",a=null!==(n=t.profileId)&&void 0!==n?n:t.network,s=t.profileId?i.profileSettings[t.profileId]:i.networkSettings[t.network];return s?Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign(Object.assign({},e.automationGroups.byId),{[t.groupId]:Object.assign(Object.assign({},i),{[o]:Object.assign(Object.assign({},i[o]),{[a]:Object.assign(Object.assign({},s),{publication:Object.assign(Object.assign({},s.publication),{templates:s.publication.templates.filter((e=>e.id!==t.id))}),reshare:Object.assign(Object.assign({},s.reshare),{templates:s.reshare.templates.filter((e=>e.id!==t.id))})})})})})})}):e}(e,t.template));case"INIT_AUTOMATION_GROUPS":return y(Object.assign(Object.assign({},e),{automationGroups:{byId:Object.assign({universal:e.automationGroups.byId.universal},(0,h.keyBy)(t.automationGroups,"id")),allIds:["universal",...(0,h.map)(t.automationGroups,"id").filter((e=>"universal"!==e))]},frequencies:(0,h.mapValues)((0,h.keyBy)(t.profiles,"id"),(e=>({publication:Math.max(1,e.publicationFrequency),reshare:Math.max(1,e.reshareFrequency)})))}));case"OPEN_TEMPLATE_EDITOR":return Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{attributes:t.template,isNew:t.isNew,isNetwork:!t.isNew&&!t.template.profileId})});case"OPEN_TEMPLATE_IMPORTER":return Object.assign(Object.assign({},e),{templateImportExport:Object.assign({mode:"import"},(0,h.omit)(t,"type"))});case"OPEN_TEMPLATE_EXPORTER":return Object.assign(Object.assign({},e),{templateImportExport:Object.assign({mode:"export"},(0,h.omit)(t,"type"))});case"MARK_AS_NETWORK_TEMPLATE":return e.templateEditor.attributes&&e.templateEditor.isNew?Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{isNetwork:t.isNetwork})}):e;case"MARK_AS_SAVING":return Object.assign(Object.assign({},e),{isSaving:t.isSaving});case"RECEIVE_AUTOMATION_GROUP_TEMPLATES":return(0,h.reduce)(t.templates,(n=t.templateType,(e,t)=>{var i;const o=null!==(i=t.profileId)&&void 0!==i?i:t.network,a=e.automationGroups.byId[t.groupId];if(!a)return e;const s=t.profileId?a.profileSettings:a.networkSettings,r=s[o];if(!r)return e;const l=r[n].templates;return Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign(Object.assign({},e.automationGroups.byId),{[t.groupId]:Object.assign(Object.assign({},a),{[t.profileId?"profileSettings":"networkSettings"]:Object.assign(Object.assign({},s),{[o]:Object.assign(Object.assign({},r),{[n]:Object.assign(Object.assign({},r[n]),{templates:(0,h.uniqWith)((0,h.values)(Object.assign(Object.assign({},(0,h.keyBy)(l,"id")),{[t.id]:t})),v)})})})})})})})}),e);case"RECEIVE_CUSTOM_FIELDS":return Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{customFields:t.customFields})});case"RECEIVE_CUSTOM_PLACEHOLDERS":return Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{customPlaceholders:t.customPlaceholders})});case"SET_PROFILE_FREQUENCIES":{const n=e.frequencies[t.profileId];return n?Object.assign(Object.assign({},e),{frequencies:Object.assign(Object.assign({},e.frequencies),{[t.profileId]:Object.assign(Object.assign({},n),t.frequencies)})}):e}case"SET_AUTOMATION_GROUP_VALIDATION":return Object.assign(Object.assign({},e),{validations:Object.assign(Object.assign({},e.validations),{[t.groupId]:t.validation})});case"SET_EDITING_TEMPLATE_ATTRIBUTES":return e.templateEditor.attributes?Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{attributes:Object.assign(Object.assign({},e.templateEditor.attributes),t.attributes)})}):e;case"SET_EDITING_TEMPLATE_ERRORS":return e.templateEditor.attributes?Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{errors:t.errors})}):e}var n}(e,t))&&void 0!==n?n:e},controls:p.controls,actions:Te,selectors:i,resolvers:s});!function(e){(0,p.register)(e)}(we);const Oe=[{title:(0,u._x)("Settings - Social Automations","text","nelio-content"),intro:(0,u._x)("Welcome to the Social Automations Screen. Here you can customize which content from your site can be automatically shared by Nelio Content and where it should be shared.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item")},{title:(0,u._x)("Automation Groups","text","nelio-content"),intro:(0,u._x)("An Automation Group allows you to select some content from your WordPress site and customize where and how it should be shared.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item"),element:()=>document.querySelector(".nelio-content-automation-group:first-child")},{title:(0,u._x)("Automation Groups","text","nelio-content"),intro:(0,u._x)("In general, the first section of an automation group lets you filter your WordPress content by its type, taxonomies, author, and publication date.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item"),element:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group-settings__section")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item")},{title:(0,u._x)("Automation Groups","text","nelio-content"),intro:(0,u._x)("However, the Universal Group limits this selection to the publication date only.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item"),element:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group-settings__extra")},{title:(0,u._x)("Automation Groups","text","nelio-content"),intro:(0,u._x)("Once you’ve established which content is shareable, you can select the social profiles where Nelio Content is allowed to share it.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item"),element:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group-settings__section + .nelio-content-automation-group-settings__section")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item")},{title:(0,u._x)("Automation Groups","text","nelio-content"),intro:(0,u._x)("Click on each social profile to toggle it. If it’s selected, Nelio Content might use it to share content on your behalf.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item"),element:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group-settings__section + .nelio-content-automation-group-settings__section")},{title:(0,u._x)("Social Profile Settings","text","nelio-content"),intro:(0,u._x)("Active social profiles will show up here. Click on any profile to further customize how Nelio Content should use it to share your content.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)"),element:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar")},{title:(0,u._x)("Social Profile Settings","text","nelio-content"),intro:(0,u.sprintf)(/* translators: 1 -> a dashicon, 2 -> another dashicon */ /* translators: 1 -> a dashicon, 2 -> another dashicon */
(0,u._x)("In particular, you can customize if and how Nelio Content should share content on publication (%1$s) and on reshare (%2$s).","user","nelio-content"),'<span class="dashicons dashicons-megaphone"></span>','<span class="dashicons dashicons-share-alt"></span>'),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)"),element:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-profile-settings__tab-selector")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar")},{title:(0,u._x)("Social Profile Settings","text","nelio-content"),intro:(0,u._x)("If you enable social automations for a profile, you’ll be able to specify how many social messages should be created by Nelio Content when sharing new content, as well as the Social Templates is should use to do so, thus setting the tone of your auto-publications. Please notice the number of messages you set in one automation group is actually shared across all your groups.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)"),element:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-templates")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-profile-settings")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-profile-settings")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar")},{title:(0,u._x)("Duplicate and Delete","text","nelio-content"),intro:(0,u._x)("You can easily duplicate an existing group or delete it using the actions here.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)"),element:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-actions")},{title:(0,u._x)("Temporary Deactivation","text","nelio-content"),intro:(0,u._x)("If you want to disable a set of posts from being auto-shared, you can easily do so by toggling this button in the desired automation group.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)"),element:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__header-content-activation-toggle")},{title:(0,u._x)("Save Changes","text","nelio-content"),intro:(0,u._x)("Once you’re happy with your setup, don’t forget to save your changes using this button!","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item"),element:()=>document.querySelector(".nelio-content-save-automation-groups")}],Se=window.wp.components,Ee=window.wp.notices,Ie=window.NelioContent.networks,Ne=()=>m((e=>{const{getAutomationGroup:t,getAutomationGroups:n,getSocialProfiles:i}=e(de.store),o=n().map(t).filter(g.isDefined),a=i();return e(we).isDirty(o,a)}));function Ae(e){return m((t=>{const{getAutomationGroup:n}=t(we);return e?n(e):void 0}))}const Ce=(e,t)=>{const n=Ae(e),{updateAutomationGroup:i}=(0,p.useDispatch)(we);return[n?n[t]:void 0,o=>{n&&i(e,{[t]:o})}]},Pe=e=>{const t=(0,h.map)(Re(e),"slug");return m((e=>{const{hasFinishedResolution:n,hasResolutionFailed:i,getEntityRecords:o}=e(ue.store),a=(e,t)=>n(e,t)||i(e,t),s={per_page:10,context:"edit",search:"",page:1,exclude:[]},r={per_page:10,context:"view",search:"",page:1,exclude:[],who:"authors"};return t.forEach((e=>o("taxonomy",e,s))),o("root","user",r),[...t.map((e=>a("getEntityRecords",["taxonomy",e,s]))),a("getEntityRecords",["root","user",r])]})).every(Boolean)},Re=e=>Be()[e||"nc_any"]||[],Ze=e=>!!ze()[e||"nc_any"],Ge=(e,t)=>{const n=ze(),i=(0,h.mapValues)(Be(),(e=>(0,h.map)(e,"slug"))),o=Le(t);return m((a=>{const{getEntityRecord:s,hasFinishedResolution:r,hasResolutionFailed:l}=a(ue.store),c=(e,t,n)=>{return!(n&&!s(e,t,n,{context:"user"===t?"view":"edit"})&&(i="getEntityRecord",o=[e,t,n,{context:"user"===t?"view":"edit"}],r(i,o)||l(i,o)));var i,o},u=(e,t)=>!t||!(null==e?void 0:e.length)||e.includes(t);return e?(0,h.mapValues)((0,h.keyBy)((0,h.castArray)(t),"id"),(t=>{var a;return{target:!!t.profileId&&!!(0,Ie.doesNetworkSupport)("multi-target",t.network)&&!t.targetName&&(0,Ie.getTargetLabel)("selectTargetError",t.network),content:null!==(a=o[t.id])&&void 0!==a&&a,availability:!!t.availability&&We(t.availability),author:He({doesAuthorExist:c("root","user",t.author),isAuthorSupported:!!n[t.postType||"nc_any"],isGroupAuthor:(0,g.isUniversalGroup)(e)||u(e.authors,t.author)}),taxonomies:(0,h.pick)((0,h.mapValues)(t.taxonomies,((t,n)=>Ye({doesTermExist:c("taxonomy",n,t),isGroupTerm:(0,g.isUniversalGroup)(e)||u(e.taxonomies[n],t)}))),i[t.postType||"nc_any"]||[])}})):{}}),[JSON.stringify(n),JSON.stringify(i),JSON.stringify(o),JSON.stringify(t)])},Me=()=>m((e=>e(we).isSaving())),De=e=>{const t=(0,de.usePostTypes)("social");if(!e)return(0,u._x)("All Content","text","nelio-content");const n=t.find((t=>t.name===e));return(null==n?void 0:n.labels.plural)||(0,u.sprintf)(/* translators: post type name */ /* translators: post type name */
(0,u._x)("Post type %s","text","nelio-content"),e)},$e=e=>{const t=m((t=>{const{getEntityRecord:n}=t(ue.store);return e.map((e=>n("root","user",e,{context:"view"}))).map((e=>null==e?void 0:e.name)).filter(g.isDefined)}));return t.length?(0,u.sprintf)(/* translators: author name(s) */ /* translators: author name(s) */
(0,u._x)("by %s","text","nelio-content"),(0,g.listify)("or",t)):""},Fe=(e,t)=>{var n,i,o,a,s,r,l,c;const d=(0,h.map)(Re(e),"slug"),p=(0,h.keys)(t).filter((e=>d.includes(e))),f=m((e=>{const{getEntityRecord:t}=e(ue.store),n=p.map((e=>t("root","taxonomy",e))).map((e=>null==e?void 0:e.labels.singular_name));return(0,h.pickBy)((0,h.zipObject)(p,n),(e=>"string"==typeof e))}),[JSON.stringify(p)]),v=(0,h.pick)(t,p),y=m((e=>{const{getEntityRecord:t}=e(ue.store);return(0,h.mapValues)(v,((e,n)=>e.map((e=>t("taxonomy",n,e,{context:"edit"}))).map((e=>null==e?void 0:e.name)).filter(g.isDefined)))}),[JSON.stringify(v)]),_=(0,h.keys)(f).filter((e=>{var t;return!!(null===(t=y[e])||void 0===t?void 0:t.length)})),x=!!(null===(n=y[g.CAT])||void 0===n?void 0:n.length)||!!(null===(i=y[g.PROD_CAT])||void 0===i?void 0:i.length),b=!!(null===(o=y[g.TAG])||void 0===o?void 0:o.length)||!!(null===(a=y[g.PROD_TAG])||void 0===a?void 0:a.length),j=[];x&&j.push((0,u.sprintf)(/* translators: category names */ /* translators: category names */
(0,u._x)("in %s","text","nelio-content"),(0,g.listify)("or",null!==(r=null!==(s=y[g.CAT])&&void 0!==s?s:y[g.PROD_CAT])&&void 0!==r?r:[]))),b&&j.push((0,u.sprintf)(/* translators: tag names */ /* translators: tag names */
(0,u._x)("tagged as %s","text","nelio-content"),(0,g.listify)("or",null!==(c=null!==(l=y[g.TAG])&&void 0!==l?l:y[g.PROD_TAG])&&void 0!==c?c:[])));const k=_.filter((e=>![g.CAT,g.PROD_CAT,g.TAG,g.PROD_TAG].includes(e))).map(((e,t)=>{var n,i;return t?(0,u.sprintf)(/* translators: 1 -> taxonomy name, 2 -> taxonomy terms */ /* translators: 1 -> taxonomy name, 2 -> taxonomy terms */
(0,u._x)("%2$s in taxonomy %1$s","text","nelio-content"),f[e],(0,g.listify)("or",null!==(i=y[e])&&void 0!==i?i:[])):(0,u.sprintf)(/* translators: 1 -> taxonomy name, 2 -> taxonomy terms */ /* translators: 1 -> taxonomy name, 2 -> taxonomy terms */
(0,u._x)("with %2$s in taxonomy %1$s","text","nelio-content"),f[e],(0,g.listify)("or",null!==(n=y[e])&&void 0!==n?n:[]))}));return(0,g.listify)("and",[...j,...k])},Ue=e=>"always"===e.type?"":{30:(0,u._x)("from last month","text","nelio-content"),60:(0,u._x)("from last two months","text","nelio-content"),90:(0,u._x)("from last three months","text","nelio-content"),180:(0,u._x)("from last six months","text","nelio-content"),365:(0,u._x)("from last year","text","nelio-content")}[`${e.days}`]||(0,u.sprintf)(/* translators: number of days */ /* translators: number of days */
(0,u._x)("from last %d days","text","nelio-content"),e.days),Le=e=>{const t=(0,h.mapValues)(Ve(),(e=>(0,h.map)(e,"key"))),n=(0,h.mapValues)(qe(),(e=>(0,h.map)(e,"key"))),i=ze(),o=(0,h.mapValues)(Be(),(e=>(0,h.map)(e,"slug"))),a=(0,h.map)(e,(e=>{if(!(0,h.trim)(e.text).length)return(0,u._x)("Please create a template with some content","user","nelio-content");const a=/* translators: a placeholder name, like author or tags */ /* translators: a placeholder name, like author or tags */
(0,u._x)("Unsupported %s placeholder found in template","text","nelio-content");if(!i[e.postType||"nc_any"]&&e.text.includes("{author}"))return(0,u.sprintf)(a,"{author}");const s=o[e.postType||"nc_any"]||[];if(!s.includes(g.CAT)&&!s.includes(g.PROD_CAT)&&e.text.includes("{categories}"))return(0,u.sprintf)(a,"{categories}");if(!s.includes(g.TAG)&&!s.includes(g.PROD_TAG)&&e.text.includes("{tags}"))return(0,u.sprintf)(a,"{tags}");const r=(0,h.map)(Array.from(e.text.matchAll(/{taxonomy:([^}]+)}/g)),1);for(const e of r)if(!s.includes(e))return(0,u.sprintf)(a,`{taxonomy:${e}}`);const l=e.postType?t[e.postType]||[]:(0,h.values)(t).flatMap((e=>e)),c=(0,h.map)(Array.from(e.text.matchAll(/{field:([^}]+)}/g)),1);for(const e of c)if(!l.includes(e))return(0,u.sprintf)(a,`{field:${e}}`);const d=e.postType?n[e.postType]||[]:(0,h.values)(n).flatMap((e=>e)),p=(0,h.map)(Array.from(e.text.matchAll(/{custom:([^}]+)}/g)),1);for(const e of p)if(!d.includes(e))return(0,u.sprintf)(a,`{custom:${e}}`);return!1})),s=(0,h.map)(e,"id");return(0,h.zipObject)(s,a)},Ve=()=>m((e=>e(we).getCustomFields())),qe=()=>m((e=>e(we).getCustomPlaceholders())),Be=()=>{const e=(0,h.map)((0,de.usePostTypes)("social"),"name"),t=(0,h.filter)(m((e=>e(ue.store).getEntityRecords("root","taxonomy",{per_page:-1})||[]),[]),(e=>e.visibility.public));return(0,h.reduce)(["nc_any",...e],((n,i)=>{const o="nc_any"===i?e:[i];return n[i]=(0,h.filter)(t,(e=>o.some((t=>e.types.includes(t))))),n}),{nc_any:[]})},ze=()=>{const e=(0,de.usePostTypes)("social");return(0,h.reduce)(["nc_any",...(0,h.map)(e,"name")],((t,n)=>(t[n]=e.filter((e=>"nc_any"===n||e.name===n)).some((e=>e.supports.author)),t)),{nc_any:!1})},We=e=>{switch(e.type){case"publication-day-offset":return!(0<=e.hoursAfterPublication&&e.hoursAfterPublication<=24)&&(0,u._x)("Please select a number of hours after publication between 0 and 24 for the availability time.","user","nelio-content");case"publication-day-period":return Ke(e.time);case"after-publication":return e.daysAfterPublication<0?(0,u._x)("Please select a valid positive number of days after publication for the availability date.","user","nelio-content"):Ke(e.time);case"reshare":return(0,h.values)(e.weekday).some(Boolean)?Ke(e.time):(0,u._x)("Please select at least one day for the availability date or the template will not be used.","user","nelio-content")}},Ke=e=>!Xe(e)&&(0,u._x)("Please select a valid availability time.","user","nelio-content"),Je=e=>{switch(e){case"morning":return(0,u._x)("in the morning","text","nelio-content");case"noon":return(0,u._x)("at noon","text","nelio-content");case"afternoon":return(0,u._x)("in the afternoon","text","nelio-content");case"night":return(0,u._x)("at night","text","nelio-content");default:return(0,u.sprintf)(/* translators: a fixed time in the format HH:mm */ /* translators: a fixed time in the format HH:mm */(0,u._x)("at %s","text","nelio-content"),e)}},He=({doesAuthorExist:e,isAuthorSupported:t,isGroupAuthor:n})=>!!t&&(e?!n&&(0,u._x)("The author is not among those selected in the automation group","text","nelio-content"):(0,u._x)("Selected author doesn’t exist","text","nelio-content")),Ye=({doesTermExist:e,isGroupTerm:t})=>e?!t&&(0,u._x)("The term is not among those selected in the automation group","text","nelio-content"):(0,u._x)("Selected term doesn’t exist","text","nelio-content"),Xe=e=>Qe(e)||/^(?:[01][0-9]|2[0-3]):[0-5][0-9](?::[0-5][0-9])?$/.test(e),Qe=e=>["morning","noon","afternoon","night"].includes(e);function et(e){return e.map((e=>{switch(e){case"mon":return(0,u._x)("Monday","text","nelio-content");case"tue":return(0,u._x)("Tuesday","text","nelio-content");case"wed":return(0,u._x)("Wednesday","text","nelio-content");case"thu":return(0,u._x)("Thursday","text","nelio-content");case"fri":return(0,u._x)("Friday","text","nelio-content");case"sat":return(0,u._x)("Saturday","text","nelio-content");case"sun":return(0,u._x)("Sunday","text","nelio-content");default:return""}}))}const tt=(e,t)=>{const[n,i]=(0,l.useState)(t.length?"loading-entities":"loading-groups"),o="authors"===e?nt(t):it(t),a="authors"===e?"root":"taxonomy",s="authors"===e?"view":"edit";(0,l.useEffect)((()=>{t.length&&"loading-groups"===n&&i("loading-entities")}),[!!t.length,n]);const{loadedEntities:r,hasFinishedResolution:c}=m((e=>(e(ue.store),"loading-entities"===n&&(0,h.keys)(o).length?{loadedEntities:(0,h.mapValues)(o,((t,n)=>(0,h.chunk)(t,100).flatMap((t=>(0,h.map)(e(ue.store).getEntityRecords(a,n,{include:t.join(","),per_page:t.length,context:s}),(e=>e.id)))))),hasFinishedResolution:(0,h.every)((0,h.values)((0,h.mapValues)(o,((t,n)=>(0,h.every)((0,h.chunk)(t,100).flatMap((t=>e(ue.store).hasFinishedResolution("getEntityRecords",[a,n,{include:t.join(","),per_page:t.length,context:s}]))))))))}:{loadedEntities:{},hasFinishedResolution:!0}))),u=(()=>{const{startResolution:e,finishResolution:t}=(0,p.useDispatch)(ue.store);return(n,i)=>{e(n,i),t(n,i)}})();return(0,l.useEffect)((()=>{"loading-entities"===n&&c&&((0,h.mapValues)(r,((e,t)=>e.forEach((e=>u("getEntityRecord",[a,t,e,{context:s}]))))),i("done"))}),[n,c]),"done"!==n},nt=e=>{const t=e.flatMap((e=>[...(0,h.values)(e.profileSettings),...(0,h.values)(e.networkSettings)])).flatMap((e=>[...e.publication.templates,...e.reshare.templates])).map((e=>e.author)).filter(g.isDefined),n=e.flatMap((e=>(0,g.isUniversalGroup)(e)?[]:e.authors));return{user:(0,h.uniq)([...t,...n])}},it=e=>{const t=[...e.flatMap((e=>[...(0,h.values)(e.profileSettings),...(0,h.values)(e.networkSettings)])).flatMap((e=>[...e.publication.templates,...e.reshare.templates])).map((e=>(0,h.mapValues)(e.taxonomies,(e=>[e])))),...e.flatMap((e=>(0,g.isUniversalGroup)(e)?[]:e.taxonomies))],n=(0,h.reduce)(t,((e,t)=>(0,h.mergeWith)(e,t,((e,t)=>(0,h.isArray)(e)&&(0,h.isArray)(t)?[...e,...t]:void 0))),{});return(0,h.mapValues)(n,h.uniq)};function ot(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=ot(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}const at=function(){for(var e,t,n=0,i="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=ot(e))&&(i&&(i+=" "),i+=t);return i},st=({groupId:e,isActive:t,isExpanded:n,onToggle:i,onToggleActivation:o})=>{const a=(e=>{const t=Ae(e),n=(({authors:e,postType:t,publication:n,taxonomies:i})=>{const o=De(t),a=$e(null!=e?e:[]),s=Fe(t,null!=i?i:{}),r=Ue(null!=n?n:{type:"always"}),l=(0,u.sprintf)(/* translators: 1 -> plural post type name (like “Posts” or “Pages”) or “All Content”, 2 -> byline, 3 -> in taxonomy, 4 -> published time */ /* translators: 1 -> plural post type name (like “Posts” or “Pages”) or “All Content”, 2 -> byline, 3 -> in taxonomy, 4 -> published time */
(0,u._x)("%1$s %2$s %3$s %4$s","text","nelio-content"),o,a,s,r);return(0,h.trim)(l.replace(/\s+/g," "))})(null!=t?t:{});return(0,g.isUniversalGroup)(t)?(0,u._x)("Universal Group","text","nelio-content"):(null==t?void 0:t.name)||n})(e),s=lt(e),l=Me();return(0,r.jsxs)("div",{className:"nelio-content-automation-group__header",onClick:i,"aria-hidden":"true",children:[(0,r.jsxs)("div",{className:"nelio-content-automation-group__header-content",onClick:i,"aria-hidden":"true",children:[(0,r.jsx)("div",{className:"nelio-content-automation-group__header-content-activation-toggle",onClick:e=>e.stopPropagation(),"aria-hidden":"true",children:(0,r.jsx)(Se.ToggleControl,{label:"",checked:t,onChange:o,disabled:l})}),(0,r.jsx)(rt,{groupId:e,isActive:t,isExpanded:n}),(0,r.jsx)("div",{className:"nelio-content-automation-group__header-content-title",children:a}),(0,r.jsxs)("div",{className:"nelio-content-automation-group__header-content-icons",children:[s.length<=4?s.map((({id:e})=>(0,r.jsx)(d.SocialProfileIcon,{profileId:e},e))):s.slice(0,3).map((({id:e})=>(0,r.jsx)(d.SocialProfileIcon,{profileId:e},e))),s.length>4&&(0,r.jsx)("div",{className:"nelio-content-automation-group__header-content-remaining-profiles",children:"+"+(s.length-4+1)})]})]}),(0,r.jsx)("div",{className:"nelio-content-automation-group__header-toggle",children:(0,r.jsx)(Se.Button,{disabled:l,icon:n?"arrow-up":"arrow-down",onClick:i})})]})},rt=({groupId:e,isActive:t,isExpanded:n})=>{const i=ct(e),o=ut(e),a=(0,de.useIsSubscribed)("standard");return!t&&!n||i&&(n||o)?a||"universal"===e?null:(0,r.jsx)(Se.Tooltip,{text:(0,u._x)("Upgrade to Nelio Content Standard to be able to use this automation group","user","nelio-content"),placement:"bottom-end",delay:0,children:(0,r.jsx)("div",{className:at({"nelio-content-automation-group--is-warning":!0,"nelio-content-automation-group--is-expanded":n})})}):(0,r.jsx)(Se.Tooltip,{text:o?(0,u._x)("Please review this group’s settings and its active social profiles","user","nelio-content"):(0,u._x)("This group does not have any profiles selected","text","nelio-content"),placement:"bottom-end",delay:0,children:(0,r.jsx)("div",{className:at({"nelio-content-automation-group--is-invalid":!i||!n&&!o,"nelio-content-automation-group--is-expanded":n})})})},lt=e=>m((t=>{const n=t(we).getAutomationGroup(e);if(!n)return[];const i=(0,h.values)(n.profileSettings).filter((e=>e.enabled)).map((e=>e.profileId));return t(de.store).getSocialProfiles().filter((e=>i.includes(e.id)))})),ct=e=>m((t=>t(we).isGroupValid(e))),ut=e=>{const t=Ae(e);return!!(0,h.values)(null==t?void 0:t.profileSettings).filter((e=>e.enabled)).length},dt={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let pt;const mt=new Uint8Array(16),ht=[];for(let e=0;e<256;++e)ht.push((e+256).toString(16).slice(1));const gt=function(e,t,n){if(dt.randomUUID&&!t&&!e)return dt.randomUUID();const i=(e=e||{}).random??e.rng?.()??function(){if(!pt){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");pt=crypto.getRandomValues.bind(crypto)}return pt(mt)}();if(i.length<16)throw new Error("Random bytes length must be >= 16");if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){if((n=n||0)<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=i[e];return t}return function(e,t=0){return(ht[e[t+0]]+ht[e[t+1]]+ht[e[t+2]]+ht[e[t+3]]+"-"+ht[e[t+4]]+ht[e[t+5]]+"-"+ht[e[t+6]]+ht[e[t+7]]+"-"+ht[e[t+8]]+ht[e[t+9]]+"-"+ht[e[t+10]]+ht[e[t+11]]+ht[e[t+12]]+ht[e[t+13]]+ht[e[t+14]]+ht[e[t+15]]).toLowerCase()}(i)},ft=({activeTab:e,groupId:t,setActiveTab:n})=>{const[i,o]=(0,l.useState)(!1),a=Me(),s=yt(t),c=m((e=>e(we).getAutomationGroup(t))),{addAutomationGroup:h,deleteAutomationGroup:f}=(0,p.useDispatch)(we),v=_t(),y=m((e=>e(de.store).getPluginLimits().maxAutomationGroups)),_=m((e=>e(we).getAutomationGroups().length))>=y;return c?(0,r.jsxs)("div",{className:"nelio-content-automation-group__sidebar",children:[s.map(((t,i)=>(0,r.jsx)("div",{className:at({"nelio-content-automation-group__sidebar-item":!0,"nelio-content-automation-group__sidebar-item--active":vt(t,e)}),onClick:()=>!a&&n(t),"aria-hidden":"true",children:"settings"===t.type?(0,r.jsx)(Se.Dashicon,{icon:"admin-settings"}):(0,r.jsx)(Se.Tooltip,{text:t.displayName,placement:"bottom-end",delay:0,children:(0,r.jsxs)("div",{className:"nelio-content-profile__icon-and-indicator",children:[(0,r.jsx)(d.SocialProfileIcon,{className:at({"nelio-content-profile__profile-icon":!0,"nelio-content-profile__profile-icon--is-selected":vt(t,e),"nelio-content-profile__profile-icon--is-invalid":!t.isValid}),profileId:t.id,isNetworkHidden:!1}),(0,r.jsx)("div",{className:at({"nelio-content-profile__profile-indicator":!0,"nelio-content-profile__profile-indicator--is-invalid":!t.isValid})})]})})},i))),(0,r.jsx)("div",{className:"nelio-content-automation-group__sidebar-item nelio-content-automation-group__sidebar-item--is-spacer"}),(0,r.jsxs)("div",{className:"nelio-content-automation-group__sidebar-item nelio-content-automation-group__sidebar-actions",children:[(0,r.jsx)(Se.DropdownMenu,{icon:"admin-generic",label:(0,u._x)("Actions","text","nelio-content"),toggleProps:{disabled:a},controls:[{title:(0,u._x)("Duplicate group","command","nelio-content"),icon:"admin-page",isDisabled:_,onClick:()=>h(v(c))},...(0,g.isUniversalGroup)(c)?[]:[{title:(0,u._x)("Remove group","command","nelio-content"),icon:"trash",onClick:()=>o(!0)}]]}),"universal"!==t&&(0,r.jsx)(d.ConfirmationDialog,{isOpen:i,confirmLabel:(0,u._x)("Delete","command","nelio-content"),onConfirm:()=>{o(!1),f(t)},onCancel:()=>o(!1),text:(0,u._x)("Are you sure you want to delete this group? This operation can’t be undone.","user","nelio-content"),title:(0,u._x)("Delete group","text","nelio-content")})]})]}):null},vt=(e,t)=>{if(e.type!==t.type)return!1;switch(e.type){case"settings":return!0;case"profile":return"profile"===t.type&&e.id===t.id}},yt=e=>{const t=Ae(e);return m((n=>{if(!t)return[];const i=(0,h.values)(t.profileSettings).filter((e=>e.enabled)).map((e=>e.profileId)),o=n(de.store).getSocialProfiles().filter((e=>i.includes(e.id))),{getProfileError:a}=n(we);return[{type:"settings"},...o.map((t=>{var n;return{displayName:a(e,t.id)||(null!==(n=t.alias)&&void 0!==n?n:t.displayName),type:"profile",id:t.id,isValid:!a(e,t.id)}}))]}))},_t=()=>{var e,t;const n=null!==(t=null===(e=(0,de.usePostTypes)("social")[0])||void 0===e?void 0:e.name)&&void 0!==t?t:g.POST;return e=>{var t;const i=Object.assign(Object.assign({postType:(0,g.isUniversalGroup)(e)?n:e.postType,authors:[],taxonomies:{}},e),{id:(0,g.createAutomationGroupId)(),name:(0,g.isUniversalGroup)(e)?(0,u._x)("Copy of Universal Group","text","nelio-content"):(0,u.sprintf)(/* translators: automation group name */ /* translators: automation group name */
(0,u._x)("Copy of %s","text","nelio-content"),null!==(t=e.name)&&void 0!==t?t:(0,u._x)("Unnamed Group","text","nelio-content"))}),o=(0,h.cloneDeep)(i);return Object.assign(Object.assign({},o),{name:(o.name||"")+" "+(0,u._x)("(duplicate)","text","nelio-content"),profileSettings:(0,h.mapValues)(o.profileSettings,(e=>Object.assign(Object.assign({},e),{publication:Object.assign(Object.assign({},e),{templates:e.publication.templates.map((e=>Object.assign(Object.assign({},e),{groupId:o.id,id:gt()})))}),reshare:Object.assign(Object.assign({},e.reshare),{templates:e.reshare.templates.map((e=>Object.assign(Object.assign({},e),{groupId:o.id,id:gt()})))})}))),networkSettings:(0,h.mapValues)(o.networkSettings,(e=>e?Object.assign(Object.assign({},e),{publication:Object.assign(Object.assign({},e.publication),{templates:e.publication.templates.map((e=>Object.assign(Object.assign({},e),{groupId:o.id,id:gt()})))}),reshare:Object.assign(Object.assign({},e.reshare),{templates:e.reshare.templates.map((e=>Object.assign(Object.assign({},e),{groupId:o.id,id:gt()})))})}):void 0))})}},xt=[{value:"always",label:(0,u._x)("Any date","text","nelio-content")},{value:"30",label:(0,u._x)("Last month","text","nelio-content")},{value:"60",label:(0,u._x)("Last two months","text","nelio-content")},{value:"90",label:(0,u._x)("Last three months","text","nelio-content")},{value:"180",label:(0,u._x)("Last six months","text","nelio-content")},{value:"365",label:(0,u._x)("Last year","text","nelio-content")}],bt=({value:e,onChange:t})=>{const n="always"===e.type?"always":`${e.days}`;return(0,r.jsx)(Se.SelectControl,{label:(0,u._x)("Publication date","text","nelio-content"),options:xt,value:n,onChange:e=>t("always"===e?{type:"always"}:{type:"max-age",days:parseInt(e)||30})})},jt=({groupId:e,disabled:t,profileId:n})=>{const i=(0,de.useSocialProfile)(n),[o,a]=kt(e,n),{alias:s,displayName:l="",network:c="twitter"}=i||{};return(0,r.jsx)(Se.Tooltip,{text:`${null!=s?s:l} (${(0,Ie.getNetworkLabel)("name",c)})`,delay:0,children:(0,r.jsxs)("li",{className:at({"nelio-content-profile-selector__profile":!0,"nelio-content-profile-selector__profile--is-selected":o,"nelio-content-profile-selector__profile--is-disabled":t}),children:[(0,r.jsx)("span",{className:"screen-reader-text",children:`${null!=s?s:l}: `}),(0,r.jsx)("input",{className:"nelio-content-profile-selector__profile-input-field",disabled:t,type:"checkbox",checked:!!o,onChange:()=>a(!o)}),(0,r.jsxs)("div",{className:"nelio-content-profile-selector__icon-and-indicator",children:[(0,r.jsx)(d.SocialProfileIcon,{className:at({"nelio-content-profile-selector__profile-icon":!0,"nelio-content-profile-selector__profile-icon--is-selected":o}),profileId:n,isNetworkHidden:!1}),(0,r.jsx)("div",{className:at({"nelio-content-profile-selector__profile-indicator":!0,"nelio-content-profile-selector__profile-indicator--is-selected":o})})]})]})})},kt=(e,t)=>{const n=Ae(e),i=m((e=>e(de.store).getSocialProfile(t))),o=(0,h.find)(null==n?void 0:n.profileSettings,{profileId:t}),{addProfileSettings:a}=(0,p.useDispatch)(we);return[!!(null==o?void 0:o.enabled),s=>{n&&i&&a(e,Object.assign(Object.assign({profileId:t,network:i.network,publication:{enabled:!0,templates:[(0,g.createSocialTemplate)({groupId:n.id,text:"{title} {permalink}",network:i.network,profileId:i.id,postType:void 0}),(0,g.createSocialTemplate)({groupId:n.id,text:"{highlight} {permalink}",network:i.network,profileId:i.id,postType:void 0}),(0,g.createSocialTemplate)({groupId:n.id,text:"{phrase} {permalink}",network:i.network,profileId:i.id,postType:void 0})]},reshare:{enabled:!1,templates:[]}},o),{enabled:s}))}]},Tt=({groupId:e})=>{const t=wt(),n=(0,de.useAdminUrl)("admin.php",{page:"nelio-content-settings",subpage:"social--profiles"});return(0,r.jsxs)("div",{className:"nelio-content-automation-group-settings__section",children:[(0,r.jsx)("p",{className:"nelio-content-automation-group-settings__section-title",children:(0,u._x)("Where should your content be shared?","user","nelio-content")}),(0,r.jsx)("div",{className:"nelio-content-automation-group-settings__section-content",children:t.length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"screen-reader-text",children:(0,u._x)("Select one or more profiles:","text","nelio-content")}),(0,r.jsx)("ul",{className:"nelio-content-automation-group-settings__profile-list",children:t.map((({id:t})=>(0,r.jsx)("div",{className:"nelio-content-automation-group-settings__profile-list-item",children:(0,r.jsx)(jt,{groupId:e,profileId:t})},t)))})]}):(0,r.jsx)("p",{children:(0,l.createInterpolateElement)((0,u._x)("There aren’t any social profiles connected to Nelio Content. <a>Connect one first</a> and then configure its auto share settings here.","user","nelio-content"),{a:(0,r.jsx)("a",{href:n,children:"."})})})})]})},wt=()=>(0,de.useSocialProfiles)().filter((e=>(0,Ie.doesNetworkSupport)("automations",e.network))),Ot=()=>{const e=(0,h.map)((0,de.usePostTypes)("social"),(e=>e.labels.plural)),t=(0,g.listify)("and",(0,h.map)(e,(e=>`<strong>${e}</strong>`))),n=(0,de.useAdminUrl)("admin.php",{page:"nelio-content-settings",subpage:"social--advanced"});return(0,r.jsxs)("div",{className:"nelio-content-automation-group-settings",children:[(0,r.jsxs)("div",{className:"nelio-content-automation-group-settings__section",children:[(0,r.jsx)("p",{className:"nelio-content-automation-group-settings__section-title",children:(0,u._x)("Which content should be shared?","user","nelio-content")}),(0,r.jsxs)("div",{className:"nelio-content-automation-group-settings__section-content",children:[(0,r.jsx)(Se.BaseControl,{id:"nelio-content-universal-post-types",label:(0,u._x)("Post Types","text","nelio-content"),children:(0,r.jsx)("p",{className:"nelio-content-automation-group-settings__universal-post-types",children:(0,l.createInterpolateElement)((0,u.sprintf)(/* translators: list of post type names */ /* translators: list of post type names */
(0,u._x)("When enabled, the universal group applies to all your <a>shareable content</a>: %s.","text","nelio-content"),t),{strong:(0,r.jsx)("strong",{}),a:(0,r.jsx)("a",{href:n,children:"."})})})}),(0,r.jsx)(St,{})]})]}),(0,r.jsx)(Tt,{groupId:"universal"})]})},St=()=>{const e=Ae("universal"),{updateAutomationGroup:t}=(0,p.useDispatch)(we);if(!(0,g.isUniversalGroup)(e))return null;const{publication:n}=e;return(0,r.jsx)("div",{className:"nelio-content-automation-group-settings__extra",children:(0,r.jsx)(bt,{value:n,onChange:e=>t("universal",{publication:e})})})},Et=({groupId:e})=>{const t=(0,de.usePostTypes)("social").map((e=>({value:e.name,label:e.labels.plural}))),[n,i]=Ce(e,"name"),[o,a]=Ce(e,"postType"),s=m((t=>t(we).isPostTypeValid(e)));return(0,r.jsxs)("div",{className:"nelio-content-automation-group-settings",children:[(0,r.jsx)(Se.TextControl,{className:"nelio-content-automation-group-settings__group-name",label:(0,u._x)("Group name","text","nelio-content"),value:null!=n?n:"",onChange:i}),(0,r.jsx)("p",{className:"nelio-content-automation-group-settings__section-title",children:(0,u._x)("Which content should be shared?","user","nelio-content")}),(0,r.jsxs)("div",{className:"nelio-content-automation-group-settings__section-content",children:[(0,r.jsx)(Se.SelectControl,{label:(0,u._x)("Post Type","text","nelio-content"),help:!s&&(0,r.jsx)("span",{className:"nelio-content-error-help",children:(0,u._x)("The selected post type is not valid.","text","nelio-content")}),options:t,value:o,onChange:a}),(0,r.jsx)(It,{groupId:e})]}),(0,r.jsx)(Tt,{groupId:e})]})},It=({groupId:e})=>{const[t]=Ce(e,"postType"),n=Ze(t),[i={},o]=Ce(e,"taxonomies"),[a=[],s]=Ce(e,"authors"),[c={type:"always"},p]=Ce(e,"publication"),[g,f]=(0,l.useState)((0,h.values)(i).some((e=>e.length))||a.length||c&&"always"!==c.type),v=Re(t),y=Pe(t),{areAuthorsValid:_,areTermsValid:x}=m((t=>{const n=t(we);return{areAuthorsValid:n.areAuthorsValid(e),areTermsValid:n.getGroupTermsValidation(e)}}));return g?y?(0,r.jsxs)("div",{className:"nelio-content-automation-group-settings__extra",children:[v.map((e=>{var t;return(0,r.jsx)(d.ItemSelectControl,{id:"nelio-content-automation-group-settings-taxonomies",error:!x[e.slug]&&(0,u._x)("Some terms are not valid.","text","nelio-content"),kind:"taxonomy",label:e.labels.name,name:e.slug,placeholder:e.labels.filter_by_item,value:null!==(t=i[e.slug])&&void 0!==t?t:[],onChange:t=>o(Object.assign(Object.assign({},i),{[e.slug]:t}))},e.slug)})),n&&(0,r.jsx)(d.ItemSelectControl,{id:"nelio-content-automation-group-settings-authors",error:!_&&(0,u._nx)("The selected author is not valid.","Some of the selected authors are not valid.",a.length,"text","nelio-content"),kind:"author",label:(0,u._x)("Authors","text","nelio-content"),placeholder:(0,u._x)("Filter by author","text","nelio-content"),value:a,onChange:s}),(0,r.jsx)(bt,{value:c,onChange:p})]}):(0,r.jsx)("div",{className:"nelio-content-automation-group-settings__extra",children:(0,r.jsx)(Se.Spinner,{})}):(0,r.jsx)("div",{className:"nelio-content-automation-group-settings__extra",children:(0,r.jsx)(Se.Button,{className:"nelio-content-automation-group-settings__extra-action",variant:"link",onClick:()=>f(!0),children:(0,u._x)("Show additional filters","command","nelio-content")})})},Nt=({groupId:e})=>"universal"===e?(0,r.jsx)(Ot,{}):(0,r.jsx)(Et,{groupId:e}),At=/({title}|{permalink}|{phrase}|{highlight}|{tags}|{author}|{categories}|{excerpt}|{field:[^}]*}|{custom:[^}]*}|{taxonomy:[^}]*})/g,Ct=e=>{const t=Pt(e),n=Rt(t),i=Zt(e),{deleteAutomationGroupTemplate:o,openTemplateEditor:a,openTemplateExporter:s}=(0,p.useDispatch)(we);return t?(0,r.jsxs)("div",{"data-template-type":"network"===e.type?(0,u._x)("Network","text (network template)","nelio-content"):"",className:at({"nelio-content-social-template":!0,"nelio-content-social-template--is-network":"network"===e.type}),children:[(0,r.jsx)("div",{className:"nelio-content-social-template__text",children:Mt(t.text)}),(0,r.jsxs)("div",{className:at({"nelio-content-social-template__extra":!0,"nelio-content-social-template__extra--is-invalid":!i}),children:[(0,r.jsx)("span",{className:at({"nelio-content-social-template__filters":!0,"nelio-content-social-template__filters--is-invalid":!i}),children:n}),(0,r.jsxs)("div",{className:"nelio-content-social-template__actions",children:[(0,r.jsx)("span",{children:"•"}),(0,r.jsx)(Se.Button,{variant:"link",onClick:()=>a(e.templateType,t),children:(0,u._x)("Edit","command","nelio-content")}),"|",(0,r.jsx)(Se.Button,{variant:"link",onClick:()=>s((0,g.makeExportedTemplate)(t)),children:(0,u._x)("Export","command","nelio-content")}),e.canBeDeleted&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{children:"|"}),(0,r.jsx)(d.DeleteButton,{confirmationLabels:{title:(0,u._x)("Delete Template","text","nelio-content"),text:(0,u._x)("Are you sure you want to delete this social template? If you then save your social automations, you won’t be able to recover it.","user","nelio-content")},onClick:()=>o(t)})]})]})]})]}):null},Pt=e=>{var t,n,i,o,a,s;const r=Ae(e.groupId);if(!r)return;const{profileSettings:l,networkSettings:c}=r;switch(e.type){case"network":return null!==(n=(0,h.find)(null===(t=c[e.networkName])||void 0===t?void 0:t.publication.templates,{id:e.templateId}))&&void 0!==n?n:(0,h.find)(null===(i=c[e.networkName])||void 0===i?void 0:i.reshare.templates,{id:e.templateId});case"profile":return null!==(a=(0,h.find)(null===(o=l[e.profileId])||void 0===o?void 0:o.publication.templates,{id:e.templateId}))&&void 0!==a?a:(0,h.find)(null===(s=l[e.profileId])||void 0===s?void 0:s.reshare.templates,{id:e.templateId})}},Rt=e=>{const t=(({attachment:e,author:t,postType:n,taxonomies:i,availability:o})=>{var a;const s=De(n),r=$e((0,g.isDefined)(t)?[t]:[]),l=Fe(n,null!==(a=(0,h.mapValues)(i,h.castArray))&&void 0!==a?a:{}),c=(e=>{if(!e)return"";let t="";switch(e.type){case"publication-day-offset":t=0===e.hoursAfterPublication?(0,u._x)("on publication","text","nelio-content"):(0,u.sprintf)(/* translators: number of hours */ /* translators: number of hours */
(0,u._nx)("%d hour after publication","%d hours after publication",e.hoursAfterPublication,"text","nelio-content"),e.hoursAfterPublication);break;case"publication-day-period":t=Je(e.time);break;case"after-publication":switch(e.daysAfterPublication){case 0:t=(0,u._x)("on publication","text","nelio-content");break;case 1:t=(0,u._x)("the day after publication","text","nelio-content");break;case 7:t=(0,u._x)("one week after publication","text","nelio-content");break;case 28:case 29:case 30:case 31:t=(0,u._x)("one month after publication","text","nelio-content");break;default:t=(0,u.sprintf)(/* translators: number of days */ /* translators: number of days */
(0,u._x)("%d days after publication","text","nelio-content"),e.daysAfterPublication)}t+=" "+Je(e.time);break;case"reshare":const n=(0,h.keys)(e.weekday).filter((t=>!1!==e.weekday[t]));let i="";i=7===n.length?(0,u._x)("every day","text","nelio-content"):2===n.length&&n.includes("sat")&&n.includes("sun")?(0,u._x)("on weekends","text","nelio-content"):5!==n.length||n.includes("sat")||n.includes("sun")?1===n.length?(0,u.sprintf)(/* translators: a day of the week */ /* translators: a day of the week */
(0,u._x)("all week but %s,","text","nelio-content"),et(n)[0]):(0,u.sprintf)(/* translators: a list of days */ /* translators: a list of days */
(0,u._x)("on %s","text","nelio-content"),(0,g.listify)("and",et(n))):(0,u._x)("on weekdays","text","nelio-content"),t=i+" "+Je(e.time)}return(0,u.sprintf)(/* translators: time period */ /* translators: time period */
(0,u._x)(", used %s","text","nelio-content"),t)})(o),d=(e=>{if(!e)return"";switch(e){case"none":return(0,u._x)("(text only)","text","nelio-content");case"image":return(0,u._x)("(image)","text","nelio-content");case"video":return(0,u._x)("(video)","text","nelio-content")}})(e),p=(0,u.sprintf)(/* translators: 1 -> plural post type name, 2 -> byline, 3 -> in taxonomy, 4 -> availability time, 5 -> text / image template */ /* translators: 1 -> plural post type name, 2 -> byline, 3 -> in taxonomy, 4 -> availability time, 5 -> text / image template */
(0,u._x)("%1$s %2$s %3$s %4$s %5$s","text","nelio-content"),s,r,l,c,d);return(0,h.trim)(p.replace(/\s+/g," ").replace(/ , /g,", "))})({attachment:null==e?void 0:e.attachment,postType:null==e?void 0:e.postType,author:null==e?void 0:e.author,taxonomies:null==e?void 0:e.taxonomies,availability:null==e?void 0:e.availability});return Gt(e)||t},Zt=e=>m((t=>{const{groupId:n,templateId:i}=e;return t(we).isTemplateValid(n,i)})),Gt=e=>{const t=m((t=>{const{getTemplateErrors:n}=t(we);return e&&n(e.groupId,e.id)}));if(!t)return"";return t.target||t.content||(t.author?t.author:(0,h.values)(t.taxonomies).some(Boolean)?(0,u._x)("Please review selected terms","user","nelio-content"):t.availability?(0,u._x)("Please review availability settings","user","nelio-content"):"")},Mt=e=>(0,l.createInterpolateElement)(Dt(e),{code:(0,r.jsx)("span",{className:"nelio-content-social-template__code-tag"}),newline:(0,r.jsx)("span",{className:"nelio-content-social-template__newline-tag"})}),Dt=e=>(0,h.flow)($t,Ft,Ut,Lt,h.trim)(` ${e} `),$t=e=>e.replace(/\r?\n/g,"¶"),Ft=e=>e.replace(new RegExp("<","g"),"<⁠").replace(new RegExp(">","g"),"⁠>"),Ut=e=>e.replace(At,"<code>$1</code>"),Lt=e=>e.replace(/ *\\u00b6 */g,"<newline>¶</newline>"),Vt=e=>{const[t,n]=(0,l.useState)(0);(0,l.useEffect)((()=>n(0)),[e.profileId]);const{openTemplateEditor:i,openTemplateExporter:o,openTemplateImporter:a}=(0,p.useDispatch)(we),s=Ae(e.groupId),c=zt(e),d=Bt(e.profileId),m=1===(null==c?void 0:c.length);if(!c||!d)return null;const f=c.length<=20?[c]:(0,h.chunk)(c,10),v=f.length,y=v>1;return(0,r.jsxs)("div",{className:"nelio-content-automation-templates",children:[(0,r.jsxs)("div",{className:"nelio-content-automation-templates__header",children:[(0,r.jsxs)("h3",{className:"nelio-content-automation-templates__title",children:[(0,u._x)("Social Templates","text","nelio-content"),y?` (${c.length})`:""]}),(0,r.jsx)(Se.Button,{size:"small",variant:"secondary",onClick:()=>{if(!s)return;const t=(0,g.createSocialTemplate)({groupId:s.id,text:"",network:d,profileId:e.profileId,postType:(0,g.isUniversalGroup)(s)?void 0:s.postType});i(e.mode,t,"new")},children:(0,u._x)("Add Template","command","nelio-content")}),(0,r.jsx)(Se.Button,{size:"small",variant:"secondary",onClick:()=>a(e.groupId,e.profileId,e.mode),children:(0,u._x)("Import","command","nelio-content")}),!!c.length&&(0,r.jsx)(Se.Button,{size:"small",variant:"secondary",onClick:()=>o(c.map(g.makeExportedTemplate)),children:(0,u._x)("Export","command","nelio-content")}),y&&(0,r.jsx)(qt,{mode:"title",current:t,total:v,onChange:n})]}),(0,r.jsx)("div",{className:"nelio-content-automation-templates__content",children:(0,h.map)(f[t],(t=>t.profileId?(0,r.jsx)(Ct,{type:"profile",groupId:e.groupId,profileId:t.profileId,templateId:t.id,templateType:e.mode,canBeDeleted:!m},t.id):(0,r.jsx)(Ct,{type:"network",groupId:e.groupId,networkName:t.network,templateId:t.id,templateType:e.mode,canBeDeleted:!m},t.id)))}),y&&(0,r.jsx)(qt,{mode:"footer",current:t,total:v,onChange:n})]})},qt=({mode:e,current:t,total:n,onChange:i})=>(0,r.jsx)("div",{className:`nelio-content-automation-templates__pagination nelio-content-automation-templates__pagination--${e}`,children:(0,r.jsxs)(Se.ButtonGroup,{children:[(0,r.jsxs)(Se.Button,{disabled:0===t,onClick:()=>i(t-1),variant:"title"===e?"secondary":void 0,size:"title"===e?"small":void 0,children:["< ",(0,r.jsx)(Se.VisuallyHidden,{children:(0,u._x)("Previous page","command","nelio-content")})]}),"footer"===e&&(0,r.jsx)("div",{className:"nelio-content-automation-templates__current-page",children:`${t+1} / ${n}`}),(0,r.jsxs)(Se.Button,{disabled:t>=n-1,onClick:()=>i(t+1),variant:"title"===e?"secondary":void 0,size:"title"===e?"small":void 0,children:["> ",(0,r.jsx)(Se.VisuallyHidden,{children:(0,u._x)("Next page","command","nelio-content")})]})]})}),Bt=e=>m((t=>{var n;return null===(n=t(de.store).getSocialProfile(e))||void 0===n?void 0:n.network})),zt=({groupId:e,profileId:t,mode:n})=>{const i=Bt(t);return m((o=>{var a,s;const r=o(we).getAutomationGroup(e);if(!r)return;const l=r.profileSettings[t],c=i?r.networkSettings[i]:void 0;return[...null!==(a=null==l?void 0:l[n].templates)&&void 0!==a?a:[],...null!==(s=null==c?void 0:c[n].templates)&&void 0!==s?s:[]]}))},Wt=({className:e,tab:t,setTab:n})=>(0,r.jsxs)(Se.Toolbar,{className:e,label:(0,u._x)("Settings","text","nelio-content"),children:[(0,r.jsx)(Se.ToolbarButton,{icon:"megaphone",title:(0,u._x)("Publication","text","nelio-content"),isActive:"publication"===t,onClick:()=>n("publication")}),(0,r.jsx)(Se.ToolbarButton,{icon:"share-alt",title:(0,u._x)("Reshare","text","nelio-content"),isActive:"reshare"===t,onClick:()=>n("reshare")})]});const Kt=e=>{var t;const{groupId:n,profileId:i}=e,[o,a]=(0,l.useState)("publication"),s=(0,de.useSocialProfile)(i),c=Yt(i),[u]=Xt(n,i);if(!s||!u)return null;const p=c&&!!u[o].enabled;return(0,r.jsxs)("div",{className:"nelio-content-automation-profile-settings",children:[(0,r.jsxs)("div",{className:"nelio-content-automation-profile-settings__header",children:[(0,r.jsxs)("div",{className:"nelio-content-automation-profile-settings__profile-details",children:[(0,r.jsx)("h3",{className:"nelio-content-automation-profile-settings__profile-name",children:null!==(t=s.alias)&&void 0!==t?t:s.displayName}),(0,r.jsx)(d.ProfileCreator,{className:"nelio-content-automation-profile-settings__profile-creator",profileId:i})]}),(0,r.jsx)(Wt,{className:"nelio-content-automation-profile-settings__tab-selector",tab:o,setTab:a})]}),(0,r.jsxs)("div",{className:"nelio-content-automation-profile-settings__content",children:[(0,r.jsx)(Jt,Object.assign({type:o},e)),p&&(0,r.jsx)(Vt,{groupId:n,profileId:i,mode:o})]})]})},Jt=e=>{var{type:t}=e,n=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n}(e,["type"]);const{groupId:i,profileId:o}=n,[a,s]=Xt(i,o),l=Ae(i),c=Qt(i,o,t);return l&&a?(0,r.jsx)("div",{className:"nelio-content-automation-profile-settings__sharing-settings",children:(0,r.jsx)(Se.CheckboxControl,{checked:a[t].enabled,onChange:()=>{const e=c||!!a[t].templates.length,i=!a[t].enabled,o=a[t].templates,r=[(0,g.createSocialTemplate)({groupId:l.id,text:"{title} {permalink}",network:a.network,profileId:n.profileId,postType:void 0}),(0,g.createSocialTemplate)({groupId:l.id,text:"{highlight} {permalink}",network:a.network,profileId:n.profileId,postType:void 0}),(0,g.createSocialTemplate)({groupId:l.id,text:"{phrase} {permalink}",network:a.network,profileId:n.profileId,postType:void 0})];s(Object.assign(Object.assign({},a),{[t]:Object.assign(Object.assign({},a[t]),{enabled:i,templates:i&&!e?r:o})}))},label:(0,r.jsx)(Ht,{profileId:n.profileId,enabled:a[t].enabled,type:t})})}):null},Ht=({enabled:e,profileId:t,type:n})=>{const[i,o]=en(t,n);if(!e)return(0,r.jsx)(r.Fragment,{children:"publication"===n?(0,u._x)("Share content on publication","command","nelio-content"):(0,u._x)("Reshare content","command","nelio-content")});const a=e=>Math.min(20,Math.max(1,e)),s="publication"===n?/* translators: number of social messages */ /* translators: number of social messages */
(0,u._x)("Share content on publication using up to %s messages","command","nelio-content"):/* translators: number of social messages */ /* translators: number of social messages */
(0,u._x)("Reshare content using up to %s daily messages","command","nelio-content");return(0,l.createInterpolateElement)((0,u.sprintf)(s,"<value/>"),{value:(0,r.jsx)("input",{type:"number",style:{width:"4.5em"},min:"1",max:20,value:a(i),onChange:e=>{const t=e.target.value,n=Number.parseInt(t);isNaN(n)||o(a(n))}})})},Yt=e=>{const t=(0,de.useSocialProfile)(e);return!!t&&(0,Ie.doesNetworkSupport)("profile-template",t.network)},Xt=(e,t)=>{const n=m((n=>n(we).getProfileAutomationSettings(e,t))),{addProfileSettings:i}=(0,p.useDispatch)(we);return[n,t=>{if(n)return i(e,Object.assign(Object.assign({},n),t))}]},Qt=(e,t,n)=>{var i,o;const a=Ae(e),s=null===(i=null==a?void 0:a.profileSettings[t])||void 0===i?void 0:i.network;return!!s&&!!(null===(o=null==a?void 0:a.networkSettings[s])||void 0===o?void 0:o[n].templates.length)},en=(e,t)=>{const n=m((n=>{var i,o;return null!==(o=null===(i=n(we).getProfileFrequencies(e))||void 0===i?void 0:i[t])&&void 0!==o?o:1})),{setProfileFrequencies:i}=(0,p.useDispatch)(we);return[n,n=>i(e,{[t]:n})]},tn=({groupId:e})=>{const[t,n]=nn(e),[i,o]=(0,l.useState)(t),[a,s]=(0,l.useState)({type:"settings"}),c=Me();return(e=>{const t=Ae(e),n=(0,h.map)((0,de.usePostTypes)("social"),"name"),i=!!(0,g.isUniversalGroup)(t)||!!(null==t?void 0:t.postType)&&n.includes(t.postType),o=(e=>{var t;const n=(0,g.isUniversalGroup)(e)||null==e?void 0:e.postType,i=!!(null===(t=(0,de.usePostType)(n))||void 0===t?void 0:t.supports.author);return m((t=>{var n;if(t(ue.store),!i||(0,g.isUniversalGroup)(e))return!0;const{getEntityRecord:o,hasFinishedResolution:a,hasResolutionFailed:s}=t(ue.store),r=null!==(n=null==e?void 0:e.authors)&&void 0!==n?n:[],l=(0,h.map)(r,(e=>o("root","user",e,{context:"view"}))),c=(0,h.map)(r,(e=>a("getEntityRecord",["root","user",e,{context:"view"}])||s("getEntityRecord",["root","user",e,{context:"view"}])));return!(0,h.every)(c)||(0,h.every)(l)}))})(t),a=(e=>{var t;const n=(0,g.isUniversalGroup)(e)||null==e?void 0:e.postType,i=(0,h.map)(Re(n),"slug"),o=(0,h.pick)(Object.assign(Object.assign({},(0,h.zipObject)(i,(0,h.map)(i,(()=>[])))),(0,g.isUniversalGroup)(e)?{}:null!==(t=null==e?void 0:e.taxonomies)&&void 0!==t?t:{}),i);return m((e=>{const{getEntityRecord:t,hasFinishedResolution:n,hasResolutionFailed:i}=e(ue.store),a=(0,h.mapValues)(o,((e,n)=>e.map((e=>n=>t("taxonomy",e,n)||void 0)(n)))),s=(0,h.mapValues)(o,((e,t)=>e.map((e=>t=>!!n("getEntityRecord",["taxonomy",e,t])||!!i("getEntityRecord",["taxonomy",e,t]))(t))));return(0,h.mapValues)(o,((e,t)=>!(0,h.every)(s[t])||(0,h.every)(a[t])))}))})(t),s=(e=>(0,h.mapValues)(null==e?void 0:e.profileSettings,(e=>!(!e.enabled||e.publication.enabled||e.reshare.enabled)&&(0,u._x)("Missing permissions to automatically share content on your behalf","user","nelio-content"))))(t),r=Ge(t,(e=>{const t=(0,h.filter)((0,h.values)(null==e?void 0:e.profileSettings),{enabled:!0}),n=(0,h.map)(t,"network"),i=(0,h.values)((0,h.pick)(null==e?void 0:e.networkSettings,n));return[...(0,h.flatten)((0,h.map)((0,h.filter)((0,h.map)(t,"publication"),{enabled:!0}),"templates")),...(0,h.flatten)((0,h.map)((0,h.filter)((0,h.map)(t,"reshare"),{enabled:!0}),"templates")),...(0,h.flatten)((0,h.map)((0,h.map)(i,"publication"),"templates")),...(0,h.flatten)((0,h.map)((0,h.map)(i,"reshare"),"templates"))]})(t)),{setAutomationGroupValidation:c}=(0,p.useDispatch)(we);(0,l.useEffect)((()=>{t&&c(e,{isPostTypeValid:i,areAuthorsValid:o,areTermsValid:a,socialProfileErrors:s,templateErrors:r})}),[JSON.stringify(i),JSON.stringify(o),JSON.stringify(a),JSON.stringify(s),JSON.stringify(r)])})(e),(0,r.jsxs)("div",{className:at({"nelio-content-automation-group":!0,"nelio-content-automation-group--inactive":!t&&!i,"nelio-content-automation-group--disabled":c}),children:[(0,r.jsx)(st,{groupId:e,isActive:t,isExpanded:i,onToggleActivation:()=>n(!t),onToggle:()=>o(!i)}),i&&(0,r.jsxs)("div",{className:"nelio-content-automation-group__body",children:[(0,r.jsx)(ft,{groupId:e,activeTab:a,setActiveTab:s}),(0,r.jsx)("div",{className:"nelio-content-automation-group__body-content",children:"settings"===a.type?(0,r.jsx)(Nt,{groupId:e}):(0,r.jsx)(Kt,{groupId:e,profileId:a.id})})]})]})},nn=e=>{const t=Ae(e),n=!!(null==t?void 0:t.priority),{updateAutomationGroup:i}=(0,p.useDispatch)(we);return[n,t=>i(e,{priority:t?100:0})]},on=()=>{const e=m((e=>e(we).getAutomationGroups())),t=m((e=>e(de.store).getPluginLimits().maxAutomationGroups)),n=m((e=>e(de.store).canCurrentUserManagePlugin())),i=e.length<t,o=(0,de.usePostTypes)("social"),{addAutomationGroup:a,saveAutomationGroups:s}=(0,p.useDispatch)(we),l=m((e=>e(we).isSaving())),c=Ne();return(0,g.isEmpty)(e)?null:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"nelio-content-automation-group-list",children:e.map((e=>(0,r.jsx)(tn,{groupId:e},e)))}),(0,r.jsx)(an,{limit:t,active:!i}),(0,r.jsxs)("div",{className:"nelio-content-automation-group-list__actions",children:[!(0,g.isEmpty)(e)&&(0,r.jsx)(Se.Button,{className:"nelio-content-save-automation-groups",variant:"primary",onClick:s,disabled:!c||l,children:l?(0,u._x)("Saving…","text","nelio-content"):(0,u._x)("Save Changes","command","nelio-content")}),1===t&&n&&(0,r.jsx)(d.PremiumFeatureButton,{feature:"raw/automation-groups",label:(0,u._x)("Add Group","command","nelio-content"),variant:"secondary"}),1<t&&(0,r.jsx)(Se.Button,{className:"nelio-content-add-automation-group",variant:(0,g.isEmpty)(e)?"primary":"secondary",onClick:()=>{o[0]&&a({id:(0,g.createAutomationGroupId)(),name:"",priority:100,postType:o[0].name,taxonomies:{},publication:{type:"always"},authors:[],profileSettings:{},networkSettings:{}})},disabled:l||!i,children:(0,u._x)("Add Group","command","nelio-content")})]})]})},an=({active:e,limit:t})=>{const n=m((e=>e(de.store).getAdminUrl("/admin.php",{page:"nelio-content-account"}))),i=m((e=>e(de.store).canCurrentUserManagePlugin())),o=m((e=>e(de.store).isSubscribed("plus")));return e&&1!==t?(0,r.jsxs)("div",{className:"nelio-content-automation-group-list__error",children:[(0,u.sprintf)(/* translators: number of groups allowed */ /* translators: number of groups allowed */
(0,u._x)("You’ve reached the maximum number of automation groups allowed (i.e. %d).","user","nelio-content"),t)+" ",!o&&i&&(0,r.jsx)(Se.ExternalLink,{href:n,children:(0,u._x)("Please consider upgrading your subscription.","user","nelio-content")})]}):null},sn=()=>{const e=m((e=>e(de.store).isSocialPublicationPaused())),t=m((e=>e(de.store).isSocialPublicationStatusBeingSynched())),{toggleSocialPublicationStatus:n}=(0,p.useDispatch)(de.store),i=e?(0,u._x)("Resume Social Publication","command","nelio-content"):(0,u._x)("Pause Social Publication","command","nelio-content"),o=e?(0,u._x)("Resuming Social Publication…","command","nelio-content"):(0,u._x)("Pausing Social Publication…","command","nelio-content");return(0,r.jsx)(Se.Button,{variant:"link",disabled:t,onClick:n,children:t?o:i})},rn=()=>{switch(m((e=>e(de.store).getResetStatus()))){case"ready":return(0,r.jsx)(ln,{});case"resetting":return(0,r.jsx)(cn,{});case"done":return(0,r.jsx)(un,{});case"error":return(0,r.jsx)(dn,{})}},ln=()=>{const{resetSocialMessages:e}=(0,p.useDispatch)(de.store);return(0,r.jsx)(Se.Button,{variant:"link",onClick:e,children:(0,u._x)("Reset Social Messages","command","nelio-content")})},cn=()=>(0,r.jsx)(r.Fragment,{children:(0,u._x)("Resetting Social Messages…","text","nelio-content")}),un=()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Se.Dashicon,{icon:"info"})," ",(0,u._x)("Social messages will be automatically regenerated shortly","text","nelio-content")]}),dn=()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Se.Dashicon,{icon:"warning"})," ",(0,u._x)("Unable to reset social messages","text","nelio-content")]}),pn=()=>{const e=Ne();return!m((e=>!!e(de.store).canCurrentUserManagePlugin()))||e?null:(0,r.jsxs)("div",{className:"nelio-content-message-actions",children:[(0,r.jsx)(rn,{}),(0,r.jsx)("span",{children:"|"}),(0,r.jsx)(sn,{})]})},mn=()=>{const{publication:e,reshare:t}=hn(),n=m((e=>e(de.store).isSocialPublicationPaused()));return e||t?(0,r.jsxs)("div",{className:"nelio-content-message-count-estimation",children:[(0,r.jsxs)("div",{children:[!!n&&gn(),!!e&&vn(e),!!t&&fn(t)]}),(0,r.jsx)(pn,{})]}):(0,r.jsx)("div",{className:"nelio-content-message-count-estimation",children:(0,r.jsx)("div",{children:(0,u._x)("Enable social automations on one or more profiles to allow Nelio Content to generate messages automatically.","user","nelio-content")})})},hn=()=>m((e=>{const{getAutomationGroup:t,getAutomationGroups:n,getProfileFrequencies:i}=e(we),o=n().map(t).filter(g.isDefined),a=e=>(0,h.sum)((0,h.uniq)(o.flatMap((t=>Object.keys(t.profileSettings).map((e=>e)).filter((n=>{var i,o;return!!t.priority&&!!(null===(i=t.profileSettings[n])||void 0===i?void 0:i.enabled)&&!!(null===(o=t.profileSettings[n])||void 0===o?void 0:o[e].enabled)}))))).map(i).filter(g.isDefined).map((t=>t[e])));return{publication:a("publication"),reshare:a("reshare")}})),gn=()=>yn((0,u._x)("<strong>Notice!</strong> Social publication is currently paused. This means Nelio Content will not share any scheduled social messages when their time comes.","usr","nelio-content")+"<br/>"),fn=e=>yn(30<e?(0,u._x)("Your calendar will contain <strong>as many messages per day as possible</strong>.","text","nelio-content"):(0,u.sprintf)(/* translators: number of social messages */ /* translators: number of social messages */
(0,u._nx)("Your calendar will contain <strong>%d social message per day</strong>.","Your calendar will contain <strong>%d social messages per day</strong>.",e,"text","nelio-content"),e)),vn=e=>yn(30<e?(0,u._x)("When publishing new content, Nelio will automatically generate <strong>as many messages as possible</strong>.","text","nelio-content"):(0,u.sprintf)(/* translators: number of social messages */ /* translators: number of social messages */
(0,u._nx)("When publishing new content, Nelio will automatically generate up to <strong>%d social message</strong>.","When publishing new content, Nelio will automatically generate up to <strong>%d social messages</strong>.",e,"text","nelio-content"),e)),yn=e=>(0,l.createInterpolateElement)(e+" ",{strong:(0,r.jsx)("strong",{}),br:(0,r.jsx)("br",{})}),xn=({resetDateTime:e})=>(0,r.jsx)("div",{className:"nelio-content-social-template-editor__reset-date-button",children:(0,r.jsx)(Se.Button,{variant:"link",onClick:()=>e(),children:(0,u._x)("Change","command","nelio-content")})}),bn=({value:e,onChange:t,resetSelector:n})=>(0,r.jsx)(Se.BaseControl,{id:"nelio-content-social-template-editor__date-selector",label:(0,u._x)("Date","text","nelio-content"),children:(0,r.jsxs)("div",{className:"nelio-content-social-template-editor__date-selector",children:[(0,l.createInterpolateElement)((0,u.sprintf)(/* translators: number of days */ /* translators: number of days */
(0,u._x)("%s days after publication.","text","nelio-content"),"<input/>"),{input:(0,r.jsx)(d.NumberControl,{className:"nelio-content-social-template-editor__positive-days-selector",value:e,min:2,onChange:e=>t(null!=e?e:2)})}),(0,r.jsx)(xn,{resetDateTime:n})]})}),jn=({daysAfterPublication:e,onChange:t})=>(0,r.jsx)(Se.BaseControl,{id:"nelio-content-social-template-editor__date-selector",label:(0,u._x)("Date","text","nelio-content"),children:(0,r.jsx)("div",{className:"nelio-content-social-template-editor__date-selector",children:(0,r.jsx)(Se.SelectControl,{options:kn,value:`${e}`,onChange:e=>t("positive-days"===e?"positive-days":parseInt(e))})})}),kn=[{value:"0",label:(0,u._x)("Same day as publication","text","nelio-content")},{value:"1",label:(0,u._x)("The day after publication","text","nelio-content")},{value:"7",label:(0,u._x)("A week after publication","text","nelio-content")},{value:"28",label:(0,u._x)("A month after publication","text","nelio-content")},{value:"positive-days",label:(0,u._x)("__ days after publication","text","nelio-content")}],Tn=({days:e,onChange:t})=>{const n=m((e=>e(de.store).getFirstDayOfWeek())),i=[{id:"sun",label:(0,u._x)("SUN","text","nelio-content")},{id:"mon",label:(0,u._x)("MON","text","nelio-content")},{id:"tue",label:(0,u._x)("TUE","text","nelio-content")},{id:"wed",label:(0,u._x)("WED","text","nelio-content")},{id:"thu",label:(0,u._x)("THU","text","nelio-content")},{id:"fri",label:(0,u._x)("FRI","text","nelio-content")},{id:"sat",label:(0,u._x)("SAT","text","nelio-content")}],o=[...i.slice(n),...i.slice(0,n)];return(0,r.jsx)(Se.BaseControl,{id:"nelio-content-social-template-editor__week-days-selector",label:(0,u._x)("Week Days","text","nelio-content"),children:(0,r.jsx)("div",{className:"nelio-content-social-template-editor__week-days-selector",children:o.map((({id:n,label:i},o)=>(0,r.jsx)(Se.CheckboxControl,{label:i,checked:e[n],onChange:i=>t(Object.assign(Object.assign({},e),{[n]:i}))},o)))})})},wn=({templateType:e,availability:t,setAvailability:n})=>{const[i,o]=(0,l.useState)("after-publication"===t.type&&!En(t.daysAfterPublication)),a=On(t),s=Sn(t);return"reshare"===e||"reshare"===t.type?(0,r.jsx)(Tn,{days:s,onChange:e=>n(Object.assign(Object.assign({},t),function(e){const{type:t}=e;switch(t){case"publication-day-offset":case"after-publication":case"publication-day-period":return!1;case"reshare":return!0}}(t)&&{weekday:Object.assign({},e)}))}):"after-publication"!==t.type||En(t.daysAfterPublication)&&!i?(0,r.jsx)(jn,{daysAfterPublication:a,onChange:e=>{0===e?n(Object.assign(Object.assign({},t),{type:"publication-day-offset",hoursAfterPublication:"publication-day-offset"===t.type?t.hoursAfterPublication:0})):"positive-days"===e?(n(Object.assign(Object.assign({},t),{type:"after-publication",daysAfterPublication:2,time:"after-publication"===t.type?t.time:"morning"})),o(!0)):n(Object.assign(Object.assign({},t),{type:"after-publication",daysAfterPublication:e,time:"after-publication"===t.type?t.time:"morning"}))}}):(0,r.jsx)(bn,{value:t.daysAfterPublication,onChange:e=>n(Object.assign(Object.assign({},t),{type:"after-publication",daysAfterPublication:e})),resetSelector:()=>{n({type:"publication-day-offset",hoursAfterPublication:0}),o(!1)}})},On=e=>{const{type:t}=e;return"after-publication"!==t?0:e.daysAfterPublication},Sn=e=>"reshare"===e.type?e.weekday:{mon:!1,tue:!1,wed:!1,thu:!1,fri:!1,sat:!1,sun:!1};function En(e){return[0,1,7,28].includes(e)}const In=({onClick:e})=>(0,r.jsx)("div",{className:"nelio-content-social-template-editor__reset-time-button",children:(0,r.jsx)(Se.Button,{variant:"link",onClick:e,children:(0,u._x)("Change","command","nelio-content")})}),Nn=({exactTime:e,setExactTime:t,reset:n})=>(0,r.jsx)(Se.BaseControl,{id:"nelio-content-social-template-editor__time-selector",label:(0,u._x)("Time","text","nelio-content"),children:(0,r.jsxs)("div",{className:"nelio-content-social-template-editor__time-selector",children:[(0,r.jsx)(d.TimeInput,{value:e,onChange:e=>e?t(e):null}),(0,r.jsx)(In,{onClick:()=>n()})]})}),An=({hours:e,setHours:t,reset:n})=>(0,r.jsx)(Se.BaseControl,{id:"nelio-content-social-template-editor__time-selector",label:(0,u._x)("Time","text","nelio-content"),children:(0,r.jsxs)("div",{className:"nelio-content-social-template-editor__time-selector",children:[(0,l.createInterpolateElement)((0,u.sprintf)(/* translators: number of hours */ /* translators: number of hours */
(0,u._x)("%s hours after publication.","text","nelio-content"),"<input/>"),{input:(0,r.jsx)(d.NumberControl,{className:"nelio-content-social-template-editor__positive-hours-selector",value:e,min:2,max:24,onChange:e=>t(null!=e?e:2)})}),(0,r.jsx)(In,{onClick:()=>n()})]})}),Cn=({interval:e,setIntervalValue:t,selectExactTime:n,reset:i})=>(0,r.jsxs)(Se.BaseControl,{id:"nelio-content-social-template-editor__time-selector",label:(0,u._x)("Time","text","nelio-content"),children:[(0,r.jsx)("div",{className:"nelio-content-social-template-editor__time-selector",children:(0,r.jsx)(Se.SelectControl,{options:Pn,value:e,onChange:e=>"exact"===e?n():t(e)})}),!!i&&(0,r.jsx)(In,{onClick:()=>i()})]}),Pn=[{value:"morning",label:(0,u._x)("Morning (8am – 11am)","text","nelio-content")},{value:"noon",label:(0,u._x)("Noon (11am – 3pm)","text","nelio-content")},{value:"afternoon",label:(0,u._x)("Afternoon (3pm – 7pm)","text","nelio-content")},{value:"night",label:(0,u._x)("Night (7pm – 11pm)","text","nelio-content")},{value:"exact",label:(0,u._x)("Choose a custom time…","user","nelio-content")}],Rn=({value:e,setValue:t,selectExactTime:n,selectPositiveHours:i,selectTimeInterval:o})=>(0,r.jsx)(Se.BaseControl,{id:"nelio-content-social-template-editor__time-selector",label:(0,u._x)("Time","text","nelio-content"),children:(0,r.jsx)("div",{className:"nelio-content-social-template-editor__time-selector",children:(0,r.jsx)(Se.SelectControl,{options:Zn,value:`${e}`,onChange:e=>{"positive-hours"===e?i():"exact"===e?n():"time-interval"===e?o():t(parseInt(e))}})})}),Zn=[{value:"0",label:(0,u._x)("Same time as publication","text","nelio-content")},{value:"1",label:(0,u._x)("One hour after publication","text","nelio-content")},{value:"3",label:(0,u._x)("Three hours after publication","text","nelio-content")},{value:"5",label:(0,u._x)("Five hours after publication","text","nelio-content")},{value:"positive-hours",label:(0,u._x)("__ hours after publication","text","nelio-content")},{value:"time-interval",label:(0,u._x)("Choose a time interval…","user","nelio-content")},{value:"exact",label:(0,u._x)("Choose a custom time…","user","nelio-content")}],Gn=({templateType:e,availability:t,setAvailability:n})=>{const[i,o]=(0,l.useState)("publication-day-offset"===t.type&&!Un(t.hoursAfterPublication)),a=Mn(e,i,t),s=Dn(t);return"exact"===a||"time-interval"===a&&Vn(s)?(0,r.jsx)(Nn,{exactTime:Vn(s)?s:"10:00",setExactTime:e=>n(Object.assign(Object.assign({},t),$n(t)&&{time:e})),reset:()=>n("publication-day-period"===t.type?{type:"publication-day-offset",hoursAfterPublication:0}:Object.assign(Object.assign({},t),$n(t)&&{time:"morning"}))}):"positive-hours"===a?(0,r.jsx)(An,{hours:"number"==typeof s?s:2,setHours:e=>n({type:"publication-day-offset",hoursAfterPublication:e}),reset:()=>{n(Object.assign(Object.assign({},t),Fn(t)&&{hoursAfterPublication:0})),o(!1)}}):"time-interval"===a?(0,r.jsx)(Cn,{interval:"number"!=typeof s&&Ln(s)?s:"morning",setIntervalValue:e=>n(Object.assign(Object.assign({},t),$n(t)&&{time:e})),selectExactTime:()=>n(Object.assign(Object.assign({},t),$n(t)&&{time:"10:00"})),reset:"publication-day-period"===t.type?()=>n({type:"publication-day-offset",hoursAfterPublication:0}):void 0}):"predefined-offset"===a?(0,r.jsx)(Rn,{value:"publication-day-offset"===t.type&&Un(t.hoursAfterPublication)?t.hoursAfterPublication:0,setValue:e=>{o(!1),n(Object.assign(Object.assign({},t),Fn(t)&&{hoursAfterPublication:e}))},selectExactTime:()=>{o(!1),n({type:"publication-day-period",time:"10:00"})},selectTimeInterval:()=>{o(!1),n({type:"publication-day-period",time:"morning"})},selectPositiveHours:()=>{o(!0),n(Object.assign(Object.assign({},t),Fn(t)&&{hoursAfterPublication:2}))}}):null},Mn=(e,t,n)=>{const{type:i}=n;if("reshare"===e)return"time-interval";switch(i){case"publication-day-offset":return!n.hoursAfterPublication||!t&&Un(n.hoursAfterPublication)?"predefined-offset":"positive-hours";case"after-publication":case"publication-day-period":case"reshare":return Ln(n.time)?"time-interval":"exact"}},Dn=e=>{const{type:t}=e;switch(t){case"publication-day-offset":return e.hoursAfterPublication;case"after-publication":case"publication-day-period":case"reshare":return e.time}};function $n(e){const{type:t}=e;switch(t){case"publication-day-offset":return!1;case"after-publication":case"publication-day-period":case"reshare":return!0}}function Fn(e){return"publication-day-offset"===e.type}function Un(e){return[0,1,3,5].includes(e)}function Ln(e){return!e.includes(":")}function Vn(e){return"string"==typeof e&&!Ln(e)}const qn=()=>{var e;const t=zn(),[n,i]=Bn(),o=m((e=>e(we).getEditingTemplateErrors()));if(!n)return null;const{availability:a}=n;return(0,r.jsxs)("div",{className:"nelio-content-availability-control",children:[!a&&(0,r.jsx)(Se.Button,{variant:"link",onClick:()=>i({availability:Wn(t)}),children:(0,u._x)("Customize template availability","command","nelio-content")}),!!a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:at("nelio-content-availability-control__options",{"nelio-content-availability-control__options--reshare":"reshare"===t}),children:[(0,r.jsx)(wn,{templateType:t,availability:a,setAvailability:e=>i({availability:e})}),(0,r.jsx)(Gn,{templateType:t,availability:a,setAvailability:e=>i({availability:e})})]}),(0,r.jsx)("div",{className:"nelio-content-availability-control__error",children:null!==(e=o.availability)&&void 0!==e?e:""}),(0,r.jsx)("div",{children:(0,r.jsx)(Se.Button,{variant:"link",onClick:()=>i({availability:void 0}),children:(0,u._x)("Make template always available","command","nelio-content")})})]})]})},Bn=()=>{const e=m((e=>e(we).getEditingTemplate())),{setEditingTemplateAttributes:t}=(0,p.useDispatch)(we);return[e,t]},zn=()=>m((e=>e(we).getEditingTemplateType())),Wn=e=>"publication"===e?{type:"publication-day-offset",hoursAfterPublication:0}:{type:"reshare",weekday:{mon:!0,tue:!0,wed:!0,thu:!0,fri:!0,sat:!0,sun:!0},time:"morning"},Kn=[{title:(0,u._x)("Social Template Editor","text","nelio-content"),intro:(0,u._x)("Welcome to the social template editor, the easiest way to create custom templates for sharing your content on social media.","user","nelio-content"),elementToClick:()=>null,element:()=>document.querySelector(".nelio-content-social-template-editor-dialog")},{title:(0,u._x)("Message","text","nelio-content"),intro:(0,u._x)("Here you can write the template itself. Add placeholders like, for example, {title} or {tags}, which will be then replaced by Nelio Content when the template is used for sharing a specific post from your site.","user","nelio-content"),elementToClick:()=>null,element:()=>document.querySelector(".nelio-content-social-template-editor-dialog__text")},{title:(0,u._x)("Placeholders","text","nelio-content"),intro:(0,u._x)("If you don’t know which placeholders are available, use this action and select the placeholder(s) you want to include in your template.","user","nelio-content"),elementToClick:()=>null,element:()=>document.querySelector(".nelio-content-social-template-editor-dialog__add-placeholder")},{title:(0,u._x)("Additional Filters","text","nelio-content"),intro:(0,u._x)("By default, templates apply to all content in the Automation Group. But you can narrow the selection using these actions here.","user","nelio-content"),elementToClick:()=>null,element:()=>document.querySelector(".nelio-content-social-template-editor-dialog__quick-actions .is-link")||document.querySelector(".nelio-content-social-template-editor-dialog__tab-selector")},{title:(0,u._x)("Content Type","text","nelio-content"),intro:(0,u._x)("Depending on the content selected in the Automation Group, you’ll be able to filter the tempate by taxonomy and/or author.","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-social-template-editor-dialog__quick-actions .is-link"),element:()=>document.querySelector(".nelio-content-social-template-editor-dialog__tab-selector")},{title:(0,u._x)("Template Availability","text","nelio-content"),intro:(0,u._x)("You can also customize the template’s availability (i.e. when a template is eligible). For instance, let Nelio Content use a template on post’s publication or on a Monday morning","user","nelio-content"),elementToClick:()=>document.querySelector(".nelio-content-social-template-editor__availability-action"),element:()=>document.querySelector(".nelio-content-availability-control")},{title:(0,u._x)("Save Changes","text","nelio-content"),intro:(0,u._x)("Save the template using the “Save” button. If there are any errors, the button will be disabled – hover it to reveal the error.","user","nelio-content"),elementToClick:()=>null,element:()=>document.querySelector(".nelio-content-social-template-editor-dialog__save-button")}];let Jn;const Hn=()=>{"function"==typeof Jn&&Jn()},Yn=({onClick:e})=>{const t=Qn(),n=Xn(),i=(e=>m((t=>{const n=t(we).getCustomFields();return e?n[e]||[]:(0,h.values)((0,h.keyBy)((0,h.values)(n).flatMap((e=>e)),"key"))})))(t),o=(e=>m((t=>{const n=t(we).getCustomPlaceholders();return e?n[e]||[]:(0,h.values)((0,h.keyBy)((0,h.values)(n).flatMap((e=>e)),"key"))})))(t),a=ei();return(0,r.jsx)(Se.DropdownMenu,{className:"nelio-content-social-template-editor-dialog__quick-action nelio-content-social-template-editor-dialog__add-placeholder",icon:"tag",label:(0,u._x)("Placeholders","text","nelio-content"),toggleProps:{tooltipPosition:"bottom center"},popoverProps:{onFocusOutside:Hn},children:({onClose:t})=>(Jn=t,(0,r.jsxs)(Se.MenuGroup,{children:[(0,r.jsxs)(Se.MenuGroup,{children:[n.title&&(0,r.jsx)(Se.MenuItem,{role:"menuitem",icon:"editor-textcolor",onClick:()=>e("{title}"),children:(0,u._x)("Add Title","command","nelio-content")}),(0,r.jsx)(Se.MenuItem,{role:"menuitem",icon:"format-status",onClick:()=>e("{phrase}"),children:(0,u._x)("Add Content Phrase","command","nelio-content")}),(0,r.jsx)(Se.MenuItem,{role:"menuitem",icon:"editor-quote",onClick:()=>e("{highlight}"),children:(0,u._x)("Add Highlight","command","nelio-content")}),n.author&&(0,r.jsx)(Se.MenuItem,{role:"menuitem",icon:"admin-users",onClick:()=>e("{author}"),children:(0,u._x)("Add Author","command","nelio-content")}),n.excerpt&&(0,r.jsx)(Se.MenuItem,{role:"menuitem",icon:"text",onClick:()=>e("{excerpt}"),children:(0,u._x)("Add Excerpt","command","nelio-content")}),(0,r.jsx)(Se.MenuItem,{role:"menuitem",icon:"admin-links",onClick:()=>e("{permalink}"),children:(0,u._x)("Add Permalink","command","nelio-content")})]}),!!a.length&&(0,r.jsx)(Se.MenuGroup,{label:(0,u._x)("Taxonomies","text","nelio-content"),children:a.map((({slug:t,labels:n})=>(0,r.jsx)(Se.MenuItem,{role:"menuitem",icon:ni(t),onClick:()=>e(ii(t)),children:(0,u.sprintf)(/* translators: taxonomy name */ /* translators: taxonomy name */
(0,u._x)("Add %s","command","nelio-content"),n.name)},t)))}),!!i.length&&(0,r.jsx)(Se.MenuGroup,{label:(0,u._x)("Custom fields","text","nelio-content"),children:i.map((({key:t,name:n})=>(0,r.jsx)(Se.MenuItem,{role:"menuitem",icon:"welcome-widgets-menus",onClick:()=>e(`{field:${t}}`),children:(0,u.sprintf)(/* translators: custom field name */ /* translators: custom field name */
(0,u._x)("Add %s","command","nelio-content"),n)},t)))}),!!o.length&&(0,r.jsx)(Se.MenuGroup,{label:(0,u._x)("Custom placeholders","text","nelio-content"),children:o.map((({key:t,name:n})=>(0,r.jsx)(Se.MenuItem,{role:"menuitem",icon:"plus-alt",onClick:()=>e(`{custom:${t}}`),children:(0,u.sprintf)(/* translators: custom placeholder name */ /* translators: custom placeholder name */
(0,u._x)("Add %s","command","nelio-content"),n)},t)))})]}))})},Xn=()=>{const e=Qn();return m((t=>{const n=e?[e]:(0,h.map)(t(de.store).getPostTypes("social"),"name"),{getEntityRecord:i}=t(ue.store),o=n.map((e=>i("root","postType",e))).filter(ti).filter(g.isDefined);return{author:o.some((e=>{var t;return!!(null===(t=e.supports)||void 0===t?void 0:t.author)})),excerpt:o.some((e=>{var t;return!!(null===(t=e.supports)||void 0===t?void 0:t.excerpt)})),title:o.some((e=>{var t;return!!(null===(t=e.supports)||void 0===t?void 0:t.title)}))}}))},Qn=()=>m((e=>{var t;return null===(t=e(we).getEditingTemplate())||void 0===t?void 0:t.postType})),ei=()=>m((e=>{var t,n;e(ue.store),e(de.store);const{getEditingTemplate:i}=e(we),o=i();if(!o)return[];const{getPostTypes:a}=e(de.store),s=o.postType?[o.postType]:null!==(t=(0,h.map)(a("social"),"name"))&&void 0!==t?t:[],{getEntityRecords:r}=e(ue.store);return(null!==(n=r("root","taxonomy",{per_page:-1}))&&void 0!==n?n:[]).filter((e=>!!e)).filter((e=>e.visibility.public&&s.some((t=>e.types.includes(t)))))})),ti=e=>!!e,ni=e=>{switch(e){case"category":case"product_cat":return"category";case"post_tag":case"product_tag":return"tag";default:return"archive"}},ii=e=>{switch(e){case"category":case"product_cat":return"{categories}";case"post_tag":case"product_tag":return"{tags}";default:return`{taxonomy:${e}}`}},oi=({data:{label:e,image:t},isFocused:n,isSelected:i,innerRef:o,innerProps:a})=>(0,r.jsxs)("div",Object.assign({ref:o,className:at({"nelio-content-target-option-in-profile-selector":!0,"nelio-content-target-option-in-profile-selector--is-focused":n,"nelio-content-target-option-in-profile-selector--is-selected":i})},a,{children:[(0,r.jsx)("div",{className:"nelio-content-target-option-in-profile-selector__icon-wrapper",children:(0,r.jsx)("div",{className:"nelio-content-target-option-in-profile-selector__icon",style:{backgroundImage:`url(${t||""})`}})}),(0,r.jsx)("div",{className:"nelio-content-target-option-in-profile-selector__label",children:e})]})),ai=({network:e,profileId:t,targetName:n,onTargetChange:i})=>{const{targets:o,isLoadingTargets:a}=si(t,e);if(!t||!o)return null;const s=(0,h.map)(o,(e=>({value:e.name,label:e.displayName,image:e.image}))),l=n?(0,h.find)(s,{value:n}):void 0;return(0,r.jsx)("div",{className:"nelio-content-social-profile-selector__targets",children:(0,r.jsx)(d.StylizedSelectControl,{disabled:a,placeholder:a?(0,u._x)("Loading…","text","nelio-content"):(0,Ie.getTargetLabel)("selectTarget",e),options:s,value:l,onChange:e=>i(null==e?void 0:e.value),components:{Option:oi}})})},si=(e,t)=>m((n=>{if(n(de.store),!e||!(0,Ie.doesNetworkSupport)("multi-target",t))return{};const{getTargetsInProfile:i}=n(de.store),o=i(e);return{isLoadingTargets:void 0===o,targets:o||[]}})),ri=({className:e=""})=>{const t=di(),[n,i]=mi(),[o,a]=(0,l.useState)("availability"),[s,c]=hi(),{isNewTemplate:m,templateType:g}=fi(),f=pi(null==s?void 0:s.groupId),v=Ze(null==s?void 0:s.postType),[y,_]=gi(),{closeTemplateEditor:x,receiveAutomationGroupTemplates:b}=(0,p.useDispatch)(we),j=vi();yi();const k=Re(null==s?void 0:s.postType);if((0,l.useEffect)((()=>{f.length>1?a("postType"):k.length?a("taxonomy"):a(v?"author":"availability")}),[f.length,null==s?void 0:s.postType]),!t||!s||!k)return null;const T=()=>{x(),i(!1)},{text:w,network:O}=s,S=e=>c({text:e});return(0,r.jsxs)(Se.Modal,{className:`nelio-content-social-template-editor-dialog ${e}`,title:y?bi(m):ji(m),isDismissible:!1,shouldCloseOnEsc:!1,shouldCloseOnClickOutside:!1,onRequestClose:()=>{},children:[(0,r.jsx)(ai,{network:s.network,profileId:s.profileId,targetName:s.targetName,onTargetChange:e=>c({targetName:e})}),(0,r.jsx)(Se.TextareaControl,{className:"nelio-content-social-template-editor-dialog__text",value:w,onChange:S,placeholder:(0,u._x)("Write a template…","user","nelio-content")}),(0,r.jsxs)("div",{className:"nelio-content-social-template-editor-dialog__quick-actions",children:[n?(0,r.jsx)(ui,{className:"nelio-content-social-template-editor-dialog__tab-selector",tab:o,availableTabs:[f.length>1&&"postType",!!k.length&&"taxonomy",v&&"author","availability","attachment"],setTab:a}):(0,r.jsx)(Se.Button,{variant:"link",onClick:()=>i(!0),children:(0,u._x)("Additional options","command","nelio-content")}),(0,r.jsx)("div",{className:"nelio-content-social-template-editor-dialog__quick-action-spacer"}),m&&(0,Ie.doesNetworkSupport)("network-template",O)&&!(0,Ie.doesNetworkSupport)("multi-target",O)&&(0,r.jsx)(Se.Button,{className:at({"nelio-content-social-template-editor-dialog__quick-action":!0,"nelio-content-social-template-editor-dialog__quick-action--is-preview":!0,"nelio-content-social-template-editor-dialog__quick-action--is-toggled":y}),icon:(0,Ie.getNetworkIcon)(O),label:(0,u.sprintf)(/* translators: network name */ /* translators: network name */
(0,u._x)("Network template (available to all %s profiles)","text","nelio-content"),(0,Ie.getNetworkLabel)("name",O)),onClick:()=>_(!y)}),(0,r.jsx)(Yn,{onClick:e=>(e=>S(/[^\s]$/.test(w)?`${w} ${e}`:`${w}${e}`))(e)})]}),n&&(0,r.jsx)(li,{type:o}),(0,r.jsxs)("div",{className:"nelio-content-social-template-editor-dialog__buttons",children:[(0,r.jsx)(d.ContextualHelp,{context:"social-template-editor",walkthrough:Kn,autostart:!0}),(0,r.jsxs)("div",{className:"nelio-content-social-template-editor-dialog__default-buttons-wrapper",children:[(0,r.jsx)(Se.Button,{className:"nelio-content-social-template-editor-dialog__cancel-button",variant:"secondary",onClick:T,children:(0,u._x)("Cancel","command","nelio-content")}),(0,r.jsx)(d.SaveButton,{className:"nelio-content-social-template-editor-dialog__save-button",variant:"primary",isUpdate:!m,error:j,onClick:()=>{T(),b(g,Object.assign(Object.assign({},s),{taxonomies:(0,h.pick)(s.taxonomies,(0,h.map)(k,"slug")),profileId:y?void 0:s.profileId,targetName:y?void 0:s.targetName}))}})]})]})]})},li=({type:e})=>{const[t,n]=hi(),i=(0,de.usePostTypes)("social"),o=Re(null==t?void 0:t.postType),a=Pe(null==t?void 0:t.postType),s=m((e=>e(we).getEditingTemplateErrors())),l=_i(null==t?void 0:t.attachment);if(!t||!s)return null;const{author:c}=t;if(!a)return(0,r.jsx)("div",{className:"nelio-content-social-template-editor-dialog__extra",children:(0,r.jsx)(Se.Spinner,{})});switch(e){case"postType":return(0,r.jsx)("div",{className:"nelio-content-social-template-editor-dialog__extra",children:(0,r.jsx)(Se.SelectControl,{value:(null==t?void 0:t.postType)||"__nc-all",options:[{value:"__nc-all",label:(0,u._x)("All Content","text","nelio-content")},...i.map((e=>({value:e.name,label:e.labels.plural||e.labels.singular||e.name})))],onChange:e=>n("__nc-all"===e?{postType:void 0}:{postType:e})})});case"taxonomy":return(0,r.jsx)("div",{className:"nelio-content-social-template-editor-dialog__extra",children:o.map((e=>(0,r.jsx)(d.ItemSelectControl,{error:s.taxonomies[e.slug],isSingle:!0,kind:"taxonomy",label:e.labels.singular_name,name:e.slug,value:t.taxonomies[e.slug],onChange:i=>n({taxonomies:xi(Object.assign(Object.assign({},t.taxonomies),{[e.slug]:i||void 0}))})},e.slug)))});case"author":return(0,r.jsx)("div",{className:"nelio-content-social-template-editor-dialog__extra",children:(0,r.jsx)(d.ItemSelectControl,{isSingle:!0,error:s.author,kind:"author",label:(0,u._x)("Author","text","nelio-content"),value:c,onChange:e=>n({author:e})})});case"availability":return(0,r.jsx)("div",{className:"nelio-content-social-template-editor-dialog__extra",children:(0,r.jsx)(qn,{})});case"attachment":return(0,r.jsx)("div",{className:"nelio-content-social-template-editor-dialog__extra",children:(0,r.jsx)(Se.SelectControl,{options:[{label:(0,u._x)("Auto Image","text","nelio-content"),value:"auto-image"},{label:(0,u._x)("Text","text","nelio-content"),value:"none"},{label:(0,u._x)("Image","text","nelio-content"),value:"image"},"video"===(null==t?void 0:t.attachment)?{label:(0,u._x)("Video","text","nelio-content"),value:"video"}:void 0].filter(g.isDefined),value:(null==t?void 0:t.attachment)||"auto-image",onChange:e=>n({attachment:"auto-image"===e?void 0:e}),help:l})})}},ci={postType:{icon:"admin-post",title:(0,u._x)("Post Type","text","nelio-content")},taxonomy:{icon:"archive",title:(0,u._x)("Taxonomies","text","nelio-content")},author:{icon:"admin-users",title:(0,u._x)("Author","text","nelio-content")},availability:{icon:"calendar-alt",title:(0,u._x)("Availability","text","nelio-content")},attachment:{icon:"format-gallery",title:(0,u._x)("Media Requirements","text","nelio-content")}},ui=({className:e,availableTabs:t,tab:n,setTab:i})=>(0,r.jsx)(Se.Toolbar,{className:e,label:(0,u._x)("Settings","text","nelio-content"),children:t.filter((e=>!!e)).map((e=>(0,r.jsx)(Se.ToolbarButton,{className:`nelio-content-social-template-editor__${e}-action`,icon:ci[e].icon,title:ci[e].title,isActive:n===e,onClick:()=>i(e)},e)))}),di=()=>m((e=>e(we).isEditingTemplate())),pi=e=>{const t=Ae(e);return(0,de.usePostTypes)("social").filter((e=>(0,g.isUniversalGroup)(t)||e.name===(null==t?void 0:t.postType)))},mi=()=>{const e=di(),[t]=hi(),[n,i]=(0,l.useState)(!1);return(0,l.useEffect)((()=>{i(!(!e||!(null==t?void 0:t.author)&&!(0,h.keys)(null==t?void 0:t.taxonomies).length&&!(null==t?void 0:t.availability)))}),[e]),[n,i]},hi=()=>{const e=m((e=>e(we).getEditingTemplate())),{setEditingTemplateAttributes:t}=(0,p.useDispatch)(we);return[e,t]},gi=()=>{const e=m((e=>e(we).isEditingNetworkTemplate())),{markAsNetworkTemplate:t}=(0,p.useDispatch)(we);return[e,t]},fi=()=>({isNewTemplate:m((e=>e(we).isEditingNewTemplate())),templateType:m((e=>e(we).getEditingTemplateType()))}),vi=()=>{const e=m((e=>e(we).getEditingTemplateErrors()));return e.target||e.content||(e.author?e.author:(0,h.values)(e.taxonomies).some(Boolean)?(0,u._x)("Please review selected terms","user","nelio-content"):e.availability?(0,u._x)("Please review availability settings","user","nelio-content"):"")},yi=()=>{const e=di(),[t]=hi(),{setEditingTemplateErrors:n}=(0,p.useDispatch)(we),i=Ae(null==t?void 0:t.groupId),o=Ge(i,t?[t]:[]);(0,l.useEffect)((()=>{if(!e||!(null==t?void 0:t.id))return;const i=o[t.id];i&&n(i)}),[e,JSON.stringify(o)])},_i=e=>{switch(e){case void 0:return(0,u._x)("Nelio Content may sometimes generate messages that share an image from related content","text","nelio-content");case"none":return(0,u._x)("Nelio Content won’t attach any images to messages generated using this template","text","nelio-content");case"image":return(0,u._x)("Nelio Content will only use this template if it can extract an image from shared content","text","nelio-content");case"video":return""}},xi=e=>(0,h.keys)(e).reduce(((t,n)=>e[n]?Object.assign(Object.assign({},t),{[n]:e[n]}):t),{}),bi=e=>e?(0,u._x)("New Network Template","text","nelio-content"):(0,u._x)("Edit Network Template","text","nelio-content"),ji=e=>e?(0,u._x)("New Template","text","nelio-content"):(0,u._x)("Edit Template","text","nelio-content");var ki,Ti;!function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(_x){throw new Error},e.arrayToEnum=e=>{const t={};for(const n of e)t[n]=n;return t},e.getValidEnumValues=t=>{const n=e.objectKeys(t).filter((e=>"number"!=typeof t[t[e]])),i={};for(const e of n)i[e]=t[e];return e.objectValues(i)},e.objectValues=t=>e.objectKeys(t).map((function(e){return t[e]})),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},e.find=(e,t)=>{for(const n of e)if(t(n))return n},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map((e=>"string"==typeof e?`'${e}'`:e)).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(ki||(ki={})),function(e){e.mergeShapes=(e,t)=>({...e,...t})}(Ti||(Ti={}));const wi=ki.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Oi=e=>{switch(typeof e){case"undefined":return wi.undefined;case"string":return wi.string;case"number":return isNaN(e)?wi.nan:wi.number;case"boolean":return wi.boolean;case"function":return wi.function;case"bigint":return wi.bigint;case"symbol":return wi.symbol;case"object":return Array.isArray(e)?wi.array:null===e?wi.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?wi.promise:"undefined"!=typeof Map&&e instanceof Map?wi.map:"undefined"!=typeof Set&&e instanceof Set?wi.set:"undefined"!=typeof Date&&e instanceof Date?wi.date:wi.object;default:return wi.unknown}},Si=ki.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Ei extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(e){return e.message},n={_errors:[]},i=e=>{for(const o of e.issues)if("invalid_union"===o.code)o.unionErrors.map(i);else if("invalid_return_type"===o.code)i(o.returnTypeError);else if("invalid_arguments"===o.code)i(o.argumentsError);else if(0===o.path.length)n._errors.push(t(o));else{let e=n,i=0;for(;i<o.path.length;){const n=o.path[i];i===o.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(t(o))):e[n]=e[n]||{_errors:[]},e=e[n],i++}}};return i(this),n}static assert(e){if(!(e instanceof Ei))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ki.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){const t={},n=[];for(const i of this.issues)i.path.length>0?(t[i.path[0]]=t[i.path[0]]||[],t[i.path[0]].push(e(i))):n.push(e(i));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}Ei.create=e=>new Ei(e);const Ii=(e,t)=>{let n;switch(e.code){case Si.invalid_type:n=e.received===wi.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case Si.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,ki.jsonStringifyReplacer)}`;break;case Si.unrecognized_keys:n=`Unrecognized key(s) in object: ${ki.joinValues(e.keys,", ")}`;break;case Si.invalid_union:n="Invalid input";break;case Si.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${ki.joinValues(e.options)}`;break;case Si.invalid_enum_value:n=`Invalid enum value. Expected ${ki.joinValues(e.options)}, received '${e.received}'`;break;case Si.invalid_arguments:n="Invalid function arguments";break;case Si.invalid_return_type:n="Invalid function return type";break;case Si.invalid_date:n="Invalid date";break;case Si.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:ki.assertNever(e.validation):n="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case Si.too_small:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case Si.too_big:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case Si.custom:n="Invalid input";break;case Si.invalid_intersection_types:n="Intersection results could not be merged";break;case Si.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Si.not_finite:n="Number must be finite";break;default:n=t.defaultError,ki.assertNever(e)}return{message:n}};let Ni=Ii;function Ai(){return Ni}const Ci=e=>{const{data:t,path:n,errorMaps:i,issueData:o}=e,a=[...n,...o.path||[]],s={...o,path:a};if(void 0!==o.message)return{...o,path:a,message:o.message};let r="";const l=i.filter((e=>!!e)).slice().reverse();for(const e of l)r=e(s,{data:t,defaultError:r}).message;return{...o,path:a,message:r}};function Pi(e,t){const n=Ai(),i=Ci({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===Ii?void 0:Ii].filter((e=>!!e))});e.common.issues.push(i)}class Ri{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const i of t){if("aborted"===i.status)return Zi;"dirty"===i.status&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const e of t){const t=await e.key,i=await e.value;n.push({key:t,value:i})}return Ri.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const i of t){const{key:t,value:o}=i;if("aborted"===t.status)return Zi;if("aborted"===o.status)return Zi;"dirty"===t.status&&e.dirty(),"dirty"===o.status&&e.dirty(),"__proto__"===t.value||void 0===o.value&&!i.alwaysSet||(n[t.value]=o.value)}return{status:e.value,value:n}}}const Zi=Object.freeze({status:"aborted"}),Gi=e=>({status:"dirty",value:e}),Mi=e=>({status:"valid",value:e}),Di=e=>"aborted"===e.status,$i=e=>"dirty"===e.status,Fi=e=>"valid"===e.status,Ui=e=>"undefined"!=typeof Promise&&e instanceof Promise;function Li(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)}function Vi(e,t,n,i,o){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?o.call(e,n):o?o.value=n:t.set(e,n),n}var qi,Bi,zi;"function"==typeof SuppressedError&&SuppressedError,function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:null==e?void 0:e.message}(qi||(qi={}));class Wi{constructor(e,t,n,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Ki=(e,t)=>{if(Fi(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Ei(e.common.issues);return this._error=t,this._error}}};function Ji(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:i,description:o}=e;if(t&&(n||i))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:o}:{errorMap:(t,o)=>{var a,s;const{message:r}=e;return"invalid_enum_value"===t.code?{message:null!=r?r:o.defaultError}:void 0===o.data?{message:null!==(a=null!=r?r:i)&&void 0!==a?a:o.defaultError}:"invalid_type"!==t.code?{message:o.defaultError}:{message:null!==(s=null!=r?r:n)&&void 0!==s?s:o.defaultError}},description:o}}class Hi{get description(){return this._def.description}_getType(e){return Oi(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Oi(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ri,ctx:{common:e.parent.common,data:e.data,parsedType:Oi(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Ui(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const i={common:{issues:[],async:null!==(n=null==t?void 0:t.async)&&void 0!==n&&n,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Oi(e)},o=this._parseSync({data:e,path:i.path,parent:i});return Ki(i,o)}"~validate"(e){var t,n;const i={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Oi(e)};if(!this["~standard"].async)try{const t=this._parseSync({data:e,path:[],parent:i});return Fi(t)?{value:t.value}:{issues:i.common.issues}}catch(e){(null===(n=null===(t=null==e?void 0:e.message)||void 0===t?void 0:t.toLowerCase())||void 0===n?void 0:n.includes("encountered"))&&(this["~standard"].async=!0),i.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:i}).then((e=>Fi(e)?{value:e.value}:{issues:i.common.issues}))}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Oi(e)},i=this._parse({data:e,path:n.path,parent:n}),o=await(Ui(i)?i:Promise.resolve(i));return Ki(n,o)}refine(e,t){const n=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement(((t,i)=>{const o=e(t),a=()=>i.addIssue({code:Si.custom,...n(t)});return"undefined"!=typeof Promise&&o instanceof Promise?o.then((e=>!!e||(a(),!1))):!!o||(a(),!1)}))}refinement(e,t){return this._refinement(((n,i)=>!!e(n)||(i.addIssue("function"==typeof t?t(n,i):t),!1)))}_refinement(e){return new Yo({schema:this,typeName:ua.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return Xo.create(this,this._def)}nullable(){return Qo.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Co.create(this)}promise(){return Ho.create(this,this._def)}or(e){return Zo.create([this,e],this._def)}and(e){return $o.create(this,e,this._def)}transform(e){return new Yo({...Ji(this._def),schema:this,typeName:ua.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new ea({...Ji(this._def),innerType:this,defaultValue:t,typeName:ua.ZodDefault})}brand(){return new oa({typeName:ua.ZodBranded,type:this,...Ji(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new ta({...Ji(this._def),innerType:this,catchValue:t,typeName:ua.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return aa.create(this,e)}readonly(){return sa.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Yi=/^c[^\s-]{8,}$/i,Xi=/^[0-9a-z]+$/,Qi=/^[0-9A-HJKMNP-TV-Z]{26}$/i,eo=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,to=/^[a-z0-9_-]{21}$/i,no=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,io=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,oo=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let ao;const so=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ro=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,lo=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,co=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,uo=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,po=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,mo="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",ho=new RegExp(`^${mo}$`);function go(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`),t}function fo(e){let t=`${mo}T${go(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function vo(e,t){if(!no.test(e))return!1;try{const[n]=e.split("."),i=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),o=JSON.parse(atob(i));return!("object"!=typeof o||null===o||!o.typ||!o.alg||t&&o.alg!==t)}catch(e){return!1}}function yo(e,t){return!("v4"!==t&&t||!ro.test(e))||!("v6"!==t&&t||!co.test(e))}class _o extends Hi{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==wi.string){const t=this._getOrReturnCtx(e);return Pi(t,{code:Si.invalid_type,expected:wi.string,received:t.parsedType}),Zi}const t=new Ri;let n;for(const a of this._def.checks)if("min"===a.kind)e.data.length<a.value&&(n=this._getOrReturnCtx(e,n),Pi(n,{code:Si.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),t.dirty());else if("max"===a.kind)e.data.length>a.value&&(n=this._getOrReturnCtx(e,n),Pi(n,{code:Si.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),t.dirty());else if("length"===a.kind){const i=e.data.length>a.value,o=e.data.length<a.value;(i||o)&&(n=this._getOrReturnCtx(e,n),i?Pi(n,{code:Si.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):o&&Pi(n,{code:Si.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),t.dirty())}else if("email"===a.kind)oo.test(e.data)||(n=this._getOrReturnCtx(e,n),Pi(n,{validation:"email",code:Si.invalid_string,message:a.message}),t.dirty());else if("emoji"===a.kind)ao||(ao=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),ao.test(e.data)||(n=this._getOrReturnCtx(e,n),Pi(n,{validation:"emoji",code:Si.invalid_string,message:a.message}),t.dirty());else if("uuid"===a.kind)eo.test(e.data)||(n=this._getOrReturnCtx(e,n),Pi(n,{validation:"uuid",code:Si.invalid_string,message:a.message}),t.dirty());else if("nanoid"===a.kind)to.test(e.data)||(n=this._getOrReturnCtx(e,n),Pi(n,{validation:"nanoid",code:Si.invalid_string,message:a.message}),t.dirty());else if("cuid"===a.kind)Yi.test(e.data)||(n=this._getOrReturnCtx(e,n),Pi(n,{validation:"cuid",code:Si.invalid_string,message:a.message}),t.dirty());else if("cuid2"===a.kind)Xi.test(e.data)||(n=this._getOrReturnCtx(e,n),Pi(n,{validation:"cuid2",code:Si.invalid_string,message:a.message}),t.dirty());else if("ulid"===a.kind)Qi.test(e.data)||(n=this._getOrReturnCtx(e,n),Pi(n,{validation:"ulid",code:Si.invalid_string,message:a.message}),t.dirty());else if("url"===a.kind)try{new URL(e.data)}catch(i){n=this._getOrReturnCtx(e,n),Pi(n,{validation:"url",code:Si.invalid_string,message:a.message}),t.dirty()}else"regex"===a.kind?(a.regex.lastIndex=0,a.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),Pi(n,{validation:"regex",code:Si.invalid_string,message:a.message}),t.dirty())):"trim"===a.kind?e.data=e.data.trim():"includes"===a.kind?e.data.includes(a.value,a.position)||(n=this._getOrReturnCtx(e,n),Pi(n,{code:Si.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),t.dirty()):"toLowerCase"===a.kind?e.data=e.data.toLowerCase():"toUpperCase"===a.kind?e.data=e.data.toUpperCase():"startsWith"===a.kind?e.data.startsWith(a.value)||(n=this._getOrReturnCtx(e,n),Pi(n,{code:Si.invalid_string,validation:{startsWith:a.value},message:a.message}),t.dirty()):"endsWith"===a.kind?e.data.endsWith(a.value)||(n=this._getOrReturnCtx(e,n),Pi(n,{code:Si.invalid_string,validation:{endsWith:a.value},message:a.message}),t.dirty()):"datetime"===a.kind?fo(a).test(e.data)||(n=this._getOrReturnCtx(e,n),Pi(n,{code:Si.invalid_string,validation:"datetime",message:a.message}),t.dirty()):"date"===a.kind?ho.test(e.data)||(n=this._getOrReturnCtx(e,n),Pi(n,{code:Si.invalid_string,validation:"date",message:a.message}),t.dirty()):"time"===a.kind?new RegExp(`^${go(a)}$`).test(e.data)||(n=this._getOrReturnCtx(e,n),Pi(n,{code:Si.invalid_string,validation:"time",message:a.message}),t.dirty()):"duration"===a.kind?io.test(e.data)||(n=this._getOrReturnCtx(e,n),Pi(n,{validation:"duration",code:Si.invalid_string,message:a.message}),t.dirty()):"ip"===a.kind?(i=e.data,("v4"!==(o=a.version)&&o||!so.test(i))&&("v6"!==o&&o||!lo.test(i))&&(n=this._getOrReturnCtx(e,n),Pi(n,{validation:"ip",code:Si.invalid_string,message:a.message}),t.dirty())):"jwt"===a.kind?vo(e.data,a.alg)||(n=this._getOrReturnCtx(e,n),Pi(n,{validation:"jwt",code:Si.invalid_string,message:a.message}),t.dirty()):"cidr"===a.kind?yo(e.data,a.version)||(n=this._getOrReturnCtx(e,n),Pi(n,{validation:"cidr",code:Si.invalid_string,message:a.message}),t.dirty()):"base64"===a.kind?uo.test(e.data)||(n=this._getOrReturnCtx(e,n),Pi(n,{validation:"base64",code:Si.invalid_string,message:a.message}),t.dirty()):"base64url"===a.kind?po.test(e.data)||(n=this._getOrReturnCtx(e,n),Pi(n,{validation:"base64url",code:Si.invalid_string,message:a.message}),t.dirty()):ki.assertNever(a);var i,o;return{status:t.value,value:e.data}}_regex(e,t,n){return this.refinement((t=>e.test(t)),{validation:t,code:Si.invalid_string,...qi.errToObj(n)})}_addCheck(e){return new _o({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...qi.errToObj(e)})}url(e){return this._addCheck({kind:"url",...qi.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...qi.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...qi.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...qi.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...qi.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...qi.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...qi.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...qi.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...qi.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...qi.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...qi.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...qi.errToObj(e)})}datetime(e){var t,n;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,local:null!==(n=null==e?void 0:e.local)&&void 0!==n&&n,...qi.errToObj(null==e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,...qi.errToObj(null==e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...qi.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...qi.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...qi.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...qi.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...qi.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...qi.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...qi.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...qi.errToObj(t)})}nonempty(e){return this.min(1,qi.errToObj(e))}trim(){return new _o({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new _o({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new _o({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isDate(){return!!this._def.checks.find((e=>"date"===e.kind))}get isTime(){return!!this._def.checks.find((e=>"time"===e.kind))}get isDuration(){return!!this._def.checks.find((e=>"duration"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isNANOID(){return!!this._def.checks.find((e=>"nanoid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get isCIDR(){return!!this._def.checks.find((e=>"cidr"===e.kind))}get isBase64(){return!!this._def.checks.find((e=>"base64"===e.kind))}get isBase64url(){return!!this._def.checks.find((e=>"base64url"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function xo(e,t){const n=(e.toString().split(".")[1]||"").length,i=(t.toString().split(".")[1]||"").length,o=n>i?n:i;return parseInt(e.toFixed(o).replace(".",""))%parseInt(t.toFixed(o).replace(".",""))/Math.pow(10,o)}_o.create=e=>{var t;return new _o({checks:[],typeName:ua.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...Ji(e)})};class bo extends Hi{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==wi.number){const t=this._getOrReturnCtx(e);return Pi(t,{code:Si.invalid_type,expected:wi.number,received:t.parsedType}),Zi}let t;const n=new Ri;for(const i of this._def.checks)"int"===i.kind?ki.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),Pi(t,{code:Si.invalid_type,expected:"integer",received:"float",message:i.message}),n.dirty()):"min"===i.kind?(i.inclusive?e.data<i.value:e.data<=i.value)&&(t=this._getOrReturnCtx(e,t),Pi(t,{code:Si.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):"max"===i.kind?(i.inclusive?e.data>i.value:e.data>=i.value)&&(t=this._getOrReturnCtx(e,t),Pi(t,{code:Si.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):"multipleOf"===i.kind?0!==xo(e.data,i.value)&&(t=this._getOrReturnCtx(e,t),Pi(t,{code:Si.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):"finite"===i.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),Pi(t,{code:Si.not_finite,message:i.message}),n.dirty()):ki.assertNever(i);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,qi.toString(t))}gt(e,t){return this.setLimit("min",e,!1,qi.toString(t))}lte(e,t){return this.setLimit("max",e,!0,qi.toString(t))}lt(e,t){return this.setLimit("max",e,!1,qi.toString(t))}setLimit(e,t,n,i){return new bo({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:qi.toString(i)}]})}_addCheck(e){return new bo({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:qi.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:qi.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:qi.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:qi.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:qi.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:qi.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:qi.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:qi.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:qi.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&ki.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if("finite"===n.kind||"int"===n.kind||"multipleOf"===n.kind)return!0;"min"===n.kind?(null===t||n.value>t)&&(t=n.value):"max"===n.kind&&(null===e||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}bo.create=e=>new bo({checks:[],typeName:ua.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...Ji(e)});class jo extends Hi{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch(t){return this._getInvalidInput(e)}if(this._getType(e)!==wi.bigint)return this._getInvalidInput(e);let t;const n=new Ri;for(const i of this._def.checks)"min"===i.kind?(i.inclusive?e.data<i.value:e.data<=i.value)&&(t=this._getOrReturnCtx(e,t),Pi(t,{code:Si.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):"max"===i.kind?(i.inclusive?e.data>i.value:e.data>=i.value)&&(t=this._getOrReturnCtx(e,t),Pi(t,{code:Si.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):"multipleOf"===i.kind?e.data%i.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),Pi(t,{code:Si.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):ki.assertNever(i);return{status:n.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return Pi(t,{code:Si.invalid_type,expected:wi.bigint,received:t.parsedType}),Zi}gte(e,t){return this.setLimit("min",e,!0,qi.toString(t))}gt(e,t){return this.setLimit("min",e,!1,qi.toString(t))}lte(e,t){return this.setLimit("max",e,!0,qi.toString(t))}lt(e,t){return this.setLimit("max",e,!1,qi.toString(t))}setLimit(e,t,n,i){return new jo({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:qi.toString(i)}]})}_addCheck(e){return new jo({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:qi.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:qi.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:qi.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:qi.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:qi.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}jo.create=e=>{var t;return new jo({checks:[],typeName:ua.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...Ji(e)})};class ko extends Hi{_parse(e){if(this._def.coerce&&(e.data=Boolean(e.data)),this._getType(e)!==wi.boolean){const t=this._getOrReturnCtx(e);return Pi(t,{code:Si.invalid_type,expected:wi.boolean,received:t.parsedType}),Zi}return Mi(e.data)}}ko.create=e=>new ko({typeName:ua.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...Ji(e)});class To extends Hi{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==wi.date){const t=this._getOrReturnCtx(e);return Pi(t,{code:Si.invalid_type,expected:wi.date,received:t.parsedType}),Zi}if(isNaN(e.data.getTime()))return Pi(this._getOrReturnCtx(e),{code:Si.invalid_date}),Zi;const t=new Ri;let n;for(const i of this._def.checks)"min"===i.kind?e.data.getTime()<i.value&&(n=this._getOrReturnCtx(e,n),Pi(n,{code:Si.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),t.dirty()):"max"===i.kind?e.data.getTime()>i.value&&(n=this._getOrReturnCtx(e,n),Pi(n,{code:Si.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),t.dirty()):ki.assertNever(i);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new To({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:qi.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:qi.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}To.create=e=>new To({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:ua.ZodDate,...Ji(e)});class wo extends Hi{_parse(e){if(this._getType(e)!==wi.symbol){const t=this._getOrReturnCtx(e);return Pi(t,{code:Si.invalid_type,expected:wi.symbol,received:t.parsedType}),Zi}return Mi(e.data)}}wo.create=e=>new wo({typeName:ua.ZodSymbol,...Ji(e)});class Oo extends Hi{_parse(e){if(this._getType(e)!==wi.undefined){const t=this._getOrReturnCtx(e);return Pi(t,{code:Si.invalid_type,expected:wi.undefined,received:t.parsedType}),Zi}return Mi(e.data)}}Oo.create=e=>new Oo({typeName:ua.ZodUndefined,...Ji(e)});class So extends Hi{_parse(e){if(this._getType(e)!==wi.null){const t=this._getOrReturnCtx(e);return Pi(t,{code:Si.invalid_type,expected:wi.null,received:t.parsedType}),Zi}return Mi(e.data)}}So.create=e=>new So({typeName:ua.ZodNull,...Ji(e)});class Eo extends Hi{constructor(){super(...arguments),this._any=!0}_parse(e){return Mi(e.data)}}Eo.create=e=>new Eo({typeName:ua.ZodAny,...Ji(e)});class Io extends Hi{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Mi(e.data)}}Io.create=e=>new Io({typeName:ua.ZodUnknown,...Ji(e)});class No extends Hi{_parse(e){const t=this._getOrReturnCtx(e);return Pi(t,{code:Si.invalid_type,expected:wi.never,received:t.parsedType}),Zi}}No.create=e=>new No({typeName:ua.ZodNever,...Ji(e)});class Ao extends Hi{_parse(e){if(this._getType(e)!==wi.undefined){const t=this._getOrReturnCtx(e);return Pi(t,{code:Si.invalid_type,expected:wi.void,received:t.parsedType}),Zi}return Mi(e.data)}}Ao.create=e=>new Ao({typeName:ua.ZodVoid,...Ji(e)});class Co extends Hi{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),i=this._def;if(t.parsedType!==wi.array)return Pi(t,{code:Si.invalid_type,expected:wi.array,received:t.parsedType}),Zi;if(null!==i.exactLength){const e=t.data.length>i.exactLength.value,o=t.data.length<i.exactLength.value;(e||o)&&(Pi(t,{code:e?Si.too_big:Si.too_small,minimum:o?i.exactLength.value:void 0,maximum:e?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),n.dirty())}if(null!==i.minLength&&t.data.length<i.minLength.value&&(Pi(t,{code:Si.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),n.dirty()),null!==i.maxLength&&t.data.length>i.maxLength.value&&(Pi(t,{code:Si.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map(((e,n)=>i.type._parseAsync(new Wi(t,e,t.path,n))))).then((e=>Ri.mergeArray(n,e)));const o=[...t.data].map(((e,n)=>i.type._parseSync(new Wi(t,e,t.path,n))));return Ri.mergeArray(n,o)}get element(){return this._def.type}min(e,t){return new Co({...this._def,minLength:{value:e,message:qi.toString(t)}})}max(e,t){return new Co({...this._def,maxLength:{value:e,message:qi.toString(t)}})}length(e,t){return new Co({...this._def,exactLength:{value:e,message:qi.toString(t)}})}nonempty(e){return this.min(1,e)}}function Po(e){if(e instanceof Ro){const t={};for(const n in e.shape){const i=e.shape[n];t[n]=Xo.create(Po(i))}return new Ro({...e._def,shape:()=>t})}return e instanceof Co?new Co({...e._def,type:Po(e.element)}):e instanceof Xo?Xo.create(Po(e.unwrap())):e instanceof Qo?Qo.create(Po(e.unwrap())):e instanceof Fo?Fo.create(e.items.map((e=>Po(e)))):e}Co.create=(e,t)=>new Co({type:e,minLength:null,maxLength:null,exactLength:null,typeName:ua.ZodArray,...Ji(t)});class Ro extends Hi{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=ki.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==wi.object){const t=this._getOrReturnCtx(e);return Pi(t,{code:Si.invalid_type,expected:wi.object,received:t.parsedType}),Zi}const{status:t,ctx:n}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof No&&"strip"===this._def.unknownKeys))for(const e in n.data)o.includes(e)||a.push(e);const s=[];for(const e of o){const t=i[e],o=n.data[e];s.push({key:{status:"valid",value:e},value:t._parse(new Wi(n,o,n.path,e)),alwaysSet:e in n.data})}if(this._def.catchall instanceof No){const e=this._def.unknownKeys;if("passthrough"===e)for(const e of a)s.push({key:{status:"valid",value:e},value:{status:"valid",value:n.data[e]}});else if("strict"===e)a.length>0&&(Pi(n,{code:Si.unrecognized_keys,keys:a}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of a){const i=n.data[t];s.push({key:{status:"valid",value:t},value:e._parse(new Wi(n,i,n.path,t)),alwaysSet:t in n.data})}}return n.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of s){const n=await t.key,i=await t.value;e.push({key:n,value:i,alwaysSet:t.alwaysSet})}return e})).then((e=>Ri.mergeObjectSync(t,e))):Ri.mergeObjectSync(t,s)}get shape(){return this._def.shape()}strict(e){return qi.errToObj,new Ro({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,n)=>{var i,o,a,s;const r=null!==(a=null===(o=(i=this._def).errorMap)||void 0===o?void 0:o.call(i,t,n).message)&&void 0!==a?a:n.defaultError;return"unrecognized_keys"===t.code?{message:null!==(s=qi.errToObj(e).message)&&void 0!==s?s:r}:{message:r}}}:{}})}strip(){return new Ro({...this._def,unknownKeys:"strip"})}passthrough(){return new Ro({...this._def,unknownKeys:"passthrough"})}extend(e){return new Ro({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Ro({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:ua.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new Ro({...this._def,catchall:e})}pick(e){const t={};return ki.objectKeys(e).forEach((n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])})),new Ro({...this._def,shape:()=>t})}omit(e){const t={};return ki.objectKeys(this.shape).forEach((n=>{e[n]||(t[n]=this.shape[n])})),new Ro({...this._def,shape:()=>t})}deepPartial(){return Po(this)}partial(e){const t={};return ki.objectKeys(this.shape).forEach((n=>{const i=this.shape[n];e&&!e[n]?t[n]=i:t[n]=i.optional()})),new Ro({...this._def,shape:()=>t})}required(e){const t={};return ki.objectKeys(this.shape).forEach((n=>{if(e&&!e[n])t[n]=this.shape[n];else{let e=this.shape[n];for(;e instanceof Xo;)e=e._def.innerType;t[n]=e}})),new Ro({...this._def,shape:()=>t})}keyof(){return Wo(ki.objectKeys(this.shape))}}Ro.create=(e,t)=>new Ro({shape:()=>e,unknownKeys:"strip",catchall:No.create(),typeName:ua.ZodObject,...Ji(t)}),Ro.strictCreate=(e,t)=>new Ro({shape:()=>e,unknownKeys:"strict",catchall:No.create(),typeName:ua.ZodObject,...Ji(t)}),Ro.lazycreate=(e,t)=>new Ro({shape:e,unknownKeys:"strip",catchall:No.create(),typeName:ua.ZodObject,...Ji(t)});class Zo extends Hi{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;if(t.common.async)return Promise.all(n.map((async e=>{const n={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const n of e)if("dirty"===n.result.status)return t.common.issues.push(...n.ctx.common.issues),n.result;const n=e.map((e=>new Ei(e.ctx.common.issues)));return Pi(t,{code:Si.invalid_union,unionErrors:n}),Zi}));{let e;const i=[];for(const o of n){const n={...t,common:{...t.common,issues:[]},parent:null},a=o._parseSync({data:t.data,path:t.path,parent:n});if("valid"===a.status)return a;"dirty"!==a.status||e||(e={result:a,ctx:n}),n.common.issues.length&&i.push(n.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const o=i.map((e=>new Ei(e)));return Pi(t,{code:Si.invalid_union,unionErrors:o}),Zi}}get options(){return this._def.options}}Zo.create=(e,t)=>new Zo({options:e,typeName:ua.ZodUnion,...Ji(t)});const Go=e=>e instanceof Bo?Go(e.schema):e instanceof Yo?Go(e.innerType()):e instanceof zo?[e.value]:e instanceof Ko?e.options:e instanceof Jo?ki.objectValues(e.enum):e instanceof ea?Go(e._def.innerType):e instanceof Oo?[void 0]:e instanceof So?[null]:e instanceof Xo?[void 0,...Go(e.unwrap())]:e instanceof Qo?[null,...Go(e.unwrap())]:e instanceof oa||e instanceof sa?Go(e.unwrap()):e instanceof ta?Go(e._def.innerType):[];class Mo extends Hi{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==wi.object)return Pi(t,{code:Si.invalid_type,expected:wi.object,received:t.parsedType}),Zi;const n=this.discriminator,i=t.data[n],o=this.optionsMap.get(i);return o?t.common.async?o._parseAsync({data:t.data,path:t.path,parent:t}):o._parseSync({data:t.data,path:t.path,parent:t}):(Pi(t,{code:Si.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Zi)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const i=new Map;for(const n of t){const t=Go(n.shape[e]);if(!t.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of t){if(i.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);i.set(o,n)}}return new Mo({typeName:ua.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i,...Ji(n)})}}function Do(e,t){const n=Oi(e),i=Oi(t);if(e===t)return{valid:!0,data:e};if(n===wi.object&&i===wi.object){const n=ki.objectKeys(t),i=ki.objectKeys(e).filter((e=>-1!==n.indexOf(e))),o={...e,...t};for(const n of i){const i=Do(e[n],t[n]);if(!i.valid)return{valid:!1};o[n]=i.data}return{valid:!0,data:o}}if(n===wi.array&&i===wi.array){if(e.length!==t.length)return{valid:!1};const n=[];for(let i=0;i<e.length;i++){const o=Do(e[i],t[i]);if(!o.valid)return{valid:!1};n.push(o.data)}return{valid:!0,data:n}}return n===wi.date&&i===wi.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class $o extends Hi{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),i=(e,i)=>{if(Di(e)||Di(i))return Zi;const o=Do(e.value,i.value);return o.valid?(($i(e)||$i(i))&&t.dirty(),{status:t.value,value:o.data}):(Pi(n,{code:Si.invalid_intersection_types}),Zi)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then((([e,t])=>i(e,t))):i(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}$o.create=(e,t,n)=>new $o({left:e,right:t,typeName:ua.ZodIntersection,...Ji(n)});class Fo extends Hi{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==wi.array)return Pi(n,{code:Si.invalid_type,expected:wi.array,received:n.parsedType}),Zi;if(n.data.length<this._def.items.length)return Pi(n,{code:Si.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Zi;!this._def.rest&&n.data.length>this._def.items.length&&(Pi(n,{code:Si.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const i=[...n.data].map(((e,t)=>{const i=this._def.items[t]||this._def.rest;return i?i._parse(new Wi(n,e,n.path,t)):null})).filter((e=>!!e));return n.common.async?Promise.all(i).then((e=>Ri.mergeArray(t,e))):Ri.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new Fo({...this._def,rest:e})}}Fo.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Fo({items:e,typeName:ua.ZodTuple,rest:null,...Ji(t)})};class Uo extends Hi{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==wi.object)return Pi(n,{code:Si.invalid_type,expected:wi.object,received:n.parsedType}),Zi;const i=[],o=this._def.keyType,a=this._def.valueType;for(const e in n.data)i.push({key:o._parse(new Wi(n,e,n.path,e)),value:a._parse(new Wi(n,n.data[e],n.path,e)),alwaysSet:e in n.data});return n.common.async?Ri.mergeObjectAsync(t,i):Ri.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,n){return new Uo(t instanceof Hi?{keyType:e,valueType:t,typeName:ua.ZodRecord,...Ji(n)}:{keyType:_o.create(),valueType:e,typeName:ua.ZodRecord,...Ji(t)})}}class Lo extends Hi{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==wi.map)return Pi(n,{code:Si.invalid_type,expected:wi.map,received:n.parsedType}),Zi;const i=this._def.keyType,o=this._def.valueType,a=[...n.data.entries()].map((([e,t],a)=>({key:i._parse(new Wi(n,e,n.path,[a,"key"])),value:o._parse(new Wi(n,t,n.path,[a,"value"]))})));if(n.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const n of a){const i=await n.key,o=await n.value;if("aborted"===i.status||"aborted"===o.status)return Zi;"dirty"!==i.status&&"dirty"!==o.status||t.dirty(),e.set(i.value,o.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const n of a){const i=n.key,o=n.value;if("aborted"===i.status||"aborted"===o.status)return Zi;"dirty"!==i.status&&"dirty"!==o.status||t.dirty(),e.set(i.value,o.value)}return{status:t.value,value:e}}}}Lo.create=(e,t,n)=>new Lo({valueType:t,keyType:e,typeName:ua.ZodMap,...Ji(n)});class Vo extends Hi{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==wi.set)return Pi(n,{code:Si.invalid_type,expected:wi.set,received:n.parsedType}),Zi;const i=this._def;null!==i.minSize&&n.data.size<i.minSize.value&&(Pi(n,{code:Si.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),null!==i.maxSize&&n.data.size>i.maxSize.value&&(Pi(n,{code:Si.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());const o=this._def.valueType;function a(e){const n=new Set;for(const i of e){if("aborted"===i.status)return Zi;"dirty"===i.status&&t.dirty(),n.add(i.value)}return{status:t.value,value:n}}const s=[...n.data.values()].map(((e,t)=>o._parse(new Wi(n,e,n.path,t))));return n.common.async?Promise.all(s).then((e=>a(e))):a(s)}min(e,t){return new Vo({...this._def,minSize:{value:e,message:qi.toString(t)}})}max(e,t){return new Vo({...this._def,maxSize:{value:e,message:qi.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Vo.create=(e,t)=>new Vo({valueType:e,minSize:null,maxSize:null,typeName:ua.ZodSet,...Ji(t)});class qo extends Hi{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==wi.function)return Pi(t,{code:Si.invalid_type,expected:wi.function,received:t.parsedType}),Zi;function n(e,n){return Ci({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Ai(),Ii].filter((e=>!!e)),issueData:{code:Si.invalid_arguments,argumentsError:n}})}function i(e,n){return Ci({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Ai(),Ii].filter((e=>!!e)),issueData:{code:Si.invalid_return_type,returnTypeError:n}})}const o={errorMap:t.common.contextualErrorMap},a=t.data;if(this._def.returns instanceof Ho){const e=this;return Mi((async function(...t){const s=new Ei([]),r=await e._def.args.parseAsync(t,o).catch((e=>{throw s.addIssue(n(t,e)),s})),l=await Reflect.apply(a,this,r);return await e._def.returns._def.type.parseAsync(l,o).catch((e=>{throw s.addIssue(i(l,e)),s}))}))}{const e=this;return Mi((function(...t){const s=e._def.args.safeParse(t,o);if(!s.success)throw new Ei([n(t,s.error)]);const r=Reflect.apply(a,this,s.data),l=e._def.returns.safeParse(r,o);if(!l.success)throw new Ei([i(r,l.error)]);return l.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new qo({...this._def,args:Fo.create(e).rest(Io.create())})}returns(e){return new qo({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new qo({args:e||Fo.create([]).rest(Io.create()),returns:t||Io.create(),typeName:ua.ZodFunction,...Ji(n)})}}class Bo extends Hi{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Bo.create=(e,t)=>new Bo({getter:e,typeName:ua.ZodLazy,...Ji(t)});class zo extends Hi{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return Pi(t,{received:t.data,code:Si.invalid_literal,expected:this._def.value}),Zi}return{status:"valid",value:e.data}}get value(){return this._def.value}}function Wo(e,t){return new Ko({values:e,typeName:ua.ZodEnum,...Ji(t)})}zo.create=(e,t)=>new zo({value:e,typeName:ua.ZodLiteral,...Ji(t)});class Ko extends Hi{constructor(){super(...arguments),Bi.set(this,void 0)}_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),n=this._def.values;return Pi(t,{expected:ki.joinValues(n),received:t.parsedType,code:Si.invalid_type}),Zi}if(Li(this,Bi,"f")||Vi(this,Bi,new Set(this._def.values),"f"),!Li(this,Bi,"f").has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return Pi(t,{received:t.data,code:Si.invalid_enum_value,options:n}),Zi}return Mi(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Ko.create(e,{...this._def,...t})}exclude(e,t=this._def){return Ko.create(this.options.filter((t=>!e.includes(t))),{...this._def,...t})}}Bi=new WeakMap,Ko.create=Wo;class Jo extends Hi{constructor(){super(...arguments),zi.set(this,void 0)}_parse(e){const t=ki.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==wi.string&&n.parsedType!==wi.number){const e=ki.objectValues(t);return Pi(n,{expected:ki.joinValues(e),received:n.parsedType,code:Si.invalid_type}),Zi}if(Li(this,zi,"f")||Vi(this,zi,new Set(ki.getValidEnumValues(this._def.values)),"f"),!Li(this,zi,"f").has(e.data)){const e=ki.objectValues(t);return Pi(n,{received:n.data,code:Si.invalid_enum_value,options:e}),Zi}return Mi(e.data)}get enum(){return this._def.values}}zi=new WeakMap,Jo.create=(e,t)=>new Jo({values:e,typeName:ua.ZodNativeEnum,...Ji(t)});class Ho extends Hi{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==wi.promise&&!1===t.common.async)return Pi(t,{code:Si.invalid_type,expected:wi.promise,received:t.parsedType}),Zi;const n=t.parsedType===wi.promise?t.data:Promise.resolve(t.data);return Mi(n.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}Ho.create=(e,t)=>new Ho({type:e,typeName:ua.ZodPromise,...Ji(t)});class Yo extends Hi{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ua.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),i=this._def.effect||null,o={addIssue:e=>{Pi(n,e),e.fatal?t.abort():t.dirty()},get path(){return n.path}};if(o.addIssue=o.addIssue.bind(o),"preprocess"===i.type){const e=i.transform(n.data,o);if(n.common.async)return Promise.resolve(e).then((async e=>{if("aborted"===t.value)return Zi;const i=await this._def.schema._parseAsync({data:e,path:n.path,parent:n});return"aborted"===i.status?Zi:"dirty"===i.status||"dirty"===t.value?Gi(i.value):i}));{if("aborted"===t.value)return Zi;const i=this._def.schema._parseSync({data:e,path:n.path,parent:n});return"aborted"===i.status?Zi:"dirty"===i.status||"dirty"===t.value?Gi(i.value):i}}if("refinement"===i.type){const e=e=>{const t=i.refinement(e,o);if(n.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===n.common.async){const i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===i.status?Zi:("dirty"===i.status&&t.dirty(),e(i.value),{status:t.value,value:i.value})}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((n=>"aborted"===n.status?Zi:("dirty"===n.status&&t.dirty(),e(n.value).then((()=>({status:t.value,value:n.value}))))))}if("transform"===i.type){if(!1===n.common.async){const e=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Fi(e))return e;const a=i.transform(e.value,o);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((e=>Fi(e)?Promise.resolve(i.transform(e.value,o)).then((e=>({status:t.value,value:e}))):e))}ki.assertNever(i)}}Yo.create=(e,t,n)=>new Yo({schema:e,typeName:ua.ZodEffects,effect:t,...Ji(n)}),Yo.createWithPreprocess=(e,t,n)=>new Yo({schema:t,effect:{type:"preprocess",transform:e},typeName:ua.ZodEffects,...Ji(n)});class Xo extends Hi{_parse(e){return this._getType(e)===wi.undefined?Mi(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Xo.create=(e,t)=>new Xo({innerType:e,typeName:ua.ZodOptional,...Ji(t)});class Qo extends Hi{_parse(e){return this._getType(e)===wi.null?Mi(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Qo.create=(e,t)=>new Qo({innerType:e,typeName:ua.ZodNullable,...Ji(t)});class ea extends Hi{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===wi.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}ea.create=(e,t)=>new ea({innerType:e,typeName:ua.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...Ji(t)});class ta extends Hi{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Ui(i)?i.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new Ei(n.common.issues)},input:n.data})}))):{status:"valid",value:"valid"===i.status?i.value:this._def.catchValue({get error(){return new Ei(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}ta.create=(e,t)=>new ta({innerType:e,typeName:ua.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...Ji(t)});class na extends Hi{_parse(e){if(this._getType(e)!==wi.nan){const t=this._getOrReturnCtx(e);return Pi(t,{code:Si.invalid_type,expected:wi.nan,received:t.parsedType}),Zi}return{status:"valid",value:e.data}}}na.create=e=>new na({typeName:ua.ZodNaN,...Ji(e)});const ia=Symbol("zod_brand");class oa extends Hi{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class aa extends Hi{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const e=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?Zi:"dirty"===e.status?(t.dirty(),Gi(e.value)):this._def.out._parseAsync({data:e.value,path:n.path,parent:n})})();{const e=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?Zi:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:n.path,parent:n})}}static create(e,t){return new aa({in:e,out:t,typeName:ua.ZodPipeline})}}class sa extends Hi{_parse(e){const t=this._def.innerType._parse(e),n=e=>(Fi(e)&&(e.value=Object.freeze(e.value)),e);return Ui(t)?t.then((e=>n(e))):n(t)}unwrap(){return this._def.innerType}}function ra(e,t){const n="function"==typeof e?e(t):"string"==typeof e?{message:e}:e;return"string"==typeof n?{message:n}:n}function la(e,t={},n){return e?Eo.create().superRefine(((i,o)=>{var a,s;const r=e(i);if(r instanceof Promise)return r.then((e=>{var a,s;if(!e){const e=ra(t,i),r=null===(s=null!==(a=e.fatal)&&void 0!==a?a:n)||void 0===s||s;o.addIssue({code:"custom",...e,fatal:r})}}));if(!r){const e=ra(t,i),r=null===(s=null!==(a=e.fatal)&&void 0!==a?a:n)||void 0===s||s;o.addIssue({code:"custom",...e,fatal:r})}})):Eo.create()}sa.create=(e,t)=>new sa({innerType:e,typeName:ua.ZodReadonly,...Ji(t)});const ca={object:Ro.lazycreate};var ua;!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(ua||(ua={}));const da=_o.create,pa=bo.create,ma=na.create,ha=jo.create,ga=ko.create,fa=To.create,va=wo.create,ya=Oo.create,_a=So.create,xa=Eo.create,ba=Io.create,ja=No.create,ka=Ao.create,Ta=Co.create,wa=Ro.create,Oa=Ro.strictCreate,Sa=Zo.create,Ea=Mo.create,Ia=$o.create,Na=Fo.create,Aa=Uo.create,Ca=Lo.create,Pa=Vo.create,Ra=qo.create,Za=Bo.create,Ga=zo.create,Ma=Ko.create,Da=Jo.create,$a=Ho.create,Fa=Yo.create,Ua=Xo.create,La=Qo.create,Va=Yo.createWithPreprocess,qa=aa.create,Ba={string:e=>_o.create({...e,coerce:!0}),number:e=>bo.create({...e,coerce:!0}),boolean:e=>ko.create({...e,coerce:!0}),bigint:e=>jo.create({...e,coerce:!0}),date:e=>To.create({...e,coerce:!0})},za=Zi;var Wa=Object.freeze({__proto__:null,defaultErrorMap:Ii,setErrorMap:function(e){Ni=e},getErrorMap:Ai,makeIssue:Ci,EMPTY_PATH:[],addIssueToContext:Pi,ParseStatus:Ri,INVALID:Zi,DIRTY:Gi,OK:Mi,isAborted:Di,isDirty:$i,isValid:Fi,isAsync:Ui,get util(){return ki},get objectUtil(){return Ti},ZodParsedType:wi,getParsedType:Oi,ZodType:Hi,datetimeRegex:fo,ZodString:_o,ZodNumber:bo,ZodBigInt:jo,ZodBoolean:ko,ZodDate:To,ZodSymbol:wo,ZodUndefined:Oo,ZodNull:So,ZodAny:Eo,ZodUnknown:Io,ZodNever:No,ZodVoid:Ao,ZodArray:Co,ZodObject:Ro,ZodUnion:Zo,ZodDiscriminatedUnion:Mo,ZodIntersection:$o,ZodTuple:Fo,ZodRecord:Uo,ZodMap:Lo,ZodSet:Vo,ZodFunction:qo,ZodLazy:Bo,ZodLiteral:zo,ZodEnum:Ko,ZodNativeEnum:Jo,ZodPromise:Ho,ZodEffects:Yo,ZodTransformer:Yo,ZodOptional:Xo,ZodNullable:Qo,ZodDefault:ea,ZodCatch:ta,ZodNaN:na,BRAND:ia,ZodBranded:oa,ZodPipeline:aa,ZodReadonly:sa,custom:la,Schema:Hi,ZodSchema:Hi,late:ca,get ZodFirstPartyTypeKind(){return ua},coerce:Ba,any:xa,array:Ta,bigint:ha,boolean:ga,date:fa,discriminatedUnion:Ea,effect:Fa,enum:Ma,function:Ra,instanceof:(e,t={message:`Input not instance of ${e.name}`})=>la((t=>t instanceof e),t),intersection:Ia,lazy:Za,literal:Ga,map:Ca,nan:ma,nativeEnum:Da,never:ja,null:_a,nullable:La,number:pa,object:wa,oboolean:()=>ga().optional(),onumber:()=>pa().optional(),optional:Ua,ostring:()=>da().optional(),pipeline:qa,preprocess:Va,promise:$a,record:Aa,set:Pa,strictObject:Oa,string:da,symbol:va,transformer:Fa,tuple:Na,undefined:ya,union:Sa,unknown:ba,void:ka,NEVER:za,ZodIssueCode:Si,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:Ei});const Ka=()=>{const e=Ja(),{receiveAutomationGroupTemplates:t,closeTemplateImportExport:n}=(0,p.useDispatch)(we),[i,o]=(0,l.useState)(""),a=Ha(i);if((0,l.useEffect)((()=>{"export"===(null==e?void 0:e.mode)?o(JSON.stringify(e.templates,null,2)):o("")}),[e]),!e)return null;const{mode:s}=e,c="export"===s?(0,u._x)("Export Templates","text","nelio-content"):(0,u._x)("Import Templates","text","nelio-content"),d="export"===s?(0,u._x)("Copy","command","nelio-content"):(0,u._x)("Import","command","nelio-content"),m="import"===s?()=>{"import"===s&&a.length&&(t(e.templateType,a),n())}:()=>{navigator.clipboard.writeText(i).then((()=>n()))},h="import"===s&&!a.length,g="export"!==s||"https:"===document.location.protocol;return(0,r.jsxs)(Se.Modal,{className:"nelio-content-import-export-templates",title:c,onRequestClose:n,style:{minWidth:"30%"},children:[(0,r.jsx)(Se.TextareaControl,{placeholder:"import"===s?(0,u._x)("Paste social templates here…","user","nelio-content"):void 0,value:i,onChange:o,readOnly:"export"===s}),(0,r.jsxs)("div",{className:"nelio-content-import-export-templates__actions",children:[(0,r.jsx)(Se.Button,{variant:"secondary",onClick:n,children:(0,u._x)("Close","command","nelio-content")}),g&&(0,r.jsx)(Se.Button,{variant:"primary",onClick:m,disabled:h,children:d})]})]})},Ja=()=>m((e=>e(we).getImportExportData())),Ha=e=>{const t=Ja(),n=m((e=>e(de.store).getCurrentUserId())),i=m((e=>{var n;const{getSocialProfile:i}=e(de.store);return"import"===(null==t?void 0:t.mode)?null===(n=i(t.profileId))||void 0===n?void 0:n.network:void 0}));if("import"!==(null==t?void 0:t.mode)||!i)return[];try{const{groupId:o,profileId:a}=t;return(0,h.castArray)(JSON.parse(e)).map((e=>ns.safeParse(e))).map((e=>e.success?e.data:void 0)).filter(g.isDefined).map((e=>{var s;return Object.assign(Object.assign({groupId:o,id:gt(),creatorId:n,network:i},!e.isNetwork&&{profileId:a,targetName:e.targetName}),{taxonomies:null!==(s=e.taxonomies)&&void 0!==s?s:{},text:e.text,postType:"universal"===o?e.postType:void 0,author:e.author,availability:Ya(t.templateType,e.availability)?e.availability:void 0})})).filter((e=>!!e.text.length))}catch(e){return[]}},Ya=(e,t)=>!!(null==t?void 0:t.type.includes(e)),Xa=Wa.object({mon:Wa.boolean(),tue:Wa.boolean(),wed:Wa.boolean(),thu:Wa.boolean(),fri:Wa.boolean(),sat:Wa.boolean(),sun:Wa.boolean()}),Qa=Wa.union([Wa.literal("morning"),Wa.literal("noon"),Wa.literal("afternoon"),Wa.literal("night"),Wa.custom((e=>"string"==typeof e&&/^[0-2][0-9]:[0-5][0-9]$/.test(e)))]),es=Wa.object({instanceCount:Wa.number().nonnegative(),intervalInDays:Wa.number().positive()}),ts=Wa.discriminatedUnion("type",[Wa.object({type:Wa.literal("publication-day-offset"),hoursAfterPublication:Wa.number().nonnegative(),randomize:Wa.optional(Wa.number().nonnegative()),recurrency:Wa.optional(es)}),Wa.object({type:Wa.literal("publication-day-period"),time:Qa,randomize:Wa.optional(Wa.number().nonnegative()),recurrency:Wa.optional(es)}),Wa.object({type:Wa.literal("after-publication"),daysAfterPublication:Wa.number().nonnegative(),time:Qa,randomize:Wa.optional(Wa.number().nonnegative()),recurrency:Wa.optional(es)}),Wa.object({type:Wa.literal("reshare"),weekday:Xa,time:Qa,randomize:Wa.optional(Wa.number().nonnegative())})]),ns=Wa.object({text:Wa.string().min(1),isNetwork:Wa.boolean(),targetName:Wa.optional(Wa.string()).transform((e=>e)),author:Wa.optional(Wa.number().positive()).transform((e=>e)),postType:Wa.optional(Wa.string()).transform((e=>e)),taxonomies:Wa.optional(Wa.record(Wa.number().positive())).transform((e=>e)),availability:Wa.optional(ts)}),is=()=>{const{isLoading:e,data:t}=(()=>{const{groups:e,isLoadingGroups:t}=m((e=>({groups:e(de.store).getAutomationGroups().map((t=>e(de.store).getAutomationGroup(t))).filter(g.isDefined),isLoadingGroups:!e(de.store).hasFinishedResolution("getAutomationGroups")}))),n=tt("authors",t?[]:e),i=tt("terms",t?[]:e);return{data:e,isLoading:t||n||i}})(),{isLoading:n,data:i}=os(),{initAutomationGroups:o}=(0,p.useDispatch)(we),{notices:a,removeNotice:s}=as(),c=Ne(),u=e||n;return(0,l.useEffect)((()=>{u||o(t,i)}),[u]),(0,l.useEffect)((()=>{if(!u)return c?window.addEventListener("beforeunload",ss,{capture:!0}):window.removeEventListener("beforeunload",ss,{capture:!0}),()=>{window.removeEventListener("beforeunload",ss,{capture:!0})}}),[c,u]),u?(0,r.jsx)("div",{className:"nelio-content-automations-settings-layout",children:(0,r.jsx)(d.LoadingAnimation,{})}):(0,r.jsx)("div",{className:"nelio-content-automations-settings-layout",children:(0,r.jsx)(l.StrictMode,{children:(0,r.jsxs)(Se.SlotFillProvider,{children:[(0,r.jsx)(Se.NoticeList,{notices:a,className:"components-editor-notices__pinned",onRemove:s}),(0,r.jsx)(on,{}),(0,r.jsx)(ri,{}),(0,r.jsx)(Ka,{}),(0,r.jsx)(mn,{}),(0,r.jsx)(d.PremiumDialog,{}),(0,r.jsx)(Se.Popover.Slot,{})]})})})},os=()=>m((e=>{const t=e(de.store).getSocialProfiles();return{isLoading:e(de.store).isResolving("getSocialProfiles"),data:t}})),as=()=>{const e=m((e=>e(Ee.store).getNotices())),{removeNotice:t}=(0,p.useDispatch)(Ee.store);return{notices:e,removeNotice:t}},ss=e=>(e.preventDefault(),e.returnValue="");function rs(e){const t=document.getElementById(e);c((0,r.jsx)(is,{}),t);const n=document.getElementById("nelio-content-settings-title");n&&c((0,r.jsx)(d.ContextualHelp,{context:"social-automations",walkthrough:Oe,autostart:!0,component:ls}),n)}const ls=({className:e,runWalkthrough:t})=>(0,r.jsx)("button",{className:`${e}  page-title-action`,onClick:()=>{cs().then(t)},children:(0,u._x)("Help","text","nelio-content")}),cs=()=>{return e=void 0,t=void 0,i=function*(){const e=".nelio-content-automation-group",t=document.querySelector(`${e}:first-child`);if(!t)return;if(!t.querySelector(`${e}__body`)){const n=t.querySelector(`${e}__header-content`);null==n||n.click(),yield us()}const n=t.querySelector(`${e}__sidebar-item`);null==n||n.click(),yield us()},new((n=void 0)||(n=Promise))((function(o,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,r)}l((i=i.apply(e,t||[])).next())}));var e,t,n,i},us=()=>new Promise((e=>setTimeout(e,50)))}},n={};function i(e){var o=n[e];if(void 0!==o)return o.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,i),a.exports}i.m=t,e=[],i.O=(t,n,o,a)=>{if(!n){var s=1/0;for(u=0;u<e.length;u++){for(var[n,o,a]=e[u],r=!0,l=0;l<n.length;l++)(!1&a||s>=a)&&Object.keys(i.O).every((e=>i.O[e](n[l])))?n.splice(l--,1):(r=!1,a<s&&(s=a));if(r){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[n,o,a]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={9877:0,262:0,492:0};i.O.j=t=>0===e[t];var t=(t,n)=>{var o,a,[s,r,l]=n,c=0;if(s.some((t=>0!==e[t]))){for(o in r)i.o(r,o)&&(i.m[o]=r[o]);if(l)var u=l(i)}for(t&&t(n);c<s.length;c++)a=s[c],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(u)},n=globalThis.webpackChunkNelioContent=globalThis.webpackChunkNelioContent||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=i.O(void 0,[262,492],(()=>i(8437)));o=i.O(o);var a=NelioContent="undefined"==typeof NelioContent?{}:NelioContent;for(var s in o)a[s]=o[s];o.__esModule&&Object.defineProperty(a,"__esModule",{value:!0})})();