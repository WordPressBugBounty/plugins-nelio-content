(()=>{var e,t={436:(e,t,n)=>{"use strict";n.r(t),n.d(t,{initField:()=>gt});var s={};n.r(s),n.d(s,{getAttributes:()=>f,getValue:()=>b});var i={};n.r(i),n.d(i,{setAttributes:()=>y,setValue:()=>v});var o={};n.r(o),n.d(o,{areAuthorsValid:()=>W,getAutomationGroup:()=>k,getAutomationGroups:()=>M,getCustomFields:()=>X,getCustomPlaceholders:()=>Q,getEditingTemplate:()=>q,getEditingTemplateErrors:()=>z,getEditingTemplateType:()=>K,getGroupTermsValidation:()=>Y,getImportExportData:()=>se,getNetworkAutomationSettings:()=>L,getProfileAutomationSettings:()=>D,getProfileError:()=>ee,getProfileFrequencies:()=>J,getTemplateErrors:()=>ne,isDirty:()=>U,isEditingNetworkTemplate:()=>$,isEditingNewTemplate:()=>B,isEditingTemplate:()=>V,isGroupValid:()=>Z,isPostTypeValid:()=>H,isSaving:()=>F,isTemplateValid:()=>te});var a={};n.r(a),n.d(a,{addAutomationGroup:()=>ie,addProfileSettings:()=>ae,closeTemplateEditor:()=>re,closeTemplateImportExport:()=>le,deleteAutomationGroup:()=>ce,deleteAutomationGroupTemplate:()=>ue,initAutomationGroups:()=>de,markAsNetworkTemplate:()=>ye,markAsSaving:()=>Oe,openTemplateEditor:()=>pe,openTemplateExporter:()=>me,openTemplateImporter:()=>ge,receiveAutomationGroupTemplates:()=>he,receiveCustomFields:()=>be,receiveCustomPlaceholders:()=>fe,setAutomationGroupValidation:()=>xe,setEditingTemplateAttributes:()=>je,setEditingTemplateErrors:()=>_e,setProfileFrequencies:()=>ve,updateAutomationGroup:()=>oe});var r={};n.r(r),n.d(r,{saveAutomationGroups:()=>Pe});var l={};n.r(l),n.d(l,{getCustomFields:()=>ke,getCustomPlaceholders:()=>De});const c=window.ReactJSXRuntime,u=window.wp.data;function d(e){(0,u.register)(e)}function p(e,t){return(0,u.subscribe)(e,t)}function g(e,t){return(0,u.useSelect)(e,t)}const m=window.wp.element,h={values:{},attributes:{}},b=function(e,t){return e.values[t]},f=function(e,t){return e.attributes[t]};function v(e,t){return{type:"SET_FIELD_VALUE",field:e,value:t}}function y(e,t){return{type:"SET_FIELD_ATTRIBUTES",field:e,attributes:t}}const O=(0,u.createReduxStore)("nelio-content/individual-settings",{reducer:function(e=h,t){var n;return null!==(n=function(e,t){switch(t.type){case"SET_FIELD_VALUE":return Object.assign(Object.assign({},e),{values:Object.assign(Object.assign({},e.values),{[t.field]:t.value})});case"SET_FIELD_ATTRIBUTES":return Object.assign(Object.assign({},e),{attributes:Object.assign(Object.assign({},e.attributes),{[t.field]:Object.assign(Object.assign({},e.attributes[t.field]),t.attributes)})})}}(e,t))&&void 0!==n?n:e},controls:u.controls,actions:i,selectors:s});d(O);const x=[];let j=(0,u.select)(O).getValue("nelio-content_settings[analytics_post_types]")||x;function _(e,t){const{setAttributes:n}=(0,u.dispatch)(O);n("nelio-content_settings[ga4_property_id]",{disabled:!e.length,refreshDisabled:t})}p(()=>{const e=(0,u.select)(O).getValue("nelio-content_settings[analytics_post_types]")||x;e!==j&&(j=e,_(e,!0))},O),_(j,!1);let E=(0,u.select)(O).getValue("nelio-content_settings[efi_post_types]")||x;function T(e){const t=!e.length,n=document.getElementById("efi-mode");n&&(n.disabled=t);const s=document.getElementById("auto-feat-image");s&&(s.disabled=t)}p(()=>{const e=(0,u.select)(O).getValue("nelio-content_settings[efi_post_types]")||x;e!==E&&(E=e,T(E))},O),T(E);const I=window.wp.i18n,P=window.NelioContent.components,A=window.lodash,S=window.NelioContent.data,w=window.wp.coreData,N=(window.NelioContent.networks,window.NelioContent.utils),R={automationGroups:{byId:{universal:{id:"universal",priority:100,publication:{type:"always"},profileSettings:{},networkSettings:{}}},allIds:["universal"]},validations:{universal:{areAuthorsValid:!0,areTermsValid:{},isPostTypeValid:!0,socialProfileErrors:{},templateErrors:{}}},frequencies:{},isSaving:!1,templateEditor:{attributes:void 0,isNew:!1,isNetwork:!1,customFields:{},customPlaceholders:{},errors:{author:!1,target:!1,content:!1,availability:!1,taxonomies:{}}},templateImportExport:void 0};function C(e,t){return(0,A.isEqual)((0,A.omit)((0,A.omitBy)(e,A.isNil),["groupId","id","creatorId"]),(0,A.omit)((0,A.omitBy)(t,A.isNil),["groupId","id","creatorId"]))}function G(e){const t=e.automationGroups.byId;return Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign({universal:(0,N.fixAttributesInGroup)(t.universal)},(0,A.mapValues)((0,A.omit)(t,"universal"),N.fixAttributesInGroup))})})}function M(e){return e.automationGroups.allIds}function k(e,t){return e.automationGroups.byId[t]}function D(e,t,n){var s;return(0,A.find)(null===(s=k(e,t))||void 0===s?void 0:s.profileSettings,{profileId:n})}function L(e,t,n){var s;return(0,A.find)(null===(s=k(e,t))||void 0===s?void 0:s.networkSettings,{name:n})}function U(e,t,n){const s=(0,A.values)(e.automationGroups.byId),i=t;return n.some(t=>{const n=e.frequencies[t.id];return(null==n?void 0:n.publication)!==Math.max(1,t.publicationFrequency)||(null==n?void 0:n.reshare)!==Math.max(1,t.reshareFrequency)})||JSON.stringify(s)!==JSON.stringify(i)}function F(e){return!!e.isSaving}function V(e){return!!e.templateEditor.attributes}function B(e){return V(e)&&e.templateEditor.isNew}function $(e){return V(e)&&e.templateEditor.isNetwork}function q(e){const t=e.templateEditor.attributes;return t?(0,A.omit)(t,"type"):void 0}function z(e){return e.templateEditor.errors}function K(e){var t;return(null===(t=e.templateEditor.attributes)||void 0===t?void 0:t.type)||"publication"}function J(e,t){return e.frequencies[t]}function X(e){return e.templateEditor.customFields}function Q(e){return e.templateEditor.customPlaceholders}function H(e,t){var n,s;return null===(s=null===(n=e.validations[t])||void 0===n?void 0:n.isPostTypeValid)||void 0===s||s}function W(e,t){var n,s;return null===(s=null===(n=e.validations[t])||void 0===n?void 0:n.areAuthorsValid)||void 0===s||s}function Y(e,t){var n;return(null===(n=e.validations[t])||void 0===n?void 0:n.areTermsValid)||{}}function Z(e,t){var n;const s=(0,A.values)(Y(e,t)).every(Boolean);return H(e,t)&&W(e,t)&&s&&(0,A.keys)(null===(n=k(e,t))||void 0===n?void 0:n.profileSettings).every(n=>!ee(e,t,n))}function ee(e,t,n){var s;const i=null===(s=e.validations[t])||void 0===s?void 0:s.socialProfileErrors[n];if(i)return i;const o=D(e,t,n);if(!o)return!1;const a=L(e,t,o.network),r=n=>!n||(e=>"enabled"in e&&!e.enabled)(n)||(0,A.map)(n.templates,"id").every(n=>te(e,t,n));return r(o.publication)&&r(null==a?void 0:a.publication)?(!r(o.reshare)||!r(null==a?void 0:a.reshare))&&(0,I._x)("Please review reshare templates","text","nelio-content"):(0,I._x)("Please review publication templates","user","nelio-content")}function te(e,t,n){var s;const i=null===(s=e.validations[t])||void 0===s?void 0:s.templateErrors[n];return(0,A.keys)((0,A.omit)(i,"taxonomies")).every(e=>!(null==i?void 0:i[e]))&&(0,A.keys)(null==i?void 0:i.taxonomies).every(e=>!(null==i?void 0:i.taxonomies[e]))}function ne(e,t,n){var s;return null===(s=e.validations[t])||void 0===s?void 0:s.templateErrors[n]}function se(e){return e.templateImportExport}function ie(e){return{type:"ADD_AUTOMATION_GROUP",group:e}}function oe(e,t){return{type:"UPDATE_AUTOMATION_GROUP",groupId:e,attrs:t}}function ae(e,t){return{type:"ADD_PROFILE_SETTINGS",groupId:e,settings:t}}function re(){return{type:"CLOSE_TEMPLATE_EDITOR"}}function le(){return{type:"CLOSE_TEMPLATE_IMPORT_EXPORT"}}function ce(e){return{type:"DELETE_AUTOMATION_GROUP",groupId:e}}function ue(e){return{type:"DELETE_AUTOMATION_GROUP_TEMPLATE",template:e}}function de(e,t){return{type:"INIT_AUTOMATION_GROUPS",automationGroups:e,profiles:t}}function pe(e,t,n){return{type:"OPEN_TEMPLATE_EDITOR",template:Object.assign(Object.assign({},t),{type:e}),isNew:"new"===n}}function ge(e,t,n){return{type:"OPEN_TEMPLATE_IMPORTER",groupId:e,profileId:t,templateType:n}}function me(e){return{type:"OPEN_TEMPLATE_EXPORTER",templates:(0,A.castArray)(e)}}function he(e,t){return{type:"RECEIVE_AUTOMATION_GROUP_TEMPLATES",templateType:e,templates:(0,A.castArray)(t)}}function be(e){return{type:"RECEIVE_CUSTOM_FIELDS",customFields:e}}function fe(e){return{type:"RECEIVE_CUSTOM_PLACEHOLDERS",customPlaceholders:e}}function ve(e,t){return{type:"SET_PROFILE_FREQUENCIES",profileId:e,frequencies:t}}function ye(e){return{type:"MARK_AS_NETWORK_TEMPLATE",isNetwork:e}}function Oe(e){return{type:"MARK_AS_SAVING",isSaving:e}}function xe(e,t){return{type:"SET_AUTOMATION_GROUP_VALIDATION",groupId:e,validation:t}}function je(e){return{type:"SET_EDITING_TEMPLATE_ATTRIBUTES",attributes:e}}function _e(e){return{type:"SET_EDITING_TEMPLATE_ERRORS",errors:e}}const Ee=window.wp.apiFetch,Te=n.n(Ee)();var Ie=function(e,t,n,s){return new(n||(n=Promise))(function(i,o){function a(e){try{l(s.next(e))}catch(e){o(e)}}function r(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,r)}l((s=s.apply(e,t||[])).next())})};function Pe(){return Ie(this,void 0,void 0,function*(){yield(0,u.dispatch)(Ue).markAsSaving(!0);const{getAutomationGroup:e,getAutomationGroups:t}=(0,u.select)(Ue),n=yield Promise.all(t().map(e).filter(N.isDefined).map(we));try{const e=(0,u.select)(S.store).getSiteId(),t=(0,u.select)(S.store).getApiRoot(),s=(0,u.select)(S.store).getAuthenticationToken(),i=yield Ae(),o=yield Te({url:`${t}/site/${e}/automation-groups`,method:"PUT",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${s}`},data:n});yield(0,u.dispatch)(Ue).initAutomationGroups(o,i),yield(0,u.dispatch)(S.store).resetAutomationGroups(o)}catch(e){yield(0,N.showErrorNotice)(e)}yield(0,u.dispatch)(Ue).markAsSaving(!1)})}const Ae=()=>Ie(void 0,void 0,void 0,function*(){return Promise.all((0,u.select)(S.store).getSocialProfiles().map(e=>Ie(void 0,void 0,void 0,function*(){if(!Se(e))return e;const t=(0,u.select)(Ue).getProfileFrequencies(e.id);if(!t)return e;const n=(0,u.select)(S.store).getSiteId(),s=(0,u.select)(S.store).getApiRoot(),i=(0,u.select)(S.store).getAuthenticationToken(),o=yield Te({url:`${s}/site/${n}/profile/${e.id}`,method:"PUT",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${i}`},data:{publicationFrequency:t.publication,reshareFrequency:t.reshare}});return yield(0,u.dispatch)(S.store).receiveSocialProfiles(o),o})))}),Se=e=>{const t=(0,u.select)(Ue).getProfileFrequencies(e.id);return(null==t?void 0:t.publication)!==e.publicationFrequency||(null==t?void 0:t.reshare)!==e.reshareFrequency},we=e=>Ie(void 0,void 0,void 0,function*(){if((0,N.isUniversalGroup)(e))return e;const t=yield Ge(e.postType),n=Ce(e.postType),s=Ne({taxonomies:t,supportsAuthors:n});return Object.assign(Object.assign({},e),{authors:!1===n?[]:e.authors,taxonomies:(0,A.pick)(e.taxonomies,t),profileSettings:(0,A.mapValues)(e.profileSettings,s),networkSettings:(0,A.pickBy)((0,A.mapValues)(e.networkSettings,s),e=>!(!e||!e.publication.templates.length&&!e.reshare.templates.length))})}),Ne=e=>t=>{const n=Re(e);return Object.assign(Object.assign({},t),{publication:Object.assign(Object.assign({},t.publication),{templates:(0,A.map)(t.publication.templates,n)}),reshare:Object.assign(Object.assign({},t.reshare),{templates:(0,A.map)(t.reshare.templates,n)})})},Re=e=>t=>Object.assign(Object.assign({},t),{author:!1===e.supportsAuthors?void 0:t.author,taxonomies:(0,A.pick)(t.taxonomies,e.taxonomies)}),Ce=e=>{var t;return null===(t=(0,u.select)(S.store).getPostType(e))||void 0===t?void 0:t.supports.author},Ge=e=>Ie(void 0,void 0,void 0,function*(){const{getEntityRecords:t}=(n=w.store,(0,u.resolveSelect)(n));var n;const s=yield t("root","taxonomy",{per_page:-1});return(0,A.castArray)(s).filter(e=>!!e).filter(t=>t.types.includes(e)).map(e=>e.slug)});var Me=function(e,t,n,s){return new(n||(n=Promise))(function(i,o){function a(e){try{l(s.next(e))}catch(e){o(e)}}function r(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,r)}l((s=s.apply(e,t||[])).next())})};function ke(){return Me(this,void 0,void 0,function*(){const e=yield Te({path:"/nelio-content/v1/custom-fields"});yield(0,u.dispatch)(Ue).receiveCustomFields(e)})}function De(){return Me(this,void 0,void 0,function*(){const e=yield Te({path:"/nelio-content/v1/custom-placeholders"});yield(0,u.dispatch)(Ue).receiveCustomPlaceholders(e)})}const Le=Object.assign(Object.assign({},a),r),Ue=(0,u.createReduxStore)("nelio-content/automation-settings",{reducer:function(e=R,t){var n;return null!==(n=function(e,t){switch(t.type){case"ADD_AUTOMATION_GROUP":{if(e.automationGroups.byId[t.group.id])return e;const n=Object.assign(Object.assign({},e.automationGroups.byId),{[t.group.id]:t.group});return G(Object.assign(Object.assign({},e),{automationGroups:{byId:n,allIds:["universal",...(0,A.keys)(n).filter(e=>"universal"!==e)]}}))}case"UPDATE_AUTOMATION_GROUP":return e.automationGroups.byId[t.groupId]?"universal"===t.groupId?G(Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign(Object.assign({},e.automationGroups.byId),{universal:Object.assign(Object.assign({},e.automationGroups.byId.universal),t.attrs)})})})):G(Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign(Object.assign({},e.automationGroups.byId),{[t.groupId]:Object.assign(Object.assign({},e.automationGroups.byId[t.groupId]),t.attrs)})})})):e;case"ADD_PROFILE_SETTINGS":{const n=e.automationGroups.byId[t.groupId];if(!n)return e;const s=Object.assign(Object.assign({},n),{profileSettings:Object.assign(Object.assign({},n.profileSettings),{[t.settings.profileId]:t.settings})});return G(Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign(Object.assign({},e.automationGroups.byId),{[s.id]:s})})}))}case"CLOSE_TEMPLATE_EDITOR":return Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{attributes:void 0,isNew:!1})});case"CLOSE_TEMPLATE_IMPORT_EXPORT":return Object.assign(Object.assign({},e),{templateImportExport:void 0});case"DELETE_AUTOMATION_GROUP":return e.automationGroups.allIds.includes(t.groupId)?Object.assign(Object.assign({},e),{automationGroups:{byId:(0,A.omit)(e.automationGroups.byId,t.groupId),allIds:["universal",...(0,A.without)((0,A.filter)(e.automationGroups.allIds,e=>"universal"!==e),t.groupId)]}}):e;case"DELETE_AUTOMATION_GROUP_TEMPLATE":return G(function(e,t){var n;const s=e.automationGroups.byId[t.groupId];if(!s)return e;const i=t.profileId?"profileSettings":"networkSettings",o=null!==(n=t.profileId)&&void 0!==n?n:t.network,a=t.profileId?s.profileSettings[t.profileId]:s.networkSettings[t.network];return a?Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign(Object.assign({},e.automationGroups.byId),{[t.groupId]:Object.assign(Object.assign({},s),{[i]:Object.assign(Object.assign({},s[i]),{[o]:Object.assign(Object.assign({},a),{publication:Object.assign(Object.assign({},a.publication),{templates:a.publication.templates.filter(e=>e.id!==t.id)}),reshare:Object.assign(Object.assign({},a.reshare),{templates:a.reshare.templates.filter(e=>e.id!==t.id)})})})})})})}):e}(e,t.template));case"INIT_AUTOMATION_GROUPS":return G(Object.assign(Object.assign({},e),{automationGroups:{byId:Object.assign({universal:e.automationGroups.byId.universal},(0,A.keyBy)(t.automationGroups,"id")),allIds:["universal",...(0,A.map)(t.automationGroups,"id").filter(e=>"universal"!==e)]},frequencies:(0,A.mapValues)((0,A.keyBy)(t.profiles,"id"),e=>({publication:Math.max(1,e.publicationFrequency),reshare:Math.max(1,e.reshareFrequency)}))}));case"OPEN_TEMPLATE_EDITOR":return Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{attributes:t.template,isNew:t.isNew,isNetwork:!t.isNew&&!t.template.profileId})});case"OPEN_TEMPLATE_IMPORTER":return Object.assign(Object.assign({},e),{templateImportExport:Object.assign({mode:"import"},(0,A.omit)(t,"type"))});case"OPEN_TEMPLATE_EXPORTER":return Object.assign(Object.assign({},e),{templateImportExport:Object.assign({mode:"export"},(0,A.omit)(t,"type"))});case"MARK_AS_NETWORK_TEMPLATE":return e.templateEditor.attributes&&e.templateEditor.isNew?Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{isNetwork:t.isNetwork})}):e;case"MARK_AS_SAVING":return Object.assign(Object.assign({},e),{isSaving:t.isSaving});case"RECEIVE_AUTOMATION_GROUP_TEMPLATES":return(0,A.reduce)(t.templates,(n=t.templateType,(e,t)=>{var s;const i=null!==(s=t.profileId)&&void 0!==s?s:t.network,o=e.automationGroups.byId[t.groupId];if(!o)return e;const a=t.profileId?o.profileSettings:o.networkSettings,r=a[i];if(!r)return e;const l=r[n].templates;return Object.assign(Object.assign({},e),{automationGroups:Object.assign(Object.assign({},e.automationGroups),{byId:Object.assign(Object.assign({},e.automationGroups.byId),{[t.groupId]:Object.assign(Object.assign({},o),{[t.profileId?"profileSettings":"networkSettings"]:Object.assign(Object.assign({},a),{[i]:Object.assign(Object.assign({},r),{[n]:Object.assign(Object.assign({},r[n]),{templates:(0,A.uniqWith)((0,A.values)(Object.assign(Object.assign({},(0,A.keyBy)(l,"id")),{[t.id]:t})),C)})})})})})})})}),e);case"RECEIVE_CUSTOM_FIELDS":return Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{customFields:t.customFields})});case"RECEIVE_CUSTOM_PLACEHOLDERS":return Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{customPlaceholders:t.customPlaceholders})});case"SET_PROFILE_FREQUENCIES":{const n=e.frequencies[t.profileId];return n?Object.assign(Object.assign({},e),{frequencies:Object.assign(Object.assign({},e.frequencies),{[t.profileId]:Object.assign(Object.assign({},n),t.frequencies)})}):e}case"SET_AUTOMATION_GROUP_VALIDATION":return Object.assign(Object.assign({},e),{validations:Object.assign(Object.assign({},e.validations),{[t.groupId]:t.validation})});case"SET_EDITING_TEMPLATE_ATTRIBUTES":return e.templateEditor.attributes?Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{attributes:Object.assign(Object.assign({},e.templateEditor.attributes),t.attributes)})}):e;case"SET_EDITING_TEMPLATE_ERRORS":return e.templateEditor.attributes?Object.assign(Object.assign({},e),{templateEditor:Object.assign(Object.assign({},e.templateEditor),{errors:t.errors})}):e}var n}(e,t))&&void 0!==n?n:e},controls:u.controls,actions:Le,selectors:o,resolvers:l});d(Ue);const Fe=e=>(e.preventDefault(),e.returnValue=""),Ve={postTypes:[],isMandatory:!1,help:""};function Be(e,t){const n=g(t=>t(O).getAttributes(e)),{setAttributes:s}=(0,u.useDispatch)(O);return[Object.assign(Object.assign({},t),n),t=>s(e,t)]}function $e(e){const t=g(t=>t(O).getValue(e)),{setValue:n}=(0,u.useDispatch)(O);return[t,t=>n(e,t)]}const qe=window.wp.components,ze={status:"loading"};const Ke=window.wp.url;function Je(e,t){t({error:!1,isRefreshing:!0,isStartingRefresh:!0,isRefreshingOver:!1,refreshPostCount:0,refreshPostIndex:0}),Xe(e,1,t)}function Xe(e,t,n){t<1?Qe(0,n):Te({path:(0,Ke.addQueryArgs)("/nelio-content/v1/analytics/post",{period:e,page:t})}).then(({ids:s,more:i,total:o,ppp:a})=>{if((0,N.isEmpty)(s))return void Qe(o,n);let r=a*(t-1);n({isStartingRefresh:!1,refreshPostCount:o,refreshPostIndex:Math.min(o,r)});const l=(0,A.map)(s,e=>Te({path:`/nelio-content/v1/analytics/post/${e}/update`,method:"PUT"}).then(()=>{++r,n({refreshPostIndex:Math.min(o,r)})}));Promise.all(l).then(()=>i?Xe(e,t+1,n):Qe(o,n)).catch(e=>{const t=function(e){const t=`${(0,I._x)("Unknown Error","text","nelio-content")}. ${(0,I._x)("Unable to refresh analytics.","text","nelio-content")}`;return e&&"object"==typeof e&&"message"in e&&"string"==typeof e.message&&e.message||t}(e);n({error:t,isRefreshing:!1,isStartingRefresh:!1,isRefreshingOver:!0,refreshPostCount:0})})})}function Qe(e,t){t({isRefreshing:!1,isStartingRefresh:!1,isRefreshingOver:!0,refreshPostCount:e,refreshPostIndex:e})}const He={disabled:!1,refreshDisabled:!1,isRefreshDialogOpen:!1,isRefreshing:!1,isRefreshingOver:!1,isStartingRefresh:!1,isValidating:!1,refreshPeriod:"month",refreshPostCount:0,refreshPostIndex:0,mode:"init",error:!1},We=({className:e,name:t,disabled:n})=>{const[s,i]=Be(t,He),{error:o,refreshDisabled:a,isRefreshDialogOpen:r,isRefreshing:l,isStartingRefresh:u,isRefreshingOver:d,refreshPeriod:p,refreshPostCount:g,refreshPostIndex:m}=s;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(qe.Button,{variant:"secondary",size:"small",disabled:n||a,onClick:()=>i({error:!1,isRefreshDialogOpen:!0,isRefreshing:!1,refreshPeriod:"month"}),children:(0,I._x)("Refresh Analytics","command","nelio-content")}),r&&(0,c.jsxs)(qe.Modal,{isDismissible:!1,title:(0,I._x)("Refresh Analytics","text","nelio-content"),onRequestClose:()=>{},children:[(0,c.jsxs)("div",{className:`${e}__dialog-content`,children:[!l&&!d&&(0,c.jsx)(qe.SelectControl,{disabled:l,value:p,onChange:e=>i({refreshPeriod:e}),options:Ye}),u&&(0,c.jsx)(P.ProgressBar,{label:(0,I._x)("Retrieving posts…","text","nelio-content")}),l&&!u&&(0,c.jsx)(P.ProgressBar,{current:m,total:g,label:`${m} / ${g}`}),d&&(0,c.jsx)(P.ProgressBar,{current:m,total:g,label:(0,I.sprintf)(/* translators: %d: Number of posts. */ /* translators: %d: Number of posts. */
(0,I._nx)("%d post updated!","%d posts updated!",g,"text","nelio-content"),g)}),!!o&&(0,c.jsx)("p",{className:`${e}__error-message`,children:o})]}),(0,c.jsxs)("div",{className:`${e}__dialog-actions`,children:[(0,c.jsx)(qe.Button,{variant:"secondary",disabled:l,onClick:()=>i({error:!1,isRefreshDialogOpen:!1,isRefreshing:!1,isStartingRefresh:!1,isRefreshingOver:!1,refreshPeriod:"month",refreshPostCount:0,refreshPostIndex:0}),children:(0,I._x)("Close","command","nelio-content")}),!d&&(0,c.jsx)(qe.Button,{variant:"primary",isBusy:l,disabled:l,onClick:()=>Je(p,e=>i(e)),children:l?(0,I._x)("Refreshing…","text","nelio-content"):(0,I._x)("Refresh Analytics","command","nelio-content")})]})]})]})},Ye=[{value:"month",label:(0,I._x)("Posts from last month","text","nelio-content")},{value:"year",label:(0,I._x)("Posts from last year","text","nelio-content")},{value:"all",label:(0,I._x)("All posts","text","nelio-content")}],Ze=({className:e="",disabled:t,mode:n,name:s,selectProfile:i=()=>{}})=>(0,c.jsxs)("div",{className:e,children:[(0,c.jsxs)("div",{className:`${e}__connection-actions`,children:[(0,c.jsx)(qe.Button,{variant:"secondary",size:"small",disabled:t,onClick:i,children:(0,I._x)("Connect Google Analytics","command","nelio-content")}),(0,c.jsx)(We,{name:s,className:e,disabled:t})]}),"awaiting-profile-selection"===n&&(0,c.jsx)("div",{className:`${e}__overlay`,children:(0,c.jsx)("div",{className:`${e}__overlay-content`,children:(0,I._x)("Please select a Google account…","user","nelio-content")})}),"checking-google-analytics"===n&&(0,c.jsx)("div",{className:`${e}__overlay`,children:(0,c.jsx)("div",{className:`${e}__overlay-content`,children:(0,I._x)("Please wait a moment…","user","nelio-content")})})]}),et=({className:e,disabled:t,name:n})=>{const[s="",i]=$e(n),[o,a]=Be(n,He),r=e=>{a({refreshDisabled:!0}),i(e)};return(0,c.jsxs)("div",{className:e,children:[(0,c.jsxs)("div",{className:`${e}__property-control`,children:[(0,c.jsx)("input",{type:"hidden",name:n,value:s}),(0,c.jsx)(qe.TextControl,{placeholder:(0,I._x)("GA4 Property Identifier","text","nelio-content"),disabled:t,value:s,onChange:r,help:(0,m.createInterpolateElement)((0,I.sprintf)("<span>%s</span>",(0,I._x)("To determine your GA4 Property Id, please <a>follow these instructions</a>","user","nelio-content")),{a:(0,c.jsx)(qe.ExternalLink,{href:"https://developers.google.com/analytics/devguides/reporting/data/v1/property-id#google_analytics"}),span:(0,c.jsx)("span",{className:"description"})})})]}),(0,c.jsxs)("div",{className:`${e}__property-control-actions`,children:[(0,c.jsx)(qe.Button,{variant:"secondary",size:"small",disabled:t,onClick:()=>{a({mode:"init",refreshDisabled:!0}),r("")},children:(0,I._x)("Remove Google Analytics","command","nelio-content")}),(0,c.jsx)(We,{name:n,className:e,disabled:t})]})]})},tt={isActive:!0,location:"top",template:""},nt=window.wp.compose,st=e=>{const{value:t,type:n,onChange:s}=e,i=it(n);return(0,c.jsx)(qe.DropdownMenu,{className:"nelio-content-smart-field-tags-control",icon:"tag",label:(0,I._x)("Placeholders","command","nelio-forms"),children:e=>(0,c.jsx)(c.Fragment,{children:i.map(({label:n,type:i})=>function({onClose:e},t,n,s,i){const o=ot().filter(e=>e.type===i);return 0===o.length?null:(0,c.jsx)(qe.MenuGroup,{label:t,children:o.map(({id:t,icon:i,label:o,help:a},r)=>(0,c.jsx)(qe.MenuItem,{role:"menuitem",icon:i,onClick:()=>{s(`${n}{${t}}`),e()},title:a,children:(0,A.truncate)(at(o),{length:40})},r))})}(e,n,t,s,i))})})},it=e=>[{label:(0,I._x)("Series","text","nelio-content"),type:"series"},{label:(0,I._x)("Posts","text","nelio-content"),type:"post"},{label:(0,I._x)("Posts List","text","nelio-content"),type:"post-list"}].filter(t=>Array.isArray(e)?e.includes(t.type):e===t.type),ot=()=>[{id:"series_title",icon:"editor-textcolor",label:(0,I._x)("Series Title","text","nelio-content"),help:(0,I._x)("Displays the title of a series","text","nelio-content"),type:"series"},{id:"series_title_linked",icon:"admin-links",label:(0,I._x)("Series Title Linked","text","nelio-content"),help:(0,I._x)("Displays the title of a series linked to the series page","text","nelio-content"),type:"series"},{id:"series_description",icon:"editor-justify",label:(0,I._x)("Series Description","text","nelio-content"),help:(0,I._x)("Displays the description of a series","text","nelio-content"),type:"series"},{id:"post_title",icon:"editor-textcolor",label:(0,I._x)("Post Title","text","nelio-content"),help:(0,I._x)("Displays the title of a post","text","nelio-content"),type:"post"},{id:"post_title_linked",icon:"admin-links",label:(0,I._x)("Post Title Linked","text","nelio-content"),help:(0,I._x)("Displays the title of a post linked to the post page","text","nelio-content"),type:"post"},{id:"series_part_number",icon:"editor-ol",label:(0,I._x)("Series Part Number","text","nelio-content"),help:(0,I._x)("Displays what part of a series the post is","text","nelio-content"),type:"post"},{id:"total_posts_in_series",icon:"editor-ol-rtl",label:(0,I._x)("Total Posts in Series","text","nelio-content"),help:(0,I._x)("Displays the total number of posts in a series","text","nelio-content"),type:"series"},{id:"series_post_list",icon:"editor-ul",label:(0,I._x)("Series Post List Items","text","nelio-content"),help:(0,I._x)("Displays the list of posts in a series.","text","nelio-content"),type:"post-list"}],at=e=>e.replace(/<\/?[a-z][^>]*?>/gi,""),rt=e=>{const{label:t,help:n,value:s,type:i,isMultiline:o=!1,maxLength:a,onChange:r}=e,l=(0,nt.useInstanceId)(rt);return(0,c.jsxs)(qe.BaseControl,{id:`${l}`,label:t,help:n,className:"nelio-content-text-field-control",children:[o?(0,c.jsx)(qe.TextareaControl,{value:s,onChange:r}):(0,c.jsx)(qe.TextControl,{value:s,maxLength:a,onChange:r}),(0,c.jsx)(st,{value:s,type:i,onChange:r})]})},lt=[{value:"top",label:(0,I._x)("Before the content","text","nelio-content")},{value:"bottom",label:(0,I._x)("After the content","text","nelio-content")},{value:"manual",label:(0,I._x)("Manual","text","nelio-content")}],ct={isActive:!0,location:"top",generalTemplate:"",currentPostTemplate:"",otherPostTemplate:""},ut=[{value:"top",label:(0,I._x)("Before the content","text","nelio-content")},{value:"bottom",label:(0,I._x)("After the content","text","nelio-content")},{value:"manual",label:(0,I._x)("Manual","text","nelio-content")}],dt={status:"loading"};const pt={PostTypeSetting:({name:e})=>{const t=g(e=>e(S.store).getPluginUrl("/includes/lib/settings/assets/images/help.png")),[n=[],s]=$e(e),[i,o]=(0,m.useState)(!1),[a]=(0,m.useState)(n),[r]=Be(e,Ve);((e,t=!1)=>{(0,m.useEffect)(()=>{if(!t)return e?window.addEventListener("beforeunload",Fe,{capture:!0}):window.removeEventListener("beforeunload",Fe,{capture:!0}),()=>{window.removeEventListener("beforeunload",Fe,{capture:!0})}},[e,t])})(!(0,A.isEqual)(n,a));const l=r.postTypes,u=l.filter(({value:e})=>n.includes(e));return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"nelio-content-post-type-setting",children:[(0,c.jsx)("input",{type:"hidden",name:e,value:n}),!!r.help&&(0,c.jsx)("img",{alt:(0,I._x)("Help","command","nelio-content"),className:"nelio-content-post-type-setting--help",src:t,onClick:()=>o(!i),height:"16",width:"16"}),(0,c.jsx)(P.StylizedSelectControl,{className:"nelio-content-post-type-setting--select",isMulti:!0,isMandatory:r.isMandatory,options:l,value:u,onChange:e=>s((0,A.map)(e,"value"))})]}),i&&(0,c.jsx)("p",{className:"description",children:r.help})]})},CloudNotificationEmailsSetting:({name:e})=>{const[t,n]=Be(e,ze),[s=[],i]=$e(e),o=g(e=>e(S.store).getSiteId()),a=g(e=>e(S.store).getApiRoot()),r=g(e=>e(S.store).getAuthenticationToken()),{status:l}=t;return(0,m.useEffect)(()=>{var e,t,s,l;e=void 0,t=void 0,l=function*(){if(o&&r)try{const e=yield Te({url:`${a}/site/${o}`,method:"GET",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${r}`}}),{notificationEmails:t=[]}=e;i(t),n({status:"ready"})}catch(e){i([]),n({status:"error"})}},new((s=void 0)||(s=Promise))(function(n,i){function o(e){try{r(l.next(e))}catch(e){i(e)}}function a(e){try{r(l.throw(e))}catch(e){i(e)}}function r(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,a)}r((l=l.apply(e,t||[])).next())})},[o,r]),(0,c.jsxs)("div",{className:"nelio-content-cloud-notification-emails-setting",children:["loading"===l&&(0,c.jsx)(qe.Spinner,{}),"error"===l&&(0,c.jsx)("p",{className:"nelio-content-cloud-notification-emails-setting__error-message",children:(0,I._x)("Unable to retrieve cloud notification emails. Please try again later.","user","nelio-content")}),"ready"===l&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("input",{type:"hidden",name:e,value:s.map(e=>e.replace(/\s/g,"")).filter(Boolean).join(",")}),(0,c.jsx)("p",{children:(0,I._x)("Please write one email address per line:","user","nelio-content")}),(0,c.jsx)("textarea",{className:"nelio-content-cloud-notification-emails-setting__input",placeholder:(0,I._x)("user@example.com","text","nelio-content"),value:s.join("\n"),onChange:e=>i(e.target.value.split("\n"))}),(0,c.jsx)("p",{children:(0,c.jsx)("span",{className:"description",children:(0,I._x)("Send email notifications to the addresses above when a social profile expires and requires re-authentication.","text","nelio-content")})})]})]})},GoogleAnalyticsSetting:({name:e})=>{const[t,n]=Be(e,He),s=e=>n({mode:e,refreshDisabled:!0}),{disabled:i,mode:o}=t;return"ga4-property-id"===o?(0,c.jsx)(et,{className:"nelio-content-google-analytics-setting",disabled:i,name:e}):(0,c.jsx)(Ze,{className:"nelio-content-google-analytics-setting",name:e,disabled:i,mode:o,selectProfile:()=>function({onOpen:e=()=>{},onClose:t=()=>{}}){e();const n=(0,u.select)(S.store).getSiteId(),s=(0,u.select)(S.store).getRestUrl("/nelio-content/v1/analytics/connect"),i=(0,u.select)(S.store).getApiRoot(),o=window.open((0,Ke.addQueryArgs)(`${i}/connect/ga`,{siteId:n,redirect:s}),"","width=640,height=480"),a=setInterval(()=>{(null==o?void 0:o.closed)&&(clearInterval(a),t())},500)}({onOpen:()=>s("awaiting-profile-selection"),onClose:()=>{s("checking-google-analytics"),Te({path:"/nelio-content/v1/analytics/check"}).then(e=>s(e?"ga4-property-id":"init"))}})})},SeriesMetadataSetting:({name:e})=>{const[t=tt,n]=$e(e),{isActive:s,template:i,location:o}=t;return(0,c.jsxs)("div",{className:"nelio-content-series-metadata-setting",children:[(0,c.jsx)("input",{type:"hidden",name:e,value:JSON.stringify(t)}),(0,c.jsx)(qe.CheckboxControl,{className:"nelio-content-series-metadata-setting__activation-control",checked:s,label:(0,I._x)("Display a box in a single post showing metadata about the series the post belongs to","text","nelio-content"),onChange:e=>n(Object.assign(Object.assign({},t),{isActive:e}))}),s&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(qe.SelectControl,{className:"nelio-content-series-metadata-setting__location-control",label:(0,I._x)("Series Metadata Location","text","nelio-content"),help:(0,I._x)("Select where do you want the series metadata box to appear in a single post.","user","nelio-content"),options:lt,value:o,onChange:e=>n(Object.assign(Object.assign({},t),{location:e}))}),(0,c.jsx)(rt,{value:i,type:["series","post"],label:(0,I._x)("Series Metadata Template","text","nelio-content"),help:(0,I._x)("This controls how and what series meta information is displayed within posts that are part of the series.","user","nelio-content"),isMultiline:!0,onChange:e=>n(Object.assign(Object.assign({},t),{template:e}))})]})]})},SeriesPostListSetting:({name:e})=>{const[t=ct,n]=$e(e),{isActive:s,generalTemplate:i,currentPostTemplate:o,otherPostTemplate:a,location:r}=t;return(0,c.jsxs)("div",{className:"nelio-content-series-post-list-setting",children:[(0,c.jsx)("input",{type:"hidden",name:e,value:JSON.stringify(t)}),(0,c.jsx)(qe.CheckboxControl,{className:"nelio-content-series-post-list-setting__activation-control",checked:s,label:(0,I._x)("Display a box in a single post with the list of all posts belonging to the series where the post belongs to","text","nelio-content"),onChange:e=>n(Object.assign(Object.assign({},t),{isActive:e}))}),s&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(qe.SelectControl,{className:"nelio-content-series-metadata-setting__location-control",label:(0,I._x)("Series Post List Location","text","nelio-content"),help:(0,I._x)("Select where do you want the series post list box to appear in a single post.","user","nelio-content"),options:ut,value:r,onChange:e=>n(Object.assign(Object.assign({},t),{location:e}))}),(0,c.jsx)(rt,{value:i,type:["series","post-list"],label:(0,I._x)("Series Post List Template","text","nelio-content"),help:(0,I._x)("This controls what information is displayed in the list of all the posts in the series.","user","nelio-content"),isMultiline:!0,onChange:e=>n(Object.assign(Object.assign({},t),{generalTemplate:e}))}),(0,c.jsx)(rt,{value:a,type:"post",label:(0,I._x)("Series Single Post Item Template","text","nelio-content"),help:(0,I._x)("This controls what information is displayed in the list for a single post in the series.","user","nelio-content"),isMultiline:!1,onChange:e=>n(Object.assign(Object.assign({},t),{otherPostTemplate:e}))}),(0,c.jsx)(rt,{value:o,type:"post",label:(0,I._x)("Series Current Single Post Item Template","text","nelio-content"),help:(0,I._x)("This controls what information is displayed in the list for the current post in the series.","user","nelio-content"),isMultiline:!1,onChange:e=>n(Object.assign(Object.assign({},t),{currentPostTemplate:e}))})]})]})},SocialSharingDelaySetting:({name:e})=>{const[t,n]=Be(e,dt),[s,i]=$e(e),o=g(e=>e(S.store).getSiteId()),a=g(e=>e(S.store).getApiRoot()),r=g(e=>e(S.store).getAuthenticationToken()),{status:l}=t;return(0,m.useEffect)(()=>{var e,t,s,l;e=void 0,t=void 0,l=function*(){if(o&&r)try{const e=yield Te({url:`${a}/site/${o}`,method:"GET",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${r}`}}),{socialSharingDelay:t}=e;i(t),n({status:"ready"})}catch(e){i(void 0),n({status:"error"})}},new((s=void 0)||(s=Promise))(function(n,i){function o(e){try{r(l.next(e))}catch(e){i(e)}}function a(e){try{r(l.throw(e))}catch(e){i(e)}}function r(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,a)}r((l=l.apply(e,t||[])).next())})},[o,r]),(0,c.jsxs)("div",{className:"nelio-content-social-sharing-delay-setting",children:["loading"===l&&(0,c.jsx)(qe.Spinner,{}),"error"===l&&(0,c.jsx)("p",{className:"nelio-content-social-sharing-delay-setting__error-message",children:(0,I._x)("Unable to retrieve social sharing delay. Please try again later.","user","nelio-content")}),"ready"===l&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("input",{type:"hidden",name:e,value:s}),(0,c.jsx)(P.NumberControl,{className:"nelio-content-social-sharing-delay-setting__input",value:s,min:0,max:15,placeholder:(0,I._x)("Delay in minutes","text","nelio-content"),onChange:i}),(0,c.jsx)("p",{children:(0,c.jsx)("span",{className:"description",children:(0,I._x)("Set the number of minutes to wait before sharing the post on social media when it is published.","user","nelio-content")})})]})]})}};function gt(e,t){const{component:n}=t,s=pt[n];if(!s)return;const i=document.getElementById(e);if(!i)return;const{name:o,value:a,attributes:r}=t,{setValue:l,setAttributes:d}=(0,u.dispatch)(O);var p,g;l(o,a),d(o,r),p=(0,c.jsx)(s,{name:o}),(g=i)&&(m.createRoot?(0,m.createRoot)(g).render(p):(0,m.render)(p,g))}const mt=document.getElementById("nelio-content-settings-form");null==mt||mt.addEventListener("keypress",function(e){if(!e)return;const t=e.target||e.srcElement;t&&"submit"!==t.id&&(/textarea/i.test(t.tagName)||13===(e.keyCode||e.which||e.charCode||0)&&e.preventDefault())})}},n={};function s(e){var i=n[e];if(void 0!==i)return i.exports;var o=n[e]={exports:{}};return t[e](o,o.exports,s),o.exports}s.m=t,e=[],s.O=(t,n,i,o)=>{if(!n){var a=1/0;for(u=0;u<e.length;u++){for(var[n,i,o]=e[u],r=!0,l=0;l<n.length;l++)(!1&o||a>=o)&&Object.keys(s.O).every(e=>s.O[e](n[l]))?n.splice(l--,1):(r=!1,o<a&&(a=o));if(r){e.splice(u--,1);var c=i();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[n,i,o]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={8284:0,7491:0};s.O.j=t=>0===e[t];var t=(t,n)=>{var i,o,[a,r,l]=n,c=0;if(a.some(t=>0!==e[t])){for(i in r)s.o(r,i)&&(s.m[i]=r[i]);if(l)var u=l(s)}for(t&&t(n);c<a.length;c++)o=a[c],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(u)},n=globalThis.webpackChunkNelioContent=globalThis.webpackChunkNelioContent||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var i=s.O(void 0,[7491],()=>s(436));i=s.O(i);var o=NelioContent="undefined"==typeof NelioContent?{}:NelioContent;for(var a in i)o[a]=i[a];i.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})})();