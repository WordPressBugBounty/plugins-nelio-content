(()=>{var e,t={4131:(e,t,n)=>{"use strict";n.r(t),n.d(t,{initField:()=>Z});var s={};n.r(s),n.d(s,{getAttributes:()=>h,getValue:()=>p});var o={};n.r(o),n.d(o,{setAttributes:()=>g,setValue:()=>u});const i=window.ReactJSXRuntime,l=window.wp.data;function a(e,t){return(0,l.subscribe)(e,t)}function r(e,t){return(0,l.useSelect)(e,t)}const c=window.wp.element,d={values:{},attributes:{}},p=function(e,t){return e.values[t]},h=function(e,t){return e.attributes[t]};function u(e,t){return{type:"SET_FIELD_VALUE",field:e,value:t}}function g(e,t){return{type:"SET_FIELD_ATTRIBUTES",field:e,attributes:t}}const x=(0,l.createReduxStore)("nelio-content/individual-settings",{reducer:function(e=d,t){var n;return null!==(n=function(e,t){switch(t.type){case"SET_FIELD_VALUE":return Object.assign(Object.assign({},e),{values:Object.assign(Object.assign({},e.values),{[t.field]:t.value})});case"SET_FIELD_ATTRIBUTES":return Object.assign(Object.assign({},e),{attributes:Object.assign(Object.assign({},e.attributes),{[t.field]:Object.assign(Object.assign({},e.attributes[t.field]),t.attributes)})})}}(e,t))&&void 0!==n?n:e},controls:l.controls,actions:o,selectors:s});!function(e){(0,l.register)(e)}(x);const m=[];let f=(0,l.select)(x).getValue("nelio-content_settings[analytics_post_types]")||m;function b(e,t){const{setAttributes:n}=(0,l.dispatch)(x);n("nelio-content_settings[ga4_property_id]",{disabled:!e.length,refreshDisabled:t})}a((()=>{const e=(0,l.select)(x).getValue("nelio-content_settings[analytics_post_types]")||m;e!==f&&(f=e,b(e,!0))}),x),b(f,!1);let _=(0,l.select)(x).getValue("nelio-content_settings[efi_post_types]")||m;function y(e){const t=!e.length,n=document.getElementById("efi-mode");n&&(n.disabled=t);const s=document.getElementById("auto-feat-image");s&&(s.disabled=t)}a((()=>{const e=(0,l.select)(x).getValue("nelio-content_settings[efi_post_types]")||m;e!==_&&(_=e,y(_))}),x),y(_);const v=window.wp.i18n,j=window.NelioContent.components,w=window.lodash,C=window.NelioContent.data,P={postTypes:[],isMandatory:!1,help:""};function S(e,t){const n=r((t=>t(x).getAttributes(e))),{setAttributes:s}=(0,l.useDispatch)(x);return[Object.assign(Object.assign({},t),n),t=>s(e,t)]}function O(e){const t=r((t=>t(x).getValue(e))),{setValue:n}=(0,l.useDispatch)(x);return[t,t=>n(e,t)]}const N=window.wp.apiFetch,T=n.n(N)(),R=window.wp.components,A={status:"loading"};const k=window.wp.url,I=window.NelioContent.utils;function D(e,t){t({error:!1,isRefreshing:!0,isStartingRefresh:!0,isRefreshingOver:!1,refreshPostCount:0,refreshPostIndex:0}),E(e,1,t)}function E(e,t,n){t<1?M(0,n):T({path:(0,k.addQueryArgs)("/nelio-content/v1/analytics/post",{period:e,page:t})}).then((({ids:s,more:o,total:i,ppp:l})=>{if((0,I.isEmpty)(s))return void M(i,n);let a=l*(t-1);n({isStartingRefresh:!1,refreshPostCount:i,refreshPostIndex:Math.min(i,a)});const r=(0,w.map)(s,(e=>T({path:`/nelio-content/v1/analytics/post/${e}/update`,method:"PUT"}).then((()=>{++a,n({refreshPostIndex:Math.min(i,a)})}))));Promise.all(r).then((()=>o?E(e,t+1,n):M(i,n))).catch((e=>{const t=function(e){const t=`${(0,v._x)("Unknown Error","text","nelio-content")}. ${(0,v._x)("Unable to refresh analytics.","text","nelio-content")}`;return e&&"object"==typeof e&&"message"in e&&"string"==typeof e.message&&e.message||t}(e);n({error:t,isRefreshing:!1,isStartingRefresh:!1,isRefreshingOver:!0,refreshPostCount:0})}))}))}function M(e,t){t({isRefreshing:!1,isStartingRefresh:!1,isRefreshingOver:!0,refreshPostCount:e,refreshPostIndex:e})}const $={disabled:!1,refreshDisabled:!1,isRefreshDialogOpen:!1,isRefreshing:!1,isRefreshingOver:!1,isStartingRefresh:!1,isValidating:!1,refreshPeriod:"month",refreshPostCount:0,refreshPostIndex:0,mode:"init",error:!1},B=({className:e,name:t,disabled:n})=>{const[s,o]=S(t,$),{error:l,refreshDisabled:a,isRefreshDialogOpen:r,isRefreshing:c,isStartingRefresh:d,isRefreshingOver:p,refreshPeriod:h,refreshPostCount:u,refreshPostIndex:g}=s;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(R.Button,{variant:"secondary",size:"small",disabled:n||a,onClick:()=>o({error:!1,isRefreshDialogOpen:!0,isRefreshing:!1,refreshPeriod:"month"}),children:(0,v._x)("Refresh Analytics","command","nelio-content")}),r&&(0,i.jsxs)(R.Modal,{isDismissible:!1,title:(0,v._x)("Refresh Analytics","text","nelio-content"),onRequestClose:()=>{},children:[(0,i.jsxs)("div",{className:`${e}__dialog-content`,children:[!c&&!p&&(0,i.jsx)(R.SelectControl,{disabled:c,value:h,onChange:e=>o({refreshPeriod:e}),options:L}),d&&(0,i.jsx)(j.ProgressBar,{label:(0,v._x)("Retrieving posts…","text","nelio-content")}),c&&!d&&(0,i.jsx)(j.ProgressBar,{current:g,total:u,label:`${g} / ${u}`}),p&&(0,i.jsx)(j.ProgressBar,{current:g,total:u,label:(0,v.sprintf)(/* translators: number of posts */ /* translators: number of posts */
(0,v._nx)("%d post updated!","%d posts updated!",u,"text","nelio-content"),u)}),!!l&&(0,i.jsx)("p",{className:`${e}__error-message`,children:l})]}),(0,i.jsxs)("div",{className:`${e}__dialog-actions`,children:[(0,i.jsx)(R.Button,{variant:"secondary",disabled:c,onClick:()=>o({error:!1,isRefreshDialogOpen:!1,isRefreshing:!1,isStartingRefresh:!1,isRefreshingOver:!1,refreshPeriod:"month",refreshPostCount:0,refreshPostIndex:0}),children:(0,v._x)("Close","command","nelio-content")}),!p&&(0,i.jsx)(R.Button,{variant:"primary",isBusy:c,disabled:c,onClick:()=>D(h,(e=>o(e))),children:c?(0,v._x)("Refreshing…","text","nelio-content"):(0,v._x)("Refresh Analytics","command","nelio-content")})]})]})]})},L=[{value:"month",label:(0,v._x)("Posts from last month","text","nelio-content")},{value:"year",label:(0,v._x)("Posts from last year","text","nelio-content")},{value:"all",label:(0,v._x)("All posts","text","nelio-content")}],F=({className:e="",disabled:t,mode:n,name:s,selectProfile:o=()=>{}})=>(0,i.jsxs)("div",{className:e,children:[(0,i.jsxs)("div",{className:`${e}__connection-actions`,children:[(0,i.jsx)(R.Button,{variant:"secondary",size:"small",disabled:t,onClick:o,children:(0,v._x)("Connect Google Analytics","command","nelio-content")}),(0,i.jsx)(B,{name:s,className:e,disabled:t})]}),"awaiting-profile-selection"===n&&(0,i.jsx)("div",{className:`${e}__overlay`,children:(0,i.jsx)("div",{className:`${e}__overlay-content`,children:(0,v._x)("Please select a Google account…","user","nelio-content")})}),"checking-google-analytics"===n&&(0,i.jsx)("div",{className:`${e}__overlay`,children:(0,i.jsx)("div",{className:`${e}__overlay-content`,children:(0,v._x)("Please wait a moment…","user","nelio-content")})})]}),V=({className:e,disabled:t,name:n})=>{const[s="",o]=O(n),[l,a]=S(n,$),r=e=>{a({refreshDisabled:!0}),o(e)};return(0,i.jsxs)("div",{className:e,children:[(0,i.jsxs)("div",{className:`${e}__property-control`,children:[(0,i.jsx)("input",{type:"hidden",name:n,value:s}),(0,i.jsx)(R.TextControl,{placeholder:(0,v._x)("GA4 Property Identifier","text","nelio-content"),disabled:t,value:s,onChange:r,help:(0,c.createInterpolateElement)((0,v.sprintf)("<span>%s</span>",(0,v._x)("To determine your GA4 Property Id, please <a>follow these instructions</a>","user","nelio-content")),{a:(0,i.jsx)(R.ExternalLink,{href:"https://developers.google.com/analytics/devguides/reporting/data/v1/property-id#google_analytics"}),span:(0,i.jsx)("span",{className:"description"})})})]}),(0,i.jsxs)("div",{className:`${e}__property-control-actions`,children:[(0,i.jsx)(R.Button,{variant:"secondary",size:"small",disabled:t,onClick:()=>{a({mode:"init",refreshDisabled:!0}),r("")},children:(0,v._x)("Remove Google Analytics","command","nelio-content")}),(0,i.jsx)(B,{name:n,className:e,disabled:t})]})]})},U={isActive:!0,location:"top",template:""},G=window.wp.compose,z=e=>{const{value:t,type:n,onChange:s}=e,o=J(n);return(0,i.jsx)(R.DropdownMenu,{className:"nelio-content-smart-field-tags-control",icon:"tag",label:(0,v._x)("Placeholders","command","nelio-forms"),children:e=>(0,i.jsx)(i.Fragment,{children:o.map((({label:n,type:o})=>function({onClose:e},t,n,s,o){const l=q().filter((e=>e.type===o));return 0===l.length?null:(0,i.jsx)(R.MenuGroup,{label:t,children:l.map((({id:t,icon:o,label:l,help:a},r)=>(0,i.jsx)(R.MenuItem,{role:"menuitem",icon:o,onClick:()=>{s(`${n}{${t}}`),e()},title:a,children:(0,w.truncate)(Q(l),{length:40})},r)))})}(e,n,t,s,o)))})})},J=e=>[{label:(0,v._x)("Series","text","nelio-content"),type:"series"},{label:(0,v._x)("Posts","text","nelio-content"),type:"post"},{label:(0,v._x)("Posts List","text","nelio-content"),type:"post-list"}].filter((t=>Array.isArray(e)?e.includes(t.type):e===t.type)),q=()=>[{id:"series_title",icon:"editor-textcolor",label:(0,v._x)("Series Title","text","nelio-content"),help:(0,v._x)("Displays the title of a series","text","nelio-content"),type:"series"},{id:"series_title_linked",icon:"admin-links",label:(0,v._x)("Series Title Linked","text","nelio-content"),help:(0,v._x)("Displays the title of a series linked to the series page","text","nelio-content"),type:"series"},{id:"series_description",icon:"editor-justify",label:(0,v._x)("Series Description","text","nelio-content"),help:(0,v._x)("Displays the description of a series","text","nelio-content"),type:"series"},{id:"post_title",icon:"editor-textcolor",label:(0,v._x)("Post Title","text","nelio-content"),help:(0,v._x)("Displays the title of a post","text","nelio-content"),type:"post"},{id:"post_title_linked",icon:"admin-links",label:(0,v._x)("Post Title Linked","text","nelio-content"),help:(0,v._x)("Displays the title of a post linked to the post page","text","nelio-content"),type:"post"},{id:"series_part_number",icon:"editor-ol",label:(0,v._x)("Series Part Number","text","nelio-content"),help:(0,v._x)("Displays what part of a series the post is","text","nelio-content"),type:"post"},{id:"total_posts_in_series",icon:"editor-ol-rtl",label:(0,v._x)("Total Posts in Series","text","nelio-content"),help:(0,v._x)("Displays the total number of posts in a series","text","nelio-content"),type:"series"},{id:"series_post_list",icon:"editor-ul",label:(0,v._x)("Series Post List Items","text","nelio-content"),help:(0,v._x)("Displays the list of posts in a series.","text","nelio-content"),type:"post-list"}],Q=e=>e.replace(/<\/?[a-z][^>]*?>/gi,""),H=e=>{const{label:t,help:n,value:s,type:o,isMultiline:l=!1,maxLength:a,onChange:r}=e,c=(0,G.useInstanceId)(H);return(0,i.jsxs)(R.BaseControl,{id:`${c}`,label:t,help:n,className:"nelio-content-text-field-control",children:[l?(0,i.jsx)(R.TextareaControl,{value:s,onChange:r}):(0,i.jsx)(R.TextControl,{value:s,maxLength:a,onChange:r}),(0,i.jsx)(z,{value:s,type:o,onChange:r})]})},X=[{value:"top",label:(0,v._x)("Before the content","text","nelio-content")},{value:"bottom",label:(0,v._x)("After the content","text","nelio-content")},{value:"manual",label:(0,v._x)("Manual","text","nelio-content")}],K={isActive:!0,location:"top",generalTemplate:"",currentPostTemplate:"",otherPostTemplate:""},W=[{value:"top",label:(0,v._x)("Before the content","text","nelio-content")},{value:"bottom",label:(0,v._x)("After the content","text","nelio-content")},{value:"manual",label:(0,v._x)("Manual","text","nelio-content")}],Y={PostTypeSetting:({name:e})=>{const t=r((e=>e(C.store).getPluginUrl("/includes/lib/settings/assets/images/help.png"))),[n=[],s]=O(e),[o,l]=(0,c.useState)(!1),[a]=S(e,P),d=a.postTypes,p=d.filter((({value:e})=>n.includes(e)));return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"nelio-content-post-type-setting",children:[(0,i.jsx)("input",{type:"hidden",name:e,value:n}),!!a.help&&(0,i.jsx)("img",{alt:(0,v._x)("Help","command","nelio-content"),className:"nelio-content-post-type-setting--help",src:t,onClick:()=>l(!o),height:"16",width:"16"}),(0,i.jsx)(j.StylizedSelectControl,{className:"nelio-content-post-type-setting--select",isMulti:!0,isMandatory:a.isMandatory,options:d,value:p,onChange:e=>s((0,w.map)(e,"value"))})]}),o&&(0,i.jsx)("p",{className:"description",children:a.help})]})},CloudNotificationEmailsSetting:({name:e})=>{const[t,n]=S(e,A),[s=[],o]=O(e),l=r((e=>e(C.store).getSiteId())),a=r((e=>e(C.store).getApiRoot())),d=r((e=>e(C.store).getAuthenticationToken())),{status:p}=t;return(0,c.useEffect)((()=>{var e,t,s,i;e=void 0,t=void 0,i=function*(){if(l&&d)try{const e=yield T({url:`${a}/site/${l}`,method:"GET",credentials:"omit",mode:"cors",headers:{Authorization:`Bearer ${d}`}}),{notificationEmails:t=[]}=e;o(t),n({status:"ready"})}catch(e){o([]),n({status:"error"})}},new((s=void 0)||(s=Promise))((function(n,o){function l(e){try{r(i.next(e))}catch(e){o(e)}}function a(e){try{r(i.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(l,a)}r((i=i.apply(e,t||[])).next())}))}),[l,d]),(0,i.jsxs)("div",{className:"nelio-content-cloud-notification-emails-setting",children:["loading"===p&&(0,i.jsx)(R.Spinner,{}),"error"===p&&(0,i.jsx)("p",{className:"nelio-content-cloud-notification-emails-setting__error-message",children:(0,v._x)("Unable to retrieve cloud notification emails. Please try again later.","user","nelio-content")}),"ready"===p&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",{type:"hidden",name:e,value:s.map((e=>e.replace(/\s/g,""))).filter(Boolean).join(",")}),(0,i.jsx)("p",{children:(0,v._x)("Please write one email address per line:","user","nelio-content")}),(0,i.jsx)("textarea",{className:"nelio-content-cloud-notification-emails-setting__input",placeholder:(0,v._x)("user@example.com","text","nelio-content"),value:s.join("\n"),onChange:e=>o(e.target.value.split("\n"))}),(0,i.jsx)("p",{children:(0,i.jsx)("span",{className:"description",children:(0,v._x)("Send email notifications to the addresses above when a social profile expires and requires re-authentication.","text","nelio-content")})})]})]})},GoogleAnalyticsSetting:({name:e})=>{const[t,n]=S(e,$),s=e=>n({mode:e,refreshDisabled:!0}),{disabled:o,mode:a}=t;return"ga4-property-id"===a?(0,i.jsx)(V,{className:"nelio-content-google-analytics-setting",disabled:o,name:e}):(0,i.jsx)(F,{className:"nelio-content-google-analytics-setting",name:e,disabled:o,mode:a,selectProfile:()=>function({onOpen:e=()=>{},onClose:t=()=>{}}){e();const n=(0,l.select)(C.store).getSiteId(),s=(0,l.select)(C.store).getRestUrl("/nelio-content/v1/analytics/connect"),o=(0,l.select)(C.store).getApiRoot(),i=window.open((0,k.addQueryArgs)(`${o}/connect/ga`,{siteId:n,redirect:s}),"","width=640,height=480"),a=setInterval((()=>{(null==i?void 0:i.closed)&&(clearInterval(a),t())}),500)}({onOpen:()=>s("awaiting-profile-selection"),onClose:()=>{s("checking-google-analytics"),T({path:"/nelio-content/v1/analytics/check"}).then((e=>s(e?"ga4-property-id":"init")))}})})},SeriesMetadataSetting:({name:e})=>{const[t=U,n]=O(e),{isActive:s,template:o,location:l}=t;return(0,i.jsxs)("div",{className:"nelio-content-series-metadata-setting",children:[(0,i.jsx)("input",{type:"hidden",name:e,value:JSON.stringify(t)}),(0,i.jsx)(R.CheckboxControl,{className:"nelio-content-series-metadata-setting__activation-control",checked:s,label:(0,v._x)("Display a box in a single post showing metadata about the series the post belongs to","text","nelio-content"),onChange:e=>n(Object.assign(Object.assign({},t),{isActive:e}))}),s&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(R.SelectControl,{className:"nelio-content-series-metadata-setting__location-control",label:(0,v._x)("Series Metadata Location","text","nelio-content"),help:(0,v._x)("Select where do you want the series metadata box to appear in a single post.","user","nelio-content"),options:X,value:l,onChange:e=>n(Object.assign(Object.assign({},t),{location:e}))}),(0,i.jsx)(H,{value:o,type:["series","post"],label:(0,v._x)("Series Metadata Template","text","nelio-content"),help:(0,v._x)("This controls how and what series meta information is displayed within posts that are part of the series.","user","nelio-content"),isMultiline:!0,onChange:e=>n(Object.assign(Object.assign({},t),{template:e}))})]})]})},SeriesPostListSetting:({name:e})=>{const[t=K,n]=O(e),{isActive:s,generalTemplate:o,currentPostTemplate:l,otherPostTemplate:a,location:r}=t;return(0,i.jsxs)("div",{className:"nelio-content-series-post-list-setting",children:[(0,i.jsx)("input",{type:"hidden",name:e,value:JSON.stringify(t)}),(0,i.jsx)(R.CheckboxControl,{className:"nelio-content-series-post-list-setting__activation-control",checked:s,label:(0,v._x)("Display a box in a single post with the list of all posts belonging to the series where the post belongs to","text","nelio-content"),onChange:e=>n(Object.assign(Object.assign({},t),{isActive:e}))}),s&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(R.SelectControl,{className:"nelio-content-series-metadata-setting__location-control",label:(0,v._x)("Series Post List Location","text","nelio-content"),help:(0,v._x)("Select where do you want the series post list box to appear in a single post.","user","nelio-content"),options:W,value:r,onChange:e=>n(Object.assign(Object.assign({},t),{location:e}))}),(0,i.jsx)(H,{value:o,type:["series","post-list"],label:(0,v._x)("Series Post List Template","text","nelio-content"),help:(0,v._x)("This controls what information is displayed in the list of all the posts in the series.","user","nelio-content"),isMultiline:!0,onChange:e=>n(Object.assign(Object.assign({},t),{generalTemplate:e}))}),(0,i.jsx)(H,{value:a,type:"post",label:(0,v._x)("Series Single Post Item Template","text","nelio-content"),help:(0,v._x)("This controls what information is displayed in the list for a single post in the series.","user","nelio-content"),isMultiline:!1,onChange:e=>n(Object.assign(Object.assign({},t),{otherPostTemplate:e}))}),(0,i.jsx)(H,{value:l,type:"post",label:(0,v._x)("Series Current Single Post Item Template","text","nelio-content"),help:(0,v._x)("This controls what information is displayed in the list for the current post in the series.","user","nelio-content"),isMultiline:!1,onChange:e=>n(Object.assign(Object.assign({},t),{currentPostTemplate:e}))})]})]})}};function Z(e,t){const{component:n}=t,s=Y[n];if(!s)return;const o=document.getElementById(e);if(!o)return;const{name:a,value:r,attributes:d}=t,{setValue:p,setAttributes:h}=(0,l.dispatch)(x);var u,g;p(a,r),h(a,d),u=(0,i.jsx)(s,{name:a}),(g=o)&&(c.createRoot?(0,c.createRoot)(g).render(u):(0,c.render)(u,g))}const ee=document.getElementById("nelio-content-settings-form");null==ee||ee.addEventListener("keypress",(function(e){if(!e)return;const t=e.target||e.srcElement;t&&"submit"!==t.id&&(/textarea/i.test(t.tagName)||13===(e.keyCode||e.which||e.charCode||0)&&e.preventDefault())}))}},n={};function s(e){var o=n[e];if(void 0!==o)return o.exports;var i=n[e]={exports:{}};return t[e](i,i.exports,s),i.exports}s.m=t,e=[],s.O=(t,n,o,i)=>{if(!n){var l=1/0;for(d=0;d<e.length;d++){for(var[n,o,i]=e[d],a=!0,r=0;r<n.length;r++)(!1&i||l>=i)&&Object.keys(s.O).every((e=>s.O[e](n[r])))?n.splice(r--,1):(a=!1,i<l&&(l=i));if(a){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[n,o,i]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={8284:0,7491:0};s.O.j=t=>0===e[t];var t=(t,n)=>{var o,i,[l,a,r]=n,c=0;if(l.some((t=>0!==e[t]))){for(o in a)s.o(a,o)&&(s.m[o]=a[o]);if(r)var d=r(s)}for(t&&t(n);c<l.length;c++)i=l[c],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(d)},n=globalThis.webpackChunkNelioContent=globalThis.webpackChunkNelioContent||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=s.O(void 0,[7491],(()=>s(4131)));o=s.O(o);var i=NelioContent="undefined"==typeof NelioContent?{}:NelioContent;for(var l in o)i[l]=o[l];o.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();